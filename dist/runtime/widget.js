/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-arcgis","jimu-core/react","jimu-theme","jimu-ui/basic/color-picker","jimu-ui","jimu-ui/basic/date-picker"],(function(e,t){var r={},n={},o={},s={},i={},a={},l={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(s,"__esModule",{value:!0}),{setters:[function(e){r.DataRecordSetChangeMessage=e.DataRecordSetChangeMessage,r.MessageManager=e.MessageManager,r.React=e.React,r.ReactDOM=e.ReactDOM,r.ReactRedux=e.ReactRedux,r.RecordSetChangeType=e.RecordSetChangeType,r.SessionManager=e.SessionManager,r.WidgetState=e.WidgetState,r.appActions=e.appActions,r.css=e.css,r.getAppStore=e.getAppStore,r.hooks=e.hooks,r.jsx=e.jsx},function(e){Object.keys(e).forEach((function(t){n[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){o[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){s[t]=e[t]}))},function(e){i.ColorPicker=e.ColorPicker},function(e){a.AdvancedButtonGroup=e.AdvancedButtonGroup,a.Alert=e.Alert,a.Button=e.Button,a.Checkbox=e.Checkbox,a.FormGroup=e.FormGroup,a.Label=e.Label,a.Loading=e.Loading,a.LoadingType=e.LoadingType,a.MultiSelect=e.MultiSelect,a.NumericInput=e.NumericInput,a.Option=e.Option,a.Radio=e.Radio,a.RichDisplayer=e.RichDisplayer,a.SVG=e.SVG,a.Select=e.Select,a.Slider=e.Slider,a.Switch=e.Switch,a.Table=e.Table,a.TagInput=e.TagInput,a.TextArea=e.TextArea,a.TextInput=e.TextInput,a.Tooltip=e.Tooltip,a.UrlInput=e.UrlInput},function(e){l.DatePicker=e.DatePicker}],execute:function(){e((()=>{var e={71:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.3 15.6A7.3 7.3 0 1 0 8.3 1a7.3 7.3 0 0 0 0 14.6M8.3 2A6.3 6.3 0 1 1 2 8.3 6.307 6.307 0 0 1 8.3 2m3.5 6.8h-4v-5h1v4h3z" clip-rule="evenodd"></path></svg>'},657:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m4-3a4 4 0 0 1-4 4 6.5 6.5 0 0 0-6.5 6.5h-1a7.5 7.5 0 0 1 5.286-7.168A4 4 0 1 1 12 5m1 5.5v1h-2v-1a1 1 0 1 1 2 0m-3 0v1H9v4h6v-4h-1v-1a2 2 0 1 0-4 0m0 2v2h4v-2z" clip-rule="evenodd"></path></svg>'},884:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14 2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3.986l.001-.024L0 4a2 2 0 0 1 2-2zm1 2.934L8.277 9.416a.5.5 0 0 1-.554 0L1 4.935V12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1zM14 3H2a1 1 0 0 0-.97.752L8 8.398l6.97-4.646A1 1 0 0 0 14 3"></path></svg>'},930:(e,t,r)=>{"use strict";r.d(t,{$j:()=>w,Fh:()=>v,Mb:()=>d,XV:()=>h,c$:()=>p,dB:()=>g,gg:()=>c,hS:()=>S,lH:()=>R,m4:()=>y,qC:()=>m,qm:()=>E,xs:()=>l,yC:()=>b});var n=r(9244),o=r(3417),s=r(2238),i=r(4986),a=r(6920);const l=()=>{if("undefined"==typeof navigator)return!1;try{const e=globalThis.navigator;return Boolean(e&&!e.onLine)}catch{return!1}},c=e=>e?e.length<=4?"*".repeat(e.length):e.length<=8?`${e.slice(0,2)}${"*".repeat(e.length-4)}${e.slice(-2)}`:`${e.slice(0,4)}${"*".repeat(Math.max(4,e.length-8))}${e.slice(-4)}`:"",u=e=>{const t=(0,i.Nn)(e);if(!t)return"token:none";let r=0;for(let e=0;e<t.length;e+=1)r=31*r+t.charCodeAt(e)>>>0;return`token:${r.toString(36)}`},d=(e,t,r,n)=>{const a=(0,i.Nn)(e),l=(0,i.Nn)(t);if(!a||!l)return null;const c={fmeServerUrl:a,fmeServerToken:l,repository:(0,i.Nn)(r)||o.nu,...Number.isFinite(n)?{requestTimeout:n}:{}};try{return(0,s.ER)(c)}catch{return null}},p=(e,...t)=>f(e,t),f=(e,t)=>{const r=e.replace(/\/$/,""),n=t.filter((e=>"string"==typeof e&&e.length>0)).map((e=>e.split("/").filter((e=>Boolean(e)&&"."!==e&&".."!==e)).map((e=>encodeURIComponent(e))).join("/"))).join("/");return n?`${r}/${n}`:r},h=(e={},t=[],r=!1)=>{const n=new URLSearchParams;if("object"!=typeof e||null===e)return n;const o=new Set(t);for(const[t,r]of Object.entries(e)){if(null==r||o.has(t))continue;const e=(0,a.wc)(r);if(null==e)continue;if((0,i.E$)(e)){n.append(t,(0,a.SB)(e));continue}const s=(0,i.P6)(e);s?n.append(t,s):n.append(t,(0,i.N7)(e))}if(r){const t=t=>{const r=n.get(t);if(null!==r)return r;const o=e[t];return(0,i.Bv)(o)},r="xml"===(0,i.QK)(t("opt_responseformat"))?"xml":"json";n.set("opt_responseformat",r);const o="false"===(0,i.QK)(t("opt_showresult"))?"false":"true";n.set("opt_showresult",o);const s="sync"===(0,i.QK)(t("opt_servicemode"))?"sync":"async";n.set("opt_servicemode",s)}return n},m=(e,t,r,n)=>{},g=e=>{const t=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(`^https?://${t}`,"i")},y=(e,t)=>!!Array.isArray(e)&&e.some((e=>{if(!e||"object"!=typeof e)return!1;const r=e;if(!r._fmeInterceptor)return!1;const n=r.urls;return n instanceof RegExp?n.source===t.source&&n.flags===t.flags:"string"==typeof n&&t.test(n)}));function E(e,t,r){const n=`${e}::${t||""}::${r||""}`;let s=o.QB.DJB2_INITIAL;for(let e=0;e<n.length;e++)s=(s<<5)+s^n.charCodeAt(e);return Math.abs(s>>>0).toString(36)}const v=e=>(e??"").toLowerCase().includes("application/json"),b=e=>{const t=(0,i.P6)(e);if(!t)return null;try{return new URL(t)}catch{return null}},w=e=>{const t=b(e);return t&&t.hostname||null},S=async e=>{const t=await n.SessionManager.getInstance().getUserInfo(),r=(t?.email||e?.defaultRequesterEmail||"").trim().toLowerCase();if(!o.Xw.test(r)){const e=new Error("MISSING_REQUESTER_EMAIL");throw e.name="MISSING_REQUESTER_EMAIL",e}return r},R={fme:["fme"],workspaces:(e,t,r)=>[...R.fme,"workspaces",e||o.nu,t,u(r)],workspaceItem:(e,t,r,n)=>[...R.fme,"workspace-item",e,t||o.nu,r,u(n)],repositories:(e,t)=>[...R.fme,"repositories",e,u(t)],health:(e,t)=>[...R.fme,"health",e,u(t)]}},1020:(e,t,r)=>{"use strict";var n=r(8972),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,s={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:o,type:e,key:c,ref:u,props:s,_owner:a.current}}t.jsx=c},1138:(e,t,r)=>{"use strict";r.d(t,{$5:()=>R,GC:()=>E,Ok:()=>I,Wz:()=>h,bN:()=>y,fA:()=>g,fV:()=>S,ps:()=>m,r5:()=>A,sJ:()=>u,zf:()=>f});var n=r(3417),o=r(3890),s=r(4986),i=r(1181);const a="error",l=new Map([["GEOMETRY_SERIALIZATION_FAILED","polygon"],["MAP_MODULES_LOAD_FAILED","map"],["FORM_INVALID","warning"]]),c=Object.freeze([{token:"GEOMETRY",icon:"polygon"},{token:"AREA",icon:"polygon"},{token:"MAP",icon:"map"},{token:"MODULE",icon:"map"},{token:"FORM",icon:"warning"},{token:"TOKEN",icon:"person-lock"},{token:"AUTH",icon:"person-lock"},{token:"REPOSITORY",icon:"folder"},{token:"REPO",icon:"folder"},{token:"DATA",icon:"data"},{token:"NETWORK",icon:"shared-no"},{token:"OFFLINE",icon:"shared-no"},{token:"CONNECTION",icon:"shared-no"},{token:"REQUEST",icon:"shared-no"},{token:"SERVER",icon:"feature-service"},{token:"GATEWAY",icon:"feature-service"},{token:"URL",icon:"link-tilted"},{token:"TIMEOUT",icon:"time"},{token:"CONFIG",icon:"setting"},{token:"EMAIL",icon:"email"}]),u=e=>{if("string"!=typeof e||!e.trim())return a;const t=e.trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").toUpperCase();const r=l.get(t);if(r)return r;const n=(e=>{for(const{token:t,icon:r}of c)if(e.includes(t))return r})(t);return n||a},d=/\baborted?\b/i,p=new Set(["AbortError","ABORT_ERR","ERR_ABORTED"]),f=e=>{if(!e)return!1;if("object"==typeof e&&null!==e){const t=e,r=(0,s.N7)(t.name??t.code);if(p.has(r))return!0;if(!r||"Error"===r){const e=(0,s.N7)(t.message);return d.test(e)||e.includes("signal is aborted")}return!1}return"string"==typeof e&&d.test(e)},h=(e,t)=>{if(e)try{e.signal.aborted||e.abort(t)}catch{try{e.abort()}catch{}}},m=(e,t,r)=>{if(!e)return()=>{};if(e.aborted){const n=e.reason;return h(t,n),r&&r(n),()=>{}}const n=()=>{const n=e.reason;h(t,n),r&&r(n)};return e.addEventListener("abort",n),()=>{try{e.removeEventListener("abort",n)}catch{}}},g=(e,t)=>{},y=e=>{if(!e)return!0;const t=e.code||"",r=e.message||"";return"CANCELLED"===t||"ABORT"===t||/cancel/i.test(r)},E=(e,t,r)=>{const n=[];return t.onRetry&&n.push({label:r("actionRetry"),onClick:t.onRetry}),t.onReload&&n.push({label:r("actionReload"),onClick:t.onReload}),n},v={codeToKey:n.jF,statusToKey:n.KG,messagePatterns:n.a9},b=e=>{if("number"==typeof e)return v.statusToKey[e]?v.statusToKey[e]:void 0},w=(e,t,r="network")=>{const n=((e,t)=>{const r=t??(0,o.Ko)(e),n=e&&"object"==typeof e?e:null,s="string"==typeof n?.code?n.code:void 0;return{status:r,code:s,message:"string"==typeof n?.message?n.message:void 0,isRequestFailed:"REQUEST_FAILED"===s}})(e,t);if("network"===r&&n.isRequestFailed)return b(n.status);if(n.code&&v.codeToKey[n.code])return v.codeToKey[n.code];if("geometry"!==r){const e=b(n.status);if(e)return e}if(n.message){const e=(e=>{const t=e.toLowerCase();for(const{pattern:e,key:r}of v.messagePatterns)if(e.test(t))return r})(n.message);if(e)return e}return"geometry"===r?"geometrySerializationFailedCode":void 0},S=(e,t)=>w(e,t,"network"),R=(e,t={})=>{const r=Date.now();return{message:e,type:t.type??n.By.NETWORK,code:t.code??"UNKNOWN",severity:t.severity??n.MU.ERROR,recoverable:t.recoverable??!0,timestamp:new Date,timestampMs:r,userFriendlyMessage:t.userFriendlyMessage??"",suggestion:t.suggestion??"",retry:t.retry,kind:"runtime"}},T=(e,t,r={})=>{const o=Date.now(),s=r.code??`${e.toUpperCase()}_ERROR`,i=r.scope??"general",a=r.recoverable??e!==n.By.MODULE;return{message:t,type:e,code:s,severity:r.severity??n.MU.ERROR,recoverable:a,timestampMs:o,userFriendlyMessage:r.userFriendlyMessage??"",suggestion:r.suggestion??"",details:r.details,kind:"serializable",errorId:`${i}_${s}`}},O={[n.By.NETWORK]:(e,t={})=>T(n.By.NETWORK,e,t),[n.By.VALIDATION]:(e,t={})=>T(n.By.VALIDATION,e,t),[n.By.CONFIG]:(e,t={})=>T(n.By.CONFIG,e,t),[n.By.GEOMETRY]:(e,t={})=>T(n.By.GEOMETRY,e,t),[n.By.MODULE]:(e,t={})=>T(n.By.MODULE,e,t)},A=(n.By.NETWORK,n.By.VALIDATION,n.By.CONFIG,O[n.By.GEOMETRY]),I=(n.By.MODULE,(e,t,r)=>{const n=e.code.toUpperCase(),o="GEOMETRY_INVALID"===n||"INVALID_GEOMETRY"===n,s="AREA_TOO_LARGE"===n,a="CONFIG_INCOMPLETE"===n,l=o||s||a,c=(0,i.I0)(e.message,t)||e.message,u=e.userFriendlyMessage||void 0;let d;return d=o?t("hintGeometryInvalid"):s?t("hintAreaTooLarge"):a?t("hintSetupWidget"):(0,i.Ej)(t,r,u),{message:c,code:l?void 0:e.code,hint:d}})},1181:(e,t,r)=>{"use strict";r.d(t,{$e:()=>Q,$j:()=>l,BU:()=>D,Ej:()=>p,FK:()=>$,HK:()=>x,I0:()=>u,JR:()=>T,Jd:()=>te,LH:()=>ne,OD:()=>M,Ox:()=>g,PE:()=>re,RM:()=>v,SP:()=>O,WZ:()=>C,Wx:()=>L,Xk:()=>G,Z_:()=>E,dC:()=>R,hk:()=>N,kz:()=>oe,q2:()=>d,rI:()=>P,xi:()=>c});var n=r(9244),o=r(3417),s=r(3890),i=r(4986),a=r(7389);const l=e=>{if(!(0,i.Bf)(e)||e<0)return null;const t=["B","KiB","MiB","GiB","TiB"];let r=e,n=0;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${n>0&&r<10?r.toFixed(1):Math.round(r).toString()} ${t[n]}`},c=(e,t)=>Number.isFinite(e)?"number"==typeof t&&t>=0?e.toFixed(t):e.toString():"";function u(e,t){return e?t(e):""}const d=e=>{const t=(0,i.Nn)(e);if(!t||!(0,s.B9)(t))return t||"";const r=t.indexOf("@");if(r<=1)return`**${t.slice(r)}`;const n=t.slice(0,r),o=t.slice(r);return`${n.slice(0,2)}****${o}`},p=(e,t,r)=>{const n=(0,i.Nn)(t);if(!n)return(0,i.Nn)(r)||"";return e("contactSupportEmail").replace(o.BY,n)},f=Object.freeze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),h=/&(?:amp|lt|gt|quot|#39);/g,m=(e,t)=>{if(e.length>6)return"";if(!/^[0-9a-f]+$/i.test(e))return"";const r=Number.parseInt(e,t);if(!Number.isFinite(r)||r<0||r>1114111)return"";try{return String.fromCodePoint(r)}catch{return""}},g=e=>{if(!e)return"";const t=(e=>{try{if("undefined"!=typeof DOMParser&&"function"==typeof DOMParser){const t=(new DOMParser).parseFromString(e,"text/html");return t?.body?.textContent||""}const t=document.createElement("div");return t.textContent=e,t.textContent||""}catch{}return null})(e);if(null!==t)return t.replace(/\s+/g," ").trim();const r=e.replace(/<\s*(script|style)[^>]*>[\s\S]*?<\s*\/\s*\1\s*>/gi,"").replace(/<[^>]*>/g,"");return r.replace(/&#(\d+);/g,((e,t)=>m(t,10))).replace(/&#x([\da-f]+);/gi,((e,t)=>m(t,16))).replace(h,(e=>f[e]||e)).replace(/\s+/g," ").trim()},y=/^(?:error|fel|warning|varning|info)\s*[:\-\u2013\u2014]?\s*/i,E=e=>{const t=(0,i.Nn)(e);if(!t)return"";return t.replace(y,"").trim()||t},v=e=>e?(0,n.css)(e):void 0,b=e=>String(e).padStart(2,"0"),w=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/,S=/^([0-9]{2}):([0-9]{2})(?::([0-9]{2}))?$/,R=e=>{if(!e)return null;const t=e.trim();if(!t)return null;const r=t.includes("T")?t:`${t}T00:00:00`,[n="",o=""]=r.split("T"),s=w.exec(n),i=S.exec(o);if(!s||!i)return null;const a=Number(s[1]),l=Number(s[2]),c=Number(s[3]),u=Number(i[1]),d=Number(i[2]),p=i[3]?Number(i[3]):0;if(!(Number.isFinite(a)&&Number.isFinite(l)&&Number.isFinite(c)&&Number.isFinite(u)&&Number.isFinite(d)&&Number.isFinite(p)))return null;if(l<1||l>12)return null;if(c<1||c>31)return null;if(u<0||u>23)return null;if(d<0||d>59)return null;if(p<0||p>59)return null;const f=new Date(a,l-1,c,u,d,p,0);return f.getFullYear()!==a||f.getMonth()!==l-1||f.getDate()!==c||f.getHours()!==u||f.getMinutes()!==d||f.getSeconds()!==p||Number.isNaN(f.getTime())?null:f},T=(e,t="iso")=>{if(!e)return"";const r=e.getTime();if(Number.isNaN(r))return"";const n=e.getFullYear(),o=b(e.getMonth()+1),s=b(e.getDate()),i=b(e.getHours()),a=b(e.getMinutes()),l=b(e.getSeconds());return"fme"===t?`${n}-${o}-${s} ${i}:${a}:${l}`:`${n}-${o}-${s}T${i}:${a}:${l}`},O=(e,t,r=0,n=[])=>{if(!e)return n;for(const o of e)o&&null!=o.value&&(n.push({option:o,depth:r}),t&&o.children?.length&&O(o.children,t,r+1,n));return n},A=/(Z|[+-]\d{2}(?::?\d{2})?)$/i,I=/\.(\d{1,9})$/,_=e=>{if(!e)return{base:"",fraction:"",offset:""};let t=e,r="";const n=A.exec(t);n?.[1]&&(r=n[1],t=t.slice(0,-r.length));let o="";const s=I.exec(t);return s?.[0]&&(o=s[0],t=t.slice(0,-o.length)),{base:t,fraction:o,offset:r}},C=e=>{const t=(e||"").trim();return _(t)},k=e=>{if(!e)return null;const t=Number(e);return(0,i.eF)(t)&&t<=99?b(t):null},L=e=>{const t=(e||"").replace(/\D/g,"");if(8!==t.length)return"";const r=t.slice(0,4),n=t.slice(4,6),o=t.slice(6,8),s=Number(r),i=Number(n),a=Number(o);return s<1e3||s>9999||i<1||i>12||a<1||a>31?"":`${r}-${n}-${o}`},M=e=>e?e.replace(/-/g,""):"",N=e=>{const{base:t}=C(e),r=t.replace(/\D/g,"");if(r.length<12)return"";const n=r.slice(0,4),o=r.slice(4,6),s=r.slice(6,8),i=r.slice(8,10),a=r.slice(10,12),l=r.length>=14?r.slice(12,14):"";return`${n}-${o}-${s}T${i}:${a}${l?`:${l}`:""}`},x=(e,t)=>{if(!e)return"";const r=e.trim(),[n,o]=r.split("T");if(!n||!o)return(0,a.J)("inputToFmeDateTime: Invalid ISO format",e),"";const[s,i,l]=n.split("-"),{base:c,fraction:u,offset:d}=_(o),[p,f,h]=c.split(":");if(!s||4!==s.length||!/^\d{4}$/.test(s))return(0,a.J)("inputToFmeDateTime: Invalid year",s),"";const m=k(i),g=k(l),y=k(p),E=k(f);if(!(m&&g&&y&&E))return(0,a.J)("inputToFmeDateTime: Invalid date/time components",{m:i,d:l,hh:p,mi:f}),"";const v=h?k(h):"00";if(null===v)return(0,a.J)("inputToFmeDateTime: Invalid seconds",h),"";const b=`${s}${m}${g}${y}${E}${v}`,w=t?C(t):null;return`${b}${u||w?.fraction||""}${d||w?.offset||""}`},D=e=>{const{base:t}=C(e),r=t.replace(/\D/g,"");return 4===r.length?`${r.slice(0,2)}:${r.slice(2,4)}`:r.length>=6?`${r.slice(0,2)}:${r.slice(2,4)}:${r.slice(4,6)}`:""},P=(e,t)=>{if(!e)return"";const{base:r,fraction:n,offset:o}=_(e),s=r.split(":").map((e=>e||"")),i=s[0]||"",a=s[1]||"",l=s[2]||"",c=Number(i),u=Number(a);if(!Number.isFinite(c)||!Number.isFinite(u))return"";const d=Number(l),p=Number.isFinite(d)?b(d):"00",f=`${b(c)}${b(u)}${p}`,h=t?C(t):null;return`${f}${n||h?.fraction||""}${o||h?.offset||""}`},F=(e,t,r)=>Number.isFinite(e)?Math.max(t,Math.min(r,e)):t,j=e=>F(e,0,1),U=e=>F(e,0,255),V=e=>Math.round(U(e)).toString(16).padStart(2,"0"),W=e=>Number(j(e).toFixed(6)).toString(),B=e=>W(e/255),q=(e,t,r)=>`#${V(e)}${V(t)}${V(r)}`,G=e=>{const t=/^#?([0-9a-f]{6})$/i.exec(e||""),r=t?parseInt(t[1],16):parseInt(o.Ve.slice(1),16);return[r>>16&255,r>>8&255,255&r]},Q=(e,t)=>{const r=(e||"").split(",").map((e=>e.trim())).filter(Boolean).map(Number);if(!r.length)return null;if("cmyk"===t?.space||!t?.space&&!t?.alpha&&4===r.length){if(r.length<4||!r.slice(0,4).every(Number.isFinite))return null;const[e,t,n,o]=r,s=((e,t,r,n)=>{const o=j(e),s=j(t),i=j(r),a=j(n);return{r:U(255*(1-o)*(1-a)),g:U(255*(1-s)*(1-a)),b:U(255*(1-i)*(1-a))}})(e,t,n,o);return q(s.r,s.g,s.b)}if(r.length<3||!r.slice(0,3).every(Number.isFinite))return null;const[n,o,s]=r,i=U(Math.round(255*j(n))),a=U(Math.round(255*j(o))),l=U(Math.round(255*j(s)));return q(i,a,l)},$=(e,t)=>{const r=/^#?([0-9a-f]{6})$/i.exec(e||"");if(!r)return null;const n=parseInt(r[1],16),o=n>>16&255,s=n>>8&255,i=255&n;if("cmyk"===t?.space){const{c:e,m:t,y:r,k:n}=((e,t,r)=>{const n=j(e/255),o=j(t/255),s=j(r/255),i=1-Math.max(n,o,s);if(i>=.999999)return{c:0,m:0,y:0,k:1};const a=1-i;return{c:j((1-n-i)/a),m:j((1-o-i)/a),y:j((1-s-i)/a),k:j(i)}})(o,s,i);return[e,t,r,n].map(W).join(",")}return[o,s,i].map(B).join(",")},H=1e6,z=2,K=27878400,X=[{factor:.3048,label:"ft\xb2",keywords:["foot","feet"],largeUnit:{threshold:K,factor:K,label:"mi\xb2"}},{factor:.3048006096,label:"ft\xb2",keywords:[]},{factor:1609.344,label:"mi\xb2",keywords:["mile"]},{factor:1e3,label:"km\xb2",keywords:["kilometer"]},{factor:.9144,label:"yd\xb2",keywords:["yard"]},{factor:.0254,label:"in\xb2",keywords:["inch"]},{factor:.01,label:"cm\xb2",keywords:["centimeter"]},{factor:.001,label:"mm\xb2",keywords:["millimeter"]},{factor:1852,label:"nm\xb2",keywords:["nautical"]},{factor:1,label:"m\xb2",keywords:["meter"]}],Y=(e,t=!1)=>t?2:e>=100?0:e>=10?1:2,J=e=>e>=H?{value:e/H,label:"km\xb2",decimals:z}:e>=1?{value:Math.round(e),label:"m\xb2",decimals:0}:{value:Number(e.toFixed(2)),label:"m\xb2",decimals:2},Z=(e,t)=>X.find((r=>((e,t)=>{if(!(0,i.Bf)(e))return!1;const r=Math.max(1e-9,1e-6*Math.abs(t));return Math.abs(e-t)<=r})(e,r.factor)||((e,t)=>t.some((t=>e.includes(t))))(t,r.keywords)))??null,ee=(e,t)=>{if(!t)return J(e);const r=t.metersPerUnit;if(!(0,i.Bf)(r))return J(e);const n="string"==typeof t.unit?t.unit.toLowerCase():"",o=Z(r,n);return o?((e,t,r)=>{const n=e/(t*t);if(r.largeUnit&&n>=r.largeUnit.threshold)return{value:n/r.largeUnit.factor,label:r.largeUnit.label,decimals:2};const o=Y(n,r.label.includes("km\xb2")||r.label.includes("mi\xb2"));return{value:n,label:r.label,decimals:o}})(e,r,o):((e,t,r)=>{const n=e/(t*t),o=Y(n),s="string"==typeof r?(e=>{if(!e)return"units\xb2";const t=e.replace(/^esri/i,"").trim();if(!t)return"units\xb2";const r=t.toLowerCase();switch(r){case"meters":return"m\xb2";case"feet":case"internationalfeet":case"ussfeet":return"ft\xb2";case"kilometers":return"km\xb2";case"miles":return"mi\xb2";case"yards":return"yd\xb2";case"inches":return"in\xb2";case"centimeters":return"cm\xb2";case"millimeters":return"mm\xb2";case"nauticalmiles":return"nm\xb2";default:return`${r}\xb2`}})(r):"units\xb2";return{value:n,label:s,decimals:o}})(e,r,t.unit)};function te(e,t,r){const n=Number.isFinite(e)&&e>0?e:0,o=ee(n,r);if(!o.value||o.value<=0)return`0 ${o.label}`;return`${((e,r)=>{const n=t.intl,o=n?.formatNumber;if("function"==typeof o){const t=o(e,{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:r});return"number"==typeof t?t.toString():t}return e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:r})})(o.value,o.decimals)} ${o.label}`}const re=e=>{if(!e)return"Unknown error";if("string"==typeof e)return e;if("number"==typeof e)return e.toString();if(e instanceof Error)return e.message||"Error object";if("object"==typeof e&&null!==e){const t=e;for(const e of["message","error","details","description"]){const r=t[e];if((0,i.YH)(r))return r.trim()}}return"Unknown error occurred"},ne=(e,t="error")=>e?`${e}-${t}`:void 0,oe=(e,t,r,n,o)=>{if(r)return r;const s=(0,i.P6)(e);if(s)return s;if(!t)return;return(0,i.P6)(n)||o}},1337:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 0a4 4 0 0 1 4 4v3a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2V4a4 4 0 0 1 4-4M5 7h1V4a2 2 0 1 1 4 0v3h1V4a3 3 0 0 0-6 0zm4 0V4a1 1 0 0 0-2 0v3zm3 1H4a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1M7 9h1v1h1v1H8v1h1v1H8v1H7z" clip-rule="evenodd"></path></svg>'},1618:(e,t,r)=>{"use strict";r.d(t,{Ad:()=>v,DU:()=>U,M4:()=>B,NV:()=>E,QC:()=>y,nW:()=>W,x0:()=>D});var n=r(3417),o=r(4986),s=r(1138),i=r(3314),a=r(7389);const l=(e,t)=>{if(!Array.isArray(e)||!Array.isArray(t)||e.length<2||t.length<2)return!1;const r=Math.min(e.length,t.length,2);for(let n=0;n<r;n++){const r=e[n],o=t[n];if("number"!=typeof r||"number"!=typeof o)return!1;if(!Number.isFinite(r)||!Number.isFinite(o))return!1;if(Math.abs(r-o)>1e-9)return!1}return!0},c=e=>"number"==typeof e&&Number.isFinite(e),u=e=>Array.isArray(e)&&e.length>=2&&e.length<=4&&e.every(c),d=e=>"object"==typeof e&&null!==e,p=e=>{if(!Array.isArray(e)||e.length<4)return!1;if(!e.every(u))return!1;const t=e[0],r=e[e.length-1];return l(t,r)},f=e=>{if(!d(e))return!1;const t="geometry"in e?e.geometry:e;if(!d(t))return!1;const r="rings"in t?t.rings:void 0;return Array.isArray(r)&&r.length>0&&r.every(p)},h=e=>{if("object"!=typeof e||null===e)return{};const t=e;return{wkid:"number"==typeof t.wkid?t.wkid:void 0,latestWkid:"number"==typeof t.latestWkid?t.latestWkid:void 0}},m=e=>{const t=e;if(t?.isWebMercator)return!0;const{wkid:r,latestWkid:n}=h(e);return 3857===r||3857===n},g=e=>{const t=e;if(t?.isGeographic||t?.isWGS84)return!0;const{wkid:r,latestWkid:n}=h(e);return 4326===r||4326===n},y=e=>{if(!e?.length)return[];const t=new Set,r=[];for(const s of e){if(!s||s.type!==n.QL.GEOMETRY)continue;const e=(0,o.Nn)(s.name);e&&!t.has(e)&&(t.add(e),r.push(e))}return r},E=(e,t,r,s,i,a)=>{const l=(0,o.E)(i?.aoiParamName,"AreaOfInterest"),c=((e,t)=>{if(f(e))return"geometry"in e?e.geometry:e;const r=t?.toJSON();return f(r)?r:null})(t,r);if(!c)return e;const u=(e=>{try{return JSON.stringify(e)}catch{return null}})(c);if(!u)return{...e,__aoi_error__:{message:"GEOMETRY_SERIALIZATION_FAILED",type:n.By.GEOMETRY,code:"GEOMETRY_SERIALIZATION_FAILED",severity:n.MU.ERROR,recoverable:!0,timestamp:new Date,timestampMs:Date.now()}};const d={...e,[l]:u};if(a?.length){const e=new Set;for(const t of a){if("string"!=typeof t)continue;const r=(0,o.E)(t,"");r&&r!==l&&e.add(r)}for(const t of e)d[t]=u}return d},v=e=>{void 0!==e.__aoi_error__&&delete e.__aoi_error__},b=e=>"object"==typeof e&&null!==e&&"then"in e&&"function"==typeof e.then,w=e=>"object"==typeof e&&null!==e&&"polygon"===e.type;let S,R,T,O;const A=e=>e.default??e,I=async(e,t,r)=>{if(!e)return 0;const n=e.geodesicArea;if(r&&"function"==typeof n)try{const e=await n(t,"square-meters");if(Number.isFinite(e)&&e>0)return e}catch(e){(0,a.J)("geodesicArea calculation failed, trying planar fallback",e)}const o=e.planarArea;if("function"==typeof o)try{const e=await o(t,"square-meters");if(Number.isFinite(e)&&e>0)return e}catch(e){(0,a.J)("planarArea calculation failed",e)}return 0},_=async e=>{try{const t=e?.esriConfig?.geometryServiceUrl;if("string"==typeof t&&t)return t;const r=await(async e=>{if(e?.esriConfig)return e.esriConfig;if(void 0!==O)return O;try{const[e]=await(0,i.ps9)(["esri/config"]);O=A(e)}catch{O=null}return O})(e);if(!r)return null;const n=r.geometryServiceUrl;if("string"==typeof n&&n)return n;const o=r.request?.geometryServiceUrl;if("string"==typeof o&&o)return o;const s=r.portalSelf?.helperServices?.geometry?.url||r.portalInfo?.helperServices?.geometry?.url||r.helperServices?.geometry?.url;if("string"==typeof s&&s)return s}catch{}return null},C=async e=>{if(!e)return null;try{const t=b(e)?await e:e;if(w(t))return t}catch(e){(0,a.J)("Polygon promise resolution failed",e)}return null},k=async(e,t,r,n)=>{const o=e?.[t];if("function"!=typeof o)return null;try{const e=o(r,...n);return await C(e)}catch{return null}},L=async(e,t)=>{const r=e?.spatialReference;if(!(g(r)||m(r)))return e;const n=await(async e=>{if(e?.normalizeUtils?.normalizeCentralMeridian)return e.normalizeUtils;if(void 0!==S)return S;try{const[e]=await(0,i.ps9)(["esri/geometry/support/normalizeUtils"]);S=A(e)}catch{S=null}return S})(t);if(!n?.normalizeCentralMeridian)return e;try{const t=await n.normalizeCentralMeridian([e]),r=Array.isArray(t)?t[0]:null;if(w(r)){if(r!==e){const t=e.extent,n=r.extent;t&&n&&Math.abs(t.xmin-n.xmin)>180&&(0,a.M)("[Geometry] Normalized dateline-crossing polygon",{originalExtent:t,normalizedExtent:n})}return r}}catch{}return e},M=async(e,t)=>{let r=e;return r=await L(r,t),r=await(async(e,t)=>{const r=e?.spatialReference,o=g(r)||m(r),s=g(r);let i=e;if(o){const e=[n.In,"meters"],r=await k(t?.geometryEngineAsync,"geodesicDensify",i,e)??await k(t?.geometryEngine,"geodesicDensify",i,e);r&&(i=r)}const a=[s?Math.max(n.In*n.qc,n.wF):n.In],l=await k(t?.geometryEngineAsync,"densify",i,a)??await k(t?.geometryEngine,"densify",i,a);return l&&(i=l),i})(r,t),r},N=async(e,t)=>{const r=await _(t);if(!r)return 0;const{geometryService:n,AreasAndLengthsParameters:o}=await(async()=>{if(void 0!==R&&void 0!==T)return{geometryService:R,AreasAndLengthsParameters:T};try{const[e,t]=await(0,i.ps9)(["esri/rest/geometryService","esri/rest/support/AreasAndLengthsParameters"]),r=A(e),n=A(t);if(!r||!n)return(0,a.J)("Geometry service modules returned null after unwrap"),R=null,T=null,{geometryService:null,AreasAndLengthsParameters:null};R=r,T=n}catch(e){(0,a.J)("Failed to load geometry service modules",e),R=null,T=null}return{geometryService:R,AreasAndLengthsParameters:T}})();if(!n?.areasAndLengths||"function"!=typeof n.areasAndLengths||!o)return 0;try{const t=new o({polygons:[e],areaUnit:"square-meters",lengthUnit:"meters",calculationType:"geodesic",geodesic:!0}),s=await n.areasAndLengths(r,t),i=s?.areas?.[0];if(Number.isFinite(i)&&Math.abs(i)>0)return Math.abs(i)}catch(e){(0,a.M)("Geometry service area calculation failed, using fallback",e)}return 0},x=(e,t)=>{if(!e)return null;if("function"==typeof e)return e;if("object"!=typeof e)return null;const r=e,n=t?["geodesicArea","geodesic","planarArea","planar"]:["planarArea","planar","geodesicArea","geodesic"];for(const e of n){const t="function"==typeof(o=r[e])?o:null;if(t)return t}var o;return r.area?x(r.area,t):null},D=async(e,t)=>{if(!e||"polygon"!==e.type)return 0;const r=e,o=r.rings?.reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)??0;o>n.VZ.MAX_GEOMETRY_VERTICES&&(0,a.M)("[Geometry] Processing complex polygon",{vertices:o,rings:r.rings?.length??0,estimatedProcessingTime:`${Math.round(o/n.QC.VERTICES_PER_MS_ESTIMATE)}ms`});let s=r;try{s=await M(r,t)}catch{s=r}const i=(e=>{try{if(g(e.spatialReference)||m(e.spatialReference))return!0;const t=e.toJSON?.();if(t&&"object"==typeof t){const e=t.spatialReference;return g(e)||m(e)}}catch{}return!1})(s),l=((e,t,r)=>{const n=[],o=x(t?.geometryOperators,r);return o&&n.push((async()=>{try{const t=o.length>=2?o(e,"square-meters"):o(e),r=b(t)?await t:t;if("number"==typeof r&&Math.abs(r)>0)return Math.abs(r)}catch{}return 0})),t?.geometryEngineAsync&&n.push((()=>I(t.geometryEngineAsync,e,r))),t?.geometryEngine&&n.push((()=>I(t.geometryEngine,e,r))),n})(s,t,i);for(const e of l)try{const t=await e();if(t>0)return t}catch{}const c=await N(s,t);return c>0?((0,a.M)("[Performance] Fell back to geometry service for area calculation",{polygonVertices:s.rings?.[0]?.length??0,spatialReference:s.spatialReference?.wkid}),c):0},P=async(e,t,r)=>(async(e,t,r)=>{const n=r?.simplify;if("function"==typeof n){const o=await n(e),s=await C(o);if(s){const e=r?.isSimple??t?.isSimple;if("function"!=typeof e)return s;{const t=e(s);if(b(t)?await t:t)return s}}}const o=t?.simplify;if("function"==typeof o){const r=await C(o(e));if(r){const e=t?.isSimple;if("function"!=typeof e)return r;{const t=e(r);if(b(t)?await t:t)return r}}}const s=t?.isSimple;if("function"==typeof s){const t=s(e);if(b(t)?await t:t)return e}return null})(e,t,r),F=e=>{if(!Array.isArray(e)||0===e.length)return!1;const t=e[0],r=e[e.length-1];return Boolean(t&&r&&Array.isArray(t)&&Array.isArray(r)&&t[0]===r[0]&&t[1]===r[1])},j=(e,t)=>({valid:!1,error:(0,s.r5)(e,{code:t,scope:"general"})}),U=async(e,t)=>{if(!e)return j("geometryMissingMessage","NO_GEOMETRY");if("polygon"!==e.type)return j("geometryPolygonRequired","INVALID_GEOMETRY_TYPE");if(!t?.geometryEngine&&!t?.geometryEngineAsync)return{valid:!0};try{const r=t.geometryEngine,n=t.geometryEngineAsync;let s=e;const i=await P(s,r,n);if(!i)return j("geometryNotSimple","INVALID_GEOMETRY");s=i;const a=s.rings,l=(0,o.eC)(a);if(!(e=>{if(!Array.isArray(e)||0===e.length)return!1;for(const t of e){if(!Array.isArray(t)||t.length<4)return!1;if(!F(t))return!1}return!0})(l))return j("geometryInvalidCode","GEOMETRY_INVALID");const c=await D(s,t);return!c||c<=0?j("geometryInvalidCode","GEOMETRY_INVALID"):((e,t,r,n)=>{if(e.length<=1)return!0;const o=r?.contains;if("function"!=typeof o)return!0;try{const r=n?.Polygon;if(!r)return!0;const s=r.fromJSON({rings:[e[0]],spatialReference:t.spatialReference});for(let n=1;n<e.length;n++)if(!o(s,r.fromJSON({rings:[e[n]],spatialReference:t.spatialReference})))return!1}catch{return!0}return!0})(l,s,r,t)?{valid:!0,simplified:s}:j("geometryInvalidCode","GEOMETRY_INVALID")}catch{return j("geometryValidationFailedMessage","GEOMETRY_VALIDATION_ERROR")}},V=e=>{if("number"==typeof e&&Number.isFinite(e)&&!(e<=0))return e},W=(e,t)=>{const r=Math.abs(e)||0,n=V(t?.maxArea),o=V(t?.largeArea),s="number"==typeof n&&r>n;return{area:r,maxThreshold:n,warningThreshold:o,exceedsMaximum:s,shouldWarn:!s&&"number"==typeof o&&r>o}},B=(e,t)=>{const r=V(t);return!r||e<=r?{ok:!0}:{ok:!1,message:"geometryAreaTooLargeCode",code:"AREA_TOO_LARGE"}}},1658:(e,t,r)=>{"use strict";r.d(t,{q:()=>y});var n=r(4880),o=r(9757),s=r(6261),i=r(6500),a=class extends i.Q{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const s=t.queryKey,i=t.queryHash??(0,n.F$)(s,t);let a=this.get(i);return a||(a=new o.X({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){s.jG.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>(0,n.MK)(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>(0,n.MK)(e,t))):t}notify(e){s.jG.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){s.jG.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){s.jG.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},l=r(6158),c=class extends i.Q{constructor(e={}){super(),this.config=e,this.#t=new Set,this.#r=new Map,this.#n=0}#t;#r;#n;build(e,t,r){const n=new l.s({client:e,mutationCache:this,mutationId:++this.#n,options:e.defaultMutationOptions(t),state:r});return this.add(n),n}add(e){this.#t.add(e);const t=u(e);if("string"==typeof t){const r=this.#r.get(t);r?r.push(e):this.#r.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#t.delete(e)){const t=u(e);if("string"==typeof t){const r=this.#r.get(t);if(r)if(r.length>1){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}else r[0]===e&&this.#r.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=u(e);if("string"==typeof t){const r=this.#r.get(t),n=r?.find((e=>"pending"===e.state.status));return!n||n===e}return!0}runNext(e){const t=u(e);if("string"==typeof t){const r=this.#r.get(t)?.find((t=>t!==e&&t.state.isPaused));return r?.continue()??Promise.resolve()}return Promise.resolve()}clear(){s.jG.batch((()=>{this.#t.forEach((e=>{this.notify({type:"removed",mutation:e})})),this.#t.clear(),this.#r.clear()}))}getAll(){return Array.from(this.#t)}find(e){const t={exact:!0,...e};return this.getAll().find((e=>(0,n.nJ)(t,e)))}findAll(e={}){return this.getAll().filter((t=>(0,n.nJ)(e,t)))}notify(e){s.jG.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return s.jG.batch((()=>Promise.all(e.map((e=>e.continue().catch(n.lQ))))))}};function u(e){return e.options.scope?.id}var d=r(9658),p=r(6035);function f(e){return{onFetch:(t,r)=>{const o=t.options,s=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],a=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let r=!1;const u=(0,n.ZM)(t.options,t.fetchOptions),d=async(e,o,s)=>{if(r)return Promise.reject();if(null==o&&e.pages.length)return Promise.resolve(e);const i=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:o,direction:s?"backward":"forward",meta:t.options.meta};var n;return n=e,Object.defineProperty(n,"signal",{enumerable:!0,get:()=>(t.signal.aborted?r=!0:t.signal.addEventListener("abort",(()=>{r=!0})),t.signal)}),e})(),a=await u(i),{maxPages:l}=t.options,c=s?n.ZZ:n.y9;return{pages:c(e.pages,a,l),pageParams:c(e.pageParams,o,l)}};if(s&&i.length){const e="backward"===s,t={pages:i,pageParams:a},r=(e?m:h)(o,t);l=await d(t,r,e)}else{const t=e??i.length;do{const e=0===c?a[0]??o.initialPageParam:h(o,l);if(c>0&&null==e)break;l=await d(l,e),c++}while(c<t)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=u}}}function h(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function m(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var g=r(3096);const y=new class{#o;#s;#i;#a;#l;#c;#u;#d;constructor(e={}){this.#o=e.queryCache||new a,this.#s=e.mutationCache||new c,this.#i=e.defaultOptions||{},this.#a=new Map,this.#l=new Map,this.#c=0}mount(){this.#c++,1===this.#c&&(this.#u=d.m.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#o.onFocus())})),this.#d=p.t.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#o.onOnline())})))}unmount(){this.#c--,0===this.#c&&(this.#u?.(),this.#u=void 0,this.#d?.(),this.#d=void 0)}isFetching(e){return this.#o.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#s.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#o.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#o.build(this,t),o=r.state.data;return void 0===o?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime((0,n.d2)(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(o))}getQueriesData(e){return this.#o.findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,r){const o=this.defaultQueryOptions({queryKey:e}),s=this.#o.get(o.queryHash),i=s?.state.data,a=(0,n.Zw)(t,i);if(void 0!==a)return this.#o.build(this,o).setData(a,{...r,manual:!0})}setQueriesData(e,t,r){return s.jG.batch((()=>this.#o.findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,r)]))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#o.get(t.queryHash)?.state}removeQueries(e){const t=this.#o;s.jG.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const r=this.#o;return s.jG.batch((()=>(r.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e,t={}){const r={revert:!0,...t},o=s.jG.batch((()=>this.#o.findAll(e).map((e=>e.cancel(r)))));return Promise.all(o).then(n.lQ).catch(n.lQ)}invalidateQueries(e,t={}){return s.jG.batch((()=>(this.#o.findAll(e).forEach((e=>{e.invalidate()})),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},o=s.jG.batch((()=>this.#o.findAll(e).filter((e=>!e.isDisabled()&&!e.isStatic())).map((e=>{let t=e.fetch(void 0,r);return r.throwOnError||(t=t.catch(n.lQ)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(o).then(n.lQ)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const r=this.#o.build(this,t);return r.isStaleByTime((0,n.d2)(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(n.lQ).catch(n.lQ)}fetchInfiniteQuery(e){return e.behavior=f(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(n.lQ).catch(n.lQ)}ensureInfiniteQueryData(e){return e.behavior=f(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return p.t.isOnline()?this.#s.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#o}getMutationCache(){return this.#s}getDefaultOptions(){return this.#i}setDefaultOptions(e){this.#i=e}setQueryDefaults(e,t){this.#a.set((0,n.EN)(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#a.values()],r={};return t.forEach((t=>{(0,n.Cp)(e,t.queryKey)&&Object.assign(r,t.defaultOptions)})),r}setMutationDefaults(e,t){this.#l.set((0,n.EN)(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#l.values()],r={};return t.forEach((t=>{(0,n.Cp)(e,t.mutationKey)&&Object.assign(r,t.defaultOptions)})),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#i.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=(0,n.F$)(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===n.hT&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#i.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#o.clear(),this.#s.clear()}}({defaultOptions:{queries:{staleTime:g.ST.FIVE_MINUTES,gcTime:g.ST.TEN_MINUTES,retry:(e,t)=>{const r=t?.status||t?.response?.status;return r!==g.jL.UNAUTHORIZED&&r!==g.jL.FORBIDDEN&&(!(r&&r>=g.H4.CLIENT_ERROR_MIN&&r<g.H4.SERVER_ERROR_MIN)&&e<g.WC.MAX_RETRY_ATTEMPTS)},refetchOnWindowFocus:!1,refetchOnReconnect:!1}}})},1692:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});var n=r(2775),o=r(4880),s=class{#p;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,o.gn)(this.gcTime)&&(this.#p=n.zs.setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(o.S$?1/0:3e5))}clearGcTimeout(){this.#p&&(n.zs.clearTimeout(this.#p),this.#p=void 0)}}},1787:(e,t,r)=>{"use strict";r.d(t,{DF:()=>y,fW:()=>M,CY:()=>x,JV:()=>_,G1:()=>N,MB:()=>O,Ou:()=>D.setupFmeDebugTools,c2:()=>D.updateFmeDebugTools});class n{constructor(){this.cache=new Map}async execute(e,t){const r=this.cache.get(e);if(r)return r;const n=t();return this.cache.set(e,n),n.finally((()=>{this.cache.delete(e)}))}}const o={healthCheck:new n,validateConnection:new n};var s=r(3096),i=r(3314),a=r(3890);const l=e=>"object"!=typeof e||null===e||Array.isArray(e)?null:e,c=(e,t)=>{let r=e;for(const e of t){if("object"!=typeof r||null===r)return;r=r[e]}return r},u=e=>Array.isArray(e)?e:"object"==typeof e&&null!==e?Object.values(e):"string"==typeof e?[e]:[],d=e=>s.K2.some((t=>e.toLowerCase().includes(t.toLowerCase()))),p=e=>s.o0.some((t=>e.toLowerCase().includes(t.toLowerCase())));function f(e){if(!e)return"";const t=l(e),r=t?.data??e,n=l(r),o=n?.status,i=n?.version,a=n?.build;if("string"==typeof o&&"ok"===o&&!(null!=i&&""!==i)&&!(null!=a&&""!==a))return"";const d=/\bFME\s+(?:Flow|Server)\s+(\d{4}(?:\.\d+)?)\b/i,p=/\b(\d+\.\d+(?:\.\d+)?|20\d{2}(?:\.\d+)?)\b/,f=["version","fmeVersion","fmeflowVersion","app.version","about.version","server.version","edition","build","productName","product","name","message"];for(const e of f){const t=e.includes(".")?c(n,e.split(".")):n?n[e]:void 0;if("string"==typeof t){const e=t.match(d);if(e)return e[1];const r=t.match(p);if(r)return r[1]}if("number"==typeof t&&Number.isFinite(t)){if(t>=s.aP.MIN_YEAR&&t<s.aP.MAX_YEAR)return String(t);if(t>0&&t<s.aP.MAX_MINOR_VERSION)return String(t)}}try{const e=u(r);for(const t of e)if("string"==typeof t){const e=t.match(d);if(e)return e[1];const r=t.match(p);if(r)return r[1]}if("string"==typeof r){const e=r.match(d);if(e)return e[1];const t=r.match(p);if(t)return t[1]}}catch{}return""}var h=r(3417),m=r(7389),g=r(2779);class y{isRenderableParam(e){if(!e||"string"!=typeof e.name)return!1;if(h.oh.has(e.name))return!1;if(h.vN.has(e.type))return!1;if(h.np.has(e.type)){const t=e.control&&(0,i.QdQ)(e.control)?e.control.choiceSettings:void 0,r=t&&(0,i.QdQ)(t)?t.choices:void 0;return r&&Array.isArray(r)&&r.length>0||null!==e.defaultValue&&void 0!==e.defaultValue&&""!==e.defaultValue}return!0}getRenderableParameters(e){return e.filter((e=>this.isRenderableParam(e)))}mapListOptions(e){const t=e,r=t.choiceSettings;if(!r||!Array.isArray(r.choices))return;const n=t.nodeDelimiter,o=e.type===h.QL.tree;return r.choices.map((e=>{const t=e.value??e.id??e.code,r=(0,i.sLt)(t),s=e.display??e.caption??e.label??e.name,a=(0,i.P6s)(s,String(r)),l=o&&n&&"string"==typeof s?s:"string"==typeof e.path&&e.path?e.path:void 0;return{label:a,value:r,...e.description&&{description:e.description},...l&&{path:l},...e.disabled&&{disabled:!0},...e.metadata&&{metadata:e.metadata}}}))}extractToggleMetaValue(e,t){if(e)for(const r of t){if(!(r in e))continue;const t=(0,i.psb)(e[r]);if(void 0!==t)return t}}getDecimalPrecision(e){const t=e.decimalPrecision;if("number"!=typeof t||!Number.isFinite(t)||t<0)return;const r=Math.floor(t);return r>=0?Math.min(r,6):void 0}getSliderMeta(e,t,r){const n="boolean"==typeof e.minimumExclusive&&e.minimumExclusive,o="boolean"==typeof e.maximumExclusive&&e.maximumExclusive;if(e.type!==h.QL.RANGE_SLIDER)return{min:"number"==typeof e.minimum?e.minimum:void 0,max:"number"==typeof e.maximum?e.maximum:void 0,minExclusive:n,maxExclusive:o};const s="number"==typeof e.minimum,i="number"==typeof e.maximum,a="number"==typeof t&&t>=0?Math.floor(t):void 0,l=s?e.minimum:r?0:void 0,c=i?e.maximum:r?100:void 0;let u;return void 0!==a?u=a>0?Number(`0.${"0".repeat(a-1)}1`):1:r&&(u=1),{min:l,max:c,step:u,minExclusive:n,maxExclusive:o}}shouldUseRangeSliderUi(e){if(e.type!==h.QL.RANGE_SLIDER)return!1;if(e.control&&"object"==typeof e.control){const t=e.control;if("boolean"==typeof t.useRangeSlider)return t.useRangeSlider;if("boolean"==typeof t.useSlider)return t.useSlider}const t=(e.description||"").toLowerCase();return!h.xH.some((e=>t.includes(e)))}getParameterMetadata(e){const t=(0,i.QdQ)(e.defaultValue)?e.defaultValue:void 0;return(0,i.W1g)([e.metadata,e.attributes,e.definition,e.control,e.schema,e.ui,e.extra,t])}normalizeOptionItem(e,t){if(null==e)return null;if((0,i.w$k)(e)){const t=(0,i.sLt)(e);return{label:String(t),value:t,isLeaf:!0}}if(!(0,i.QdQ)(e))return null;const r=e,n=(0,i.XlQ)(r,["caption","label","name","title","displayName"])??`Option ${t+1}`,o=r.value??r.id??r.code??r.path??r.name??r.key??n??t,s=(0,i.sLt)(o),a=(0,i.vqZ)(r.children),l=a?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));return{label:n,value:s,...(0,i.XlQ)(r,["description","detail","tooltip","hint","helper"])&&{description:(0,i.XlQ)(r,["description","detail","tooltip","hint","helper"])},...(0,i.XlQ)(r,["path","fullPath","groupPath","folder"])&&{path:(0,i.XlQ)(r,["path","fullPath","groupPath","folder"])},...(!0===r.disabled||!0===r.readOnly||!1===r.selectable)&&{disabled:!0},...l?.length&&{children:l},...(0,i.ITI)(r)&&{metadata:(0,i.ITI)(r)},...l?.length?{}:{isLeaf:!0}}}collectMetaOptions(e){const t=["options","items","values","choices","entries","list","records","data","nodes","children"];for(const r of t){const t=(0,i.vqZ)(e[r]);if(!t?.length)continue;const n=t.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));if(n.length)return n}}extractScriptedOptions(e,t){const r=this.getParameterMetadata(e),n=this.collectMetaOptions(r);return n?.length?n:t}buildScriptedNodes(e,t){if(!e?.length)return;return e.some((e=>e.children&&e.children.length>0))?this.buildNodesFromHierarchy(e,t):this.buildNodesFromPaths(e,t)}buildNodesFromHierarchy(e,t){const r=(e,n)=>{const o=e.path?e.path.split(t).map((e=>e.trim())).filter(Boolean):n?[...n,e.label]:[e.label],s=e.metadata&&"string"==typeof e.metadata.id&&e.metadata.id||(null!=e.value?String(e.value):o.join("|")),i=e.children?.length?e.children.map((e=>r(e,o))):void 0;return{id:s,label:e.label,path:o,...void 0!==e.value?{value:e.value}:{},...e.disabled?{disabled:!0}:{},...e.metadata?{metadata:e.metadata}:{},...i&&i.length?{children:i}:{isLeaf:!0}}};return e.map((e=>r(e,void 0)))}buildNodesFromPaths(e,t){const r="string"==typeof t&&t?t.slice(0,h.uV):"|",n=`[${(0,g.yK)(r)}]`,o=(0,g.rH)(n,"",{maxLength:n.length+2})||h.wq;o===h.wq&&"|"!==r&&(0,m.J)("ParameterFormService: Using fallback path separator",{separatorLength:r.length});const s=[],i=new Map,a=(e,t)=>{const r=e.join("|")||(t?String(t.value):"root"),n=i.get(r);if(n)return n;const o={id:r,label:e[e.length-1]||t?.label||r,path:[...e],children:[]};if(i.set(r,o),e.length>1){const t=e.slice(0,-1);a(t).children.push(o)}else s.push(o);return o};for(const t of e){const e=t.path?t.path.split(o).map((e=>e.trim())).filter(Boolean):[t.label],r=a(e,t);r.value=t.value,t.metadata&&(r.metadata={...r.metadata||{},...t.metadata}),t.disabled&&(r.disabled=!0),t.description&&(r.metadata={...r.metadata||{},description:t.description})}const l=e=>{const t=e.children.map((e=>l(e)));return{id:e.id,label:e.label,path:e.path,...void 0!==e.value?{value:e.value}:{},...e.disabled?{disabled:!0}:{},...e.metadata?{metadata:e.metadata}:{},...t.length?{children:t}:{isLeaf:!0}}};return s.map((e=>l(e)))}deriveTableConfig(e){const t=this.getParameterMetadata(e),r=(0,i.vqZ)(t.columns)??(0,i.vqZ)(t.fields)??(0,i.vqZ)(t.tableColumns)??(0,i.vqZ)(t.schema);if(!r?.length)return;const n=r.map(((e,t)=>this.normalizeTableColumn(e,t))).filter((e=>null!=e)),o=this.validateTableColumns(n);if(!o.length)return;const s=(0,i.hUO)(t,["minRows","minimumRows","minRowCount"]),a=(0,i.hUO)(t,["maxRows","maximumRows","maxRowCount"]),l=this.normalizeRowBounds(s,a);return{columns:o,...void 0!==l.minRows&&{minRows:l.minRows},...void 0!==l.maxRows&&{maxRows:l.maxRows},...(0,i.XlQ)(t,["addRowLabel","addLabel"])&&{addRowLabel:(0,i.XlQ)(t,["addRowLabel","addLabel"])},...(0,i.XlQ)(t,["removeRowLabel","removeLabel"])&&{removeRowLabel:(0,i.XlQ)(t,["removeRowLabel","removeLabel"])},...(0,i.XlQ)(t,["helper","helperText","instructions"])&&{helperText:(0,i.XlQ)(t,["helper","helperText","instructions"])},...(0,i.CqL)(t,["allowReorder","reorder"],!1)&&{allowReorder:!0},...(0,i.CqL)(t,["showHeader","displayHeader"],!0)&&{showHeader:!0}}}validateTableColumns(e){if(!e?.length)return[];const t=new Set,r=[];for(const n of e)n?.key&&(t.has(n.key)||("select"!==n.type||n.options&&0!==n.options.length)&&(r.push(n),t.add(n.key)));return r}normalizeRowBounds(e,t){const r="number"==typeof e&&(0,i.eF2)(e)?Math.floor(e):void 0;let n="number"==typeof t&&(0,i.eF2)(t)?Math.floor(t):void 0;return void 0!==r&&void 0!==n&&r>n&&(n=r),{minRows:r,maxRows:n}}normalizeTableColumn(e,t){if(!(0,i.QdQ)(e))return null;const r=e,n=(0,i.XlQ)(r,["key","name","field","id"])??`column_${t}`,o=(0,i.XlQ)(r,["label","title","caption","name"])??n,s=(0,i.XlQ)(r,["type","inputType","fieldType"]),a=s?{text:"text",string:"text",number:"number",numeric:"number",float:"number",integer:"number",select:"select",choice:"select",dropdown:"select",list:"select",boolean:"boolean",checkbox:"boolean",date:"date",time:"time",datetime:"datetime","date-time":"datetime"}[s.toLowerCase()]:void 0,l=(0,i.vqZ)(r.options)??(0,i.vqZ)(r.choices)??(0,i.vqZ)(r.values),c=l?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));return{key:n,label:o,...a&&{type:a},...(0,i.CqL)(r,["required","isRequired"],!1)&&{required:!0},...(0,i.CqL)(r,["readOnly","readonly"],!1)&&{readOnly:!0},...(0,i.XlQ)(r,["placeholder","prompt"])&&{placeholder:(0,i.XlQ)(r,["placeholder","prompt"])},...void 0!==(0,i.hUO)(r,["min","minimum"])&&{min:(0,i.hUO)(r,["min","minimum"])},...void 0!==(0,i.hUO)(r,["max","maximum"])&&{max:(0,i.hUO)(r,["max","maximum"])},...void 0!==(0,i.hUO)(r,["step","increment"])&&{step:(0,i.hUO)(r,["step","increment"])},...(0,i.XlQ)(r,["pattern","regex"])&&{pattern:(0,i.XlQ)(r,["pattern","regex"])},...c?.length&&{options:c},...(0,i.XlQ)(r,["description","detail","helper","hint"])&&{description:(0,i.XlQ)(r,["description","detail","helper","hint"])},...void 0!==r.defaultValue&&{defaultValue:r.defaultValue},...void 0!==r.width&&{width:r.width}}}deriveScriptedConfig(e,t){if(e.type!==h.QL.SCRIPTED)return;const r=this.getParameterMetadata(e),n=this.extractScriptedOptions(e,t),o=e,s=("string"==typeof o.nodeDelimiter?o.nodeDelimiter:void 0)||("string"==typeof o.delimiter?o.delimiter:void 0)||(0,i.XlQ)(r,["breadcrumbSeparator","pathSeparator","delimiter"])||"/",a=this.buildScriptedNodes(n,s),l=(0,i.CqL)(r,["allowMultiple","multiple","multiSelect","supportsMultiple"],Array.isArray(e.defaultValue)),c=(0,i.CqL)(r,["allowManualEntry","allowManual","allowCustom","allowFreeform"],!1),u=(0,i.CqL)(r,["allowSearch","searchable","enableSearch","supportsSearch"],(n?.length??0)>15),d=(0,i.hUO)(r,["pageSize","page_size","limit","pageLimit"]),p=(0,i.XlQ)(r,["instructions","instruction","helper","hint"])||(0,i.NnH)(e.description),f=(0,i.XlQ)(r,["searchPlaceholder","searchLabel","searchPrompt"]),m=(0,i.CqL)(r,["autoSelectSingleLeaf","autoSelectSingle","autoSelect"],!0),g=(0,i.XlQ)(r,["maxResultsHint","resultsHint","resultsMessage"]);return{allowMultiple:l,allowSearch:u,hierarchical:Boolean(a?.some((e=>e.children&&e.children.length>0))),allowManualEntry:c,searchPlaceholder:f,instructions:p,breadcrumbSeparator:s,pageSize:d,maxResultsHint:g,autoSelectSingleLeaf:m,nodes:a}}deriveDateTimeConfig(e){if(![h.QL.DATE_TIME,h.QL.DATETIME,h.QL.TIME].includes(e.type))return;const t=this.getParameterMetadata(e),r=(0,i.CqL)(t,["includeSeconds","showSeconds","seconds"],!0),n="string"==typeof e.defaultValue?e.defaultValue:void 0,o=n?(0,i.WZF)(n):{fraction:"",offset:"",base:""},s=(0,i.CqL)(t,["includeMilliseconds","milliseconds","fractional"],!1)||o.fraction&&o.fraction.length>1,a=(0,i.vqZ)(t.timezones)??(0,i.vqZ)(t.timezoneOptions),l=a?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e)),c=(0,i.XlQ)(t,["defaultTimezone","timezoneDefault"])||(0,i.XlQ)(t,["timezoneOffset","defaultOffset"])||o.offset||void 0,u=(0,i.XlQ)(t,["timezoneMode","timezone","tzMode"]),d="fixed"===u||"select"===u?u:l?.length?"select":o.offset||"offset"===u?"offset":void 0;return{includeSeconds:r,includeMilliseconds:s,...d&&{timezoneMode:d},...o.offset&&{timezoneOffset:o.offset},...l?.length&&{timezoneOptions:l},...c&&{defaultTimezone:c},...(0,i.XlQ)(t,["helper","hint","instructions"])&&{helperText:(0,i.XlQ)(t,["helper","hint","instructions"])},showTimezoneBadge:Boolean(o.offset)}}deriveSelectConfig(e,t,r){if(!new Set([h.Vw.SELECT,h.Vw.MULTI_SELECT,h.Vw.COORDSYS,h.Vw.ATTRIBUTE_NAME,h.Vw.ATTRIBUTE_LIST,h.Vw.DB_CONNECTION,h.Vw.WEB_CONNECTION,h.Vw.REPROJECTION_FILE]).has(e))return;const n=this.getParameterMetadata(t),o=t.type===h.QL.tree,s=Boolean(r?.some((e=>e.path||e.children&&e.children.length>0))),a=(0,i.CqL)(n,["hierarchical","tree","grouped","nested"],o||s),l=(0,i.CqL)(n,["allowSearch","searchable","enableSearch"],(r?.length??0)>25),c=(0,i.CqL)(n,["allowCustomValues","allowCustom","allowManual","allowFreeform"],!1),u=(0,i.hUO)(n,["pageSize","page_size","limit","pageLimit"]),d=(0,i.XlQ)(n,["instructions","hint","helper"]);return l||c||u||d||a?{allowSearch:l,allowCustomValues:c,hierarchical:a,...u&&{pageSize:u},...d&&{instructions:d}}:void 0}deriveFileConfig(e,t){if(!new Set([h.Vw.FILE,h.Vw.TEXT_OR_FILE,h.Vw.REPROJECTION_FILE]).has(e))return;const r=this.getParameterMetadata(t),n=r.accept??r.accepted??r.extensions,o=(()=>{if(n){if(Array.isArray(n)){const e=n.map((e=>(0,i.NnH)(e))).filter((e=>Boolean(e)));return e.length?e:void 0}if("string"==typeof n){const e=n.split(/[,;\s]+/).map((e=>e.trim())).filter(Boolean);return e.length?e:void 0}}})(),s=(0,i.hUO)(r,["maxSizeMb","maxSize","fileSizeMb","maxUploadMb"]),a=(0,i.CqL)(r,["allowMultiple","multiple","multi"],!1),l=(0,i.XlQ)(r,["helper","hint","instructions"]),c=(0,i.XlQ)(r,["capture","captureMode"]);return o||s||a||l||c?{...o&&{accept:o},...void 0!==s&&{maxSizeMb:s},...a&&{multiple:!0},...l&&{helperText:l},...c&&{capture:c}}:void 0}extractChoiceSetConfig(e){if(!e||!e.choiceSet)return;const t=e.choiceSet,r=t.type;if(r)switch(r){case"attributeNames":return{type:"attributeNames",...t};case"coordinateSystems":return{type:"coordinateSystems",...t};case"dbConnections":return{type:"dbConnections",...t};case"webConnections":return{type:"webConnections",...t}}}parseToggleOptionEntries(e){return Array.isArray(e)?e.map((e=>({value:(0,i.psb)(e?.value),label:(0,i.NnH)(e?.label)??void 0}))).filter((e=>void 0!==e.value||e.label)):[]}resolveToggleOptionsFromEntries(e,t,r){let n=this.extractToggleMetaValue(r,["checkedValue","checked_value","trueValue","true_value","onValue","on_value","yesValue","yes_value"]),o=this.extractToggleMetaValue(r,["uncheckedValue","unchecked_value","falseValue","false_value","offValue","off_value","noValue","no_value"]);if(2===e.length){const[r,s]=e;if(void 0!==t&&void 0===o&&(void 0!==r.value&&(0,i.$Xq)(r.value,t)?(o=r.value,void 0===n&&void 0!==s.value&&(n=s.value)):void 0!==s.value&&(0,i.$Xq)(s.value,t)&&(o=s.value,void 0===n&&void 0!==r.value&&(n=r.value))),void 0===n){const e=r.value??s.value;void 0!==e&&(n=e)}if(void 0===o){const e=s.value??r.value;void 0!==e&&void 0!==n&&(0,i.$Xq)(e,n)&&void 0!==r.value&&!(0,i.$Xq)(r.value,n)?o=r.value:void 0!==e&&(o=e)}}else 1===e.length&&void 0===n&&void 0!==e[0].value&&(n=e[0].value);return{checkedValue:n,uncheckedValue:o}}applyToggleDefaults(e,t,r,n){let o=e,s=t;return void 0!==n&&(void 0===o&&n&&(o=(0,i.psb)(!0)),void 0!==s||n||(s=(0,i.psb)(!1))),void 0===s&&void 0!==r&&(s=r),void 0!==o&&void 0!==s&&(0,i.$Xq)(o,s)&&(s=void 0),{checkedValue:o,uncheckedValue:s}}extractToggleLabels(e,t,r,n){return{checkedLabel:(0,i.XlQ)(e,["checkedLabel","checked_caption","checkedText","checked_label","trueLabel"])||t.find((e=>e.label&&void 0!==r&&void 0!==e.value&&(0,i.$Xq)(e.value,r)))?.label,uncheckedLabel:(0,i.XlQ)(e,["uncheckedLabel","unchecked_caption","uncheckedText","unchecked_label","falseLabel"])||t.find((e=>e.label&&void 0!==n&&void 0!==e.value&&(0,i.$Xq)(e.value,n)))?.label}}deriveToggleConfig(e,t,r){if(e!==h.Vw.SWITCH&&e!==h.Vw.CHECKBOX)return;const n=this.getParameterMetadata(t),o=(0,i.psb)(t.defaultValue),s=(0,i.Dr1)(t.defaultValue),a=this.parseToggleOptionEntries(r);let{checkedValue:l,uncheckedValue:c}=this.resolveToggleOptionsFromEntries(a,o,n);const u=this.applyToggleDefaults(l,c,o,s);l=u.checkedValue,c=u.uncheckedValue;const{checkedLabel:d,uncheckedLabel:p}=this.extractToggleLabels(n,a,l,c),f={...void 0!==l&&{checkedValue:l},...void 0!==c&&{uncheckedValue:c},...d&&{checkedLabel:d},...p&&{uncheckedLabel:p}};return Object.keys(f).length?f:void 0}deriveColorConfig(e){if(e.type!==h.QL.COLOR&&e.type!==h.QL.COLOR_PICK)return;const t=this.getParameterMetadata(e),r=(0,i.XlQ)(t,["colorSpace","colourSpace","space","colorModel","colourModel"]),n=r?(0,i.QKA)(r):void 0;let o;if("cmyk"===n?o="cmyk":"rgb"===n&&(o="rgb"),!o){const t=("string"==typeof e.defaultValue?e.defaultValue:"").split(",").map((e=>e.trim())).filter(Boolean);o||(4===t.length?o="cmyk":3===t.length&&(o="rgb"))}const s=(0,i.CqL)(t,["alpha","allowAlpha","hasAlpha","supportsAlpha","includeAlpha"],!1);return o||s?{...o&&{space:o},...s&&{alpha:!0}}:void 0}validateParameters(e,t){const r=[],n=this.getRenderableParameters(t);for(const t of n){if(t.type===h.QL.GEOMETRY)continue;const n=e[t.name];if(!t.optional&&(0,i.Ime)(n))r.push(`${t.name}:required`);else if(!(0,i.Ime)(n)){const e=(0,a.ut)(t.type,t.name,n);if(e){r.push(e);continue}const o=t.control&&(0,i.QdQ)(t.control)?t.control.choiceSettings:void 0,s=o&&(0,i.QdQ)(o)?o.choices:void 0,l=(0,i.uAi)(Array.isArray(s)?s:void 0),c=(0,a.sW)(t.name,n,l,h.d8.has(t.type));c&&r.push(c)}}return{isValid:0===r.length,errors:r}}parseConditionClause(e){const t=this.parseVisibilityState(e.then);if(!t)return null;const r=Object.keys(e).filter((e=>e.startsWith("$")));if(0===r.length)return{then:t};const n={then:t};for(const t of r)n[t]=e[t];return n}buildVisibilityExpression(e,t){const r=(0,i.QdQ)(t)?this.parseVisibilityState(t.value):void 0;return{if:e,...r&&{default:{value:r,override:(0,i.CqL)(t,["override"],!1)}}}}deriveVisibilityConfig(e){const t=this.getParameterMetadata(e).visibility;if(!(0,i.QdQ)(t))return;const r=t,n=(0,i.vqZ)(r.if);if(!n?.length)return;const o=[];for(const e of n){if(!(0,i.QdQ)(e))continue;const t=e,r=this.parseConditionClause(t);r&&o.push(r)}return o.length?this.buildVisibilityExpression(o,r.default):void 0}parseVisibilityState(e){if("string"!=typeof e)return;switch((0,i.QKA)(e)){case"visibleenabled":case"visible_enabled":return"visibleEnabled";case"visibledisabled":case"visible_disabled":return"visibleDisabled";case"hiddenenabled":case"hidden_enabled":return"hiddenEnabled";case"hiddendisabled":case"hidden_disabled":return"hiddenDisabled";default:return}}convertParametersToFields(e){return e?.length?this.getRenderableParameters(e).map((e=>{const t=this.getFieldType(e),r=this.getDecimalPrecision(e),n=e.type===h.QL.RANGE_SLIDER&&this.shouldUseRangeSliderUi(e),o=e.type!==h.QL.RANGE_SLIDER||n?t:h.Vw.NUMERIC_INPUT,s=this.mapListOptions(e),a=this.deriveScriptedConfig(e,s),l=this.deriveTableConfig(e),c=this.deriveDateTimeConfig(e),u=this.deriveSelectConfig(o,e,s),d=this.deriveFileConfig(o,e),p=this.deriveColorConfig(e),f=this.deriveToggleConfig(o,e,s),m=this.deriveVisibilityConfig(e),g=this.extractChoiceSetConfig(e),y=this.isReadOnlyField(o,a),E=a?.instructions??l?.helperText??c?.helperText??d?.helperText??u?.instructions,{min:v,max:b,step:w,minExclusive:S,maxExclusive:R}=this.getSliderMeta(e,r,n),T=(()=>{if(o===h.Vw.PASSWORD)return"";if(e.type===h.QL.GEOMETRY)return"";if(o===h.Vw.MULTI_SELECT)return(0,i.$rL)(e.defaultValue);if((o===h.Vw.SWITCH||o===h.Vw.CHECKBOX)&&f){const t=(0,i.psb)(e.defaultValue);if(void 0!==t&&void 0!==f.checkedValue&&(0,i.$Xq)(t,f.checkedValue))return f.checkedValue;if(void 0!==t&&void 0!==f.uncheckedValue&&(0,i.$Xq)(t,f.uncheckedValue))return f.uncheckedValue;const r=(0,i.Dr1)(e.defaultValue);if(void 0!==r){if(r&&void 0!==f.checkedValue)return f.checkedValue;if(!r&&void 0!==f.uncheckedValue)return f.uncheckedValue}if(void 0!==t)return t;if(void 0!==f.uncheckedValue)return f.uncheckedValue;if(void 0!==f.checkedValue)return f.checkedValue}return e.defaultValue})(),O=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.prompt:void 0;return{name:e.name,label:(0,i.wKo)(O)||e.description||e.name,type:o,required:!e.optional,readOnly:y,description:(0,i.wKo)(O)||e.description,defaultValue:T,placeholder:(0,i.wKo)(O)||e.description||"",...s?.length&&{options:[...s]},...e.type===h.QL.TEXT_EDIT&&{rows:3},...(void 0!==v||void 0!==b||void 0!==w)&&{min:v,max:b,step:w},...(o===h.Vw.SLIDER||o===h.Vw.NUMERIC_INPUT)&&void 0!==r&&{decimalPrecision:r},...(o===h.Vw.SLIDER||o===h.Vw.NUMERIC_INPUT)&&void 0!==S&&{minExclusive:S},...(o===h.Vw.SLIDER||o===h.Vw.NUMERIC_INPUT)&&void 0!==R&&{maxExclusive:R},...E&&{helper:E},...a&&{scripted:a},...l&&{tableConfig:l},...c&&{dateTimeConfig:c},...u&&{selectConfig:u},...d&&{fileConfig:d},...p&&{colorConfig:p},...f&&{toggleConfig:f},...g&&{choiceSetConfig:g},...m&&{visibility:m}}})):[]}getFieldType(e){if(h.d8.has(e.type))return h.Vw.MULTI_SELECT;const t=e.control&&(0,i.QdQ)(e.control)?e.control.choiceSettings:void 0,r=t&&(0,i.QdQ)(t)?t.choices:void 0;if(r&&Array.isArray(r)&&r.length>0){return Array.isArray(e.defaultValue)?h.Vw.MULTI_SELECT:h.Vw.SELECT}const n=h.xA[e.type];if(n)return n;if(e.type===h.QL.text||e.type===h.QL.TEXT){const t=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.editor:void 0,r=(0,i.wKo)(t);if("plaintext"===r)return h.Vw.TEXTAREA;if("url"===r)return h.Vw.URL;const n=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.valueType:void 0;if("stringEncoded"===(0,i.wKo)(n))return h.Vw.TEXTAREA}return h.Vw.TEXT}isReadOnlyField(e,t){if(e===h.Vw.MESSAGE||e===h.Vw.GEOMETRY)return!0;if(e===h.Vw.SCRIPTED){return!Boolean(t?.allowManualEntry||t?.nodes&&t.nodes.length>0)}return!1}validateFormValues(e,t){if(!e||!t?.length)return{isValid:!0,errors:{}};const r={};for(const n of t){const t=n.visibilityState;if(t&&"visibleEnabled"!==t)continue;const o=e[n.name],s=!(0,i.Ime)(o);if(n.type!==h.Vw.GEOMETRY)if(n.type!==h.Vw.TEXT_OR_FILE){if(n.required&&!s)r[n.name]="";else if(s&&(n.type===h.Vw.NUMBER||n.type===h.Vw.NUMERIC_INPUT)&&!(0,i.BfI)(o)&&!(0,i.P3$)(o)){r[n.name]="";continue}if(s&&(n.type===h.Vw.NUMBER||n.type===h.Vw.NUMERIC_INPUT||n.type===h.Vw.SLIDER)){const e=Number(o);if(!Number.isFinite(e)){r[n.name]="";continue}if("number"==typeof n.min){if(n.minExclusive?e<=n.min:e<n.min){r[n.name]="";continue}}if("number"==typeof n.max){if(n.maxExclusive?e>=n.max:e>n.max){r[n.name]="";continue}}}if(s&&n.type===h.Vw.NUMERIC_INPUT&&"number"==typeof n.decimalPrecision&&n.decimalPrecision>=0&&Number.isFinite(Number(o))){const e=Number(o),t=Math.pow(10,n.decimalPrecision);if(Number.isFinite(t)){const o=e*t,s=Math.round(o);Math.abs(o-s)>Number.EPSILON&&(r[n.name]="")}else r[n.name]=""}}else{const e=o,t=(0,i.YH$)(e?.text),s=(0,i.E$q)(e?.file);!n.required||t||s||(r[n.name]="")}}return{isValid:0===Object.keys(r).length,errors:r}}}var E=r(1138);const v=(e,t="aborted")=>({success:!1,steps:e,error:{message:t,type:"generic",status:0}}),b=(e,t)=>({success:!1,steps:e,error:{message:"errorServerUnreachable",type:"server",status:t}}),w=(e,t)=>({success:!1,steps:e,error:{message:"errorTokenIssue",type:"token",status:t}}),S=(e,t)=>({success:!1,steps:e,error:{message:"errorRepositoryIssue",type:"repository",status:t}}),R=(e,t)=>e?.aborted?v(t):null;async function T(e){const{serverUrl:t,token:r,repository:n,signal:l}=e,c=`${t}|${r}|${n||"_"}`,u={serverUrl:h.OX.PENDING,token:h.OX.PENDING,repository:n?h.OX.PENDING:h.OX.SKIP,version:""};return await o.validateConnection.execute(c,(async()=>{try{const e=(0,i.MbC)(t,r,n);if(!e)return{success:!1,steps:u,error:{message:void 0,type:"server",status:0}};let c;try{c=await e.testConnection(l),u.serverUrl=h.OX.OK,u.token=h.OX.OK,u.version=f(c)}catch(e){if((0,i.zfx)(e))return v(u,e.message);const n=(0,a.Ko)(e);if(n===h.jL.UNAUTHORIZED)return u.serverUrl=h.OX.OK,u.token=h.OX.FAIL,w(u,n);if(n===h.jL.FORBIDDEN){const c=(0,i.PEb)(e);if(p(c))return u.serverUrl=h.OX.FAIL,u.token=h.OX.SKIP,b(u,n);try{const e=await async function(e,t,r){const n=`${e}|${t}`;return(0,a.dC)(e).ok?await o.healthCheck.execute(n,(async()=>{const n=Date.now();try{const o=(0,i.MbC)(e,t),a=await o.testConnection(r),l=Date.now()-n,c=Number.isFinite(l)&&l>=0&&l<s.ST.MAX_RESPONSE_TIME?l:l<0?0:s.ST.MAX_RESPONSE_TIME;return{reachable:!0,version:f(a),responseTime:c}}catch(t){const r=Date.now()-n,o=Number.isFinite(r)&&r>=0&&r<s.ST.MAX_RESPONSE_TIME?r:r<0?0:s.ST.MAX_RESPONSE_TIME,l=(0,a.Ko)(t),c=(0,i.PEb)(t);return l===s.jL.UNAUTHORIZED||l===s.jL.FORBIDDEN?d(c)&&!(0,a.dC)(e,{strict:!0}).ok?{reachable:!1,responseTime:o,error:"invalidUrl",status:l}:{reachable:!0,responseTime:o,error:c,status:l}:{reachable:!1,responseTime:o,error:c,status:l}}})):{reachable:!1,responseTime:0,error:"invalidUrl",status:0}}(t,r,l),c=R(l,u);return c||(e?.reachable?(u.serverUrl=h.OX.OK,u.token=h.OX.FAIL,w(u,n)):(u.serverUrl=h.OX.FAIL,u.token=h.OX.SKIP,b(u,n)))}catch(e){return(0,i.fAF)("Health check during 403 handling failed",e),u.serverUrl=h.OX.FAIL,u.token=h.OX.SKIP,b(u,n)}}return u.serverUrl=h.OX.FAIL,u.token=h.OX.SKIP,{success:!1,steps:u,error:{message:(0,E.fV)(e,n),type:0===n?"network":"server",status:n}}}const m=[];if(n)try{await e.validateRepository(n,l),u.repository=h.OX.OK}catch(e){const t=(0,a.Ko)(e);if(!(t===h.jL.UNAUTHORIZED||t===h.jL.FORBIDDEN))return u.repository=h.OX.FAIL,S(u,t);u.repository=h.OX.SKIP,m.push("repositoryNotAccessible")}return{success:!0,version:"string"==typeof u.version?u.version:"",steps:u,warnings:m.length?m:void 0}}catch(e){if((0,i.zfx)(e))return v(u,e.message);const t=(0,a.Ko)(e);return{success:!1,steps:u,error:{message:(0,E.fV)(e,t),type:"generic",status:t}}}}))}async function O(e){const{config:t,useMapWidgetIds:r,translate:n,signal:o,onProgress:s}=e;s(n("validatingStartup")),s(n("statusValidatingMap"));const l=Array.isArray(r)&&r.length>0;s(n("statusValidatingConnection"));const c=await async function(e){const{config:t,translate:r,signal:n,mapConfigured:o}=e;if(!t)return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,E.$5)("errorSetupRequired",{type:h.By.CONFIG,code:"configMissing",suggestion:r("actionOpenSettings"),userFriendlyMessage:r("hintSetupWidget")})};if(!(0,a.Rv)(t,r,{mapConfigured:o??!0}).isValid)return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,E.$5)("errorSetupRequired",{type:h.By.CONFIG,code:"CONFIG_INCOMPLETE"})};try{const e=await T({serverUrl:t.fmeServerUrl,token:t.fmeServerToken,repository:t.repository,signal:n});if(!e.success){const t=e.error?.message||"errorValidationFailed",n=e.error?.type||"server";return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,E.$5)(t,{type:h.By.NETWORK,code:e.error?.type?.toUpperCase()||"CONNECTION_ERROR",suggestion:r("token"===n?"tokenSettingsHint":"server"===n?"serverUrlSettingsHint":"repository"===n?"repositorySettingsHint":"connectionSettingsHint")})}}return{isValid:!0,canProceed:!0,requiresSettings:!1}}catch(e){return(0,i.zfx)(e)?{isValid:!1,canProceed:!1,requiresSettings:!1}:{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,E.$5)("errorStartupFailed",{type:h.By.NETWORK,code:"STARTUP_NETWORK_ERROR",suggestion:r("networkConnectionHint")})}}}({config:t,translate:n,signal:o,mapConfigured:l});if(!c.isValid){if(c.error)throw new Error(JSON.stringify(c.error));if(c.requiresSettings){const e=(0,E.$5)("configurationInvalid",{type:h.By.CONFIG,code:"VALIDATION_FAILED"});throw new Error(JSON.stringify(e))}return{success:!1}}if(!t?.syncMode){s(n("statusValidatingEmail"));try{const e=await(0,i.hSq)(t);if(!(0,i.B9Y)(e)){const e=(0,E.$5)("userEmailMissingError",{type:h.By.CONFIG,code:"UserEmailMissing"});throw new Error(JSON.stringify(e))}}catch(e){if((0,i.zfx)(e))return{success:!1};const t=(0,E.$5)("userEmailMissingError",{type:h.By.CONFIG,code:"UserEmailMissing"});throw new Error(JSON.stringify(t))}}return{success:!0}}var A=r(3040);async function I({rawFormData:e,userEmail:t,geometryJson:r,geometry:n,modules:o,config:s,workspaceParameters:a,workspaceItem:l,selectedWorkspaceName:c,areaWarning:u,drawnArea:d,makeCancelable:p,fmeClient:f,signal:h,remoteDatasetSubfolder:m,onStatusChange:g}){g?.("normalizing");const{sanitizedFormData:y,uploadFile:E,remoteUrl:v}=(0,i.sqe)(e),b=(0,i.EoF)(s||void 0),w=(0,i.cLk)({data:y},t,r,n||void 0,o,{config:b,workspaceParameters:a,workspaceItem:l,areaWarning:u,drawnArea:d}),S=w.__aoi_error__;if(S)return g?.("complete"),{params:null,aoiError:S};const R={...w};Boolean(E||(0,i.YH$)(v))&&g?.("resolvingDataset"),await async function({params:e,remoteUrl:t,uploadFile:r,config:n,workspaceParameters:o,makeCancelable:s,fmeClient:a,signal:l,subfolder:c,workspaceName:u}){if((0,i.dd1)(e,n),(0,i.rBs)(t,n))return void(e.opt_geturl=t);if(!(0,i.pZA)(n,r))return;const d=(0,i.NnH)(u);if(!d)throw new Error("REMOTE_DATASET_WORKSPACE_REQUIRED");void 0!==e.opt_geturl&&delete e.opt_geturl;const p=await s(a.uploadToTemp(r,{subfolder:c,signal:l,repository:n?.repository,workspace:d})),f=p.data?.path;(0,i.sIn)({finalParams:e,uploadedPath:f,parameters:o,explicitTarget:(0,i.yol)(n)})}({params:R,remoteUrl:v,uploadFile:E,config:b,workspaceParameters:a,makeCancelable:p,fmeClient:f,signal:h,subfolder:m,workspaceName:(0,i.NnH)(l?.name)||(0,i.NnH)(c)||null}),g?.("applyingDefaults");const T=(0,i._RB)(R,b);return(0,i.Ad4)(T),g?.("complete"),{params:T}}async function _(e){const{formData:t,config:r,geometryJson:n,modules:o,workspaceParameters:s,workspaceItem:l,selectedWorkspace:c,areaWarning:u,drawnArea:d,fmeClient:p,submissionAbort:f,widgetId:h,translate:m,makeCancelable:g,onStatusChange:y,getActiveGeometry:E}=e;let v=null,b=null;try{const e=t?.data||{},a=(0,i.MmJ)({data:e},r,{workspaceItem:l,areaWarning:u,drawnArea:d,onModeOverride:()=>{}});b="sync"===a||"async"===a?a:null;const w="async"===b?await(0,i.hSq)(r):"",S=c;if(!S)return{success:!1,error:new Error("No workspace selected"),serviceMode:b};v=f.abortAndCreate();const R=`widget_${h||"fme"}`,T=await I({rawFormData:e,userEmail:w,geometryJson:n,geometry:E()||void 0,modules:o,config:r,workspaceParameters:s,workspaceItem:l,selectedWorkspaceName:S,areaWarning:u,drawnArea:d,makeCancelable:g,fmeClient:p,signal:v.signal,remoteDatasetSubfolder:R,onStatusChange:y});if(T.aoiError)return{success:!1,error:T.aoiError,serviceMode:b};const O=T.params;if(!O)throw new Error("Submission parameter preparation failed");y?.("submitting");const _=await g(p.runWorkspace(S,O,void 0,v.signal));if(v.signal.aborted)return{success:!1,serviceMode:b};const C=function(e,t,r,n,o){return{...(0,A.Hz)(e,t,r,n),...o?{serviceMode:o}:{}}}(_,S,w,m,b);return{success:!0,result:C,serviceMode:b}}catch(e){const t=function(e,t,r,n){if((0,i.zfx)(e))return null;const o=(0,i.fVY)(e);let s="";if(o)try{s=(0,i.I0Z)(o,t)}catch{s=""}const a=(0,i.EjJ)(t,r);return{success:!1,message:[t("errorOrderFailed"),s,a].filter(Boolean).join(". "),code:e.code||"SUBMISSION_ERROR",...n?{serviceMode:n}:{}}}(e,m,(0,a.id)(r?.supportEmail),b);return t?{success:!1,result:t,error:e,serviceMode:b}:{success:!1,serviceMode:b}}finally{f.finalize(v)}}var C=r(5880),k=r(2242),L=r(1618);function M(e,t,r){const n=new t.GraphicsLayer(h.PJ);return e.view.map.add(n),r(n),n}async function N(e){const{geometry:t,modules:r,config:n,signal:o}=e;if(!t)return{success:!1,error:{code:"NO_GEOMETRY"}};if(o.aborted)return{success:!1,error:{code:"ABORTED"}};const s=await(0,L.DU)(t,r);if(o.aborted)return{success:!1,error:{code:"ABORTED"}};if(!s.valid)return{success:!1,error:s.error};const i=s.simplified??t,a=await(0,L.x0)(i,r);if(o.aborted)return{success:!1,error:{code:"ABORTED"}};if(!a||a<=0)return{success:!1,error:{code:"ZERO_AREA",message:"geometryInvalidCode"}};const l=Math.abs(a),c=(0,L.nW)(l,{maxArea:n?.areaThreshold,largeArea:n?.largeAreaThreshold});if(o.aborted)return{success:!1,error:{code:"ABORTED"}};if(c.exceedsMaximum){const e=(0,L.M4)(l,n?.areaThreshold);return{success:!1,error:{code:e.code,message:e.message||"geometryAreaTooLargeCode"}}}return{success:!0,geometry:i,area:l,shouldWarn:c.shouldWarn}}function x({jmv:e,modules:t,layer:r,onDrawComplete:n,dispatch:o,widgetId:s,symbols:a,onDrawingSessionChange:l,onSketchToolStart:c}){const u=new t.SketchViewModel({view:e.view,layer:r,polygonSymbol:a.polygon,polylineSymbol:a.polyline,pointSymbol:a.point,defaultCreateOptions:{hasZ:!1,mode:"click"},defaultUpdateOptions:{tool:"reshape",toggleToolOnClick:!1,enableRotation:!0,enableScaling:!0,preserveAspectRatio:!1},snappingOptions:{enabled:!0,selfEnabled:!0,featureEnabled:!0},tooltipOptions:{enabled:!0,inputEnabled:!0,visibleElements:{area:!0,totalLength:!0,distance:!0,coordinates:!1,elevation:!1,rotation:!1,scale:!1,size:!1,radius:!0,direction:!0,header:!0,helpMessage:!0}},valueOptions:{directionMode:"relative",displayUnits:{length:"meters",verticalLength:"meters",area:"square-meters"},inputUnits:{length:"meters",verticalLength:"meters",area:"square-meters"}}}),d=function({sketchViewModel:e,onDrawComplete:t,dispatch:r,widgetId:n,onDrawingSessionChange:o,onSketchToolStart:s}){let a=0;const l=e.on("create",(l=>{switch(l.state){case"start":{a=0;const t=(0,i.wk6)(l.tool);if(!t)return(0,k.uB)(e),void o({isActive:!1,clickCount:0});o({isActive:!0,clickCount:0}),s("rectangle"===t?h.hL.RECTANGLE:h.hL.POLYGON);break}case"active":{const e=(0,i.wk6)(l.tool);if("polygon"===e&&l.graphic?.geometry){const e=l.graphic.geometry,t=e.rings?.[0],s=t?Math.max(0,t.length-1):0;s>a&&(a=s,o({clickCount:s,isActive:!0}),1===s&&r(C.fmeActions.setViewMode(h.nE.DRAWING,n)))}else"rectangle"===e&&1!==a&&(a=1,o({clickCount:1,isActive:!0}));break}case"complete":a=0,o({isActive:!1,clickCount:0});try{t(l)}catch(e){(0,i.fAF)("onDrawComplete error",e)}break;case"cancel":a=0,o({isActive:!1,clickCount:0})}})),c=e.on("update",(e=>{if("complete"===e.state&&Array.isArray(e.graphics)&&e.graphics.length>0&&e.graphics[0]?.geometry){const r=(0,i.wk6)(e?.tool);try{t({graphic:e.graphics[0],state:"complete",tool:r??e.tool})}catch(e){(0,i.fAF)("onDrawComplete update error",e)}}}));return()=>{try{l?.remove()}catch{}try{c?.remove()}catch{}try{e.__fmeCleanup__=void 0}catch{}}}({sketchViewModel:u,onDrawComplete:n,dispatch:o,widgetId:s,onDrawingSessionChange:l,onSketchToolStart:c});return u.__fmeCleanup__=d,{sketchViewModel:u,cleanup:d}}var D=r(5009)},1888:e=>{"use strict";e.exports=s},1920:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},2238:(e,t,r)=>{"use strict";r.d(t,{ER:()=>ue,IH:()=>h,VM:()=>f});var n=r(3096),o=r(3417),s=r(5009),i=r(3314),a=r(1138),l=r(3040),c=r(3890);const u={...n.mR},d=[];function p(e){for(d.push(e);d.length>n.WC.MAX_HISTORY_SIZE;)d.shift()}function f(){return[...d]}function h(){d.length=0}async function m(e){if(!u.enabled)return e.execute();const t=e.method.toUpperCase(),r=e.correlationId||g(),o=Date.now();try{const s=await e.execute(),a=Date.now()-o,l=(0,i.eF2)(a)?a:0,c=e.responseInterpreter?.status?.(s),u=e.responseInterpreter?.ok?.(s)??function(e){return"number"!=typeof e?void 0:(0,n.ar)(e)}(c),d=e.responseInterpreter?.size?.(s),f={timestamp:o,method:t,url:E(e.url,e.query),path:b(e.url),status:c,ok:u,durationMs:l,correlationId:r,caller:e.caller,transport:e.transport,retryAttempt:e.retryAttempt,responseSize:d,isAbort:!1};return O("success",f,e.body),p(f),s}catch(n){const s=Date.now()-o,l=(0,i.eF2)(s)?s:0,u=(0,c.Ko)(n),d=(0,a.zf)(n),f={timestamp:o,method:t,url:E(e.url,e.query),path:b(e.url),status:u,ok:!1,durationMs:l,correlationId:r,caller:e.caller,transport:e.transport,retryAttempt:e.retryAttempt,isAbort:d};throw O("error",f,e.body,n),p(f),n instanceof Error?n:new Error((0,i.PEb)(n))}}function g(e="net"){const t=Date.now().toString(36);let r=Math.random().toString(36).slice(2,10);for(;r.length<8;)r+=Math.random().toString(36).slice(2);return`${e}_${t}_${r.slice(0,8)}`}const y=(e,t)=>e?`${e.origin}${e.pathname}`:R(t.split("?")[0]||"");function E(e,t){const r=v(e),n=function(e,t){const r=new URLSearchParams(e?.search||"");t&&w(r,t);return r}(r,t),o=function(e){const t=new URLSearchParams;for(const[r,n]of e.entries())S(r.toLowerCase())?t.set(r,"[TOKEN]"):t.set(r,R(n));return t}(n),s=function(e){const t=[];for(const[r,n]of e.entries())t.push([r,n]);return t.sort((([e],[t])=>e>t?1:e<t?-1:0)),t.map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(o),i=y(r,e);return s?`${i}?${s}`:i}function v(e){if(!e)return null;try{return(0,i.yCG)(e)||new URL(e,"http://localhost")}catch{return null}}function b(e){const t=v(e);return t?.pathname||e.split("?")[0]||e}const w=(e,t)=>{"string"!=typeof t?t instanceof URLSearchParams?t.forEach(((t,r)=>{e.set(r,t)})):Object.entries(t).forEach((([t,r])=>{if(null!=r)if(Array.isArray(r))e.delete(t),r.forEach((r=>{e.append(t,String(r))}));else{const n="string"==typeof r||"number"==typeof r||"boolean"==typeof r?String(r):JSON.stringify(r);e.set(t,n)}})):new URLSearchParams(t).forEach(((t,r)=>{e.set(r,t)}))};function S(e){const t=e.toLowerCase();return n.wS.some((e=>t.includes(e)))}function R(e){return e.replace(n.zw,'authorization="[TOKEN]"').replace(n.si,"$1=[TOKEN]")}function T(e,t){return e.length<=t?e:`${e.slice(0,t-1)}\u2026`}function O(e,t,r,n){if("silent"===u.logLevel)return;const o=r?function(e){if(null==e)return"";if("string"==typeof e)return T(R(e),u.bodyPreviewLimit);if("object"!=typeof e)try{return T(R(JSON.stringify(e)),u.bodyPreviewLimit)}catch{return"[Object]"}if("undefined"!=typeof FormData&&e instanceof FormData)return"[FormData]";if("undefined"!=typeof Blob&&e instanceof Blob)return`[Blob:${e.size}]`;if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)return`[Binary:${e instanceof ArrayBuffer?e.byteLength:e.buffer?.byteLength||0}]`;try{return T(R(JSON.stringify(e)),u.bodyPreviewLimit)}catch{return"[Object]"}}(r):void 0,a=n?(0,i.PEb)(n):void 0;try{if("debug"===u.logLevel){const r="success"===e?"\u2713":"\u2717",n={phase:e,method:t.method,url:t.url,status:t.status,durationMs:t.durationMs,correlationId:t.correlationId,caller:t.caller,transport:t.transport};void 0!==t.responseSize&&(n.responseSize=t.responseSize),void 0!==t.retryAttempt&&(n.retry=t.retryAttempt),t.isAbort&&(n.aborted=!0),o&&(n.body=o),a&&(n.error=a),(0,s.conditionalLog)(`[FME][net] ${r}`,n)}else if("warn"===u.logLevel){const r=`[FME][net] ${e} ${t.method} ${t.path} ${t.status||"?"} ${t.durationMs}ms`;(0,s.conditionalLog)(r,{correlationId:t.correlationId,...t.caller&&{caller:t.caller}})}t.durationMs>=u.warnSlowMs&&(0,s.conditionalLog)("[FME][net] slow",{method:t.method,path:t.path,durationMs:t.durationMs,correlationId:t.correlationId})}catch{}}const A=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),I=(e,t=0)=>{if(null==e)return null;if("string"==typeof e){const t=e.trim();return t||null}if("number"==typeof e||"boolean"==typeof e)return String(e);if(Array.isArray(e)){if(t>=3)return null;const r=e.map((e=>I(e,t+1))).filter((e=>Boolean(e)));if(!r.length)return null;return T(r.join(", "),n.Us)}if(A(e)){if(t>=3)return null;for(const r of n.xW){const n=I(e[r],t+1);if(n)return n}}return null},_=e=>{if(!e)return;const t={};if(Array.isArray(e))return e.forEach(((e,r)=>{if(null!=e)if(A(e)){const o=e,s="string"==typeof o.name?o.name:void 0,a="string"==typeof o.field?o.field:void 0,l="string"==typeof o.parameter?o.parameter:void 0,c=(0,i.P6s)(s)||(0,i.P6s)(a)||(0,i.P6s)(l)||String(r),u=I(e,1)||I(o.value,1);u&&(t[c]=T(u,n.Us))}else{const o=I(e,1);o&&(t[String(r)]=T(o,n.Us))}})),Object.keys(t).length?t:void 0;if(A(e)){for(const r of Object.keys(e)){const o=I(e[r]);o&&(t[r]=T(o,n.Us))}return Object.keys(t).length?t:void 0}const r=I(e);return r?(t.general=T(r,n.Us),t):void 0},C=(e,t)=>{let r=e;for(const e of t){if(!A(r))return;r=r[e]}return r},k=e=>{if(!e||"object"!=typeof e)return;const t=[["details"],["response","details"],["response","data","details"],["data","details"],["body","details"],["error","details"]];for(const r of t){const t=C(e,r);if(void 0!==t){const e=_(t);if(e)return e}}},L=e=>{if(void 0!==e)return e;if("function"==typeof DOMException)return new DOMException("Aborted","AbortError");const t=new Error("Aborted");return t.name="AbortError",t},M=()=>{};new class{constructor(){this.controllers=new Map,this.listeners=new Map,this.pendingReasons=new Map}register(e,t){if(!e)return;this.controllers.set(e,t);const r=this.pendingReasons.get(e);void 0!==r&&((0,a.Wz)(t,r),this.pendingReasons.delete(e))}release(e,t){if(!e)return;const r=this.controllers.get(e);if(t&&r&&r!==t)return;this.controllers.delete(e),this.pendingReasons.delete(e);const n=this.listeners.get(e);if(n?.size){for(const e of n)try{e.signal.removeEventListener("abort",e.handler)}catch{}this.listeners.delete(e)}}abort(e,t){if(!e)return;const r=this.controllers.get(e);if(!r)return void this.pendingReasons.set(e,t??L());const n=t??L();(0,a.Wz)(r,n),this.release(e,r)}linkExternal(e,t){if(!e||!t)return M;if(t.aborted)return this.abort(e,t.reason),M;const r={signal:t,handler:()=>{const r=t.reason;this.abort(e,r)}};t.addEventListener("abort",r.handler);let n=this.listeners.get(e);return n||(n=new Set,this.listeners.set(e,n)),n.add(r),()=>{try{t.removeEventListener("abort",r.handler)}catch{}const n=this.listeners.get(e);n&&(n.delete(r),0===n.size&&this.listeners.delete(e))}}abortAll(e){const t=Array.from(this.controllers.entries());for(const[r,n]of t)this.abort(r,e),this.release(r,n)}};const N=(e,t)=>new o.VQ(e,e,t,(e=>(0,n.PS)(e))(t)),x={text:"TEXT",string:"STRING",text_edit:"TEXT_EDIT",textedit:"TEXT_EDIT",textarea:"TEXT_EDIT",password:"PASSWORD",url:"URL",integer:"INTEGER",int:"INTEGER",float:"FLOAT",number:"FLOAT",decimal:"FLOAT",boolean:"BOOLEAN",bool:"BOOLEAN",checkbox:"CHECKBOX",choice:"CHOICE",dropdown:"CHOICE",select:"CHOICE",listbox:"LISTBOX",lookup_choice:"LOOKUP_CHOICE",lookup_listbox:"LOOKUP_LISTBOX",tree:"SCRIPTED",range:"RANGE_SLIDER",filename:"FILENAME",file:"FILENAME",filename_mustexist:"FILENAME_MUSTEXIST",dirname:"DIRNAME",directory:"DIRNAME",dirname_mustexist:"DIRNAME_MUSTEXIST",dirname_src:"DIRNAME_SRC",lookup_file:"LOOKUP_FILE",date:"DATE",time:"TIME",datetime:"DATETIME",date_time:"DATE_TIME",month:"MONTH",week:"WEEK",color:"COLOR",colour:"COLOR",color_pick:"COLOR_PICK",colorpick:"COLOR_PICK",coordsys:"COORDSYS",coordinate_system:"COORDSYS",geometry:"GEOMETRY",message:"MESSAGE",range_slider:"RANGE_SLIDER",slider:"RANGE_SLIDER",text_or_file:"TEXT_OR_FILE",attribute_name:"ATTRIBUTE_NAME",attribute_list:"ATTRIBUTE_LIST",db_connection:"DB_CONNECTION",web_connection:"WEB_CONNECTION",reprojection_file:"REPROJECTION_FILE",scripted:"SCRIPTED",group:"GROUP"},D=e=>{if(!e||"object"!=typeof e)return{};const t=e,r={...t};if(t.type&&(r.type=(e=>{if("string"!=typeof e)return"TEXT";const t=(0,i.QKA)(e),r=x[t];return r||e.toUpperCase()})(t.type)),"number"===t.type&&!0===t.showSlider&&(r.type="RANGE_SLIDER"),"datetime"===t.type&&"date"===t.format&&(r.type="DATE"),"file"===t.type&&t.itemsToSelect){const e="string"==typeof t.itemsToSelect?t.itemsToSelect.toLowerCase():"";"folders"===e||"directories"===e?r.type=t.validateExistence?"DIRNAME_MUSTEXIST":"DIRNAME":"files"===e&&(r.type=t.validateExistence?"FILENAME_MUSTEXIST":"FILENAME")}"text"===t.type&&"url"===t.editor&&(r.type="URL");const n=t.choiceSettings;if(n?.choices&&!t.listOptions){const e=Array.isArray(n.choices)?n.choices:[];r.listOptions=e.map((e=>{const t=e,r=t.value??t.caption;return{caption:t.display??t.caption??r,value:r,...t.description&&{description:t.description},...t.path&&{path:t.path},...t.disabled&&{disabled:t.disabled},...t.metadata&&{metadata:t.metadata}}})),"text"===t.type&&"URL"!==r.type&&(r.type="CHOICE")}return"tree"===t.type&&t.nodeDelimiter&&(r.metadata={...r.metadata||{},breadcrumbSeparator:t.nodeDelimiter,pathSeparator:t.nodeDelimiter}),t.prompt&&!t.description&&(r.description=t.prompt),"required"in t?r.optional=!t.required:"optional"in t||(r.optional=!1),"number"!==t.type&&"RANGE_SLIDER"!==r.type||("number"==typeof t.minimum&&(r.minimum=t.minimum),"number"==typeof t.maximum&&(r.maximum=t.maximum),"boolean"==typeof t.minimumExclusive&&(r.minimumExclusive=t.minimumExclusive),"boolean"==typeof t.maximumExclusive&&(r.maximumExclusive=t.maximumExclusive),"number"==typeof t.multipleOf&&(r.decimalPrecision=1===t.multipleOf?0:void 0)),"color"===t.type&&t.colorSpace&&(r.metadata={...r.metadata||{},colorSpace:t.colorSpace}),t.visibility&&(r.visibility=t.visibility),"group"===t.type&&Array.isArray(t.parameters)&&(r.parameters=t.parameters.map(D)),r},P=e=>{const t=A(e)&&Array.isArray(e.value)?e.value:e;if(!Array.isArray(t))return[];const r=t.map(D),n=[];for(const e of r)n.push(e),"GROUP"===e.type&&Array.isArray(e.parameters)&&n.push(...e.parameters);return n},F=e=>{const t=e?.httpStatus,r=e?.status;return"number"==typeof t?t:"number"==typeof r?r:void 0},j=e=>{const t=F(e);if("number"==typeof t)return(0,n.ar)(t)},U=e=>{try{const t=e?.data;if(!t)return;if("string"==typeof t)return t.length;return JSON.stringify(t).length}catch{return}},V=e=>{if(e&&"object"==typeof e&&"default"in e){const t=e;if(void 0!==t.default)return t.default}return e};let W,B,q,G,Q,$=null;const H=Object.create(null),z=e=>n.FB[e];async function K(){if(Boolean(W&&B&&q&&G&&Q))return;if($)return $;const e=(async()=>{const e=(()=>{try{const e=globalThis;return o._$.some((t=>t in e))?e:null}catch{return null}})();if(e)(e=>{if(!e)return;const t={esriRequest:e=>{W=e},esriConfig:e=>{B=e},projection:e=>{q=e},webMercatorUtils:e=>{G=e},SpatialReference:e=>{Q=e}};for(const r of o._$){const n=(r in e?e[r]:void 0)??z(r);t[r](n)}})(e);else try{await(async()=>{const[e,t,r,n,o]=await(0,i.ps9)(["esri/request","esri/config","esri/geometry/projection","esri/geometry/support/webMercatorUtils","esri/geometry/SpatialReference"]);W=V(e),B=V(t),q=V(r),G=V(n),Q=V(o);const s=te(q);s?.load&&await s.load()})()}catch{throw new Error("ARCGIS_MODULE_ERROR")}})();$=e;try{await e}catch(e){throw W=void 0,B=void 0,q=void 0,G=void 0,Q=void 0,$=null,ie=null,e instanceof Error?e:new Error(String(e))}}async function X(){return await K(),ee(B)}const Y=e=>{if(!A(e))return!1;const t=e,{before:r,error:n}=t;if(void 0!==r&&"function"!=typeof r)return!1;if(void 0!==n&&"function"!=typeof n)return!1;const{urls:o}=t;return void 0===o||("string"==typeof o||o instanceof RegExp||!!Array.isArray(o))};const J=e=>Boolean(e&&"object"==typeof e),Z=e=>"function"==typeof e?e:null,ee=e=>{if(!J(e))return null;const t=e;return t.request&&Array.isArray(t.request.interceptors)?t:null},te=e=>J(e)?e:null,re=(e,t,r)=>{const n=new Error(e);return n.code=e,null!=t&&(n.status=t),void 0!==r&&(n.cause=r),n},ne=async e=>{let t;try{t=await X()}catch{return}!function(e,t){if(Array.isArray(e)&&e.length)for(let r=e.length-1;r>=0;r--){const n=e[r];if(!Y(n)||!n._fmeInterceptor)continue;const o=n.urls;let s=!1;o instanceof RegExp?s=o.source===t.source&&o.flags===t.flags:Array.isArray(o)?s=o.some((e=>t.test(String(e??"")))):"string"==typeof o&&(s=t.test(o)),s&&e.splice(r,1)}}(t?.request?.interceptors,e)},oe=(e,t)=>({urls:t,before(t){if(!(e=>{if("string"==typeof e)return n.KC.test(e);if(e instanceof URL)return n.KC.test(e.pathname);if(e&&"object"==typeof e){const t="string"==typeof e.href?e.href:"string"==typeof e.url?e.url:null;return!!t&&n.KC.test(t)}return!1})(t?.url))return;t?.requestOptions||(t.requestOptions={});const r=t.requestOptions,o=r.headers??{},s=r.query??{};r.headers=o,r.query=s;const i=(e=>H[e])(e);i&&(s.fmetoken||(s.fmetoken=i),o.Authorization=`fmetoken token=${i}`)},_fmeInterceptor:!0});async function se(e,t){if(!e)return;const r=(0,i.$j5)(e);if(!r)return;const n=r.toLowerCase(),o=(0,i.dBM)(r);if(!t){const e=(e=>Object.prototype.hasOwnProperty.call(H,e))(n);return(e=>{delete H[e]})(n),void(e&&await ne(o))}let s;((e,t)=>{H[e]=t})(n,t);try{s=await X()}catch(e){throw e instanceof Error?e:new Error(String(e))}s?.request?.interceptors&&((0,i.m4N)(s.request.interceptors,o)||s.request.interceptors.push(oe(n,o)))}let ie=null;const ae=(e,t)=>{const r=(e=>{const t=(0,l.Lz)(e?.tm_ttc),r=(0,l.Lz)(e?.tm_ttl),n=(0,i.NnH)(e?.tm_tag),o={};return void 0!==t&&(o.ttc=t),void 0!==r&&(o.ttl=r),n&&(o.tag=n),o})(t),n={publishedParameters:e};return Object.keys(r).length>0&&(n.TMDirectives=r),n};class le{constructor(e){this.basePath=o.vA.BASE_PATH,this.disposed=!1,this.config=Object.freeze({...e}),this.setupPromise=Promise.resolve(),this.queueSetup(e)}queueSetup(e){this.setupPromise=(this.setupPromise||Promise.resolve()).catch((()=>{})).then((async()=>{try{await async function(){const e=await X();e&&(e.request.maxUrlLength=Math.max(Number(e.request.maxUrlLength)||0,o.vA.MAX_URL_LENGTH))}(),await se(e.serverUrl,e.token)}catch(e){throw e instanceof Error?e:new Error(String(e))}}))}queueTeardown(e){this.setupPromise=(this.setupPromise||Promise.resolve()).catch((()=>{})).then((()=>se(e,""))).catch((()=>{}))}dispose(){this.disposed||(this.disposed=!0,this.queueTeardown(this.config.serverUrl))}async uploadToTemp(e,t){if(t?.signal?.aborted)throw new DOMException("Aborted","AbortError");const r=this.resolveRepository(t?.repository),s=(0,i.P6s)(t?.workspace);if(!s)throw N("DATA_UPLOAD_ERROR");const a=((0,i.P6s)(e instanceof File?e.name:void 0)||`upload_${Date.now()}`).replace(/[^A-Za-z0-9._-]/g,"_").slice(0,n.vp.MAX_FILENAME_LENGTH)||`upload_${Date.now()}`,l=(0,i.P6s)(t?.subfolder).replace(/[^A-Za-z0-9_-]/g,"-").slice(0,n.vp.MAX_NAMESPACE_LENGTH)||g("upload"),c=(0,i.c$7)(this.config.serverUrl,"fmedataupload",r,s,a),u={opt_fullpath:"true",opt_responseformat:"json",opt_namespace:l},d={Accept:"application/json","Content-Type":e instanceof File&&e.type?e.type:"application/octet-stream"},p=await this.request(c,{method:o.ym.PUT,headers:d,body:e,query:u,signal:t?.signal,cacheHint:!1,repositoryContext:r}),f=p.data?.file,h=(0,i.NnH)(f?.path)??null;if(!h)throw N("DATA_UPLOAD_ERROR",p.status);return{data:{path:h},status:p.status,statusText:p.statusText}}resolveRepository(e){return e||this.config.repository}formatJobParams(e={}){if(A(t=e)&&Array.isArray(t.publishedParameters))return e;var t;const r=Object.entries(e).filter((([e])=>!o.d.has(e))).map((([e,t])=>({name:e,value:t})));return ae(r,e)}repoEndpoint(e,...t){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"repositories",e,...t)}jobsEndpoint(){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"jobs")}workspaceEndpoint(e,t,...r){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"workspaces",e,t,...r)}async withApiError(e,t,r){try{return await e()}catch(e){const n=(0,c.Ko)(e),s=(0,c.$d)(e),i=e instanceof o.VQ?e:null,a=i?.details??k(e),l=i?.severity,u="number"==typeof n?n:"number"==typeof i?.httpStatus?i.httpStatus:0;throw new o.VQ(t,r,u,s,l,a)}}async testConnection(e){return this.request("/healthcheck/liveness",{signal:e})}async validateRepository(e,t){const r=this.resolveRepository(e),n=this.repoEndpoint(r);return this.request(n,{signal:t})}async getRepositories(e){return this.withApiError((async()=>{const t=(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"repositories"),r=await this.request(t,{signal:e,cacheHint:!1,query:{limit:n.WC.API_QUERY_LIMIT,offset:0}}),o=r?.data;return{data:(0,i.o44)(o).map((e=>({name:e}))),status:r.status,statusText:r.statusText}}),"REPOSITORIES_ERROR","REPOSITORIES_ERROR")}async getWorkspaceParameter(e,t,r,n){const o=this.resolveRepository(r),s=this.workspaceEndpoint(o,e,"parameters",t),i=await this.request(s,{signal:n,cacheHint:!1,repositoryContext:o});return{...i,data:D(i.data)}}async getWorkspaceParameters(e,t,r){const n=this.resolveRepository(t),o=this.workspaceEndpoint(n,e,"parameters");return this.withApiError((async()=>{const e=await this.request(o,{signal:r,cacheHint:!1,repositoryContext:n});return{...e,data:P(e.data)}}),"WORKSPACE_PARAMETERS_ERROR","WORKSPACE_PARAMETERS_ERROR")}async getRepositoryItems(e,t,r,n,o){const s=this.resolveRepository(e),i=this.repoEndpoint(s,"items"),a={};return t&&(a.type=t),"number"==typeof r&&(a.limit=r),"number"==typeof n&&(a.offset=n),this.withApiError((()=>this.request(i,{signal:o,cacheHint:!1,repositoryContext:s,query:a})),"REPOSITORY_ITEMS_ERROR","REPOSITORY_ITEMS_ERROR")}async getWorkspaceItem(e,t,r){const n=this.resolveRepository(t),o=this.workspaceEndpoint(n,e);return this.withApiError((()=>this.request(o,{signal:r,cacheHint:!1,repositoryContext:n})),"WORKSPACE_ITEM_ERROR","WORKSPACE_ITEM_ERROR")}async submitJob(e,t={},r,n){const s=this.resolveRepository(r),i=this.jobsEndpoint(),a={repository:s,workspace:e,...this.formatJobParams(t)};return this.withApiError((()=>this.request(i,{method:o.ym.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:n,cacheHint:!1})),"JOB_SUBMISSION_ERROR","JOB_SUBMISSION_ERROR")}async runDataDownload(e,t={},r,n){const o=this.resolveRepository(r);return await this.runDownloadWebhook(e,t,o,n)}async runWorkspace(e,t={},r,n){return await this.runDataDownload(e,t,r,n)}async runDownloadWebhook(e,t={},r,n){try{const s={requireHttps:this.config.requireHttps},{baseUrl:c,params:u,fullUrl:d}=(0,l.vl)(this.config.serverUrl,r,e,t,this.config.token,s),p=(()=>{const e=(()=>{if("undefined"==typeof window)return;const e=window?.esriConfig?.request?.maxUrlLength,t=(0,i.MeA)(e)??Number(e);return Number.isFinite(t)&&t>0?t:void 0})();if(void 0!==e)return e;if(null!==ie)return ie;const t=ee(B),r=t?.request?.maxUrlLength,n="number"==typeof r?r:Number(r);return ie=Number.isFinite(n)&&n>0?n:1900,ie})();if(Number.isFinite(p)&&p>0&&d.length>p)throw re("URL_TOO_LONG",0);(0,i.qCC)("WEBHOOK_CALL",c,u,o.vA.WEBHOOK_LOG_WHITELIST),await K();const f=Z(W);if(!f)throw N("ARCGIS_MODULE_ERROR");const h={Accept:"application/json","Cache-Control":"no-cache"},y=new AbortController;let E=null,v=!1;const b=()=>{y.abort()};try{n&&(n.aborted?y.abort():n.addEventListener("abort",b));const e="number"==typeof this.config.timeout&&this.config.timeout>0?this.config.timeout:void 0;e&&(E=setTimeout((()=>{v=!0;try{y.abort()}catch{}}),e));const t=await m({method:"GET",url:d,transport:"fme-webhook",query:u,correlationId:g("webhook"),responseInterpreter:{status:F,ok:j,size:U},execute:()=>{const t={method:"get",responseType:"json",headers:h,signal:y.signal};return"number"==typeof e&&e>0&&(t.timeout=e),f(d,t)}});return this.parseWebhookResponse(t)}catch(e){if((0,a.zf)(e)&&v)throw re("WEBHOOK_TIMEOUT",408,e);throw e instanceof Error?e:new Error(String(e))}finally{E&&clearTimeout(E);try{n&&n.removeEventListener("abort",b)}catch{}}}catch(e){if(e instanceof o.VQ)throw e;if(e?.code)throw e instanceof Error?e:new Error(String(e));const t=(0,c.Ko)(e);throw N("DATA_DOWNLOAD_ERROR",t||0)}}async parseWebhookResponse(e){const t="number"==typeof(r=e).status?r.status:"httpStatus"in r&&"number"==typeof r.httpStatus?r.httpStatus??0:0;var r;if(401===t||403===t)throw re("WEBHOOK_AUTH_ERROR",t);const n=e instanceof Response||"object"==typeof e.headers&&e.headers&&"get"in e.headers&&"function"==typeof e.headers.get?e.headers:void 0,o=n?.get("content-type")||void 0,s=await(async e=>{if(e instanceof Response)try{return await e.json()}catch(e){throw re("WEBHOOK_NON_JSON",t,e)}if("function"==typeof e.json)try{return await e.json()}catch(e){throw re("WEBHOOK_NON_JSON",t,e)}return void 0!==e.data?e.data:void 0!==e.json?e.json:"function"==typeof e.text||"string"==typeof e.text?(async e=>{try{let t="";if("function"==typeof e)t=await e();else if("string"==typeof e)t=e;else if("number"==typeof e||"boolean"==typeof e)t=String(e);else{if(null!=e)throw new Error("Unsupported text source type");t=""}return t?JSON.parse(t):{}}catch(e){throw re("WEBHOOK_NON_JSON",t,e)}})(e.text):void 0})(e);if(!s||"object"!=typeof s)throw re("WEBHOOK_NON_JSON",t,e);if(o&&!(0,i.Fhj)(o))throw re("WEBHOOK_NON_JSON",t,{contentType:o});const a=e instanceof Response?e.statusText:e.statusText??"";return{data:s,status:t,statusText:a}}async request(e,t={}){if(this.disposed)throw N("CLIENT_DISPOSED");try{await this.setupPromise}catch(e){this.queueSetup(this.config);try{await this.setupPromise}catch{throw N("ARCGIS_MODULE_ERROR")}}await K();const r=e=>e.startsWith("/")?e.slice(1):e,s=r(this.basePath||""),l=s?[s]:[],u=r(e),d=e.startsWith("http")?e:e.startsWith("/fme")?(0,i.c$7)(this.config.serverUrl,u):u?(0,i.c$7)(this.config.serverUrl,...l,u):(0,i.c$7)(this.config.serverUrl,...l),p={...t.headers||{}},f={...t.query||{}};if(!t.method||t.method===o.ym.GET){const e=(0,i.qmZ)(this.config.serverUrl,this.config.token,t.repositoryContext);void 0===f.__scope&&(f.__scope=e)}const h={method:(t.method??o.ym.GET).toLowerCase(),query:f,responseType:"json",headers:p,signal:t.signal};try{const e=(0,i.$j5)(this.config.serverUrl)?.toLowerCase(),r=(0,i.yCG)(d);if(!r)throw N("INVALID_REQUEST_URL");if(this.config.requireHttps&&r.protocol&&"https:"!==r.protocol.toLowerCase())throw N("HTTPS_REQUIRED");const o=(r.hostname||"").toLowerCase();if(e&&o===e&&this.config.token){f.fmetoken||(f.fmetoken=this.config.token);const e={...h.headers??{}};e.Authorization=`fmetoken token=${this.config.token}`,h.headers=e}const s="number"==typeof t.timeout?t.timeout:"number"==typeof this.config.timeout?this.config.timeout:void 0;"number"==typeof s&&s>0&&(h.timeout=s),void 0!==t.cacheHint&&(h.cacheHint=t.cacheHint),void 0!==t.body&&(h.body=t.body);const a=Z(W);if(!a)throw N("ARCGIS_MODULE_ERROR");const l=g("fme"),c=await m({method:"string"==typeof h.method?h.method.toUpperCase():"GET",url:d,transport:"fme-flow-api",body:h.body,query:f,correlationId:l,responseInterpreter:{status:F,ok:j,size:U},execute:()=>a(d,h)});return{data:c.data,status:c.httpStatus??c.status??n.jL.OK,statusText:c.statusText??""}}catch(e){if("AbortError"===e?.name)return{data:void 0,status:0,statusText:"requestAborted"};if(e instanceof o.VQ)throw e;const t=(0,c.Ko)(e)||0,r=(0,c.$d)(e);let n="REQUEST_FAILED";(0,i.PEb)(e).includes("Unexpected token")&&(n="INVALID_RESPONSE_FORMAT");const s=(0,a.fV)(e,t),l=k(e),u=s||n;throw new o.VQ(u,n,t,r,void 0,l)}}}const ce=e=>({serverUrl:(0,i.P6s)(e.fmeServerUrl)||(0,i.P6s)(Reflect.get(e,"fme_server_url"))||"",token:(0,i.P6s)(e.fmeServerToken)||(0,i.P6s)(Reflect.get(e,"fme_server_token"))||(0,i.P6s)(Reflect.get(e,"fmw_server_token"))||"",repository:e.repository||"",timeout:e.requestTimeout,requireHttps:e.requireHttps});function ue(e){const t=ce(e);try{(0,c.e6)(t)}catch{throw N("INVALID_CONFIG")}return new le({...t,serverUrl:t.serverUrl.replace(/\/$/,"")})}},2242:(e,t,r)=>{"use strict";r.d(t,{CH:()=>A,Gb:()=>g,SB:()=>I,UA:()=>v,Vp:()=>y,YG:()=>w,bQ:()=>O,bn:()=>C,d7:()=>m,ho:()=>_,j_:()=>S,kg:()=>T,qp:()=>k,rG:()=>E,uB:()=>f,yN:()=>h});var n=r(9244),o=r(3930),s=r(7665),i=r(3417),a=r(5880),l=(r(1787),r(3314));const c=e=>{if("object"!=typeof e||null===e)return null;const t=Reflect.get(e,"operators");return"object"==typeof(r=t)&&null!==r?t:null;var r},u=e=>!(!e||"object"!=typeof e)&&"string"==typeof e.name,d=e=>Array.isArray(e),p=(e,t)=>{if(e)try{t(e)}catch{}},f=e=>{p(e,(e=>{e.cancel()}))},h=e=>{p(e,(e=>{e.removeAll()}))},m=(e,t,r)=>{const o=(0,l.eF2)(t)?t:0,s=n.React.useRef(null),i=n.React.useRef(!1),a=n.React.useRef(null),c=n.hooks.useLatest(e),u=n.hooks.useLatest(r),d=n.hooks.useEventCallback((e=>{if(i.current===e)return;i.current=e;const t=u.current?.onPendingChange;if("function"==typeof t)try{t(e)}catch{}})),p=n.hooks.useEventCallback((()=>{s.current&&(clearTimeout(s.current),s.current=null),a.current=null,i.current&&d(!1)})),f=n.hooks.useEventCallback(((...e)=>{a.current=e,s.current&&clearTimeout(s.current),d(!0),s.current=setTimeout((()=>{s.current=null,a.current=null;try{c.current(...e)}finally{d(!1)}}),o)})),h=n.hooks.useEventCallback((()=>{if(!a.current)return;const e=a.current;p(),c.current(...e)})),m=n.React.useRef(null),g=n.hooks.useLatest(f),y=n.hooks.useLatest(p),E=n.hooks.useLatest(h);if(!m.current){const e=(...e)=>{g.current(...e)};e.cancel=()=>y.current(),e.flush=()=>E.current(),e.isPending=()=>i.current,m.current=e}const v=n.hooks.useLatest(p);n.hooks.useEffectOnce((()=>()=>{v.current()}));const b=m.current;if(!b)throw new Error("debounceUnavailable");return b},g=e=>{const[t,r]=n.React.useState({modules:null,loading:!0,errorKey:null});return n.hooks.useEffectWithPreviousValues((()=>{let t=!1;r((t=>({modules:0===e?t.modules:null,loading:!0,errorKey:null})));return(async()=>{try{const n=await(0,l.ps9)(i.RF);if(t)return;const[o,s,a,u,d,p,f,h,m,g,y]=n;try{"object"==typeof(e=p)&&null!==e&&"function"==typeof Reflect.get(e,"load")&&await p.load()}catch(e){}const E=c(u)??c(a)??null;r({modules:{SketchViewModel:o,GraphicsLayer:s,geometryEngine:a,geometryEngineAsync:u,webMercatorUtils:d,projection:p,SpatialReference:f,normalizeUtils:h,Polyline:m,Polygon:g,Graphic:y,geometryOperators:E},loading:!1,errorKey:null})}catch(e){t||r({modules:null,loading:!1,errorKey:"errorMapInit"})}var e})(),()=>{t=!0}}),[e]),t},y=()=>{const[e,t]=n.React.useState({jimuMapView:null,sketchViewModel:null,graphicsLayer:null,cleanupHandles:null}),r=n.hooks.useEventCallback(((e,r)=>{t((t=>{if("sketchViewModel"===e&&t.sketchViewModel&&t.sketchViewModel!==r)try{const e=t.sketchViewModel?.__fmeCleanup__;"function"==typeof e&&e()}catch{}if("cleanupHandles"===e&&t.cleanupHandles&&t.cleanupHandles!==r)try{t.cleanupHandles()}catch{}return{...t,[e]:r}}))})),o=n.hooks.useEventCallback((r=>{const{sketchViewModel:n,graphicsLayer:o,jimuMapView:s,cleanupHandles:i}=e;if(i)try{i()}catch{}var a,l;f(n),p(n,(e=>{"function"==typeof e.destroy&&e.destroy()})),a=s,l=o,a?.view?.map&&p(l,(e=>{e.parent&&a.view.map.remove(e)})),h(o),(e=>{p(e,(e=>{const t=e.destroy;"function"==typeof t&&t.call(e)}))})(o),t((e=>({...e,jimuMapView:r?null:e.jimuMapView,sketchViewModel:null,graphicsLayer:null,cleanupHandles:null})))})),s=n.hooks.useEventCallback((()=>{o(!1)})),i=n.hooks.useEventCallback((()=>{o(!0)}));return{...e,setJimuMapView:e=>r("jimuMapView",e),setSketchViewModel:e=>r("sketchViewModel",e),setGraphicsLayer:e=>r("graphicsLayer",e),setCleanupHandles:e=>r("cleanupHandles",e),teardownDrawingResources:s,cleanupResources:i}},E=(e,t)=>n.hooks.useEventCallback(((r,n,o)=>{const s={message:r,type:n,code:o||"UNKNOWN",severity:i.MU.ERROR,recoverable:!0,timestampMs:Date.now(),kind:"serializable",userFriendlyMessage:"",suggestion:""};e(a.fmeActions.setError("general",s,t))})),v=(e,t)=>{const[r,o]=n.React.useState((()=>e.initializeValues())),[s,i]=n.React.useState(!0),[a,l]=n.React.useState({}),c=n.hooks.useEventCallback((e=>{o(e),t?.(e)})),u=n.hooks.useEventCallback(((e,t)=>{const n={...r,[e]:t};c(n)})),d=n.hooks.useEventCallback((()=>{const t=e.validateValues(r);return i(t.isValid),l(t.errors),t})),p=n.hooks.useEventCallback((()=>{const t=e.initializeValues();l({}),i(!0),c(t)}));return{values:r,isValid:s,errors:a,updateField:u,validateForm:d,resetForm:p,setValues:c,setIsValid:i,setErrors:l}};let b=0;const w=()=>{const e=n.React.useRef();return e.current||(b>=Number.MAX_SAFE_INTEGER&&(b=0),b+=1,e.current=`fme-${b}`),e.current},S=(e,t,r)=>{const[o,s]=n.hooks.useControlled({controlled:e,default:t});return[o,n.hooks.useEventCallback((e=>{s(e),r?.(e)}))]},R=e=>{if(!e)return null;const t=e.message,r=e.detail,n=e.messages,o=Array.isArray(n)?n.filter((e=>null!=e)):void 0;return null!=t||null!=r||o&&0!==o.length?{message:t,detail:r,messages:o}:null},T=(e,t)=>{const r=(0,l.eF2)(t)?t:0,[o,s]=n.React.useState("loading"===e.kind),i=n.React.useRef("loading"===e.kind?Date.now():null),a=n.React.useRef("loading"===e.kind?R(e):null),c=n.hooks.useEventCallback((()=>{s(!1),i.current=null,a.current=null}));n.hooks.useEffectWithPreviousValues((()=>{if("loading"===e.kind)return a.current=R(e),null==i.current&&(i.current=Date.now()),void s(!0);if(null==i.current)return void c();const t=Date.now()-i.current,n=(0,l.eF2)(t)?t:0,o=Math.max(0,r-n);if(0===o)return void c();const u=setTimeout((()=>{c()}),o);return()=>{clearTimeout(u)}}),[e,r,c]);const u="loading"===e.kind;return{showLoading:u||o,snapshot:u?R(e):a.current}},O=()=>{const e=n.React.useRef(null),t=n.hooks.useEventCallback((()=>{const t=e.current;(0,l.Wz3)(t),e.current=null})),r=n.hooks.useEventCallback((()=>{t();const r=new AbortController;return e.current=r,r})),o=n.hooks.useEventCallback((t=>{t&&e.current===t&&(e.current=null)}));return{controllerRef:e,abortAndCreate:r,cancel:t,finalize:o}};function A(e,t){return(0,o.I)({queryKey:l.lHd.workspaces(e.repository||i.nu,e.fmeServerUrl,e.fmeServerToken),queryFn:async({signal:t})=>{const r=(0,l.MbC)(e.fmeServerUrl,e.fmeServerToken,e.repository);if(!r)throw new Error("FME client not initialized");const n=e.repository||i.nu,o=await r.getRepositoryItems(n,i.h6,void 0,void 0,t);return Array.isArray(o?.data?.items)?o.data.items:[]},enabled:(t?.enabled??!0)&&Boolean(e.fmeServerUrl&&e.fmeServerToken)})}function I(e,t,r){return(0,o.I)({queryKey:l.lHd.workspaceItem(e,t.repository||i.nu,t.fmeServerUrl,t.fmeServerToken),queryFn:async({signal:r})=>{if(!e)throw new Error("Workspace name required");const n=(0,l.MbC)(t.fmeServerUrl,t.fmeServerToken,t.repository);if(!n)throw new Error("FME client not initialized");const o=t.repository||i.nu,[s,a]=await Promise.allSettled([n.getWorkspaceItem(e,o,r),n.getWorkspaceParameters(e,o,r)]);if("rejected"===s.status){const e=s.reason;throw e instanceof Error?e:new Error("string"==typeof e&&e.trim()?e:"Failed to fetch workspace item")}let c=[];"fulfilled"===a.status&&d(a.value?.data)&&(c=a.value.data);const p=s.value?.data;if(!u(p))throw new Error("Workspace item missing data");return{item:p,parameters:c}},enabled:(r?.enabled??!0)&&Boolean(e&&t.fmeServerUrl&&t.fmeServerToken),staleTime:i.ST.TEN_MINUTES,refetchOnMount:!1})}function _(e,t,r){const o=(0,s.jE)(),[a,c]=n.React.useState((()=>({isPrefetching:!1,progress:null,prefetchStatus:"idle"}))),u=r?.enabled??!0,d=r?.chunkSize??10,p=n.hooks.useLatest(t),f=n.hooks.useLatest(e),h=n.hooks.useLatest(r?.onProgress);return n.hooks.useEffectWithPreviousValues((()=>{const e=f.current;let t=!1;const r=new Set,n=e=>{r.forEach((t=>{(0,l.Wz3)(t,e)})),r.clear()},s=()=>{t=!0,n()};if(!u||!e?.length)return c({isPrefetching:!1,progress:null,prefetchStatus:"idle"}),s;const a=p.current??{},m=a.repository||i.nu,g=a.fmeServerUrl,y=a.fmeServerToken;if(!g||!y)return s;const E=(0,l.MbC)(g,y,m);if(!E)return s;const v=e=>(r.add(e),()=>{r.delete(e)}),b=(e,t)=>(0,l.psn)(e,t);return(async()=>{c({isPrefetching:!0,progress:{loaded:0,total:e.length},prefetchStatus:"loading"});const r=[];for(let t=0;t<e.length;t+=d)r.push(e.slice(t,t+d));let s=0;try{for(const n of r){if(t)break;const r=i.WC.MAX_CONCURRENT_PREFETCH,a={active:0,queue:[]},u=async e=>{for(;a.active>=r;)await new Promise((e=>a.queue.push(e)));a.active++;try{return await e()}finally{a.active--;const e=a.queue.shift();e&&e()}};if(await Promise.allSettled(n.map((e=>u((()=>o.prefetchQuery({queryKey:l.lHd.workspaceItem(e.name,m,g,y),queryFn:async({signal:t})=>{const r=new AbortController,n=v(r),o=b(t,r);try{const t=r.signal,[n,o]=await Promise.all([E.getWorkspaceItem(e.name,m,t),E.getWorkspaceParameters(e.name,m,t)]);return{item:n.data,parameters:Array.isArray(o?.data)?o.data:[]}}finally{o(),n()}},staleTime:i.ST.TEN_MINUTES})))))),t)break;s+=n.length,c((t=>({...t,progress:{loaded:s,total:e.length}}))),h.current?.(s,e.length)}t||c({isPrefetching:!1,progress:null,prefetchStatus:"success"})}catch(e){t||((0,l.fAF)("Workspace prefetch error",e),c({isPrefetching:!1,progress:null,prefetchStatus:"error"}))}finally{n()}})(),s}),[u,o,d,h,t?.repository,t?.fmeServerUrl,t?.fmeServerToken,e]),a}function C(e,t,r=i.ST.MIN_LOADING_DELAY_MS){const o=n.React.useRef({});return n.hooks.useEventCallback(((n,s)=>{if(s)o.current[n]=Date.now(),e(a.fmeActions.setLoadingFlag(n,!0,t));else{const s=o.current[n];if(s){const i=Date.now()-s,l=Math.max(0,r-i);l>0?setTimeout((()=>{e(a.fmeActions.setLoadingFlag(n,!1,t)),delete o.current[n]}),l):(e(a.fmeActions.setLoadingFlag(n,!1,t)),delete o.current[n])}else e(a.fmeActions.setLoadingFlag(n,!1,t))}}))}function k(e){const t=n.ReactRedux.useDispatch(),r=n.React.useRef({setDrawingTool:r=>{t(a.fmeActions.setDrawingTool(r,e))},setViewMode:r=>{t(a.fmeActions.setViewMode(r,e))},setError:(r,n)=>{t(a.fmeActions.setError(r,n,e))},clearError:r=>{t(a.fmeActions.clearError(r,e))},setGeometry:(r,n)=>{t(a.fmeActions.setGeometry(r,n,e))},setWorkspaceItems:r=>{t(a.fmeActions.setWorkspaceItems(r,e))},applyWorkspaceData:r=>{t(a.fmeActions.applyWorkspaceData(r,e))},completeDrawing:(r,n,o)=>{t(a.fmeActions.completeDrawing(r,n,o,e))},clearWorkspaceState:()=>{t(a.fmeActions.clearWorkspaceState(e))},resetState:()=>{t(a.fmeActions.resetState(e))},resetToDrawing:()=>{t(a.fmeActions.resetToDrawing(e))},setLoadingFlag:(r,n)=>{t(a.fmeActions.setLoadingFlag(r,n,e))},setOrderResult:r=>{t(a.fmeActions.setOrderResult(r,e))},completeStartup:()=>{t(a.fmeActions.completeStartup(e))},removeWidgetState:()=>{t(a.fmeActions.removeWidgetState(e))}});return n.hooks.useUpdateEffect((()=>{r.current={setDrawingTool:r=>{t(a.fmeActions.setDrawingTool(r,e))},setViewMode:r=>{t(a.fmeActions.setViewMode(r,e))},setError:(r,n)=>{t(a.fmeActions.setError(r,n,e))},clearError:r=>{t(a.fmeActions.clearError(r,e))},setGeometry:(r,n)=>{t(a.fmeActions.setGeometry(r,n,e))},setWorkspaceItems:r=>{t(a.fmeActions.setWorkspaceItems(r,e))},applyWorkspaceData:r=>{t(a.fmeActions.applyWorkspaceData(r,e))},completeDrawing:(r,n,o)=>{t(a.fmeActions.completeDrawing(r,n,o,e))},clearWorkspaceState:()=>{t(a.fmeActions.clearWorkspaceState(e))},resetState:()=>{t(a.fmeActions.resetState(e))},resetToDrawing:()=>{t(a.fmeActions.resetToDrawing(e))},setLoadingFlag:(r,n)=>{t(a.fmeActions.setLoadingFlag(r,n,e))},setOrderResult:r=>{t(a.fmeActions.setOrderResult(r,e))},completeStartup:()=>{t(a.fmeActions.completeStartup(e))},removeWidgetState:()=>{t(a.fmeActions.removeWidgetState(e))}}}),[t,e]),r.current}},2606:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1 1v14h14V1zm9.082 13c-.005-.037-.113-.274-.122-.309a1.5 1.5 0 0 0 .718-1.267 1.2 1.2 0 0 0-.053-.358c.152-.176.263-.383.326-.607q.046.003.093.003c.3.002.593-.091.836-.266q.06.066.126.124c.42.412.977.654 1.564.68H14v2h-3.918M14 11h-.43a1.46 1.46 0 0 1-.906-.433c-.264-.23-.258-.782-.617-.782-.482 0-.52.677-1.003.677-.219 0-.38-.177-.599-.177-.193 0-.445.102-.445.293v.502c0 .424-.506.508-.506.934 0 .171.184.236.184.41 0 .58-.893.502-.893 1.08 0 .191.215.305.215.486V14H6.375q.087-.243.09-.502c0-.547-1.043-.393-1.207-.72-.407-.813.693-1.022.693-1.673 0-.16-.082-.488-.334-.513-.351-.035-.443.154-.797.154a.406.406 0 0 1-.437-.36c0-.386.308-.566.308-.952 0-.25-.102-.393-.102-.643a.62.62 0 0 1 .59-.643c.323 0 .464.264.618.54a.64.64 0 0 0 .617.308c.49 0 .798-.61.798-.977a.47.47 0 0 1 .437-.488c.347 0 .476.36.824.36.57 0 .55-.756 1.053-1.03.618-.332.438-1.052.36-1.44-.032-.169.29-.5.464-.487.72.05.412-.54.412-.823q0-.073.022-.142c.111-.332.595-.438.595-.836 0-.281-.233-.41-.233-.693a.65.65 0 0 1 .22-.44H14zM2 14V2h8.278c-.013.077-.132.356-.132.44 0 .194.038.387.112.567a1.6 1.6 0 0 0-.422.643 1.4 1.4 0 0 0-.074.442 1.7 1.7 0 0 0-.536.43 1.32 1.32 0 0 0-.32 1.091q.046.205.066.414a2 2 0 0 0-.649.67 1.46 1.46 0 0 0-.674-.166 1.45 1.45 0 0 0-1.383 1.086 1.44 1.44 0 0 0-1.086-.469 1.62 1.62 0 0 0-1.591 1.643c0 .254.113.293.084.574s-.29.535-.29 1.022a1.37 1.37 0 0 0 .984 1.29 1.58 1.58 0 0 0-.003 1.549c.143.286.636.774.534.774z"></path></svg>'},2686:e=>{"use strict";e.exports=n},2775:(e,t,r)=>{"use strict";r.d(t,{Zq:()=>s,zs:()=>o});var n={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},o=new class{#f=n;#h=!1;setTimeoutProvider(e){this.#f=e}setTimeout(e,t){return this.#f.setTimeout(e,t)}clearTimeout(e){this.#f.clearTimeout(e)}setInterval(e,t){return this.#f.setInterval(e,t)}clearInterval(e){this.#f.clearInterval(e)}};function s(e){setTimeout(e,0)}},2779:(e,t,r)=>{"use strict";r.d(t,{rH:()=>o,yK:()=>n});const n=e=>e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),o=(e,t="",r)=>{const n=r?.maxLength??512;if(e.length>n)return null;try{return new RegExp(e,t)}catch{return null}}},3040:(e,t,r)=>{"use strict";r.d(t,{Eo:()=>g,Hz:()=>A,Jo:()=>h,Lz:()=>b,Mm:()=>y,_R:()=>v,cL:()=>w,o4:()=>S,vl:()=>k});var n=r(9244),o=r(3417),s=r(5132),i=r(3890),a=r(4986),l=r(6920),c=r(1181),u=r(1618),d=r(930);const p=e=>"object"!=typeof e||null===e||Array.isArray(e)?null:e,f=e=>{const t=p(e),r=t?.data;return p(r)??{}},h=(e,t,r,o,i,a)=>{if(!e)return(0,s.Qg)(r("msgNoResult"),{code:"NO_RESULT",actions:o.onBack?[{label:r("btnBack"),onClick:o.onBack}]:void 0});const l=Boolean(e.cancelled),u=!l&&Boolean(e.success),d=!l&&!u,p=t?.syncMode?"sync":"async",f="sync"===e.serviceMode||"async"===e.serviceMode?e.serviceMode:p,h=[];void 0!==e.jobId&&null!==e.jobId&&h.push(`${r("lblJobId")}: ${e.jobId}`),e.workspaceName&&h.push(`${r("lblWorkspace")}: ${e.workspaceName}`);const m="async"===f?"optAsyncMode":"optSyncMode";if(h.push(`${r("lblDelivery")}: ${r(m)}`),e.downloadFilename&&h.push(`${r("lblFilename")}: ${e.downloadFilename}`),e.status&&h.push(`${r("lblFmeStatus")}: ${e.status}`),e.statusMessage&&e.statusMessage!==e.message&&h.push(`${r("lblFmeMessage")}: ${e.statusMessage}`),e.blobMetadata?.type&&h.push(`${r("lblBlobType")}: ${e.blobMetadata.type}`),e.blobMetadata?.size){const t=(0,c.$j)(e.blobMetadata.size);t&&h.push(`${r("lblBlobSize")}: ${t}`)}if("sync"!==f&&e.email){const n=t?.maskEmailOnSuccess&&u?(0,c.q2)(e.email):e.email;h.push(`${r("lblEmail")}: ${n}`)}e.code&&d&&h.push(`${r("lblErrorCode")}: ${e.code}`);let g=null;if(l){g=r((e.code||"").toString().toUpperCase().includes("TIMEOUT")?"msgOrderTimeout":"msgOrderCancelled")}else if(u)"async"===f&&(g=r("msgEmailSent"));else{const t=(e.code||"").toString().toUpperCase(),n=e.message||e.statusMessage||"";g="FME_JOB_CANCELLED_TIMEOUT"===t?r("msgJobTimeout"):"FME_JOB_CANCELLED"===t?r("msgJobCancelled"):"FME_JOB_FAILURE"===t||/FME\s*Flow\s*transformation\s*failed/i.test(n)?r("errTransformFailed"):n||r("msgJobFailed")}const y=[];l?y.push({label:r("btnNewOrder"),onClick:()=>{o.onReuseGeography?.()},type:"primary"}):u?y.push({label:r("btnReuseArea"),onClick:()=>{o.onReuseGeography?.()},type:"primary"}):y.push({label:r("btnRetry"),onClick:()=>{o.onBack?.()},type:"primary"}),y.push({label:r("btnEnd"),onClick:()=>{o.onReset?o.onReset():o.onBack?.()},type:"default"});const E=h.length>0?(0,n.jsx)(n.React.Fragment,null,...h.map(((e,t)=>(0,n.jsx)("div",{key:t},e)))):null;let v=null;if(u&&"sync"===f){const t=e.downloadUrl||a||null;t&&(v=(0,n.jsx)("div",{style:{marginBottom:"0.5rem"}},(0,n.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",download:e.downloadFilename||"download"},r("btnDownloadFallback"))))}const b=i||E||v||g?(0,n.jsx)(n.React.Fragment,null,i,E,v,g&&(0,n.jsx)("div",null,g)):void 0;if(d){const t=r("titleOrderFailed");return(0,s.Qg)(t,{code:e.code,actions:y,detail:b})}return{kind:"success",title:r(l?"titleOrderCancelled":"sync"===f?"titleOrderComplete":"titleOrderConfirmed"),message:void 0,actions:y,detail:b}},m=["sync","async"],g=e=>{if(!e)return e??void 0;const t=e.syncMode;let r="boolean"==typeof t?t:(0,a.Dr)(t);if(void 0===r&&(r=Boolean(t)),"boolean"==typeof t&&t===r)return e;const n={...e,syncMode:r};var o;return"object"!=typeof(o=e)||null===o||Array.isArray(o)||"function"!=typeof o.set||Object.defineProperty(n,"set",{value:e.set,writable:!0,configurable:!0}),n},y=(e,t,r)=>{const n=f(e),s=n._serviceMode,i=(0,a.P6)((0,a.Bv)(s)).toLowerCase();let l;l="sync"===i||"async"===i?i:t?.syncMode?"sync":"async";const c=((e,t)=>{if(!t)return null;if(t.areaWarning)return{reason:"area",value:t.drawnArea,threshold:e?.largeArea};if("number"==typeof e?.largeArea&&null!=t.drawnArea&&t.drawnArea>e.largeArea)return{reason:"area",value:t.drawnArea,threshold:e.largeArea};if(t.formData&&e)try{const r=t.formData?.data||{},n=E({data:r},t.userEmail||"","sync",e),s=t.workspaceItem?.name;if(s&&e.fmeServerUrl&&e.repository&&L({serverUrl:e.fmeServerUrl,repository:e.repository,workspace:s,parameters:n,token:e.fmeServerToken,options:{requireHttps:e.requireHttps}})){const{fullUrl:t}=k(e.fmeServerUrl,e.repository,s,n,e.fmeServerToken,{requireHttps:e.requireHttps});return{reason:"url_length",urlLength:t.length,threshold:o.vA.MAX_URL_LENGTH}}}catch{}return null})(t,{workspaceItem:r?.workspaceItem,areaWarning:r?.areaWarning,drawnArea:r?.drawnArea,formData:e,userEmail:"string"==typeof n.opt_requesteremail?n.opt_requesteremail:""});return c&&"sync"===l?(r?.onModeOverride?.({forcedMode:"async",previousMode:"sync",reason:c.reason,value:c.value,threshold:c.threshold,urlLength:c.urlLength}),"async"):l},E=(e,t,r="async",n)=>{const o=f(e),s=m.includes(r)?r:"async",i={...o,opt_servicemode:s,opt_responseformat:"json",opt_showresult:n?.showResult??!0?"true":"false"},l=(0,a.P6)(t);return"async"===s&&l&&(i.opt_requesteremail=l),i},v=(e,t)=>{if(!t)return e;const r={...e},n=e=>{const t=b(e);if(!(void 0===t||t<=0))return t},o=(()=>{const t=e.opt_servicemode;if("string"==typeof t)return t;const n=r.opt_servicemode;return(0,a.Bv)(n)})(),s=(0,a.P6)(o).toLowerCase(),i="sync"===s||!s&&Boolean(t?.syncMode);if(i||void 0===r.tm_ttc){if(i&&!("tm_ttc"in r)){const e=n(t?.tm_ttc);void 0!==e&&(r.tm_ttc=e)}}else delete r.tm_ttc;if(!("tm_ttl"in r)){const e=n(t?.tm_ttl);void 0!==e&&(r.tm_ttl=e)}return r},b=e=>{if("number"==typeof e&&Number.isFinite(e)){if(e<0)return;return Math.floor(e)}const t=(0,a.Nn)(e);if(!t||!/^\d+$/.test(t))return;const r=Number(t);return!Number.isFinite(r)||r<0?void 0:Math.floor(r)},w=(e,t,r,n,o,s)=>{const{config:i,workspaceParameters:a,workspaceItem:c,areaWarning:d,drawnArea:p}=s||{},f=g(i),h=e?.data||{},m=y({data:h},f,{workspaceItem:c,areaWarning:d,drawnArea:p}),{_serviceMode:b,__upload_file__:w,__remote_dataset_url__:S,...R}=h,T=E({data:R},t,m,f),O=(0,u.QC)(a),A=(0,u.NV)(T,r,n,o,f,O),I=v(A,f);return(0,l.dd)(I,f),I},S=e=>{if(Array.isArray(e))return(0,l.is)((0,l.YD)(e,"name"));const t="object"==typeof e&&null!==e?e:null,r=t?.items;return Array.isArray(r)?(0,l.is)((0,l.YD)(r,"name")):[]},R=(e,t,r)=>({success:!0,blob:e,email:r,workspaceName:t,downloadFilename:`${t}_export.zip`,blobMetadata:{type:(0,a.Nn)(e.type),size:"number"==typeof e.size&&Number.isFinite(e.size)?e.size:void 0}}),T=(e,t,r)=>({success:!0,jobId:"number"==typeof e.jobId?e.jobId:void 0,email:r,workspaceName:t,downloadUrl:e.url,downloadFilename:e.url?`${t}_export.zip`:void 0,status:e.status,statusMessage:e.message}),O=(e,t,r="FME_JOB_FAILURE")=>({success:!1,message:e,code:r,..."number"==typeof t?.jobId&&{jobId:t.jobId},...t?.status&&{status:t.status},...t?.message&&{statusMessage:t.message}}),A=(e,t,r,n)=>{const o=p(e),s=o?.data;if(!s)return{success:!1,message:n("noDataInResponse"),code:"NO_DATA"};const i=p(s),l=i?.blob;if(l instanceof Blob)return R(l,t,r);const c=I(e),u=(c.status||"").toString().trim().toUpperCase();if("ABORTED"===u){const e=c.message||"",t=e.toLowerCase(),r=["timeout","time limit","time-limit","max execution","maximum execution","max runtime","maximum runtime","max run time"].some((e=>t.includes(e)));return{success:!1,cancelled:!0,message:n(r?"jobCancelledTimeout":"jobCancelled"),code:r?"FME_JOB_CANCELLED_TIMEOUT":"FME_JOB_CANCELLED",status:c.status,statusMessage:e,jobId:"number"==typeof c.jobId?c.jobId:void 0}}if(new Set(["FAILURE","FAILED","JOB_FAILURE","FME_FAILURE"]).has(u)){const e=(0,a.Nn)(c.message)||n("jobFailed");return O(e,c,"FME_JOB_FAILURE")}var d;return"SUCCESS"===u||"string"==typeof(d=c.url)&&/^https?:\/\//.test(d)||"number"==typeof c.jobId&&c.jobId>0?T(c,t,r):O(c.message||n("errorJobSubmission"),c)},I=e=>{const t=e||{},r=t?.data?.serviceResponse||t?.data||t,n=r?.statusInfo?.status||r?.status,o=r?.statusInfo?.message||r?.message,s="number"==typeof r?.jobID?r.jobID:r?.id,i=r?.url;return{status:n,message:o,jobId:s,url:i}},_=e=>Array.from(e.entries()).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),C=(e,t={})=>{for(const r of o.T5){const n=b(t[r]);void 0!==n&&e.set(r,String(n))}const r=((e,t)=>{const r=(0,a.Nn)(e);return r?r.slice(0,t):void 0})(t.tm_tag,128);r&&e.set("tm_tag",r)},k=(e,t,r,n={},s,a)=>{const l=(0,d.c$)(e,"fmedatadownload",t,r),c=(0,d.yC)(e)??(0,d.yC)(l)??void 0,u=c?.hostname||"",p=a?.requireHttps??!0,f=a?.strict??(!(e=>{if(!e)return!1;const t=e.replace(/^\[|\]$/g,"").toLowerCase();return"localhost"===t||"::1"===t||"0:0:0:0:0:0:0:1"===t||!!t.startsWith("127.")})(u)&&p),h=(0,i._Y)(l,{strict:f,requireHttps:p});if(!h.ok)throw((e,t,r)=>{const n=new Error(e);return n.code=e,null!=t&&(n.status=t),void 0!==r&&(n.cause=r),n})("WEBHOOK_AUTH_ERROR",0,h.errorKey||"invalid_url");const m=(0,d.XV)(n,[...o.GR],!0);return s&&m.set("token",s),C(m,n),{baseUrl:l,params:m,fullUrl:`${l}?${_(m)}`}},L=e=>{const{serverUrl:t,repository:r,workspace:n,parameters:s={},maxLen:i=o.vA.MAX_URL_LENGTH,token:a,options:l}=e,{fullUrl:c}=k(t,r,n,s,a,l);return"number"==typeof i&&i>0&&c.length>i}},3096:(e,t,r)=>{"use strict";r.d(t,{AR:()=>F,BY:()=>G,Bd:()=>z,Do:()=>B,EW:()=>ae,FB:()=>l,FS:()=>re,GR:()=>w,H4:()=>$,In:()=>p,K2:()=>J,KC:()=>y,KF:()=>te,KG:()=>de,LZ:()=>W,P9:()=>ce,PJ:()=>c,PS:()=>K,QB:()=>Ee,QC:()=>m,R0:()=>O,RF:()=>i,ST:()=>ie,T5:()=>v,Us:()=>me,VZ:()=>V,Ve:()=>u,WC:()=>X,Wp:()=>U,Xw:()=>q,_$:()=>a,_A:()=>x,a0:()=>ve,a9:()=>pe,aP:()=>ye,ar:()=>H,bD:()=>he,d:()=>S,d8:()=>C,h6:()=>R,j2:()=>le,jF:()=>ue,jL:()=>Q,lY:()=>j,lh:()=>o,m2:()=>ee,mR:()=>Y,nc:()=>s,np:()=>_,nu:()=>T,o0:()=>Z,oh:()=>A,qT:()=>d,qc:()=>h,si:()=>se,uV:()=>L,vA:()=>g,vH:()=>P,vN:()=>I,vp:()=>D,wF:()=>f,wS:()=>ne,wq:()=>M,xA:()=>k,xH:()=>N,xW:()=>ge,zo:()=>fe,zw:()=>oe});var n=r(6055);Object.freeze([n.ZW.SET_VIEW_MODE,n.ZW.RESET_STATE,n.ZW.SET_GEOMETRY,n.ZW.SET_DRAWING_TOOL,n.ZW.COMPLETE_DRAWING,n.ZW.SET_ORDER_RESULT,n.ZW.SET_WORKSPACE_ITEMS,n.ZW.SET_WORKSPACE_PARAMETERS,n.ZW.SET_SELECTED_WORKSPACE,n.ZW.SET_WORKSPACE_ITEM,n.ZW.SET_ERROR,n.ZW.SET_ERRORS,n.ZW.CLEAR_WORKSPACE_STATE,n.ZW.CLEAR_ERROR,n.ZW.RESET_TO_DRAWING,n.ZW.COMPLETE_STARTUP,n.ZW.REMOVE_WIDGET_STATE,n.ZW.SET_LOADING_FLAG,n.ZW.APPLY_WORKSPACE_DATA]);const o={[n.nE.STARTUP_VALIDATION]:n.nE.STARTUP_VALIDATION,[n.nE.EXPORT_FORM]:n.nE.WORKSPACE_SELECTION,[n.nE.WORKSPACE_SELECTION]:n.nE.INITIAL,[n.nE.EXPORT_OPTIONS]:n.nE.INITIAL,[n.nE.ORDER_RESULT]:n.nE.INITIAL,[n.nE.DRAWING]:n.nE.INITIAL,[n.nE.INITIAL]:n.nE.INITIAL},s=Object.freeze({modules:!1,submission:!1,workspaces:!1,parameters:!1,geometryValidation:!1}),i=Object.freeze(["esri/widgets/Sketch/SketchViewModel","esri/layers/GraphicsLayer","esri/geometry/geometryEngine","esri/geometry/geometryEngineAsync","esri/geometry/support/webMercatorUtils","esri/geometry/projection","esri/geometry/SpatialReference","esri/geometry/support/normalizeUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/Graphic"]),a=Object.freeze(["esriRequest","esriConfig","projection","webMercatorUtils","SpatialReference"]),l=Object.freeze({esriRequest:()=>Promise.resolve({data:null}),esriConfig:{request:{maxUrlLength:4e3,interceptors:[]}},projection:{},webMercatorUtils:{},SpatialReference:()=>({})}),c=Object.freeze({title:"",listMode:"hide",elevationInfo:{mode:"on-the-ground"}}),u="#0079C1",d=Object.freeze([{value:"POLYGON",label:"optPolygon",icon:"polygon.svg",tooltip:"tipDrawPolygon",hideLabel:!0},{value:"RECTANGLE",label:"optRectangle",icon:"rectangle.svg",tooltip:"tipDrawRectangle",hideLabel:!0}]),p=(Object.freeze({WGS84:4326,WEB_MERCATOR:3857}),50),f=1e-6,h=1/111319.49079327358,m=Object.freeze({M2_PER_KM2:1e6,AREA_DECIMALS:2,METERS_PER_KILOMETER:1e3,SQUARE_FEET_PER_SQUARE_MILE:27878400,VERTICES_PER_MS_ESTIMATE:100}),g=(Object.freeze([{factor:.3048,label:"ft\xb2",keywords:["foot","feet"],largeUnit:{threshold:m.SQUARE_FEET_PER_SQUARE_MILE,factor:m.SQUARE_FEET_PER_SQUARE_MILE,label:"mi\xb2"}},{factor:.3048006096,label:"ft\xb2",keywords:[]},{factor:1609.344,label:"mi\xb2",keywords:["mile"]},{factor:m.METERS_PER_KILOMETER,label:"km\xb2",keywords:["kilometer"]},{factor:.9144,label:"yd\xb2",keywords:["yard"]},{factor:.0254,label:"in\xb2",keywords:["inch"]},{factor:.01,label:"cm\xb2",keywords:["centimeter"]},{factor:.001,label:"mm\xb2",keywords:["millimeter"]},{factor:1852,label:"nm\xb2",keywords:["nautical"]},{factor:1,label:"m\xb2",keywords:["meter"]}]),Object.freeze({BASE_PATH:"/fmeapiv4",MAX_URL_LENGTH:4e3,WEBHOOK_EXCLUDE_KEYS:[],WEBHOOK_LOG_WHITELIST:Object.freeze(["opt_responseformat","opt_showresult","opt_servicemode"])})),y=/\/(?:fmedatadownload|fmedataupload|fmeapiv4)\b/i,E=(Object.freeze(["sync","async"]),Object.freeze(["tm_ttc","tm_ttl","tm_tag"])),v=Object.freeze(["tm_ttc","tm_ttl"]),b=Object.freeze(["opt_servicemode","opt_responseformat","opt_showresult","opt_requesteremail"]),w=Object.freeze([...g.WEBHOOK_EXCLUDE_KEYS,...E]),S=new Set([...E,...b]),R="workspace",T="_",O=Object.freeze([]),A=(Object.freeze({DEFAULT_CHUNK_SIZE:5,MIN_CHUNK_SIZE:1,MAX_CHUNK_SIZE:15}),Object.freeze(new Set(["MAXX","MINX","MAXY","MINY","AreaOfInterest","AREA","ExtentGeoJson","tm_ttc","tm_ttl","tm_tag"]))),I=Object.freeze(new Set([n.QL.NOVALUE,n.QL.GROUP,n.QL.group])),_=Object.freeze(new Set([n.QL.DB_CONNECTION,n.QL.WEB_CONNECTION,n.QL.ATTRIBUTE_NAME,n.QL.ATTRIBUTE_LIST,n.QL.COORDSYS,n.QL.REPROJECTION_FILE])),C=Object.freeze(new Set([n.QL.LISTBOX,n.QL.LOOKUP_LISTBOX,n.QL.ATTRIBUTE_LIST,n.QL.listbox])),k=Object.freeze({[n.QL.text]:n.Vw.TEXT,[n.QL.number]:n.Vw.NUMBER,[n.QL.checkbox]:n.Vw.CHECKBOX,[n.QL.dropdown]:n.Vw.RADIO,[n.QL.listbox]:n.Vw.MULTI_SELECT,[n.QL.tree]:n.Vw.SELECT,[n.QL.password]:n.Vw.PASSWORD,[n.QL.datetime]:n.Vw.DATE_TIME,[n.QL.message]:n.Vw.MESSAGE,[n.QL.group]:n.Vw.HIDDEN,[n.QL.file]:n.Vw.FILE,[n.QL.color]:n.Vw.COLOR,[n.QL.range]:n.Vw.SLIDER,[n.QL.FLOAT]:n.Vw.NUMERIC_INPUT,[n.QL.INTEGER]:n.Vw.NUMBER,[n.QL.TEXT_EDIT]:n.Vw.TEXTAREA,[n.QL.PASSWORD]:n.Vw.PASSWORD,[n.QL.BOOLEAN]:n.Vw.SWITCH,[n.QL.CHECKBOX]:n.Vw.SWITCH,[n.QL.CHOICE]:n.Vw.RADIO,[n.QL.LOOKUP_CHOICE]:n.Vw.RADIO,[n.QL.LISTBOX]:n.Vw.MULTI_SELECT,[n.QL.LOOKUP_LISTBOX]:n.Vw.MULTI_SELECT,[n.QL.FILENAME]:n.Vw.FILE,[n.QL.FILENAME_MUSTEXIST]:n.Vw.FILE,[n.QL.DIRNAME]:n.Vw.FILE,[n.QL.DIRNAME_MUSTEXIST]:n.Vw.FILE,[n.QL.DIRNAME_SRC]:n.Vw.FILE,[n.QL.DATE_TIME]:n.Vw.DATE_TIME,[n.QL.DATETIME]:n.Vw.DATE_TIME,[n.QL.URL]:n.Vw.URL,[n.QL.LOOKUP_URL]:n.Vw.URL,[n.QL.LOOKUP_FILE]:n.Vw.FILE,[n.QL.DATE]:n.Vw.DATE,[n.QL.TIME]:n.Vw.TIME,[n.QL.MONTH]:n.Vw.MONTH,[n.QL.WEEK]:n.Vw.WEEK,[n.QL.COLOR]:n.Vw.COLOR,[n.QL.COLOR_PICK]:n.Vw.COLOR,[n.QL.RANGE_SLIDER]:n.Vw.SLIDER,[n.QL.MESSAGE]:n.Vw.MESSAGE,[n.QL.TEXT_OR_FILE]:n.Vw.TEXT_OR_FILE,[n.QL.REPROJECTION_FILE]:n.Vw.REPROJECTION_FILE,[n.QL.COORDSYS]:n.Vw.COORDSYS,[n.QL.ATTRIBUTE_NAME]:n.Vw.ATTRIBUTE_NAME,[n.QL.ATTRIBUTE_LIST]:n.Vw.ATTRIBUTE_LIST,[n.QL.DB_CONNECTION]:n.Vw.DB_CONNECTION,[n.QL.WEB_CONNECTION]:n.Vw.WEB_CONNECTION,[n.QL.SCRIPTED]:n.Vw.SCRIPTED}),L=(Object.freeze({FLOAT:"number",INTEGER:"number",BOOLEAN:"boolean",STRING:"text",TEXT:"text"}),64),M=/\|/,N=Object.freeze(["no slider","noslider","without slider"]),x=Object.freeze(["FILENAME","FILENAME_MUSTEXIST","DIRNAME","DIRNAME_MUSTEXIST","DIRNAME_SRC","LOOKUP_FILE","REPROJECTION_FILE"]),D=Object.freeze({DEFAULT_MAX_SIZE_MB:150,ONE_MB_IN_BYTES:1048576,GEOMETRY_PREVIEW_MAX_LENGTH:1500,MAX_FILENAME_LENGTH:128,MAX_NAMESPACE_LENGTH:64,DEFAULT_ALLOWED_EXTENSIONS:Object.freeze([".zip",".kmz",".json",".geojson",".gml"]),DEFAULT_ALLOWED_MIME_TYPES:Object.freeze(new Set(["application/zip","application/x-zip-compressed","application/vnd.google-earth.kmz","application/json","application/geo+json","application/gml+xml","text/plain",""].map((e=>e.toLowerCase())))),FILE_DISPLAY_KEYS:Object.freeze(["text","path","location","value","dataset","defaultValue","fileName","filename","file_path","file","uri","url","name"])}),P=/\.(zip|kmz|json|geojson|gml)(\?.*)?$/i,F=new Set(["SELECT","COORDSYS","ATTRIBUTE_NAME","DB_CONNECTION","WEB_CONNECTION","REPROJECTION_FILE"]),j=new Set(["MULTI_SELECT","ATTRIBUTE_LIST"]),U=Object.freeze({TEXT:"text",FILE:"file"}),V=(Object.freeze(["text","email","tel","search","password","number"]),Object.freeze({email:"phEmail",phone:"phPhone",search:"phSearch"}),Object.freeze({MAX_TEXT_LENGTH:5e3,IPV4_OCTET_MAX:255,IPV4_OCTET_MIN:0,MAX_GEOMETRY_VERTICES:5e3,SLIDER_DEFAULT_MAX:100,RGB_MAX:255,RGB_MIN:0})),W=(Object.freeze({VALIDATION:{DEFAULT_TTL_VALUE:"",DEFAULT_TTC_VALUE:""},LIMITS:{MAX_M2_CAP:1e10,MAX_REQUEST_TIMEOUT_MS:6e5},DIRECTIVES:{DESCRIPTION_MAX:512,TAG_MAX:128},COLORS:{BACKGROUND_DARK:"#181818"},TEXT:{LARGE_AREA_MESSAGE_MAX:200}}),Object.freeze(["fmeServerUrl","fmeServerToken","repository"])),B=512,q=/^[^\s@]{1,64}@[^\s@]{1,253}\.[^\s@]{2,63}$/,G=/\{\s*email\s*\}/i,Q=(Object.freeze(new Set(["AbortError","ABORT_ERR","ERR_ABORTED"])),Object.freeze({OK:200,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,BAD_REQUEST:400,TIMEOUT:408,GATEWAY_TIMEOUT:504,TOO_MANY_REQUESTS:429,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,NETWORK_ERROR:0,SERVER_ERROR_MIN:500,SERVER_ERROR_MAX:599})),$=Object.freeze({SUCCESS_MIN:200,SUCCESS_MAX:399,CLIENT_ERROR_MIN:400,CLIENT_ERROR_MAX:499,SERVER_ERROR_MIN:500,SERVER_ERROR_MAX:599,MIN_VALID:100,MAX_VALID:599}),H=e=>"number"==typeof e&&e>=$.SUCCESS_MIN&&e<=$.SUCCESS_MAX,z=e=>"number"==typeof e&&e>=$.MIN_VALID&&e<=$.MAX_VALID,K=e=>!e||e<$.MIN_VALID||(!!(e=>"number"==typeof e&&e>=$.SERVER_ERROR_MIN)(e)||(e===Q.TIMEOUT||e===Q.TOO_MANY_REQUESTS)),X=Object.freeze({MAX_HISTORY_SIZE:100,API_QUERY_LIMIT:500,RANDOM_ID_LENGTH:8,MAX_RETRY_ATTEMPTS:3,MAX_CONCURRENT_PREFETCH:6}),Y=Object.freeze({enabled:!0,logLevel:"debug",bodyPreviewLimit:1024,warnSlowMs:1e3}),J=Object.freeze(["failed to fetch","networkerror","net::","dns","enotfound","econnrefused","timeout","name or service not known","err_name_not_resolved","unable to load","/sharing/proxy","proxy"]),Z=Object.freeze(["unable to load","/sharing/proxy","proxy"]),ee=4e3,te=Object.freeze(["localhost",".localhost",".local",".internal",".intranet",".home",".lan",".localdomain"]),re=Object.freeze([{start:[10,0,0,0],end:[10,255,255,255]},{start:[100,64,0,0],end:[100,127,255,255]},{start:[127,0,0,0],end:[127,255,255,255]},{start:[169,254,0,0],end:[169,254,255,255]},{start:[172,16,0,0],end:[172,31,255,255]},{start:[192,168,0,0],end:[192,168,255,255]},{start:[0,0,0,0],end:[0,255,255,255]}]),ne=Object.freeze(["token","auth","secret","key","password"]),oe=/authorization="?[^"]+"?/gi,se=/(token|fmetoken)=([^&\s]+)/gi,ie=Object.freeze({SECOND:1e3,MINUTE:6e4,FIVE_MINUTES:3e5,TEN_MINUTES:6e5,MAX_RESPONSE_TIME:3e5,SLOW_REQUEST_THRESHOLD:1e3,DEBOUNCE_VALIDATION_MS:300,AUTO_DOWNLOAD_DELAY_MS:150,POPUP_CLOSE_DELAY_MS:100,BLOB_URL_CLEANUP_DELAY_MS:12e4,STARTUP_TIMEOUT_MS:15e3,MIN_LOADING_DELAY_MS:400}),ae=Object.freeze({OPACITY_SCALE_FACTOR:100,OUTLINE_WIDTH_SLIDER_MIN:0,OUTLINE_WIDTH_SLIDER_MAX:10,OUTLINE_WIDTH_MIN:.1,OUTLINE_WIDTH_MAX:5,OUTLINE_WIDTH_INCREMENT:.5,OUTLINE_WIDTH_PRECISION:10,AREA_INPUT_STEP:1e3,PERCENT_SLIDER_MAX:100,ICON_SIZE_SMALL:16,ICON_SIZE_MEDIUM:18,ICON_SIZE_LARGE:24,LOADING_SPINNER_SIZE:32}),le=Object.freeze({DELAY_ENTER_MS:500,DELAY_NEXT_MS:300,DELAY_LEAVE_MS:300,DELAY_TOUCH_MS:700}),ce=Object.freeze({DELAY_MS:1e3,DETAIL_DELAY_MS:2e3,CYCLE_INTERVAL_MS:4e3}),ue=(Object.freeze({error:"error.svg",map:"map.svg",polygon:"polygon.svg",warning:"warning.svg","person-lock":"person-lock.svg",folder:"folder.svg",data:"data.svg","shared-no":"shared-no.svg","feature-service":"feature-service.svg","link-tilted":"link-tilted.svg",time:"time.svg",setting:"setting.svg",email:"email.svg",info:"info.svg",success:"success.svg"}),Object.freeze({warning:"warning",error:"error",info:"info",success:"success"}),Object.freeze({GEOMETRY_SERIALIZATION_FAILED:"polygon",MAP_MODULES_LOAD_FAILED:"map",FORM_INVALID:"warning"}),Object.freeze([{token:"GEOMETRY",icon:"polygon"},{token:"AREA",icon:"polygon"},{token:"MAP",icon:"map"},{token:"MODULE",icon:"map"},{token:"FORM",icon:"warning"},{token:"TOKEN",icon:"person-lock"},{token:"AUTH",icon:"person-lock"},{token:"REPOSITORY",icon:"folder"},{token:"REPO",icon:"folder"},{token:"DATA",icon:"data"},{token:"NETWORK",icon:"shared-no"},{token:"OFFLINE",icon:"shared-no"},{token:"CONNECTION",icon:"shared-no"},{token:"REQUEST",icon:"shared-no"},{token:"SERVER",icon:"feature-service"},{token:"GATEWAY",icon:"feature-service"},{token:"URL",icon:"link-tilted"},{token:"TIMEOUT",icon:"time"},{token:"CONFIG",icon:"setting"},{token:"EMAIL",icon:"email"}]),Object.freeze({CANCELLED_PROMISE:"CancelledPromiseError",ABORT:"AbortError"}),{INVALID_RESPONSE_FORMAT:"errorTokenIssue",WEBHOOK_AUTH_ERROR:"errorTokenIssue",WEBHOOK_TIMEOUT:"requestTimedOut",REPOSITORIES_ERROR:"errorRepositoryAccess",REPOSITORY_ITEMS_ERROR:"errorRepositoryAccess",JOB_SUBMISSION_ERROR:"errorJobSubmission",INVALID_CONFIG:"errorSetupRequired",CONFIG_INCOMPLETE:"errorSetupRequired",configMissing:"errorSetupRequired",HTTPS_REQUIRED:"require_https",INVALID_REQUEST_URL:"invalid_url",GEOMETRY_MISSING:"geometryMissingCode",GEOMETRY_TYPE_INVALID:"geometryTypeInvalidCode",GEOMETRY_SERIALIZATION_FAILED:"geometrySerializationFailedCode",URL_TOO_LONG:"urlTooLongMessage",WEBHOOK_URL_TOO_LONG:"urlTooLongMessage",PARAMETER_VALIDATION_ERROR:"errorParameterValidation",WORKSPACE_PARAMETERS_ERROR:"errorWorkspaceParameters"}),de={401:"errorTokenIssue",408:"requestTimedOut",429:"rateLimitExceeded",431:"headersTooLargeMessage"},pe=Object.freeze([{pattern:/timeout/i,key:"requestTimedOut"},{pattern:/cors/i,key:"corsBlocked"},{pattern:/url.*too/i,key:"urlTooLongMessage"},{pattern:/remote_dataset_workspace_required/i,key:"REMOTE_DATASET_WORKSPACE_REQUIRED"}]),fe={require_https:"require_https",no_query_or_hash:"invalid_url",invalid_url:"invalid_url"},he=Object.freeze(["status","statusCode","httpStatus"]),me=(Object.freeze({ERROR:3,WARNING:2,INFO:1}),Object.freeze({general:0,export:1,import:2}),Object.freeze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),320),ge=Object.freeze(["message","error","detail","description","reason","text"]),ye=(Object.freeze({success:"color: #28a745; font-weight: bold",info:"color: #007bff; font-weight: bold",warn:"color: #ffc107; font-weight: bold",error:"color: #dc3545; font-weight: bold",action:"color: #0078d4; font-weight: bold"}),Object.freeze({MIN_YEAR:2020,MAX_YEAR:2100,MAX_MINOR_VERSION:100})),Ee=Object.freeze({DJB2_INITIAL:5381}),ve=Object.freeze({MAX_WINDOW_HIERARCHY_ITERATIONS:100})},3128:(e,t,r)=>{"use strict";r.d(t,{$W:()=>i,MN:()=>c});var n=r(9244),o=r(1888),s=r(3096);const i={icon:{small:s.EW.ICON_SIZE_SMALL,medium:s.EW.ICON_SIZE_MEDIUM,large:s.EW.ICON_SIZE_LARGE},tooltip:{delay:{enter:s.j2.DELAY_ENTER_MS,next:s.j2.DELAY_NEXT_MS,leave:s.j2.DELAY_LEAVE_MS,touch:s.j2.DELAY_TOUCH_MS},position:{top:"top",bottom:"bottom",left:"left",right:"right"},showArrow:!0},button:{defaults:{block:!0,tooltipPosition:"top"},offset:"10px",textPadding:"18px"},zIndex:{selectMenu:1005,overlay:1e3},loading:{width:s.EW.LOADING_SPINNER_SIZE,height:s.EW.LOADING_SPINNER_SIZE,delay:s.P9.DELAY_MS,detailDelay:s.P9.DETAIL_DELAY_MS,cycleInterval:s.P9.CYCLE_INTERVAL_MS},required:"*"},a=e=>({fontFamily:e?.fontFamily,fontWeight:e?.fontWeight?.toString(),fontSize:e?.fontSize,fontStyle:e?.fontStyle,lineHeight:e?.lineHeight,color:e?.color}),l=(e,t={})=>(0,n.css)({display:"inline"===e?"inline-flex":"flex",flexFlow:"column"===e?"column nowrap":"inline"===e?"row wrap":void 0,...t}),c=()=>(e=>{const t=e.sys.spacing,r=e.sys.color,o=e.sys.typography,s=t?.(2),c="1 1 auto";return{row:l("row",{gap:s}),buttonGroup:l("column",{inlineSize:"100%",gap:s}),fullWidth:l("column",{inlineSize:"100%",flex:c,minInlineSize:0}),relative:(0,n.css)({position:"relative"}),rowAlignCenter:(0,n.css)({alignItems:"center"}),disabledPicker:l("row",{pointerEvents:"none"}),textareaResize:(0,n.css)({resize:"vertical"}),parent:l("column",{overflowY:"auto",blockSize:"100%",position:"relative",gap:s,padding:t?.(1),backgroundColor:r?.surface?.paper}),header:l("row",{alignItems:"center",justifyContent:"flex-end",gap:s,marginBlockEnd:t?.(2)}),headerAlert:(0,n.css)({marginInlineEnd:"auto",display:"flex",alignItems:"center"}),content:l("column",{flex:c,minBlockSize:0,gap:s}),centered:l("column",{placeContent:"center",alignItems:"center",textAlign:"center",flex:c,minBlockSize:0,gap:s}),loadingText:(0,n.css)({}),loadingSpinner:(0,n.css)({"& .donut-loading":{top:"60% !important"}}),overlay:(0,n.css)({position:"absolute",inset:"50% auto auto 50%",transform:"translate(-50%, -50%)",textAlign:"center",zIndex:i.zIndex.overlay}),alert:(0,n.css)({width:"100% !important"}),alertInline:(0,n.css)({opacity:.8}),alertContent:l("row",{alignItems:"flex-start",gap:s}),alertMessage:(0,n.css)({flex:c,...a(o?.label2)}),alertIcon:(0,n.css)({display:"inline-flex",alignItems:"center",justifyContent:"center",flex:"0 0 auto"}),typo:{caption:(0,n.css)({...a(o?.body1),marginBlockEnd:t?.(3)}),label:(0,n.css)({...a(o?.label1),fontWeight:"400",marginBlockEnd:0}),title:(0,n.css)({...a(o?.title1),margin:`${t?.(1)} 0`}),instruction:(0,n.css)({textAlign:"center",...a(o?.body1),margin:`${t?.(3)} 0`}),link:(0,n.css)({...a(o?.body1),color:r?.action.link?.default,textDecoration:"underline",wordBreak:"break-all","&:hover":{color:r?.action.link?.hover,textDecoration:"underline"}}),loadingMessage:(0,n.css)({...a(o?.label2)}),required:(0,n.css)({marginInlineStart:t?.(1)}),hint:(0,n.css)({...a(o?.label3),marginBlockStart:t?.(1)}),errorMessage:(0,n.css)({...a(o?.label3),color:r?.error?.main,marginBlockStart:t?.(1)})},btn:{flex:(0,n.css)({flex:c}),group:l("column",{inlineSize:"100%",gap:s}),text:e=>(0,n.css)({flex:c,textAlign:e||"start",paddingInlineEnd:i.button.textPadding}),icon:(0,n.css)({position:"absolute",zIndex:1,insetBlockStart:"50%",insetInlineEnd:i.button.offset,transform:"translateY(-50%)"})},form:{layout:l("column",{flex:c,minBlockSize:0,gap:s}),header:(0,n.css)({flex:"0 0 auto"}),sliderField:l("row",{alignItems:"center",width:"100%",gap:s}),sliderValue:(0,n.css)({...a(o?.label2),textAlign:"center"}),content:l("column",{flex:c,gap:s}),body:l("column",{flex:c,gap:s,overflowY:"auto"}),footer:l("column",{flex:"0 0 auto",gap:s})},field:(0,n.css)({marginBlockEnd:t?.(3)}),checkLabel:l("row",{alignItems:"center",justifyContent:"space-between",inlineSize:"100%"}),selection:{container:l("column",{flex:c,gap:s,minBlockSize:0}),warning:(0,n.css)({marginBlockStart:"auto"}),message:(0,n.css)({marginBlockStart:"auto",...a(o?.body2)})},tooltipWrap:{block:l("row",{inlineSize:"100%",minInlineSize:0}),inline:l("inline",{minInlineSize:0}),anchor:l("row",{flex:c,minInlineSize:0,"& > *":{flex:c,minInlineSize:0}})},stateView:{frame:l("column",{inlineSize:"100%",blockSize:"100%",minBlockSize:0}),error:l("column",{flex:c,inlineSize:"100%",blockSize:"100%",minBlockSize:0,gap:s,alignItems:"stretch"}),errorContent:l("column",{gap:s,flex:"1 1 auto",justifyContent:"center"}),errorIcon:(0,n.css)({marginBlockEnd:t?.(2)??0}),errorActions:(0,n.css)({inlineSize:"100%",marginBlockStart:"auto",alignSelf:"stretch"}),infoLine:(0,n.css)({marginBlockEnd:t?.(2)??0})}}})((0,o.useTheme)())},3314:(e,t,r)=>{"use strict";r.d(t,{zzz:()=>T,_RB:()=>l._R,sIn:()=>i.sI,$Xq:()=>n.$X,LHE:()=>o.LH,Fmk:()=>S,uAi:()=>n.uA,JoK:()=>l.Jo,EjJ:()=>o.Ej,gV5:()=>p,c$7:()=>R.c$,ARn:()=>i.AR,RBD:()=>w,ZFl:()=>A.ZF,UEQ:()=>b,GCs:()=>a.GC,MbC:()=>R.Mb,dBM:()=>R.dB,xry:()=>O,MmJ:()=>l.Mm,eCr:()=>n.eC,PEb:()=>o.PE,$j5:()=>R.$j,o44:()=>l.o4,WZF:()=>o.WZ,SP$:()=>o.SP,hk0:()=>o.hk,Wxj:()=>o.Wx,BU:()=>o.BU,JdW:()=>o.Jd,OkK:()=>a.Ok,JRh:()=>o.JR,xik:()=>o.xi,kzc:()=>o.kz,hSq:()=>R.hS,sJ:()=>a.sJ,SBV:()=>i.SB,Tdo:()=>n.Td,FKs:()=>o.FK,Xk1:()=>o.Xk,bE2:()=>i.bE,OD1:()=>o.OD,HKR:()=>o.HK,rIK:()=>o.rI,m4N:()=>R.m4,zfx:()=>a.zf,Ime:()=>n.Im,E$q:()=>n.E$,BfI:()=>n.Bf,IAu:()=>n.IA,Fhj:()=>R.Fh,xsy:()=>R.xs,YH$:()=>n.YH,eF2:()=>n.eF,P3$:()=>n.P3,QdQ:()=>n.Qd,w$k:()=>n.w$,B9Y:()=>A.B9,psn:()=>a.ps,ps9:()=>m,fAF:()=>a.fA,B_y:()=>n.B_,qmZ:()=>R.qm,fVY:()=>a.fV,W1g:()=>n.W1,HeH:()=>n.He,sLt:()=>n.sL,EoF:()=>l.Eo,wk6:()=>f,QKA:()=>n.QK,psb:()=>n.ps,P9t:()=>_,$em:()=>o.$e,dCw:()=>o.dC,sqe:()=>i.sq,H9i:()=>A.H9,CqL:()=>n.Cq,hUO:()=>n.hU,XlQ:()=>n.Xl,Fv9:()=>v,cLk:()=>l.cL,lHd:()=>R.lH,Ad4:()=>s.Ad,I0Z:()=>o.I0,yol:()=>i.yo,Wz3:()=>a.Wz,qCC:()=>R.qC,yCG:()=>R.yC,XTn:()=>C,dd1:()=>i.dd,rBs:()=>A.rB,Ynv:()=>i.Yn,bNn:()=>a.bN,pZA:()=>A.pZ,Z_x:()=>o.Z_,OxR:()=>o.Ox,RMY:()=>o.RM,$rL:()=>n.$r,Dr1:()=>n.Dr,ITI:()=>n.IT,P6s:()=>n.P6,MeA:()=>n.Me,wKo:()=>n.wK,NnH:()=>n.Nn,BvY:()=>n.Bv,vqZ:()=>n.vq,qpp:()=>I.qp,bQb:()=>I.bQ});r(5880);var n=r(4986),o=r(1181),s=r(1618),i=r(6920),a=r(1138),l=r(3040),c=r(9244);const u=e=>null!=e&&"object"==typeof e,d=new Map,p=(e,t)=>{const r=[e[0],e[1],e[2]],n="number"==typeof t?.outlineWidth?t.outlineWidth:2,o=Math.min(5,Math.max(.1,n)),s="number"==typeof t?.fillOpacity?t.fillOpacity:.2,i=Math.min(1,Math.max(0,s)),a={type:"simple-fill",color:[...r,i],outline:{color:r,width:o}};return{HIGHLIGHT_SYMBOL:a,DRAWING_SYMBOLS:{polygon:a,polyline:{type:"simple-line",color:r,width:o},point:{type:"simple-marker",style:"circle",size:8,color:r,outline:{color:[255,255,255],width:1}}}}},f=e=>{if(!e)return null;const t=e.toLowerCase();return"extent"===t||"rectangle"===t?"rectangle":"polygon"===t?"polygon":null},h=e=>e?.default??e;async function m(e){if(!Array.isArray(e)||!e.length)return[];const t=globalThis?.__ESRI_TEST_STUB__;if("function"==typeof t)return t(e);const n=e.filter((e=>"string"==typeof e&&e.length>0));if(!n.length)return[];const o=JSON.stringify(n),s=d.get(o);if(s)return s;const i=(async()=>{try{const e=await Promise.resolve().then(r.bind(r,2686)),t=e?.loadArcGISJSAPIModules;if("function"!=typeof t)throw new Error("ARCGIS_MODULE_ERROR");return(await t(n)||[]).map(h)}catch(e){throw d.delete(o),console.log("Critical: Failed to load jimu-arcgis module",e),new Error("ARCGIS_MODULE_ERROR")}})();return d.set(o,i),i}const g=(e,t)=>{try{if(t&&u(t)&&"function"==typeof t.close)return void t.close();e&&"function"==typeof e.closePopup&&e.closePopup()}catch{}},y=(e,t)=>{if(!e||!u(e))return null;const r=e,n="boolean"==typeof r.autoOpenEnabled?r.autoOpenEnabled:void 0;g(t,e);try{r.autoOpenEnabled=!1}catch{}let o=null;if("function"==typeof r.watch)try{o=r.watch("visible",(r=>{r&&g(t,e)}))}catch{}return{popup:e,view:t||null,handle:o,prevAutoOpen:n}},E=e=>{if(e){try{e.handle?.remove?.()}catch{}(e=>{const t=e.popup;if(!u(t))return;const r=t;try{const t="boolean"!=typeof e.prevAutoOpen||e.prevAutoOpen;r.autoOpenEnabled=t}catch{}})(e)}};const v=new class{constructor(){this.record=null,this.owners=new Set}acquire(e,t,r){if(!t)return void this.release(e);const n=this.record?.popup;if(!n||n!==t){this.teardown(),this.owners.clear();const e=y(t,r);if(!e)return;this.record=e}this.owners.add(e)}release(e){this.owners.delete(e)&&0===this.owners.size&&this.teardown()}releaseAll(){(0!==this.owners.size||this.record)&&(this.owners.clear(),this.teardown())}teardown(){this.record&&(E(this.record),this.record=null)}},b=(e,t,r)=>{if(!e)return[];const n=[],o=new Set(r||[]);for(const[r,s]of Object.entries(e)){if(r===t||!s)continue;if(o.has(r))continue;const e=s.state;if(!e)continue;const i=String(e).toUpperCase();i!==c.WidgetState.Closed&&i!==c.WidgetState.Hidden&&n.push(r)}return n};function w(e){const t=[];let r=0,n=!1;if(!e)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};const o=e.map;if(!o||!o.layers)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};try{const e=o.allLayers||o.layers;if(!e)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};e.forEach((e=>{if(!e||"object"!=typeof e)return;const o=e;if(!o.type)return;const s="feature"===o.type,i="graphics"===o.type;if(!s&&!i)return;const a=o.fields;if(!a||!Array.isArray(a)||0===a.length)return;r++;const l=o.title||o.name||o.id||"Unknown Layer",c=o.id,u=o.geometryType;u&&(n=!0),a.forEach((e=>{if(!e||!e.name)return;let r;if(e.domain)if("coded-value"===e.domain.type){const t=e.domain;r={type:t.type||"unknown",codedValues:t.codedValues?.map((e=>({name:e.name,code:e.code})))}}else r={type:e.domain.type||"unknown"};const n={name:e.name,alias:e.alias||e.name,type:e.type||"string",nullable:e.nullable??!0,editable:e.editable??!0,layerName:l,layerId:c,geometryType:u,domain:r};t.push(n)}))}))}catch(e){console.log("Error collecting layer attributes",e)}return{attributes:t,layerCount:r,totalAttributeCount:t.length,hasGeometry:n}}function S(e){if(!e||!e.attributes||0===e.attributes.length)return[];const t=new Set,r=[];return e.attributes.forEach((e=>{if(!e||!e.name)return;if(t.has(e.name))return;t.add(e.name);const n=e.layerName&&"Unknown Layer"!==e.layerName?`${e.name} (${e.layerName})`:e.alias||e.name;r.push({value:e.name,label:n})})),r.sort(((e,t)=>e.label.localeCompare(t.label))),r}var R=r(930);const T={TO_ACTIVE:{fromStates:[c.WidgetState.Closed,c.WidgetState.Hidden],toStates:[c.WidgetState.Opened,c.WidgetState.Active]},TO_INACTIVE:{fromStates:[c.WidgetState.Opened,c.WidgetState.Active],toStates:[c.WidgetState.Closed,c.WidgetState.Hidden]},TO_CLOSED:{fromStates:[c.WidgetState.Opened,c.WidgetState.Active],toStates:[c.WidgetState.Closed]},FROM_CLOSED:{fromStates:[c.WidgetState.Closed],toStates:[c.WidgetState.Opened,c.WidgetState.Active]}},O=e=>({isTransition:(e,t,r)=>((e,t,r)=>{if(!e||!t)return!1;const n=r.fromStates.includes(e),o=r.toStates.includes(t);return n&&o})(e,t,r),log:(t,r,n)=>{((e,t,r,n)=>{const o=t||"undefined",s=r||"undefined";console.log(`[FME Widget ${e}] State transition: ${o} \u2192 ${s}`,n?{...n}:"")})(e,t,r,n)},isActive:e=>(e=>{if(!e)return!1;const t=String(e).toUpperCase();return t===c.WidgetState.Opened||t===c.WidgetState.Active})(e),isInactive:e=>(e=>{if(!e)return!0;const t=String(e).toUpperCase();return t===c.WidgetState.Closed||t===c.WidgetState.Hidden})(e)});var A=r(3890),I=r(2242);const _=e=>{const t=e.id;if("string"==typeof t&&t)return t;const r=e.widgetId;return"string"==typeof r&&r?r:""},C=e=>{if(!e)return"";try{return JSON.stringify(e)}catch{return""}}},3417:(e,t,r)=>{"use strict";r.d(t,{$W:()=>i.$W,AR:()=>o.AR,BY:()=>o.BY,Bd:()=>o.Bd,By:()=>n.By,Dd:()=>s.Dd,Do:()=>o.Do,EW:()=>o.EW,FS:()=>o.FS,GR:()=>o.GR,In:()=>o.In,KF:()=>o.KF,KG:()=>o.KG,LZ:()=>o.LZ,MN:()=>i.MN,MU:()=>n.MU,OX:()=>n.OX,PJ:()=>o.PJ,PS:()=>o.PS,QB:()=>o.QB,QC:()=>o.QC,QL:()=>n.QL,Qg:()=>s.Qg,R0:()=>o.R0,RF:()=>o.RF,ST:()=>o.ST,T5:()=>o.T5,VQ:()=>s.VQ,VZ:()=>o.VZ,Ve:()=>o.Ve,Vw:()=>n.Vw,WC:()=>o.WC,Wp:()=>o.Wp,Xw:()=>o.Xw,ZW:()=>n.ZW,_$:()=>o._$,_A:()=>o._A,a0:()=>o.a0,a9:()=>o.a9,aE:()=>s.aE,bD:()=>o.bD,d:()=>o.d,d8:()=>o.d8,h6:()=>o.h6,hL:()=>n.hL,jF:()=>o.jF,jL:()=>o.jL,lY:()=>o.lY,lh:()=>o.lh,m2:()=>o.m2,nE:()=>n.nE,nc:()=>o.nc,np:()=>o.np,nu:()=>o.nu,oh:()=>o.oh,qT:()=>o.qT,qc:()=>o.qc,uV:()=>o.uV,vA:()=>o.vA,vH:()=>o.vH,vN:()=>o.vN,vp:()=>o.vp,wF:()=>o.wF,wq:()=>o.wq,xA:()=>o.xA,xH:()=>o.xH,ym:()=>n.ym,zo:()=>o.zo});var n=r(6055),o=r(3096),s=r(5132),i=r(3128)},3624:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},3744:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},3890:(e,t,r)=>{"use strict";r.d(t,{$d:()=>w,B9:()=>E,CL:()=>s,H9:()=>a,Ko:()=>b,Rv:()=>T,Xz:()=>O,ZF:()=>i,_Y:()=>h,dC:()=>m,e6:()=>S,id:()=>v,pZ:()=>u,rB:()=>c,sW:()=>p,ut:()=>d});var n=r(3417),o=r(3314);const s=e=>{const t=(0,o.BvY)(e);if(!t||t.length>n.m2)return!1;let r;try{r=new URL(t)}catch{return!1}if(r.username||r.password||"https:"!==r.protocol)return!1;const s=r.hostname.toLowerCase();if(!s||(e=>{const t=e.toLowerCase();return n.KF.some((e=>t===e||t.endsWith(e)))})(s))return!1;const i=(e=>{const t=e.split(".");if(4!==t.length)return null;const r=t.map((e=>{if(!/^\d+$/.test(e))return NaN;const t=Number(e);return t>=n.VZ.IPV4_OCTET_MIN&&t<=n.VZ.IPV4_OCTET_MAX?t:NaN}));return r.every(Number.isInteger)?Object.freeze(r):null})(s);if(i&&(a=i,n.FS.some((({start:e,end:t})=>a.every(((r,n)=>r>=e[n]&&r<=t[n]))))))return!1;var a;if(s.includes(":")&&(e=>{const t=e.toLowerCase();return"::1"===t||t.startsWith("::1:")||"0:0:0:0:0:0:0:1"===t||t.startsWith("fc")||t.startsWith("fd")||/^fe[89ab][0-9a-f]/i.test(t)})(s))return!1;if(/\.[^/]+$/.test(r.pathname)){const e=`${r.pathname}${r.search}`;if(!n.vH.test(e))return!1}return!0},i=(e,t)=>{if(!e||!t?.length)return;return t.every((e=>(e=>{if((0,o.BfI)(e))return!0;if("string"!=typeof e)return!1;const t=e.trim();if(!t)return!1;const r=Number(t);return Number.isFinite(r)&&String(r)===t})(e.value)))?"number":void 0},a=e=>{if(Array.isArray(e))return e.map((e=>"string"==typeof e?e:String(e)));if("string"==typeof e)try{const t=JSON.parse(e);return(0,o.eCr)(t).map(String).filter(Boolean)}catch{return e?[e]:[]}return[]},l=e=>Boolean(e?.allowRemoteDataset),c=(e,t)=>{if(!l(t))return!1;if(!t?.allowRemoteUrlDataset)return!1;const r=(0,o.NnH)(e);return!!r&&s(r)},u=(e,t)=>!!l(e)&&(!!t&&("undefined"!=typeof Blob&&t instanceof Blob||(0,o.E$q)(t))),d=(e,t,r)=>{switch(e){case"integer":return(0,o.IAu)(r)?null:`${t}:integer`;case"float":return(0,o.BfI)(r)||(0,o.P3$)(r)?null:`${t}:number`;default:return null}},p=(e,t,r,n)=>{if(!r)return null;const o=e=>"number"==typeof e&&Number.isFinite(e)||"string"==typeof e?e:"boolean"==typeof e?e?"true":"false":JSON.stringify(e??null);if(n){if((Array.isArray(t)?t:[t]).some((e=>!r.has(o(e)))))return`${e}:choice`}else if(!r.has(o(t)))return`${e}:choice`;return null},f=e=>{const t=(0,o.yCG)(e||"");if(!t)return"";t.search="",t.hash="",t.username="",t.password="";const r="/"===t.pathname?"":t.pathname.replace(/\/$/,"");return`${t.origin}${r}`};function h(e,t){const r=(0,o.NnH)(e);if(!r)return{ok:!1,errorKey:"invalid_url"};const n=m(r,t);if(!n.ok){const e="reason"in n?n.reason:void 0;return{ok:!1,errorKey:g(e)}}return{ok:!0,normalized:f(r)||r}}function m(e,t){const r=(0,o.BvY)(e);if(!r)return{ok:!1,reason:"invalid_url"};try{const e=new URL(r),n=e.protocol.toLowerCase();if("http:"!==n&&"https:"!==n)return{ok:!1,reason:"invalid_url"};if(t?.requireHttps&&"https:"!==n)return{ok:!1,reason:"require_https"};if(e.username||e.password)return{ok:!1,reason:"invalid_url"};if(e.search||e.hash)return{ok:!1,reason:"no_query_or_hash"};if(e.hostname.endsWith("."))return{ok:!1,reason:"invalid_url"};if(t?.strict){const t=e.hostname||"";if(!t.includes(".")||t.length<4)return{ok:!1,reason:"invalid_url"}}return{ok:!0}}catch{return{ok:!1,reason:"invalid_url"}}}const g=e=>e&&n.zo[e]||"invalid_url",y=/^no[-_]?reply@/i,E=e=>!("string"!=typeof e||!e)&&(!y.test(e)&&n.Xw.test(e)),v=e=>{const t=(0,o.NnH)(e);return t&&E(t)?t:void 0},b=e=>{if(!e||"object"!=typeof e)return;const t=e;for(const e of n.bD){const r=t[e];if((0,n.Bd)(r))return r}const r=t.details;if(r&&"object"==typeof r){const e=r,t=e.httpStatus??e.status;if((0,n.Bd)(t))return t}const s=(0,o.PEb)(e);if("string"==typeof s){const e=/status:\s*(\d{3})/i.exec(s);if(e){const t=parseInt(e[1],10);if((0,n.Bd)(t))return t}}},w=e=>{if(e&&"object"==typeof e){const t=e;if("boolean"==typeof t.isRetryable)return t.isRetryable}const t=b(e);return(0,n.PS)(t)},S=e=>{if(!e.serverUrl||!e.token||!e.repository)throw new Error("Missing required configuration")},R=e=>e?n.LZ.filter((t=>!e[t]?.trim())):[...n.LZ];const T=(e,t,r)=>{const n=R(e),o=r?.mapConfigured??!0;return n.length>0||!o?{isValid:!1,canProceed:!1,requiresSettings:!0}:{isValid:!0,canProceed:!0,requiresSettings:!1}},O=e=>{const t=e.trim();return/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(t)}},3930:(e,t,r)=>{"use strict";r.d(t,{I:()=>C});var n=r(9658),o=r(6261),s=r(9757),i=r(6500),a=r(4658),l=r(4880),c=r(2775),u=class extends i.Q{constructor(e,t){super(),this.options=t,this.#m=e,this.#g=null,this.#y=(0,a.T)(),this.bindMethods(),this.setOptions(t)}#m;#E=void 0;#v=void 0;#b=void 0;#w;#S;#y;#g;#R;#T;#O;#A;#I;#_;#C=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#E.addObserver(this),d(this.#E,this.options)?this.#k():this.updateResult(),this.#L())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return p(this.#E,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return p(this.#E,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#M(),this.#N(),this.#E.removeObserver(this)}setOptions(e){const t=this.options,r=this.#E;if(this.options=this.#m.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.Eh)(this.options.enabled,this.#E))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#E.setOptions(this.options),t._defaulted&&!(0,l.f8)(this.options,t)&&this.#m.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#E,observer:this});const n=this.hasListeners();n&&f(this.#E,r,this.options,t)&&this.#k(),this.updateResult(),!n||this.#E===r&&(0,l.Eh)(this.options.enabled,this.#E)===(0,l.Eh)(t.enabled,this.#E)&&(0,l.d2)(this.options.staleTime,this.#E)===(0,l.d2)(t.staleTime,this.#E)||this.#D();const o=this.#P();!n||this.#E===r&&(0,l.Eh)(this.options.enabled,this.#E)===(0,l.Eh)(t.enabled,this.#E)&&o===this.#_||this.#F(o)}getOptimisticResult(e){const t=this.#m.getQueryCache().build(this.#m,e),r=this.createResult(t,e);return function(e,t){if(!(0,l.f8)(e.getCurrentResult(),t))return!0;return!1}(this,r)&&(this.#b=r,this.#S=this.options,this.#w=this.#E.state),r}getCurrentResult(){return this.#b}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"!==r||this.options.experimental_prefetchInRender||"pending"!==this.#y.status||this.#y.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(e,r))})}trackProp(e){this.#C.add(e)}getCurrentQuery(){return this.#E}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#m.defaultQueryOptions(e),r=this.#m.getQueryCache().build(this.#m,t);return r.fetch().then((()=>this.createResult(r,t)))}fetch(e){return this.#k({...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),this.#b)))}#k(e){this.#x();let t=this.#E.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.lQ)),t}#D(){this.#M();const e=(0,l.d2)(this.options.staleTime,this.#E);if(l.S$||this.#b.isStale||!(0,l.gn)(e))return;const t=(0,l.j3)(this.#b.dataUpdatedAt,e)+1;this.#A=c.zs.setTimeout((()=>{this.#b.isStale||this.updateResult()}),t)}#P(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#E):this.options.refetchInterval)??!1}#F(e){this.#N(),this.#_=e,!l.S$&&!1!==(0,l.Eh)(this.options.enabled,this.#E)&&(0,l.gn)(this.#_)&&0!==this.#_&&(this.#I=c.zs.setInterval((()=>{(this.options.refetchIntervalInBackground||n.m.isFocused())&&this.#k()}),this.#_))}#L(){this.#D(),this.#F(this.#P())}#M(){this.#A&&(c.zs.clearTimeout(this.#A),this.#A=void 0)}#N(){this.#I&&(c.zs.clearInterval(this.#I),this.#I=void 0)}createResult(e,t){const r=this.#E,n=this.options,o=this.#b,i=this.#w,c=this.#S,u=e!==r?e.state:this.#v,{state:p}=e;let m,g={...p},y=!1;if(t._optimisticResults){const o=this.hasListeners(),i=!o&&d(e,t),a=o&&f(e,r,t,n);(i||a)&&(g={...g,...(0,s.k)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(g.fetchStatus="idle")}let{error:E,errorUpdatedAt:v,status:b}=g;m=g.data;let w=!1;if(void 0!==t.placeholderData&&void 0===m&&"pending"===b){let e;o?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(e=o.data,w=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#O?.state.data,this.#O):t.placeholderData,void 0!==e&&(b="success",m=(0,l.pl)(o?.data,e,t),y=!0)}if(t.select&&void 0!==m&&!w)if(o&&m===i?.data&&t.select===this.#R)m=this.#T;else try{this.#R=t.select,m=t.select(m),m=(0,l.pl)(o?.data,m,t),this.#T=m,this.#g=null}catch(e){this.#g=e}this.#g&&(E=this.#g,m=this.#T,v=Date.now(),b="error");const S="fetching"===g.fetchStatus,R="pending"===b,T="error"===b,O=R&&S,A=void 0!==m,I={status:b,fetchStatus:g.fetchStatus,isPending:R,isSuccess:"success"===b,isError:T,isInitialLoading:O,isLoading:O,data:m,dataUpdatedAt:g.dataUpdatedAt,error:E,errorUpdatedAt:v,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>u.dataUpdateCount||g.errorUpdateCount>u.errorUpdateCount,isFetching:S,isRefetching:S&&!R,isLoadingError:T&&!A,isPaused:"paused"===g.fetchStatus,isPlaceholderData:y,isRefetchError:T&&A,isStale:h(e,t),refetch:this.refetch,promise:this.#y,isEnabled:!1!==(0,l.Eh)(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===I.status?e.reject(I.error):void 0!==I.data&&e.resolve(I.data)},n=()=>{const e=this.#y=I.promise=(0,a.T)();t(e)},o=this.#y;switch(o.status){case"pending":e.queryHash===r.queryHash&&t(o);break;case"fulfilled":"error"!==I.status&&I.data===o.value||n();break;case"rejected":"error"===I.status&&I.error===o.reason||n()}}return I}updateResult(){const e=this.#b,t=this.createResult(this.#E,this.options);if(this.#w=this.#E.state,this.#S=this.options,void 0!==this.#w.data&&(this.#O=this.#E),(0,l.f8)(t,e))return;this.#b=t;this.#j({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#C.size)return!0;const n=new Set(r??this.#C);return this.options.throwOnError&&n.add("error"),Object.keys(this.#b).some((t=>{const r=t;return this.#b[r]!==e[r]&&n.has(r)}))})()})}#x(){const e=this.#m.getQueryCache().build(this.#m,this.options);if(e===this.#E)return;const t=this.#E;this.#E=e,this.#v=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#L()}#j(e){o.jG.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e(this.#b)})),this.#m.getQueryCache().notify({query:this.#E,type:"observerResultsUpdated"})}))}};function d(e,t){return function(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&p(e,t,t.refetchOnMount)}function p(e,t,r){if(!1!==(0,l.Eh)(t.enabled,e)&&"static"!==(0,l.d2)(t.staleTime,e)){const n="function"==typeof r?r(e):r;return"always"===n||!1!==n&&h(e,t)}return!1}function f(e,t,r,n){return(e!==t||!1===(0,l.Eh)(n.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&h(e,r)}function h(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&e.isStaleByTime((0,l.d2)(t.staleTime,e))}var m=r(8972),g=r(7665);r(4848);function y(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var E=m.createContext(y()),v=()=>m.useContext(E),b=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},w=e=>{m.useEffect((()=>{e.clearReset()}),[e])},S=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:o})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(o&&void 0===e.data||(0,l.GU)(r,[e.error,n])),R=m.createContext(!1),T=()=>m.useContext(R),O=(R.Provider,e=>{if(e.suspense){const t=1e3,r=e=>"static"===e?e:Math.max(e??t,t),n=e.staleTime;e.staleTime="function"==typeof n?(...e)=>r(n(...e)):r(n),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}}),A=(e,t)=>e.isLoading&&e.isFetching&&!t,I=(e,t)=>e?.suspense&&t.isPending,_=(e,t,r)=>t.fetchOptimistic(e).catch((()=>{r.clearReset()}));function C(e,t){return function(e,t,r){const n=T(),s=v(),i=(0,g.jE)(r),a=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(a),a._optimisticResults=n?"isRestoring":"optimistic",O(a),b(a,s),w(s);const c=!i.getQueryCache().get(a.queryHash),[u]=m.useState((()=>new t(i,a))),d=u.getOptimisticResult(a),p=!n&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback((e=>{const t=p?u.subscribe(o.jG.batchCalls(e)):l.lQ;return u.updateResult(),t}),[u,p]),(()=>u.getCurrentResult()),(()=>u.getCurrentResult())),m.useEffect((()=>{u.setOptions(a)}),[a,u]),I(a,d))throw _(a,u,s);if(S({result:d,errorResetBoundary:s,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw d.error;if(i.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!l.S$&&A(d,n)){const e=c?_(a,u,s):i.getQueryCache().get(a.queryHash)?.promise;e?.catch(l.lQ).finally((()=>{u.updateResult()}))}return a.notifyOnChangeProps?d:u.trackResult(d)}(e,u,t)}},4321:e=>{"use strict";e.exports=a},4337:e=>{"use strict";e.exports=i},4658:(e,t,r)=>{"use strict";function n(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));function n(e){Object.assign(r,e),delete r.resolve,delete r.reject}return r.status="pending",r.catch((()=>{})),r.resolve=t=>{n({status:"fulfilled",value:t}),e(t)},r.reject=e=>{n({status:"rejected",reason:e}),t(e)},r}r.d(t,{T:()=>n})},4712:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1.333 0h4c.737 0 1.334.597 1.334 1.333v1.334h8C15.403 2.667 16 3.264 16 4v10.667c0 .736-.597 1.333-1.333 1.333H1.333A1.333 1.333 0 0 1 0 14.667V1.333C0 .597.597 0 1.333 0m0 7.333v7.334h13.334V7.333zm0-1.333h13.334V4H5.334V1.335h-4z" clip-rule="evenodd"></path></svg>'},4848:(e,t,r)=>{"use strict";e.exports=r(1020)},4880:(e,t,r)=>{"use strict";r.d(t,{Cp:()=>m,EN:()=>h,Eh:()=>u,F$:()=>f,GU:()=>_,MK:()=>d,S$:()=>o,ZM:()=>I,ZZ:()=>O,Zw:()=>i,d2:()=>c,f8:()=>E,gn:()=>a,hT:()=>A,j3:()=>l,lQ:()=>s,nJ:()=>p,pl:()=>R,y9:()=>T,yy:()=>S});var n=r(2775),o="undefined"==typeof window||"Deno"in globalThis;function s(){}function i(e,t){return"function"==typeof e?e(t):e}function a(e){return"number"==typeof e&&e>=0&&e!==1/0}function l(e,t){return Math.max(e+(t||0)-Date.now(),0)}function c(e,t){return"function"==typeof e?e(t):e}function u(e,t){return"function"==typeof e?e(t):e}function d(e,t){const{type:r="all",exact:n,fetchStatus:o,predicate:s,queryKey:i,stale:a}=e;if(i)if(n){if(t.queryHash!==f(i,t.options))return!1}else if(!m(t.queryKey,i))return!1;if("all"!==r){const e=t.isActive();if("active"===r&&!e)return!1;if("inactive"===r&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&((!o||o===t.state.fetchStatus)&&!(s&&!s(t)))}function p(e,t){const{exact:r,status:n,predicate:o,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(h(t.options.mutationKey)!==h(s))return!1}else if(!m(t.options.mutationKey,s))return!1}return(!n||t.state.status===n)&&!(o&&!o(t))}function f(e,t){return(t?.queryKeyHashFn||h)(e)}function h(e){return JSON.stringify(e,((e,t)=>b(t)?Object.keys(t).sort().reduce(((e,r)=>(e[r]=t[r],e)),{}):t))}function m(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every((r=>m(e[r],t[r]))))}var g=Object.prototype.hasOwnProperty;function y(e,t){if(e===t)return e;const r=v(e)&&v(t);if(!(r||b(e)&&b(t)))return t;const n=(r?e:Object.keys(e)).length,o=r?t:Object.keys(t),s=o.length,i=r?new Array(s):{};let a=0;for(let l=0;l<s;l++){const s=r?l:o[l],c=e[s],u=t[s];if(c===u){i[s]=c,(r?l<n:g.call(e,s))&&a++;continue}if(null===c||null===u||"object"!=typeof c||"object"!=typeof u){i[s]=u;continue}const d=y(c,u);i[s]=d,d===c&&a++}return n===s&&a===n?e:i}function E(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function v(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function b(e){if(!w(e))return!1;const t=e.constructor;if(void 0===t)return!0;const r=t.prototype;return!!w(r)&&(!!r.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function w(e){return"[object Object]"===Object.prototype.toString.call(e)}function S(e){return new Promise((t=>{n.zs.setTimeout(t,e)}))}function R(e,t,r){return"function"==typeof r.structuralSharing?r.structuralSharing(e,t):!1!==r.structuralSharing?y(e,t):t}function T(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function O(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var A=Symbol();function I(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==A?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function _(e,t){return"function"==typeof e?e(...t):!!e}},4945:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M28 6h2v20h-2zM17 6l-1.43 1.393L23.15 15H2v2h21.15l-7.58 7.573L17 26l10-10z"></path></svg>'},4986:(e,t,r)=>{"use strict";r.d(t,{$X:()=>P,$r:()=>O,B_:()=>B,Bf:()=>E,Bv:()=>f,Cq:()=>C,Dr:()=>R,E:()=>j,E$:()=>S,Gt:()=>V,He:()=>U,IA:()=>b,IT:()=>N,Im:()=>u,Me:()=>T,N7:()=>F,Nn:()=>m,P3:()=>w,P6:()=>h,QK:()=>p,Qd:()=>y,Td:()=>G,W1:()=>L,Xl:()=>_,YH:()=>d,eC:()=>A,eF:()=>v,hU:()=>k,ps:()=>D,sL:()=>x,uA:()=>W,vq:()=>M,w$:()=>a,wK:()=>g});const n=(e,t)=>{if("string"==typeof e){const r=e.trim();return r||t?.allowEmpty?r:t?.nullable?null:void 0}return t?.allowNumeric&&"number"==typeof e&&Number.isFinite(e)?String(e):t?.nullable?null:void 0},o=e=>"string"==typeof e,s=e=>"number"==typeof e,i=e=>"boolean"==typeof e,a=e=>"string"==typeof e||"number"==typeof e,l=e=>null===e,c=e=>null==e,u=e=>null==e||""===e||(Array.isArray(e)?0===e.length:!!o(e)&&0===e.trim().length),d=e=>o(e)&&e.trim().length>0,p=e=>o(e)?e.trim().toLowerCase():"",f=e=>m(e)??"",h=(e,t="")=>{const r=m(e);return r&&r.length>0?r:t},m=e=>n(e,{allowNumeric:!1}),g=e=>n(e,{allowNumeric:!0}),y=e=>"object"==typeof e&&!l(e)&&!Array.isArray(e),E=e=>s(e)&&Number.isFinite(e),v=e=>E(e)&&e>=0,b=e=>E(e)&&Number.isInteger(e),w=e=>{if(!o(e))return!1;const t=e.trim();if(!t)return!1;const r=Number(t);return Number.isFinite(r)},S=e=>e instanceof File,R=e=>{if(i(e))return e;if(s(e)){if(!Number.isFinite(e))return;return 0!==e}const t=n(e,{allowNumeric:!1});if(!t)return;const r=t.toLowerCase();return!!["true","1","yes","y","on"].includes(r)||!["false","0","no","n","off"].includes(r)&&void 0},T=e=>{if(E(e))return e;const t=n(e,{allowNumeric:!1});if(!t)return;const r=Number(t);return Number.isFinite(r)?r:void 0},O=e=>Array.isArray(e)?e:null==e?[]:[e],A=e=>Array.isArray(e)?e:[],I=(e,t,r,n)=>{if(!e)return n;for(const n of t){const t=r(e[n]);if(void 0!==t)return t}return n},_=(e,t)=>I(e,t,g),C=(e,t,r=!1)=>I(e,t,R,r)??r,k=(e,t)=>I(e,t,T),L=e=>{const t={};for(const r of e)if(y(r))for(const[e,n]of Object.entries(r))null==n||e in t||(t[e]=n);return t},M=e=>{if(Array.isArray(e))return e;if(y(e))for(const t of["data","items","options"]){const r=e[t];if(Array.isArray(r))return r}},N=e=>{if(!y(e))return;const t=Object.entries(e).filter((([,e])=>void 0!==e));return t.length?Object.fromEntries(t):void 0},x=e=>E(e)||o(e)?e:i(e)?e?"true":"false":JSON.stringify(e??null),D=e=>{if(!c(e)){if(o(e)){const t=e.trim();if(!t)return;return x(t)}return s(e)||i(e)?x(e):void 0}},P=(e,t)=>{const r=D(e);if(void 0===r)return!1;const n=D(t);return void 0!==n&&r===n},F=e=>{if(o(e))return e;if(s(e)||i(e))return String(e);if(void 0===e)return"undefined";if(l(e))return"null";if("object"==typeof e)try{return JSON.stringify(e)}catch{return Object.prototype.toString.call(e)}return Object.prototype.toString.call(e)},j=(e,t)=>(m(e)??"").replace(/[^A-Za-z0-9_\-]/g,"").trim()||t,U=(e,t)=>c(e)?t?[]:"":t?Array.isArray(e)?e:[e]:o(e)||s(e)||i(e)?e:"",V=(e,t)=>{if(!e||(o(r=e)||"function"!=typeof r?.[Symbol.iterator]))return[];var r;const n=[];let s=0;for(const r of e){const e=t(r,s++);null!=e&&n.push(e)}return n},W=e=>e?.length?new Set(e.map((e=>x(e.value)))):null,B=(e,t)=>({enter:e("phEnter",{field:t}),select:e("phSelect",{field:t})}),q=Object.freeze({email:"phEmail",phone:"phPhone",search:"phSearch"}),G=(e,t,r,n)=>e?.placeholder?e.placeholder:n?r(q[n]):t.enter},5009:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEBUG_STYLES:()=>y,conditionalLog:()=>f,conditionalTable:()=>h,conditionalWarn:()=>m,criticalError:()=>g,getLoggingEnabled:()=>p,setLoggingEnabled:()=>d,setupFmeDebugTools:()=>k,updateFmeDebugTools:()=>L});var n=r(9244),o=r(3417),s=r(5880),i=r(2238),a=r(1658),l=r(1181),c=r(930);let u=!1;const d=e=>{u=e},p=()=>u,f=(...e)=>{u&&console.log(...e)},h=(e,t)=>{u&&console.table(e,t)},m=(...e)=>{u&&console.warn(...e)},g=(...e)=>{console.error(...e)},y={success:"color: #28a745; font-weight: bold",info:"color: #007bff; font-weight: bold",warn:"color: #ffc107; font-weight: bold",error:"color: #dc3545; font-weight: bold",action:"color: #0078d4; font-weight: bold"},E=(e,t="info",...r)=>{u&&console.log(`%c[FME Debug] ${e}`,y[t],...r)},v=()=>"undefined"==typeof window?null:window.__FME_DEBUG__??null,b=e=>e?{serverUrl:e.fmeServerUrl||"[NONE]",repository:e.repository||"[NONE]",token:e.fmeServerToken?(0,c.gg)(e.fmeServerToken):"[NONE]",timeout:e.requestTimeout,largeArea:e.largeArea,maxArea:e.maxArea}:null,w=e=>({method:e.method??"[UNKNOWN]",path:e.path??"[UNKNOWN]",status:e.status??"?",duration:(e.durationMs??0)+"ms",ok:void 0===e.ok?"?":e.ok?"\u2713":"\u2717",time:new Date(e.timestamp).toLocaleTimeString()}),S=e=>{try{return e.__FME_DEBUG__??null}catch{return null}},R=(e,t)=>{t.forEach((t=>{((e,t)=>{try{Object.defineProperty(e,"__FME_DEBUG__",{configurable:!0,enumerable:!1,writable:!0,value:t})}catch{try{e.__FME_DEBUG__=t}catch{}}})(t,e)}))},T=e=>{for(const t of e){const e=S(t);if(e)return e}return null},O=e=>(t=o.By.NETWORK,r="TEST_ERROR")=>{const n=v();n&&(n.dispatch(n.actions.setError("general",{type:t,code:r,message:"Test error message",severity:o.MU.ERROR,recoverable:!0,timestampMs:Date.now()},e)),E("Test error dispatched","warn"))},A=()=>e=>{const t=v();if(!t)return;const r=((e,t)=>{let r=[...e];return t?.failed&&(r=r.filter((e=>void 0!==e.ok&&!e.ok))),t?.slow&&(r=r.filter((e=>e.durationMs>o.ST.SLOW_REQUEST_THRESHOLD))),r})(t.getNetworkHistory?.()??[],e);0!==r.length?(E(`Network History (${r.length} requests):`,"warn"),h(r.map(w))):E("No network requests found","warn")},I=()=>()=>{const e=v();if(!e)return"";const t=e.getState?.(),r=e.getConfig?.(),n=e.getNetworkHistory?.()??[],s=e.getQueryCache?.()??[],i=b(r),a=(e=>e?{viewMode:e.viewMode,drawingTool:e.drawingTool,hasGeometry:!!e.geometryJson,drawnArea:e.drawnArea,selectedWorkspace:e.selectedWorkspace,hasError:!!(e.errors&&Object.keys(e.errors).length>0)}:null)(t),l=(e=>{const t=e.filter((e=>void 0!==e.ok&&!e.ok)),r=e.filter((e=>e.durationMs>o.ST.SLOW_REQUEST_THRESHOLD)),n=e.length>0?Math.round(e.reduce(((e,t)=>e+t.durationMs),0)/e.length):0;return{total:e.length,failed:t.length,avgDurationMs:n,slowRequests:r.length}})(n),c={timestamp:(new Date).toISOString(),widgetId:e.widgetId,config:i,state:a,networkSummary:l,queryCacheSize:s.length,recentRequests:n.slice(-10).map((e=>({method:e.method,path:e.path,status:e.status,ok:e.ok,durationMs:e.durationMs,time:new Date(e.timestamp).toISOString()})))},u=JSON.stringify(c,null,2);return E("Debug Package:","success"),f(u),(e=>{const t=navigator.clipboard;t&&t.writeText?t.writeText(e).then((()=>{E("Copied to clipboard","success")}),(e=>{E("Could not copy to clipboard","error"),f("Clipboard error:",e)})):E("Clipboard API not available","warn")})(u),u},_=e=>{return{widgetId:e.widgetId,getConfig:()=>e.config,getState:()=>(e=>{const t=(0,n.getAppStore)().getState()["fme-state"];return t?.byId?.[e]??null})(e.widgetId),getQueryCache:()=>a.q.getQueryCache().getAll().map((e=>({queryKey:e.queryKey,state:e.state,queryHash:e.queryHash}))),getMutationCache:()=>a.q.getMutationCache().getAll().map((e=>({mutationId:e.mutationId,state:e.state}))),clearQueryCache:()=>{a.q.clear(),E("Query cache cleared","warn")},invalidateQueries:e=>{a.q.invalidateQueries(e),E("Queries invalidated","warn",e)},getAppState:()=>(0,n.getAppStore)().getState(),dispatch:e=>{const t=(0,n.getAppStore)();E("Dispatching action:","action",e),t.dispatch(e)},actions:s.fmeActions,getNetworkHistory:()=>(0,i.VM)(),clearNetworkHistory:()=>{(0,i.IH)(),E("Network history cleared","warn")},utils:{maskToken:e=>(0,c.gg)(e),formatArea:(e,t)=>(0,l.Jd)(e,{intl:{formatNumber:(e,t)=>e.toLocaleString(void 0,{minimumFractionDigits:t?.minimumFractionDigits??0,maximumFractionDigits:t?.maximumFractionDigits??2})}},t),safeLogParams:e=>e},helpers:{inspectState:()=>{const e=v();if(!e)return;const t=e.getState?.();t?(E("Widget State:","success"),h({viewMode:t.viewMode,drawingTool:t.drawingTool,hasGeometry:!!t.geometryJson,drawnArea:t.drawnArea,selectedWorkspace:t.selectedWorkspace})):E("No state found","error")},inspectQueries:()=>{const e=v();if(!e)return;const t=e.getQueryCache?.()??[];E("Query Cache:","info"),h(t.map((e=>({queryKey:JSON.stringify(e.queryKey),status:e.state.status,hasData:!!e.state.data}))))},resetToDrawing:(t=e.widgetId,()=>{const e=v();e&&(e.dispatch(e.actions.resetState(t)),E("Widget reset to drawing state","success"))}),testError:O(e.widgetId),inspectNetwork:A(),showFullState:()=>{const e=v();if(!e)return;const t=e.getState?.();t?(E("Full Widget State:","success"),f(t)):E("No state found","error")},showConfig:()=>{const e=v();if(!e)return;const t=e.getConfig?.(),r=b(t);r?(E("Widget Config:","success"),h(r)):E("No config found","error")},showTimeline:()=>{const e=v();if(!e)return;const t=e.getNetworkHistory?.()??[],r=e.getState?.();if(0===t.length)return void E("No timeline data","warn");E("Timeline:","info");const n=t.map((e=>{return{time:new Date(e.timestamp).toLocaleTimeString(),event:`${e.method} ${e.path}`,status:(t=e,`${void 0===t.ok?"?":t.ok?"\u2713":"\u2717"} ${t.status??(void 0===t.ok||t.ok?"":"error")}`),duration:e.durationMs+"ms"};var t}));h(n),r&&(f("Current State:"),f("  View Mode:",r.viewMode),f("  Has Geometry:",!!r.geometryJson),f("  Selected Workspace:",r.selectedWorkspace||"[NONE]"))},exportDebugInfo:I()}};var t},C=e=>{const t=(e=>{if("string"!=typeof e)return null;const t=e.trim();return t.length?t:null})(e.widgetId);if(!t||!e.config)return null;const r=(()=>{if("undefined"==typeof window)return[];const e=[],t=new Set,r=r=>{r&&!t.has(r)&&(t.add(r),e.push(r))};let n=window,s=0;const i=o.a0.MAX_WINDOW_HIERARCHY_ITERATIONS;for(;n&&s<i;){r(n);try{const e=n.parent;if(!e||e===n||t.has(e))break;n=e}catch{break}s++}try{r(window.opener)}catch{}return e})();return 0===r.length?null:{widgetId:t,config:e.config,targets:r}},k=e=>{const t=C(e);if(!t)return;const{widgetId:r,config:n,targets:o}=t,s=Boolean(T(o)),i=_({widgetId:r,config:n});R(i,o),s||(E("Global debug object available at window.__FME_DEBUG__","action"),E("Try: __FME_DEBUG__.getState() or __FME_DEBUG__.getConfig()","action"),E("Helpers: __FME_DEBUG__.helpers.inspectState() | inspectQueries() | inspectNetwork()","action"),E("Export: __FME_DEBUG__.helpers.exportDebugInfo() | showTimeline() | showConfig()","action"))},L=e=>{const t=C(e);if(!t)return;const{widgetId:r,config:n,targets:o}=t;if(!T(o))return;const s=_({widgetId:r,config:n});R(s,o)}},5132:(e,t,r)=>{"use strict";r.d(t,{Dd:()=>s,Qg:()=>i,VQ:()=>a,aE:()=>o});var n=r(6055);const o=(e,t,r)=>({kind:"loading",message:e,detail:t,messages:r}),s=(e,t)=>({kind:"empty",message:e,actions:t}),i=(e,t)=>({kind:"error",message:e,code:t?.code,actions:t?.actions,recoverable:t?.recoverable,detail:t?.detail});class a extends Error{constructor(e,t,r,o,s=n.MU.ERROR,i){super(e),this.name="FmeFlowApiError",this.code=t,this.httpStatus=r,this.status=r,this.retryable=Boolean(o),this.isRetryable=this.retryable,this.severity=s,this.details=i?Object.freeze({...i}):void 0}}},5160:(e,t,r)=>{"use strict";var n=r(8972);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useSyncExternalStore,i=n.useRef,a=n.useEffect,l=n.useMemo,c=n.useDebugValue},5502:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 4.429V15h14V1L6.833 7.857zM14 3v11H2V6.114l4.182 2.51a1.2 1.2 0 0 0 1.398-.118z" clip-rule="evenodd"></path></svg>'},5668:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"></path><path fill="#000" fill-rule="evenodd" d="m11.002 7.002-3 3-3-3v-4a2.893 2.893 0 0 1 3-3 2.893 2.893 0 0 1 3 3zm-3-6h-.038a1.893 1.893 0 0 0-1.963 1.962l.001.018v3.606l2 2 2-2V2.964A1.894 1.894 0 0 0 8.04 1z" clip-rule="evenodd"></path><path fill="#000" d="M4.072 1.908a10.4 10.4 0 0 1-1.939-.433L0 13.077c1.2.504 2.493.746 3.793.711A10.7 10.7 0 0 0 7 13.31v1.678H2v1h11v-1H8v-2a11.9 11.9 0 0 1 4.207-.8A6.62 6.62 0 0 1 16 13.277L13.867 1.674a8.2 8.2 0 0 0-2.236-.61 3.5 3.5 0 0 1 .336 1.066q.514.097 1.009.27l1.72 9.163a8.3 8.3 0 0 0-2.489-.376 12.8 12.8 0 0 0-4.526.852l-.604.204-.363.108a9.7 9.7 0 0 1-2.921.436 9.5 9.5 0 0 1-2.668-.363l1.81-9.697q.53.115 1.068.18v-.173a3.4 3.4 0 0 1 .069-.826"></path></svg>'},5880:(e,t,r)=>{"use strict";r.d(t,{areLoadingStatesEqual:()=>b,createFmeSelectors:()=>R,fmeActions:()=>m,initialFmeState:()=>g});var n=r(7390),o=r.n(n);function s(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var i=e=>Array.isArray(e)?e:[e];function a(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const r=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var l="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function c(e,t={}){let r={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:n}=t;let o,s=0;function i(){let t=r;const{length:i}=arguments;for(let e=0,r=i;e<r;e++){const r=arguments[e];if("function"==typeof r||"object"==typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);const n=e.get(r);void 0===n?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=n}else{let e=t.p;null===e&&(t.p=e=new Map);const n=e.get(r);void 0===n?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=n}}const a=t;let c;if(1===t.s)c=t.v;else if(c=e.apply(null,arguments),s++,n){const e=o?.deref?.()??o;null!=e&&n(e,c)&&(c=e,0!==s&&s--);o="object"==typeof c&&null!==c||"function"==typeof c?new l(c):c}return a.s=1,a.v=c,c}return i.clearCache=()=>{r={s:0,v:void 0,o:null,p:null},i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function u(e,...t){const r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,n=(...e)=>{let t,n=0,o=0,l={},u=e.pop();"object"==typeof u&&(l=u,u=e.pop()),s(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...l},{memoize:p,memoizeOptions:f=[],argsMemoize:h=c,argsMemoizeOptions:m=[],devModeChecks:g={}}=d,y=i(f),E=i(m),v=a(e),b=p((function(){return n++,u.apply(null,arguments)}),...y);const w=h((function(){o++;const e=function(e,t){const r=[],{length:n}=e;for(let o=0;o<n;o++)r.push(e[o].apply(null,t));return r}(v,arguments);return t=b.apply(null,e),t}),...E);return Object.assign(w,{resultFunc:u,memoizedResultFunc:b,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>t,recomputations:()=>n,resetRecomputations:()=>{n=0},memoize:p,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var d=u(c),p=Object.assign(((e,t=d)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const r=Object.keys(e);return t(r.map((t=>e[t])),((...e)=>e.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})))}),{withTypes:()=>p}),f=r(3417),h=r(3314);const m={setViewMode:(e,t)=>({type:f.ZW.SET_VIEW_MODE,viewMode:e,widgetId:t}),resetState:e=>({type:f.ZW.RESET_STATE,widgetId:e}),setGeometry:(e,t,r)=>({type:f.ZW.SET_GEOMETRY,geometryJson:v(e),drawnArea:t,widgetId:r}),setDrawingTool:(e,t)=>({type:f.ZW.SET_DRAWING_TOOL,drawingTool:e,widgetId:t}),completeDrawing:(e,t,r,n)=>({type:f.ZW.COMPLETE_DRAWING,geometryJson:v(e),drawnArea:t,nextViewMode:r,widgetId:n}),setOrderResult:(e,t)=>({type:f.ZW.SET_ORDER_RESULT,orderResult:e,widgetId:t}),setWorkspaceItems:(e,t)=>({type:f.ZW.SET_WORKSPACE_ITEMS,workspaceItems:e,widgetId:t}),setWorkspaceParameters:(e,t,r)=>({type:f.ZW.SET_WORKSPACE_PARAMETERS,workspaceParameters:e,workspaceName:t,widgetId:r}),setSelectedWorkspace:(e,t)=>({type:f.ZW.SET_SELECTED_WORKSPACE,workspaceName:e,widgetId:t}),setWorkspaceItem:(e,t)=>({type:f.ZW.SET_WORKSPACE_ITEM,workspaceItem:e,widgetId:t}),setError:(e,t,r)=>({type:f.ZW.SET_ERROR,scope:e,error:t,widgetId:r}),setErrors:(e,t)=>{const r={};for(const[t,n]of Object.entries(e))void 0!==n&&(r[t]=n);return{type:f.ZW.SET_ERRORS,errors:r,widgetId:t}},clearError:(e,t)=>({type:f.ZW.CLEAR_ERROR,scope:e,widgetId:t}),clearWorkspaceState:e=>({type:f.ZW.CLEAR_WORKSPACE_STATE,widgetId:e}),resetToDrawing:e=>({type:f.ZW.RESET_TO_DRAWING,widgetId:e}),completeStartup:e=>({type:f.ZW.COMPLETE_STARTUP,widgetId:e}),setLoadingFlag:(e,t,r)=>({type:f.ZW.SET_LOADING_FLAG,flag:e,value:t,widgetId:r}),applyWorkspaceData:(e,t)=>({type:f.ZW.APPLY_WORKSPACE_DATA,workspaceName:e.workspaceName,workspaceParameters:e.parameters,workspaceItem:e.item,widgetId:t}),removeWidgetState:e=>({type:f.ZW.REMOVE_WIDGET_STATE,widgetId:e})},g={viewMode:f.nE.STARTUP_VALIDATION,drawingTool:f.hL.POLYGON,geometryJson:null,drawnArea:0,orderResult:null,workspaceItems:[],selectedWorkspace:null,workspaceParameters:[],workspaceItem:null,loading:{workspaces:!1,parameters:!1,modules:!1,submission:!1,geometryValidation:!1},errors:{}},y=o().default??o(),E=e=>(0,h.NnH)(e)??null,v=e=>{if(!e)return null;if("object"!=typeof e)return null;const t=Reflect.get(e,"toJSON");if("function"!=typeof t)return null;try{return t.call(e)}catch{return null}};function b(e,t){return e.workspaces===t.workspaces&&e.parameters===t.parameters&&e.modules===t.modules&&e.submission===t.submission&&e.geometryValidation===t.geometryValidation}const w={[f.MU.ERROR]:3,[f.MU.WARNING]:2,[f.MU.INFO]:1},S={general:0,export:1,import:2};const R=e=>{const t=t=>((e,t)=>{const r=e,n=r?.["fme-state"]?.byId?.[t];return n??null})(t,e),r=e=>t(e)?.geometryJson??null,n=e=>t(e)?.drawnArea??g.drawnArea,o=e=>t(e)?.selectedWorkspace??g.selectedWorkspace,s=e=>t(e)?.workspaceParameters??g.workspaceParameters,i=e=>t(e)?.workspaceItem??g.workspaceItem,a=e=>t(e)?.errors??g.errors,l=e=>t(e)?.loading??g.loading,c=d([r,n],((e,t)=>Boolean(e)&&t>0)),u=d([a],(e=>(e=>{let t=null,r=-1,n=Number.POSITIVE_INFINITY;for(const[o,s]of Object.entries(e)){if(!s)continue;if(!(s.severity in w))continue;if(!(o in S))continue;const e=w[s.severity],i=S[o];(e>r||e===r&&i<n)&&(t={scope:o,details:s},r=e,n=i)}return t})(e))),p=d([r,n,o,s,i,a],((e,t,r,n,o,s)=>{const i=Boolean(e)&&Number.isFinite(t)&&t>0,a=Boolean(E(r)),l=n.length>0||null!==o,c=s?.general,u=!!c&&(w[c.severity]??0)>=w[f.MU.ERROR];return i&&a&&l&&!u})),h=d([l],(e=>e.workspaces||e.parameters||e.modules||e.submission));return{selectSlice:t,selectViewMode:e=>t(e)?.viewMode??g.viewMode,selectDrawingTool:e=>t(e)?.drawingTool??g.drawingTool,selectGeometryJson:r,selectDrawnArea:n,selectWorkspaceItems:e=>t(e)?.workspaceItems??g.workspaceItems,selectWorkspaceParameters:s,selectWorkspaceItem:i,selectSelectedWorkspace:o,selectOrderResult:e=>t(e)?.orderResult??g.orderResult,selectErrors:a,selectErrorByScope:e=>r=>t(r)?.errors?.[e]??null,selectLoading:l,selectLoadingFlag:e=>r=>t(r)?.loading?.[e]??g.loading[e],selectHasValidAoi:c,selectPrimaryError:u,selectCanExport:p,selectIsBusy:h}};y({byId:{}})},5938:e=>{"use strict";e.exports=l},6035:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});var n=r(6500),o=r(4880),s=new class extends n.Q{#U=!0;#V;#W;constructor(){super(),this.#W=e=>{if(!o.S$&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#V||this.setEventListener(this.#W)}onUnsubscribe(){this.hasListeners()||(this.#V?.(),this.#V=void 0)}setEventListener(e){this.#W=e,this.#V?.(),this.#V=e(this.setOnline.bind(this))}setOnline(e){this.#U!==e&&(this.#U=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#U}}},6055:(e,t,r)=>{"use strict";var n,o,s,i,a,l,c,u,d,p;r.d(t,{By:()=>a,MU:()=>i,OX:()=>l,QL:()=>u,Vw:()=>s,ZW:()=>p,hL:()=>o,nE:()=>n,ym:()=>c}),function(e){e.STARTUP_VALIDATION="startup-validation",e.INITIAL="initial",e.DRAWING="drawing",e.WORKSPACE_SELECTION="workspace-selection",e.EXPORT_FORM="export-form",e.EXPORT_OPTIONS="export-options",e.ORDER_RESULT="order-result"}(n||(n={})),function(e){e.POLYGON="polygon",e.RECTANGLE="rectangle"}(o||(o={})),function(e){e.TEXT="text",e.NUMBER="number",e.TEXTAREA="textarea",e.SELECT="select",e.MULTI_SELECT="multi-select",e.CHECKBOX="checkbox",e.PASSWORD="password",e.FILE="file",e.DATE_TIME="date-time",e.URL="url",e.SWITCH="switch",e.RADIO="radio",e.SLIDER="slider",e.NUMERIC_INPUT="numeric-input",e.TAG_INPUT="tag-input",e.COLOR="color",e.DATE="date",e.TIME="time",e.EMAIL="email",e.PHONE="phone",e.SEARCH="search",e.MESSAGE="message",e.TABLE="table",e.MONTH="month",e.WEEK="week",e.COORDSYS="coord-sys",e.ATTRIBUTE_NAME="attribute-name",e.ATTRIBUTE_LIST="attribute-list",e.DB_CONNECTION="db-connection",e.WEB_CONNECTION="web-connection",e.TEXT_OR_FILE="text-or-file",e.REPROJECTION_FILE="reprojection-file",e.SCRIPTED="scripted",e.GEOMETRY="geometry",e.HIDDEN="hidden"}(s||(s={})),function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(i||(i={})),function(e){e.VALIDATION="validation",e.CONFIG="config",e.NETWORK="network",e.MODULE="module",e.GEOMETRY="geometry"}(a||(a={})),function(e){e.IDLE="idle",e.PENDING="pending",e.OK="ok",e.FAIL="fail",e.SKIP="skip"}(l||(l={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(c||(c={})),function(e){e.text="text",e.number="number",e.checkbox="checkbox",e.dropdown="dropdown",e.listbox="listbox",e.tree="tree",e.password="password",e.datetime="datetime",e.message="message",e.group="group",e.file="file",e.color="color",e.range="range",e.TEXT="TEXT",e.INTEGER="INTEGER",e.FLOAT="FLOAT",e.BOOLEAN="BOOLEAN",e.CHECKBOX="CHECKBOX",e.CHOICE="CHOICE",e.LISTBOX="LISTBOX",e.LOOKUP_LISTBOX="LOOKUP_LISTBOX",e.LOOKUP_CHOICE="LOOKUP_CHOICE",e.TEXT_OR_FILE="TEXT_OR_FILE",e.TEXT_EDIT="TEXT_EDIT",e.PASSWORD="PASSWORD",e.FILENAME="FILENAME",e.FILENAME_MUSTEXIST="FILENAME_MUSTEXIST",e.DIRNAME="DIRNAME",e.DIRNAME_MUSTEXIST="DIRNAME_MUSTEXIST",e.DIRNAME_SRC="DIRNAME_SRC",e.COORDSYS="COORDSYS",e.STRING="STRING",e.URL="URL",e.LOOKUP_URL="LOOKUP_URL",e.LOOKUP_FILE="LOOKUP_FILE",e.DATE_TIME="DATE_TIME",e.DATETIME="DATETIME",e.DATE="DATE",e.TIME="TIME",e.MONTH="MONTH",e.WEEK="WEEK",e.COLOR="COLOR",e.COLOR_PICK="COLOR_PICK",e.RANGE_SLIDER="RANGE_SLIDER",e.GEOMETRY="GEOMETRY",e.MESSAGE="MESSAGE",e.ATTRIBUTE_NAME="ATTRIBUTE_NAME",e.ATTRIBUTE_LIST="ATTRIBUTE_LIST",e.DB_CONNECTION="DB_CONNECTION",e.WEB_CONNECTION="WEB_CONNECTION",e.REPROJECTION_FILE="REPROJECTION_FILE",e.SCRIPTED="SCRIPTED",e.NOVALUE="NOVALUE",e.GROUP="GROUP"}(u||(u={})),function(e){e.QUEUED="QUEUED",e.PULLED="PULLED",e.RUNNING="RUNNING",e.SUCCESS="SUCCESS",e.FME_FAILURE="FME_FAILURE",e.JOB_FAILURE="JOB_FAILURE",e.ABORTED="ABORTED"}(d||(d={})),function(e){e.SET_VIEW_MODE="fme/SET_VIEW_MODE",e.RESET_STATE="fme/RESET_STATE",e.SET_GEOMETRY="fme/SET_GEOMETRY",e.SET_DRAWING_TOOL="fme/SET_DRAWING_TOOL",e.COMPLETE_DRAWING="fme/COMPLETE_DRAWING",e.SET_ORDER_RESULT="fme/SET_ORDER_RESULT",e.SET_WORKSPACE_ITEMS="fme/SET_WORKSPACE_ITEMS",e.SET_WORKSPACE_PARAMETERS="fme/SET_WORKSPACE_PARAMETERS",e.SET_SELECTED_WORKSPACE="fme/SET_SELECTED_WORKSPACE",e.SET_WORKSPACE_ITEM="fme/SET_WORKSPACE_ITEM",e.SET_ERROR="fme/SET_ERROR",e.SET_ERRORS="fme/SET_ERRORS",e.CLEAR_WORKSPACE_STATE="fme/CLEAR_WORKSPACE_STATE",e.CLEAR_ERROR="fme/CLEAR_ERROR",e.RESET_TO_DRAWING="fme/RESET_TO_DRAWING",e.COMPLETE_STARTUP="fme/COMPLETE_STARTUP",e.REMOVE_WIDGET_STATE="fme/REMOVE_WIDGET_STATE",e.SET_LOADING_FLAG="fme/SET_LOADING_FLAG",e.APPLY_WORKSPACE_DATA="fme/APPLY_WORKSPACE_DATA"}(p||(p={}))},6158:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});var n=r(6261),o=r(1692),s=r(8904),i=class extends o.k{#m;#B;#s;#q;constructor(e){super(),this.#m=e.client,this.mutationId=e.mutationId,this.#s=e.mutationCache,this.#B=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#B.includes(e)||(this.#B.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#B=this.#B.filter((t=>t!==e)),this.scheduleGc(),this.#s.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#B.length||("pending"===this.state.status?this.scheduleGc():this.#s.remove(this))}continue(){return this.#q?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#G({type:"continue"})},r={client:this.#m,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#q=(0,s.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#G({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#G({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#s.canRun(this)});const n="pending"===this.state.status,o=!this.#q.canStart();try{if(n)t();else{this.#G({type:"pending",variables:e,isPaused:o}),await(this.#s.config.onMutate?.(e,this,r));const t=await(this.options.onMutate?.(e,r));t!==this.state.context&&this.#G({type:"pending",context:t,variables:e,isPaused:o})}const s=await this.#q.start();return await(this.#s.config.onSuccess?.(s,e,this.state.context,this,r)),await(this.options.onSuccess?.(s,e,this.state.context,r)),await(this.#s.config.onSettled?.(s,null,this.state.variables,this.state.context,this,r)),await(this.options.onSettled?.(s,null,e,this.state.context,r)),this.#G({type:"success",data:s}),s}catch(t){try{throw await(this.#s.config.onError?.(t,e,this.state.context,this,r)),await(this.options.onError?.(t,e,this.state.context,r)),await(this.#s.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,r)),await(this.options.onSettled?.(void 0,t,e,this.state.context,r)),t}finally{this.#G({type:"error",error:t})}}finally{this.#s.runNext(this)}}#G(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),n.jG.batch((()=>{this.#B.forEach((t=>{t.onMutationUpdate(e)})),this.#s.notify({mutation:this,type:"updated",action:e})}))}}},6261:(e,t,r)=>{"use strict";r.d(t,{jG:()=>o});var n=r(2775).Zq;var o=function(){let e=[],t=0,r=e=>{e()},o=e=>{e()},s=n;const i=n=>{t?e.push(n):s((()=>{r(n)}))};return{batch:n=>{let i;t++;try{i=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&s((()=>{o((()=>{t.forEach((e=>{r(e)}))}))}))})()}return i},batchCalls:e=>(...t)=>{i((()=>{e(...t)}))},schedule:i,setNotifyFunction:e=>{r=e},setBatchNotifyFunction:e=>{o=e},setScheduler:e=>{s=e}}}()},6278:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14M8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},6500:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}},6920:(e,t,r)=>{"use strict";r.d(t,{AR:()=>f,SB:()=>u,YD:()=>g,Yn:()=>h,bE:()=>p,dd:()=>l,is:()=>m,sI:()=>a,sq:()=>i,wc:()=>d,yo:()=>c});var n=r(3417),o=r(3890),s=r(4986);const i=e=>{const{__upload_file__:t,__remote_dataset_url__:r,opt_geturl:n,...o}=e,i=(0,s.Nn)(n),a={...o};i&&(a.opt_geturl=i);return{sanitizedFormData:(e=>{const t={};for(const[r,n]of e)t[r]=d(n);return t})(Object.entries(a)),uploadFile:t instanceof File?t:null,remoteUrl:(0,s.Nn)(r)??""}},a=({finalParams:e,uploadedPath:t,parameters:r,explicitTarget:o})=>{if(!t)return;if(o)return void(e[o]=t);const s=(e=>{if(e)for(const t of e){if(!t)continue;const e=String(t.type);if(n._A.includes(e)&&t.name)return t.name}})(r);s?e[s]=t:void 0===e.SourceDataset&&(e.SourceDataset=t)},l=(e,t)=>{if(!e)return;if(!Boolean(t?.allowRemoteDataset&&t?.allowRemoteUrlDataset))return void(void 0!==e.opt_geturl&&delete e.opt_geturl);const r=(0,s.Nn)(e.opt_geturl);r&&(0,o.CL)(r)?e.opt_geturl=r:void 0!==e.opt_geturl&&delete e.opt_geturl},c=e=>{if(!e?.uploadTargetParamName)return null;return(0,s.E)(e.uploadTargetParamName,"")||null},u=(e,t)=>{const r=(0,s.Nn)(e.name);return r||(t?t("lblUnnamedFile"):"unnamed-file")},d=e=>{if(!e||"object"!=typeof e||Array.isArray(e))return e;if(!(e=>"object"==typeof e&&null!==e&&!Array.isArray(e)&&"mode"in e)(e))return e;const t=e;if("file"===t.mode)return(e=>(0,s.E$)(e.file)?e.file:(0,s.Nn)(e.fileName)??(0,s.wK)(e.fileName??e.file)??"")(t);if("text"===t.mode){return(0,s.wK)(t.text)??""}return e},p=e=>{const t={};for(const r of e)r?.name&&"string"==typeof r.name&&(t[r.name]=r.defaultValue??"");return t},f=(e,t,r,n,o,s)=>!(!e||!t||"order-result"===r)&&("drawing"===r?Boolean(s&&s>0)||Boolean(o):n>0&&"initial"!==r),h=(e,t,r,n)=>{if(n)return!1;return("workspace-selection"===r||"export-options"===r)&&e},m=e=>{const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r},g=(e,t)=>(0,s.Gt)(e,(e=>{if("object"!=typeof e||null===e)return;const r=e;return(0,s.Nn)(r[t])}))},7389:(e,t,r)=>{"use strict";r.d(t,{J:()=>a,M:()=>i});let n=null,o=null;const s=(e,t)=>{(n?Promise.resolve(n):(o||(o=Promise.resolve().then(r.bind(r,5009)).then((e=>(n=e,e)))),o)).then((r=>{const n=e(r);"function"==typeof n&&n(...t)})).catch((()=>{}))},i=(...e)=>{s((e=>e.conditionalLog),e)},a=(...e)=>{s((e=>e.conditionalWarn),e)}},7390:(e,t,r)=>{var n;!function(){"use strict";var o=function e(t){var r,n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),o={use_static:!1};function s(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function i(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:r})}"object"!=typeof(r=t)||Array.isArray(r)||null===r||void 0!==t.use_static&&(o.use_static=Boolean(t.use_static));var a="__immutable_invariants_hold";function l(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,a)))}function c(e,t){return e===t||e!=e&&t!=t}function u(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var d=["setPrototypeOf"],p=(d.concat(["push","pop","sort","splice","shift","unshift","reverse"]),["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]));function f(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function h(e,t){return i(e,a,!0),e}function m(e,t){var r=e[t];i(e,t,(function(){return B(r.apply(e,arguments))}))}function g(e,t,r){var n=r&&r.deep;if(e in this&&(n&&this[e]!==t&&u(t)&&u(this[e])&&(t=B.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var o=R.call(this);return o[e]=B(t),v(o)}d.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]),f.prototype=new Error,f.prototype.constructor=Error;var y=B([]);function E(e,t,r){var n=e[0];if(1===e.length)return g.call(this,n,t,r);var o,s=e.slice(1),i=this[n];if("object"==typeof i&&null!==i)o=B.setIn(i,s,t);else{var a=s[0];o=""!==a&&isFinite(a)?E.call(y,s,t):N.call(M,s,t)}if(n in this&&i===o)return this;var l=R.call(this);return l[n]=o,v(l)}function v(e){for(var t in p){if(p.hasOwnProperty(t))m(e,p[t])}o.use_static||(i(e,"flatMap",w),i(e,"asObject",T),i(e,"asMutable",R),i(e,"set",g),i(e,"setIn",E),i(e,"update",D),i(e,"updateIn",F),i(e,"getIn",j));for(var r=0,n=e.length;r<n;r++)e[r]=B(e[r]);return h(e)}function b(){return new Date(this.getTime())}function w(e){if(0===arguments.length)return this;var t,r=[],n=this.length;for(t=0;t<n;t++){var o=e(this[t],t,this);Array.isArray(o)?r.push.apply(r,o):r.push(o)}return v(r)}function S(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,r){"number"==typeof e&&(r[t]=e.toString())})),e=function(e,r){return-1!==t.indexOf(r)}}var r=s(this);for(var n in this)this.hasOwnProperty(n)&&!1===e(this[n],n)&&(r[n]=this[n]);return W(r)}function R(e){var t,r,n=[];if(e&&e.deep)for(t=0,r=this.length;t<r;t++)n.push(O(this[t]));else for(t=0,r=this.length;t<r;t++)n.push(this[t]);return n}function T(e){"function"!=typeof e&&(e=function(e){return e});var t,r={},n=this.length;for(t=0;t<n;t++){var o=e(this[t],t,this),s=o[0],i=o[1];r[s]=i}return W(r)}function O(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,a)||e instanceof Date?e:B.asMutable(e,{deep:!0})}function A(e,t){for(var r in e)Object.getOwnPropertyDescriptor(e,r)&&(t[r]=e[r]);return t}function I(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var r,n,o=Array.isArray(e),i=t&&t.deep,a=t&&t.mode||"merge",l=t&&t.merger;function d(e,n,o){var a,d=B(n[o]),p=l&&l(e[o],d,t),f=e[o];void 0===r&&void 0===p&&e.hasOwnProperty(o)&&c(d,f)||(c(f,a=void 0!==p?p:i&&u(f)&&u(d)?B.merge(f,d,t):d)&&e.hasOwnProperty(o)||(void 0===r&&(r=A(e,s(e))),r[o]=a))}if(o)for(var p=0,f=e.length;p<f;p++){var h=e[p];for(n in h)h.hasOwnProperty(n)&&d(void 0!==r?r:this,h,n)}else{for(n in e)Object.getOwnPropertyDescriptor(e,n)&&d(this,e,n);"replace"===a&&function(e,t){for(var n in e)t.hasOwnProperty(n)||(void 0===r&&(r=A(e,s(e))),delete r[n])}(this,e)}return void 0===r?this:W(r)}function _(e,t){var r=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return B.merge(this,e,{deep:r,mode:"replace"})}var C,k,L,M=B({});function N(e,t,r){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var n=e[0];if(1===e.length)return x.call(this,n,t,r);var o,i=e.slice(1),a=this[n];if(o=this.hasOwnProperty(n)&&"object"==typeof a&&null!==a?B.setIn(a,i,t):N.call(M,i,t),this.hasOwnProperty(n)&&a===o)return this;var l=A(this,s(this));return l[n]=o,W(l)}function x(e,t,r){var n=r&&r.deep;if(this.hasOwnProperty(e)&&(n&&this[e]!==t&&u(t)&&u(this[e])&&(t=B.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var o=A(this,s(this));return o[e]=B(t),W(o)}function D(e,t){var r=Array.prototype.slice.call(arguments,2),n=this[e];return B.set(this,e,t.apply(n,[n].concat(r)))}function P(e,t){for(var r=0,n=t.length;null!=e&&r<n;r++)e=e[t[r]];return r&&r==n?e:void 0}function F(e,t){var r=Array.prototype.slice.call(arguments,2),n=P(this,e);return B.setIn(this,e,t.apply(n,[n].concat(r)))}function j(e,t){var r=P(this,e);return void 0===r?t:r}function U(e){var t,r=s(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(r[t]=O(this[t]));else for(t in this)this.hasOwnProperty(t)&&(r[t]=this[t]);return r}function V(){return{}}function W(e){return o.use_static||(i(e,"merge",I),i(e,"replace",_),i(e,"without",S),i(e,"asMutable",U),i(e,"set",x),i(e,"setIn",N),i(e,"update",D),i(e,"updateIn",F),i(e,"getIn",j)),h(e)}function B(e,t,r){if(l(e)||function(e){return"object"==typeof e&&null!==e&&(60103===e.$$typeof||e.$$typeof===n)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(B);if(Array.isArray(e))return v(e.slice());if(e instanceof Date)return s=new Date(e.getTime()),o.use_static||i(s,"asMutable",b),h(s);var s,a=t&&t.prototype,c=(a&&a!==Object.prototype?function(){return Object.create(a)}:V)();for(var u in e)Object.getOwnPropertyDescriptor(e,u)&&(c[u]=B(e[u],void 0,r));return W(c)}function q(e){return function(){var t=[].slice.call(arguments),r=t.shift();return e.apply(r,t)}}function G(e,t){return function(){var r=[].slice.call(arguments),n=r.shift();return Array.isArray(n)?t.apply(n,r):e.apply(n,r)}}return B.from=B,B.isImmutable=l,B.ImmutableError=f,B.merge=q(I),B.replace=q(_),B.without=q(S),B.asMutable=(C=U,k=R,L=b,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?k.apply(t,e):t instanceof Date?L.apply(t,e):C.apply(t,e)}),B.set=G(x,g),B.setIn=G(N,E),B.update=q(D),B.updateIn=q(F),B.getIn=q(j),B.flatMap=q(w),B.asObject=q(T),o.use_static||(B.static=e({use_static:!0})),Object.freeze(B),B}();void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},7413:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 1 8 1a7 7 0 0 1 0 14" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M11.53 5.47a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-2-2a.75.75 0 0 1 1.06-1.06L7 8.94l3.47-3.47a.75.75 0 0 1 1.06 0" clip-rule="evenodd"></path></svg>'},7665:(e,t,r)=>{"use strict";r.d(t,{Ht:()=>a,jE:()=>i});var n=r(8972),o=r(4848),s=n.createContext(void 0),i=e=>{const t=n.useContext(s);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},a=({client:e,children:t})=>(n.useEffect((()=>(e.mount(),()=>{e.unmount()})),[e]),(0,o.jsx)(s.Provider,{value:e,children:t}))},7711:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8M13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97"></path><path fill="#000" d="M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828z"></path></svg>'},8418:(e,t,r)=>{"use strict";r(5160)},8904:(e,t,r)=>{"use strict";r.d(t,{II:()=>u,cc:()=>c,v_:()=>l});var n=r(9658),o=r(6035),s=r(4658),i=r(4880);function a(e){return Math.min(1e3*2**e,3e4)}function l(e){return"online"!==(e??"online")||o.t.isOnline()}var c=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function u(e){let t,r=!1,u=0;const d=(0,s.T)(),p=()=>"pending"!==d.status,f=()=>n.m.isFocused()&&("always"===e.networkMode||o.t.isOnline())&&e.canRun(),h=()=>l(e.networkMode)&&e.canRun(),m=e=>{p()||(t?.(),d.resolve(e))},g=e=>{p()||(t?.(),d.reject(e))},y=()=>new Promise((r=>{t=e=>{(p()||f())&&r(e)},e.onPause?.()})).then((()=>{t=void 0,p()||e.onContinue?.()})),E=()=>{if(p())return;let t;const n=0===u?e.initialPromise:void 0;try{t=n??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(m).catch((t=>{if(p())return;const n=e.retry??(i.S$?0:3),o=e.retryDelay??a,s="function"==typeof o?o(u,t):o,l=!0===n||"number"==typeof n&&u<n||"function"==typeof n&&n(u,t);!r&&l?(u++,e.onFail?.(u,t),(0,i.yy)(s).then((()=>f()?void 0:y())).then((()=>{r?g(t):E()}))):g(t)}))};return{promise:d,status:()=>d.status,cancel:t=>{if(!p()){const r=new c(t);g(r),e.onCancel?.(r)}},continue:()=>(t?.(),d),cancelRetry:()=>{r=!0},continueRetry:()=>{r=!1},canStart:h,start:()=>(h()?E():y().then(E),d)}}},8972:e=>{"use strict";e.exports=o},9124:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C1 1.567 4.134 0 8 0s7 1.567 7 3.5M2 5.304V6.5C2 7.692 4.615 9 8 9s6-1.308 6-2.5V5.304C12.775 6.32 10.546 7 8 7s-4.775-.68-6-1.696M8 10c2.546 0 4.775-.68 6-1.696V9.5c0 1.192-2.615 2.5-6 2.5s-6-1.308-6-2.5V8.304C3.225 9.32 5.454 10 8 10m6 1.304C12.775 12.32 10.546 13 8 13s-4.775-.68-6-1.696V12.5C2 13.692 4.615 15 8 15s6-1.308 6-2.5zM14 3.5C14 4.692 11.385 6 8 6S2 4.692 2 3.5 4.615 1 8 1s6 1.308 6 2.5" clip-rule="evenodd"></path></svg>'},9244:e=>{"use strict";e.exports=r},9658:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var n=r(6500),o=r(4880),s=new class extends n.Q{#Q;#V;#W;constructor(){super(),this.#W=e=>{if(!o.S$&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#V||this.setEventListener(this.#W)}onUnsubscribe(){this.hasListeners()||(this.#V?.(),this.#V=void 0)}setEventListener(e){this.#W=e,this.#V?.(),this.#V=e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#Q!==e&&(this.#Q=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"==typeof this.#Q?this.#Q:"hidden"!==globalThis.document?.visibilityState}}},9757:(e,t,r)=>{"use strict";r.d(t,{X:()=>a,k:()=>l});var n=r(4880),o=r(6261),s=r(8904),i=r(1692),a=class extends i.k{#$;#H;#z;#m;#q;#i;#K;constructor(e){super(),this.#K=!1,this.#i=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#m=e.client,this.#z=this.#m.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#$=c(this.options),this.state=e.state??this.#$,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#q?.promise}setOptions(e){if(this.options={...this.#i,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=c(this.options);void 0!==e.data&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#$=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#z.remove(this)}setData(e,t){const r=(0,n.pl)(this.state.data,e,this.options);return this.#G({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#G({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#q?.promise;return this.#q?.cancel(e),t?t.then(n.lQ).catch(n.lQ):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#$)}isActive(){return this.observers.some((e=>!1!==(0,n.Eh)(e.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===n.hT||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some((e=>"static"===(0,n.d2)(e.options.staleTime,this)))}isStale(){return this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!(0,n.j3)(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#q?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#q?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#z.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#q&&(this.#K?this.#q.cancel({revert:!0}):this.#q.cancelRetry()),this.scheduleGc()),this.#z.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#G({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#q?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#q)return this.#q.continueRetry(),this.#q.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const r=new AbortController,o=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#K=!0,r.signal)})},i=()=>{const e=(0,n.ZM)(this.options,t),r=(()=>{const e={client:this.#m,queryKey:this.queryKey,meta:this.meta};return o(e),e})();return this.#K=!1,this.options.persister?this.options.persister(e,r,this):e(r)},a=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#m,state:this.state,fetchFn:i};return o(e),e})();this.options.behavior?.onFetch(a,this),this.#H=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===a.fetchOptions?.meta||this.#G({type:"fetch",meta:a.fetchOptions?.meta}),this.#q=(0,s.II)({initialPromise:t?.initialPromise,fn:a.fetchFn,onCancel:e=>{e instanceof s.cc&&e.revert&&this.setState({...this.#H,fetchStatus:"idle"}),r.abort()},onFail:(e,t)=>{this.#G({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#G({type:"pause"})},onContinue:()=>{this.#G({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0});try{const e=await this.#q.start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#z.config.onSuccess?.(e,this),this.#z.config.onSettled?.(e,this.state.error,this),e}catch(e){if(e instanceof s.cc){if(e.silent)return this.#q.promise;if(e.revert){if(void 0===this.state.data)throw e;return this.state.data}}throw this.#G({type:"error",error:e}),this.#z.config.onError?.(e,this),this.#z.config.onSettled?.(this.state.data,e,this),e}finally{this.scheduleGc()}}#G(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...l(t.data,this.options),fetchMeta:e.meta??null};case"success":const r={...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#H=e.manual?r:void 0,r;case"error":const n=e.error;return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),o.jG.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#z.notify({query:this,type:"updated",action:e})}))}};function l(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:(0,s.v_)(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function c(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,r=void 0!==t,n=r?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}}},t={};function c(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,c),o.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{__set_webpack_public_path__:()=>vt,default:()=>Et});var e=c(9244),t=c(2686),r=c(7665),n=function(){return null};c(8972),c(8418);function o(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function s(e,t){if(o(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!o(e[r[n]],t[r[n]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;"undefined"!=typeof globalThis&&globalThis;var i=c(3417),a=c(5880),l=c(2238),d=c(2242),p=c(1658),f=c(1787),h=c(5009),m=c(3314),g=c(1138),y=c(1618),E=c(3890),v=c(4337),b=c(4321),w=c(4986);const S={btnBack:"Back",btnSubmit:"Submit Export",btnCancel:"Cancel",btnRetry:"Retry",btnNewOrder:"New Export",btnEnd:"Close",btnDownload:"Download",btnDownloadFallback:"Click here if download didn't start",btnAddRow:"Add Row",btnDeleteRow:"Delete Row",btnMoveUp:"Move Up",btnMoveDown:"Move Down",btnReuseArea:"New Export with Same Area",btnReload:"Reload Page",btnRetryValidation:"Retry",btnOpenSettings:"Open Settings",lblJobId:"Job ID",lblWorkspace:"Workspace",lblEmail:"Email Address",lblFilename:"Filename",lblDelivery:"Delivery Method",lblFmeStatus:"FME Flow Status",lblFmeMessage:"FME Flow Message",lblErrorCode:"Error Code",lblBlobType:"File Type",lblBlobSize:"File Size",lblGeomPreview:"Geometry Preview (Esri JSON)",lblUploadFile:"Upload File (TEMP Resource)",lblRemoteUrl:"Remote URL (HTTPS)",lblTableValue:"Value",lblTableActions:"Actions",lblUnnamedFile:"Unnamed File",lblActions:"Actions",lblDrawLayer:"Drawing Layer",titleOrderConfirmed:"Export Submitted",titleOrderComplete:"Export Completed",titleOrderFailed:"Export Failed",titleOrderCancelled:"Export Cancelled",titleConfigParams:"Configure Workspace Parameters",actionRetry:"Retry",actionReload:"Reload",actionOpenSettings:"Open Settings",statusSubmitting:"Submitting job\u2026",statusProcessing:"FME Flow processing\u2026",statusValidating:"Checking settings\u2026",statusPreparing:"Preparing\u2026",statusUploading:"Uploading\u2026",statusTransforming:"Transforming\u2026",statusDownloading:"Downloading\u2026",statusInitMap:"Preparing map tools\u2026",statusLoadWorkspaces:"Fetching workspaces\u2026",statusLoadParams:"Fetching workspace parameters\u2026",statusValidateGeom:"Validating geometry\u2026",statusPreparingMapTools:"Preparing map tools\u2026",statusValidatingMap:"Verifying map configuration\u2026",statusValidatingConnection:"Testing connection to FME Flow\u2026",statusValidatingEmail:"Validating email address\u2026",statusCheckMap:"Verifying map configuration\u2026",statusCheckConnection:"Testing connection to FME Flow\u2026",statusCheckEmail:"Validating email address\u2026",validatingStartup:"Validating widget startup\u2026",submittingOrder:"Submitting export job\u2026",submittingOrderSync:"Processing export\u2026",msgOrderCancelled:"Export cancelled",msgOrderTimeout:"Export cancelled due to time limit. FME Flow workspace exceeded maximum runtime",msgNoResult:"Nothing available",msgJobCancelled:"Job cancelled",msgJobTimeout:"Job exceeded time limit",msgJobFailed:"Job failed in FME Flow",msgProcessingWait:"Processing. Please wait\u2026",msgValidating:"Validating parameter values\u2026",msgUploading:"Uploading data source\u2026",msgConfiguring:"Configuring FME Flow job\u2026",msgProcessingOrder:"Processing export\u2026",msgTransforming:"FME Flow transforming data\u2026",msgPrepDownload:"Preparing download\u2026",msgLoadingDraw:"Loading drawing tools\u2026",msgCheckGeom:"Validating geometry\u2026",msgPleaseWait:"This can take a few minutes\u2026",msgProcessingActive:"FME Flow processing\u2026",msgLargeArea:"The area ({current}) is large and may result in longer processing time",msgLargeAreaThreshold:"The area {current} is large and may result in longer processing time. Recommended area is below {threshold}",msgNoWorkspaces:"No workspaces found in this repository",msgAsyncForced:"The area {area} is large and may result in longer processing time",forcedAsyncArea:"The area {area} is large and may result in longer processing time",forcedAsyncUrlLength:"URL length ({urlLength} characters) exceeds limit. Automatically switched to email notification mode",msgNoGeometry:"No area selected. Draw an area on the map",msgGeomReady:"Area defined ({rings} polygons, {vertices} vertices)",msgContactSupport:"Please contact support at {email}",msgEmailSent:"Email notification will be sent when job is complete",msgTableEmpty:"No rows have been added",msgSetupWidget:"Widget needs to be configured before it can be used",msgCheckSettings:"Check connection settings in configuration panel",msgCheckToken:"Verify API token in settings",msgCheckUrl:"Check FME Flow server URL in settings",msgCheckRepo:"Select a valid repository in settings",msgCheckNetwork:"Check network connection and firewall settings",msgServerUrlReq:"Enter FME Flow server URL",msgTokenReq:"Enter API token for FME Flow",msgUrlTooLong:"URL exceeds maximum allowed length",msgHeadersLarge:"Request headers are too large",msgOffline:"No network connection",msgCorsBlock:"Request was blocked by CORS policy",msgRateLimit:"Too many requests. Please wait and try again",msgConfigInvalid:"Invalid widget configuration",msgCancelled:"Request was cancelled by user",msgTimeout:"Request exceeded time limit",msgWorkspacesReady:"Workspaces available for selection",msgFormReady:"Parameters ready for input",msgOrderSuccess:"Export was submitted",msgOrderFail:"Export failed",msgJobCompletionPublished:"Export job completion notification sent to other widgets",msgJobMessagePublishFailed:"Failed to notify other widgets about export completion",errNoSetup:"Widget is not configured",errTokenInvalid:"API token is missing or invalid",errNoRepository:"Repository cannot be accessed",errNoAccess:"Repository could not be verified with current API token. Check permissions or select another repository",errServerUnreach:"FME Flow server cannot be reached",errConnectFail:"Connection to FME Flow failed",errAuthFail:"Authentication to FME Flow failed",errValidateFail:"Server invalid or incorrect configuration",errStartupFail:"Widget could not start",errSubmitFail:"Job could not be submitted",errWorkspaceLoad:"Workspace could not be loaded",errParamsLoad:"Workspace parameters could not be fetched",errRepoLoad:"Repository could not be loaded",errDatasetResolve:"Data source could not be determined",errGeomProcess:"Geometry processing failed",errNoServerUrl:"FME Flow server URL is missing",errNoToken:"API token is missing",errTokenSpace:"API token cannot contain spaces",errNoRepoSelected:"No repository has been selected",errNoWorkspace:"No workspace has been selected",errRepoInvalid:"Invalid repository",errWorkspaceInvalid:"Invalid workspace",errOrderFail:"Export order failed",errJobSubmit:"FME Flow job could not be submitted",errMapInit:"Map could not be initialized",errDrawComplete:"Drawing could not be completed",errNoUserEmail:"User email address is missing",errLoadTimeout:"Loading exceeded time limit",errEmailInvalid:"Invalid email address",errTransformFailed:"FME Flow transformation failed. See log file above for details",errLoadWorkspaces:"Could not fetch workspaces from repository",errLoadParams:"Could not fetch workspace parameters",errNoConfig:"Export configuration is missing",errGeomParse:"Could not parse geometry JSON",errFileLarge:"File is too large. Max {maxSize} MB allowed",errFileType:"File type not supported. Please use one of the following formats: .zip, .kmz, .json, .geojson, .gml",errFileInvalid:"Invalid file",errDateTimeFormat:"Invalid date format. Use YYYY-MM-DD HH:MM:SS",errGeomMissing:"Geometry is missing",errGeomType:"Only polygon geometry is allowed",errGeomInvalid:"Invalid geometry",errGeomSerialize:"Geometry could not be serialized",errGeomNotSimple:"Polygon intersects itself",errGeomValidate:"Geometry could not be validated",errAreaLarge:"Area exceeds maximum limit",errGeomReq:"No geometry has been specified",errGeomPolygon:"Geometry must be a polygon",errorTokenIssue:"API token is missing or invalid",errorServerUnreachable:"FME Flow server cannot be reached",errorSetupRequired:"Widget is not configured",errorValidationFailed:"Server invalid or incorrect configuration",errorStartupFailed:"Widget could not start",errorRepositoryAccess:"Repository cannot be accessed",errorJobSubmission:"FME Flow job could not be submitted",errorMapInit:"Map could not be initialized",errorOrderFailed:"Export failed",errorWidgetIdMissing:"Widget ID is missing or invalid",configurationInvalid:"Invalid widget configuration",userEmailMissingError:"User email address is missing",geometryMissingCode:"Geometry is missing",geometryTypeInvalidCode:"Only polygon geometry is allowed",geometrySerializationFailedCode:"Geometry could not be serialized",geometryInvalidCode:"Invalid geometry",geometryAreaTooLargeCode:"Area exceeds maximum limit",urlTooLongMessage:"URL exceeds maximum allowed length",requestTimedOut:"Request exceeded time limit",requestAborted:"Request was aborted",rateLimitExceeded:"Too many requests. Please wait and try again",headersTooLargeMessage:"Request headers are too large",corsBlocked:"Request was blocked by CORS policy",REMOTE_DATASET_WORKSPACE_REQUIRED:"FME Flow workspace requires remote dataset configuration",failedToLoadWorkspaces:"Failed to load workspaces",valRequiredField:"This field is required",valSingleError:"Fill in the required field",valMultipleErrors:"Fill in all required fields",valIntegerOnly:"Only integers allowed (no decimals)",valInvalidNumber:"Invalid numeric value",valGreaterThan:"Must be greater than {value}",valAtLeast:"Must be at least {value}",valLessThan:"Must be less than {value}",valAtMost:"Must be at most {value}",phSelect:"Select {field}\u2026",phEnter:"Enter {field}\u2026",phTags:"Enter tags (separate with commas)",phEmail:"example@example.com",phPhone:"+46 70-123 45 67",phSearch:"Search\u2026",phSelectOption:"Select an option",optSyncMode:"Direct Download",optAsyncMode:"Email Notification",optPolygon:"Polygon",optRectangle:"Rectangle",optTextInput:"Text Input",optFileInput:"File Upload",tipDrawMode:"Select drawing mode to define export area",tipDrawPolygon:"Draw a polygon to define export area",tipDrawRectangle:"Draw a rectangle to define export area",tipSubmitOrder:"Submit export to FME Flow",tipCancel:"Cancel and start over",tipReuseArea:"Create new export with same area",tipNewOrder:"Create new export with same area",hintUploadFile:"Select file to use as input to workspace",hintRemoteUrl:"Enter secure HTTPS URL to remote data source",hintFileFormats:"Allowed formats: .zip, .kmz, .json, .geojson, .gml (max 150 MB)",hintUrlFormat:"Example: https://fmeflow.example.com",hintClickMap:"Click on map to define export area",hintDrawRect:"Drag to draw a rectangle",hintDrawContinue:"Click to add more corner points",hintDrawComplete:"Double-click to complete polygon",hintSelectMode:"Select drawing mode to start",hintGeomInvalid:"Polygon is invalid (not closed, self-intersecting, or without area)",hintAreaLarge:"Reduce area size for faster export",hintGeometryInvalid:"Polygon is invalid (not closed, self-intersecting, or without area)",hintAreaTooLarge:"Large area may result in longer export time. Consider reducing size",hintSetupWidget:"Widget needs to be configured before it can be used",contactSupportEmail:"Contact support at {email}",tokenSettingsHint:"Verify API token in settings",serverUrlSettingsHint:"Check FME Flow server URL in settings",repositorySettingsHint:"Select a valid repository in settings",connectionSettingsHint:"Check connection settings in configuration panel",networkConnectionHint:"Check network connection and firewall settings",largeAreaWarning:"The drawn area ({current}) is very large",largeAreaWarningWithThreshold:"The drawn area ({current}) exceeds the recommended limit ({threshold}). Consider reducing the area",ariaButton:"Button",ariaLoading:"Loading",ariaErrorActions:"Error Handling",ariaEmptyActions:"Empty Results",ariaSuccessActions:"Successful Action",ariaRequired:"Required Field",alertSyncSuccess:"Download started automatically",alertSyncFallback:"If download didn't start, use the link below",alertAsyncSuccess:"You will receive an email when the export is complete",alertAsyncQueued:"Export job submitted and queued for processing",alertSyncError:"Export failed during processing",alertAsyncError:"Export job could not be completed",alertCancelledTimeout:"Export cancelled due to timeout",alertCancelledUser:"Export was cancelled",alertJobFailed:"FME Flow transformation failed",alertTransformError:"Data transformation could not be completed",msgCloseConfirmDetail:"Are you sure you want to abort and close the widget? Current work will be cancelled.",btnContinue:"Continue",btnAbortAndClose:"Abort and Close"};var R=c(9124),T=c.n(R),O=c(884),A=c.n(O),I=c(6278),_=c.n(I),C=c(5668),k=c.n(C),L=c(4712),M=c.n(L),N=c(3744),x=c.n(N),D=c(7711),P=c.n(D),F=c(2606),j=c.n(F),U=c(657),V=c.n(U),W=c(5502),B=c.n(W),q=c(3624),G=c.n(q),Q=c(1337),$=c.n(Q),H=c(7413),z=c.n(H),K=c(71),X=c.n(K),Y=c(1920),J=c.n(Y);const Z=i.$W,ee={error:_(),map:j(),polygon:B(),warning:J(),"person-lock":V(),folder:M(),data:T(),"shared-no":$(),"feature-service":k(),"link-tilted":P(),time:X(),setting:G(),email:A(),info:x(),success:z()},te={warning:"warning",error:"error",info:"info",success:"success"},re=()=>(0,i.MN)(),ne=d.YG,oe=d.j_,se=(e,t)=>[...e,(0,m.RMY)(t)].filter((e=>Boolean(e))),ie=(e,t)=>se([e.fullWidth],t),ae=e=>{const{id:t,required:r,errorText:n,errorSuffix:o}=e||{};return{"aria-required":!!r,"aria-invalid":!!n,"aria-describedby":n&&t?(0,m.LHE)(t,o):void 0}},le=(t,r)=>{const{tooltip:n,placement:o,block:s,jimuCss:i,jimuStyle:a,styles:l}=r;if(!n)return t;const c=[i,(0,m.RMY)(a),s?l.tooltipWrap.block:l.tooltipWrap.inline].filter((e=>Boolean(e)));return(0,e.jsx)("span",{css:c},(0,e.jsx)(pe,{content:n,placement:o},(0,e.jsx)("span",{css:l.tooltipWrap.anchor},t)))},ce=(t,r)=>(0,e.jsx)(pe,{content:t("valRequiredField"),placement:"bottom"},(0,e.jsx)("span",{css:r.typo.required,"aria-label":t("ariaRequired"),role:"img","aria-hidden":"false"},Z.required)),ue=({loading:t,children:r,text:n,icon:o,alignText:s})=>{const i=re();if(t)return(0,e.jsx)(b.Loading,{type:b.LoadingType.Donut});if(r)return(0,e.jsx)(e.React.Fragment,null,r);const a="string"==typeof o&&o.length>0||null!=o&&e.React.isValidElement(o),l=!!n;if(!a&&!l)return null;if(a&&!l)return"string"==typeof o?(0,e.jsx)(de,{src:o,size:Z.icon.large}):o;if(l&&!a)return(0,e.jsx)(e.React.Fragment,null,n);const c="string"==typeof o?(0,e.jsx)(de,{src:o,size:Z.icon.medium}):o,u=(0,e.jsx)("span",{css:i.btn.icon,"aria-hidden":"true"},c);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("div",{css:i.btn.text(s)},n),u)},de=({src:t,size:r=Z.icon.medium,className:n,style:o,role:s="img","aria-label":i,"aria-hidden":a,...l})=>{const c=ee[t]??t,u=a??!i;return(0,e.jsx)(b.SVG,{...l,src:c,size:r,className:n,role:s,"aria-label":i,"aria-hidden":u,css:se([],o)})},pe=({content:t,children:r,showArrow:n=Z.tooltip.showArrow,placement:o=Z.tooltip.position.top,disabled:s=!1,...i})=>{const a=t;if(!e.React.isValidElement(r)||!a||s)return(0,e.jsx)(e.React.Fragment,null,r);const l=((t,r)=>{const n=t.props||{};if(!n.disabled&&!n["aria-disabled"])return t;const o=(0,m.NnH)(r);return(0,e.jsx)("span",{"aria-disabled":"true","aria-label":o},t)})(r,a),c=o;return(0,e.jsx)(b.Tooltip,{title:a,showArrow:n,placement:c,...i},l)},fe=t=>(0,e.jsx)(b.Checkbox,{...t}),he=["text","email","select","file","date","datetime-local","month","search","tel","week","password","datetime","time"],me=t=>{const{value:r,defaultValue:n,required:o=!1,maxLength:s,errorText:i,type:a="text",step:l,onChange:c,onBlur:u,onFileChange:d,style:p,id:f,...h}=t,m=re(),g="file"===a,[y,E]=oe(r,n??""),[v,S]=g?[void 0,void 0]:[y,E],R=e.hooks.useEventCallback((e=>{const t=e.target.value;g||S(t),g&&d?d(e):c&&c(t)})),T=e.hooks.useEventCallback((e=>{u&&u(g?"":e.target.value)})),O=ae({id:f,required:o,errorText:i});if(g)return(0,e.jsx)("input",{...h,type:"file",onChange:R,onBlur:T,required:o,title:i,...O,id:f,style:p,css:ie(m,p)});const A=(I=a,he.includes(I)?a:"text");var I;const _=(0,w.w$)(v)?v:"";return(0,e.jsx)(b.TextInput,{...h,id:f,style:p,type:A,value:_,step:l,onChange:R,onBlur:T,required:o,maxLength:s,title:i,...O,css:ie(m,t.style)})},ge=({value:t,defaultValue:r,onChange:n,rows:o=2,onBlur:s,...i})=>{const a=re(),[l,c]=oe(t,r||""),u=e.hooks.useEventCallback((e=>{const t=e.target.value;c(t),n?.(t)})),d=e.hooks.useEventCallback((e=>{s?.(e.target.value)})),p=i.errorText,f=ae({id:i.id,required:i.required,errorText:p,errorSuffix:"error"});return(0,e.jsx)(b.TextArea,{...i,value:l,onChange:u,onBlur:d,css:se([a.fullWidth,a.textareaResize],i.style),...f})},ye=({value:t,defaultValue:r,placeholder:n,style:o,onChange:s})=>{const i=re();return(0,e.jsx)(b.UrlInput,{value:t,defaultValue:r,placeholder:n,schemes:["https"],onChange:e=>{const t=(e?.value||"").trim();s?.(t)},css:ie(i,o)})},Ee=t=>(0,e.jsx)(b.Switch,{...t}),ve=({options:t,value:r,defaultValue:n,onChange:o,style:s,disabled:i,"aria-label":a})=>{const l=re(),c=void 0!==r;return(0,e.jsx)("div",{css:ie(l,s),role:"radiogroup","aria-label":a},t.map(((t,s)=>(0,e.jsx)(b.Label,{key:`${t.value}-${s}`,check:!0,centric:!0},(0,e.jsx)(b.Radio,{value:t.value,...c?{checked:r===t.value}:{defaultChecked:n===t.value},disabled:i,onChange:e=>{o?.(e.target.value)}}),t.label))))},be=({value:t,defaultValue:r,min:n,max:o,step:s,onChange:i,style:a,disabled:l,"aria-label":c,decimalPrecision:u,showValue:d=!0,valueFormatter:p})=>{const f=re(),h=e.hooks.useEventCallback((e=>"function"==typeof p?p(e):(0,m.xik)(e,u))),g="number"==typeof t&&Number.isFinite(t)?t:"number"==typeof r&&Number.isFinite(r)?r:void 0,y=d&&"number"==typeof g?h(g):"";return(0,e.jsx)("div",{css:f.form.sliderField},(0,e.jsx)(b.Slider,{value:t,defaultValue:r,min:n,max:o,step:s,disabled:l,"aria-label":c,onChange:e=>{const t=parseFloat(e.target.value);!Number.isNaN(t)&&Number.isFinite(t)&&i?.(t)},css:ie(f,a)}),d&&""!==y?(0,e.jsx)("div",{css:f.form.sliderValue,"aria-live":"polite",role:"status"},y):null)},we=({style:t,onChange:r,...n})=>{const o=re();return(0,e.jsx)(b.NumericInput,{...n,onChange:e=>{"number"!=typeof e||Number.isNaN(e)?(null==e||Number.isNaN(e))&&r?.(void 0):r?.(e)},css:ie(o,t)})},Se=t=>(0,e.jsx)(b.Table,{...t}),Re=({value:t,defaultValue:r,onChange:n,style:o,"aria-label":s})=>{const i=re();return(0,e.jsx)(v.ColorPicker,{color:t||r||"#000000",onChange:e=>{n?.(e)},"aria-label":s,css:ie(i,o),showArrow:!0})},Te=({options:t=[],value:r,defaultValue:n,onChange:o,placeholder:s,disabled:i=!1,style:a,coerce:l,allowSearch:c=!1,allowCustomValues:u=!1,hierarchical:d=!1})=>{const p=e.hooks.useTranslation(S),f=re(),[h,g]=oe(r,n),[y,E]=e.React.useState(""),v=s||p("phSelectOption"),R=e.hooks.useEventCallback((e=>{if("number"===l&&"string"==typeof e){const t=Number(e);return Number.isFinite(t)?t:e}return e})),T=e.hooks.useEventCallback(((e,t)=>{const r=R(void 0!==t?t:e?.target?.value);g(r),o?.(r)})),O=e.hooks.useEventCallback((e=>{if(!u)return;const t=e.trim();if(!t)return;const r=R(t);Object.is(r,h)||(g(r),o?.(r))})),A=c||u,I=(0,m.SP$)(t,d),_=A?y.trim():"",C=_.toLowerCase();let k=C?I.filter((({option:e})=>(e.label&&e.label.trim()?e.label.trim():String(e.value)).toLowerCase().includes(C))):I;if(u){if((e=>{if(null==e||"string"!=typeof e&&"number"!=typeof e)return;const t=String(e);k.some((({option:e})=>String(e.value)===t))||(k=[...k,{option:{value:e,label:t},depth:0}])})(h),_){const e=R(_),t="number"==typeof e||"string"==typeof e?e:_,r=String(t);k.some((({option:e})=>String(e.value)===r))||(k=[{option:{value:t,label:_},depth:0},...k])}}const L=null!=h&&(0,w.w$)(h)?String(h):void 0,M=se([f.fullWidth],a);return(0,e.jsx)("div",{css:M},A?(0,e.jsx)(me,{type:"search",value:y,placeholder:p("phSearch"),onChange:e=>{E((0,m.BvY)(e))},onKeyDown:e=>{"Enter"===e.key&&u&&(e.preventDefault(),O(e.currentTarget.value),E(""))},disabled:i}):null,(0,e.jsx)(b.Select,{value:L,onChange:T,disabled:i,placeholder:v,zIndex:Z.zIndex.selectMenu,css:f.fullWidth},k.map((({option:t,depth:r},n)=>{if(!t||null==t.value)return null;const o=String(t.value),s=o===L,i=t.label&&t.label.trim()?t.label.trim():o,a=(0,m.I0Z)(i,p),l=t.hideLabel?"":d&&r>0?`${"- ".repeat(r)}${a}`:a;return(0,e.jsx)(b.Option,{key:`${o}-${r}-${n}`,value:t.value,active:s,disabled:Boolean(t.disabled),onClick:()=>{t.disabled||o===L||T(void 0,t.value)}},t.hideLabel?null:l)})).filter(Boolean)))},Oe=({text:t,icon:r,alignText:n="start",tooltip:o,type:s,tooltipDisabled:i=!1,tooltipPlacement:a=Z.button.defaults.tooltipPosition,loading:l=!1,onClick:c,children:u,block:d=Z.button.defaults.block,size:p,variant:f="contained",color:h,htmlType:g="button",...y})=>{const E=re(),v=e.hooks.useTranslation(S),w=e.hooks.useEventCallback((()=>{y.disabled||l||!c||c()})),R=y["aria-label"],T=(0,m.kzc)(t,!!r,R,o,v("ariaButton")),{style:O,...A}=y,I=!!o&&!i,_="danger"===h||"danger"===s?"error":"link"===h?"default":h||"default",C=(0,e.jsx)(b.Button,{...A,type:s,color:_,variant:f,size:p,htmlType:g,icon:!t&&!!r,onClick:w,disabled:y.disabled||l,"aria-busy":l,"aria-live":l?"polite":void 0,"aria-label":T,title:o?void 0:y.title,css:[E.relative,!I&&(0,m.RMY)(O)],block:d,tabIndex:y.tabIndex??0},(0,e.jsx)(ue,{loading:l,text:t,icon:r,alignText:n},u));return I?le(C,{tooltip:o,placement:a,block:d,jimuCss:void 0,jimuStyle:O,styles:E}):C},Ae=({className:t,style:r,text:n,children:o,type:s="warning",withIcon:i,variant:a="default",jimuVariant:l,tooltipPlacement:c=Z.tooltip.position.top,...u})=>{const d=re(),p=te[s],f=o??(null!=n?(0,e.jsx)("span",null,n):null),h=u;if("icon"===("icon"!==a||p?a:"default")){const i="string"==typeof n?n:"string"==typeof o?o:f,a=Boolean(i),u="string"==typeof n?n:"string"==typeof o?o:void 0,m=(0,e.jsx)(b.Alert,{...h,type:s,withIcon:!1,variant:l,className:t,css:se([d.alert,void 0],r)},p?(0,e.jsx)("div",{css:d.alertIcon},(0,e.jsx)(de,{src:p,"aria-label":u})):null);return a?le(m,{tooltip:i,placement:c,block:!0,jimuCss:void 0,jimuStyle:r,styles:d}):m}return null!=f||p?(0,e.jsx)(b.Alert,{...h,type:s,withIcon:!1,variant:l,className:t,css:se([d.alert,void 0],r)},(0,e.jsx)("div",{css:d.alertContent},p?(0,e.jsx)("div",{css:d.alertIcon},(0,e.jsx)(de,{src:p,size:Z.icon.small})):null,f?(0,e.jsx)("div",{css:d.alertMessage},f):null)):(0,e.jsx)(b.Alert,{...h,type:s,withIcon:!1,variant:l,className:t,css:se([d.alert,void 0],r)})},Ie=({items:t,value:r,defaultValue:n,onChange:o,onTabChange:s,ariaLabel:i})=>{const a=re(),[l,c]=oe(void 0,n||t[0]?.value),u=void 0!==r,d=u?r:l,p=e.hooks.useEventCallback((e=>{const r=t.find((t=>t.value===e)),n=r&&"number"==typeof r.value?Number(e):e;u||c(n),o?.(n),s?.(n)}));return(0,e.jsx)(b.AdvancedButtonGroup,{role:"tablist","aria-label":i,css:[a.row]},t.map(((t,r)=>{const n=d===t.value;return(0,e.jsx)(Oe,{key:"string"==typeof t.value||"number"==typeof t.value?String(t.value):`tab-${r}-${t.label}`,icon:t.icon,size:"lg",text:t.hideLabel?void 0:t.label,active:n,"aria-label":t.label,type:n?"primary":"tertiary",role:"tab","aria-selected":n,tooltip:t.tooltip,tooltipPlacement:"bottom",disabled:t.disabled,onClick:()=>{n||p(t.value)},block:!1})})))},_e=({state:t,className:r,style:n,renderActions:o,center:s})=>{const i=re(),a=e.hooks.useTranslation(S),{showLoading:l,snapshot:c}=(0,d.kg)(t,Z.loading.delay),[u,p]=e.React.useState(0),f="loading"===t.kind?t.message:void 0,h="loading"===t.kind?t.detail:void 0,g="loading"===t.kind&&Array.isArray(t.messages)?t.messages:void 0,y=c&&Array.isArray(c.messages)?c.messages:void 0,{messages:E,signature:v}=((t,r)=>{const n=new Set,o=[],s=e=>{if(null!=e){if("string"==typeof e){const t=e.trim();if(!t||n.has(t))return;return n.add(t),void o.push(t)}o.push(e)}};t.forEach(s),r&&r.forEach(s);const i=o.map(((t,r)=>"string"==typeof t?t:e.React.isValidElement(t)&&null!=t.key?String(t.key):`node-${r}`)).join("|");return{messages:o,signature:i}})([c?.message??f,c?.detail??h],y??g),w=E.length;e.hooks.useEffectWithPreviousValues((()=>{p(0)}),[v,l]),e.hooks.useEffectWithPreviousValues((()=>{0!==w||0===u?w>0&&u>=w&&p(w-1):p(0)}),[w,u]),e.hooks.useEffectWithPreviousValues((()=>{let e=null,t=null;if(!l||w<=1)return()=>{e&&clearTimeout(e),t&&clearInterval(t)};const r=Z.loading.detailDelay??Z.loading.delay,n=Z.loading.cycleInterval??0;return e=setTimeout((()=>{p((e=>{if(w<=1)return 0;const t=e%w;return 0===t?1:t})),n>0&&(t&&clearInterval(t),t=setInterval((()=>{p((e=>w<=1?0:(e+1)%w))}),n))}),r),()=>{e&&clearTimeout(e),t&&clearInterval(t)}}),[l,w,v]);const R=w>0&&u>=0?E[Math.max(0,u)%w]:null,T=e.hooks.useEventCallback((({actions:t,ariaLabel:r})=>t?.length?(0,e.jsx)("div",{role:"group","aria-label":r,css:i.btn.group},t.map(((t,r)=>(0,e.jsx)(Oe,{key:r,onClick:t.onClick,disabled:t.disabled,type:t.type,variant:t.variant,text:t.label,block:!0})))):null)),O=o?({actions:e,ariaLabel:t})=>o(e,t):T,A=()=>(0,e.jsx)("div",{css:i.centered,role:"status","aria-live":"polite","aria-atomic":!0},l&&(0,e.jsx)("div",{css:i.loadingSpinner},(0,e.jsx)(b.Loading,{type:b.LoadingType.Donut,width:Z.loading.width,height:Z.loading.height})),R?(0,e.jsx)("div",{css:[i.typo.loadingMessage,i.loadingText]},R):null),I="loading"===t.kind||l?A():(()=>{switch(t.kind){case"error":{const r=O({actions:t.actions,ariaLabel:a("ariaErrorActions")}),n=null==t.detail?null:(0,e.jsx)("div",{css:i.typo.caption},t.detail);return(0,e.jsx)("div",{role:"alert","aria-live":"assertive",css:i.stateView.error},(0,e.jsx)("div",{css:i.stateView.errorContent},(0,e.jsx)("div",{css:[i.row,i.rowAlignCenter]},(0,e.jsx)(de,{src:(0,m.sJ)(t.code),size:Z.icon.large}),(0,e.jsx)("div",{css:i.typo.title},t.message)),(0,e.jsx)(e.React.Fragment,null,n,t.code?(0,e.jsx)("div",null,a("lblErrorCode"),": ",t.code):null)),r?(0,e.jsx)("div",{css:i.stateView.errorActions},r):null)}case"empty":return(0,e.jsx)("div",{role:"status","aria-live":"polite"},(0,e.jsx)("div",null,t.message),O({actions:t.actions,ariaLabel:a("ariaEmptyActions")}));case"success":{const r=O({actions:t.actions,ariaLabel:a("ariaSuccessActions")});return(0,e.jsx)("div",{role:"status","aria-live":"polite",css:i.stateView.error},t.title&&(0,e.jsx)("div",{css:i.typo.title},t.title),t.message&&(0,e.jsx)("div",{css:i.typo.caption},t.message),t.detail&&(0,e.jsx)("div",{css:[i.typo.caption,(0,e.css)({"& > div":i.stateView.infoLine})]},"string"==typeof t.detail?(0,e.jsx)("span",null,t.detail):t.detail),r?(0,e.jsx)("div",{css:i.stateView.errorActions},r):null)}case"content":return(0,e.jsx)(e.React.Fragment,null,t.node);case"loading":return A()}})(),_=(0,m.Dr1)(s)??l;return(0,e.jsx)("div",{className:r,css:se([i.stateView.frame,_?i.centered:void 0],n)},I)},Ce=t=>{const{buttons:r,secondaryButton:n,primaryButton:o,className:s,style:i}=t,a=re(),l=r?.length?r.map(((e,t)=>({config:e,role:t===r.length-1?"primary":"secondary",key:t.toString()}))):[o?{config:o,role:"primary",key:"primary"}:null,n?{config:n,role:"secondary",key:"secondary"}:null].filter((e=>null!=e));return l.length?(0,e.jsx)("div",{css:se([a.btn.group],i),className:s},l.map((({config:t,role:r,key:n})=>{const o="primary"===r?"primary":"default",s={...t,type:t.type??o};return(0,e.jsx)(Oe,{key:n,...s,block:!0,css:a.btn.flex})}))):null},ke=t=>{const{variant:r,className:n,style:o,children:s}=t,i=e.hooks.useTranslation(S),a=re();if("layout"===r){const{title:r,subtitle:l,onBack:c,onSubmit:u,isValid:d=!0,loading:p=!1}=t;return(0,e.jsx)("div",{className:n,css:se([a.form.layout],o)},(0,e.jsx)("div",{css:a.form.header},r&&(0,e.jsx)("div",{css:a.typo.title},r),l&&(0,e.jsx)("div",{css:a.typo.caption},l)),(0,e.jsx)("div",{css:a.form.content},(0,e.jsx)("div",{css:a.form.body},s),(0,e.jsx)("div",{css:a.form.footer},(0,e.jsx)(Ce,{secondaryButton:c?{text:i("btnBack"),onClick:c,disabled:p}:void 0,primaryButton:{text:i("btnSubmit"),onClick:u,disabled:!d||p,loading:p,tooltip:i("tipSubmitOrder")}}))))}if("field"===r){const{label:r,helper:i,required:a=!1,readOnly:l=!1,error:c}=t;return(0,e.jsx)(Le,{className:n,style:o,label:r,helper:i,required:a,readOnly:l,error:c},s)}throw new Error(`Unknown Form variant: ${r}`)},Le=({className:t,style:r,label:n,helper:o,required:s=!1,readOnly:i=!1,check:a=!1,error:l,children:c})=>{const u=re(),d=e.hooks.useTranslation(S),p=ne(),{id:f,child:h}=((t,r,n)=>{if(r||!e.React.isValidElement(t))return{id:void 0,child:t};const o=t.props||{},s=o.id||n;return o.id?{id:s,child:t}:{id:s,child:e.React.cloneElement(t,{id:s})}})(c,i,p);return(0,e.jsx)(b.FormGroup,{className:t,css:se([u.field],r)},a?(0,e.jsx)(b.Label,{css:[u.typo.label,u.checkLabel],check:!0},(0,e.jsx)("span",null,n,s&&ce(d,u)),!i&&h):(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(b.Label,{css:u.typo.label,check:!1,for:f},n,s&&ce(d,u)),!i&&h),o&&!l&&(0,e.jsx)("div",{css:u.typo.hint,id:f?`${f}-help`:void 0},o),l&&(0,e.jsx)("div",{id:f?`${f}-error`:void 0,css:u.typo.errorMessage,role:"alert"},l))},Me=(t,r,n,o)=>{if(!t)return(0,e.jsx)(e.React.Fragment,null,o);const s=r("msgContactSupport"),a=s.split(i.BY);return a.length<2?(0,e.jsx)(e.React.Fragment,null,s," ",(0,e.jsx)("a",{href:`mailto:${t}`,css:n.typo.link,"aria-label":r("msgContactSupport",{email:t})},t)):a.map(((o,s)=>s<a.length-1?(0,e.jsx)(e.React.Fragment,{key:s},o,(0,e.jsx)("a",{href:`mailto:${t}`,css:n.typo.link,"aria-label":r("msgContactSupport",{email:t})},t)):(0,e.jsx)(e.React.Fragment,{key:s},o)))};var Ne=c(7389),xe=c(2779);class De{constructor(e,t,r){this.fieldStates=new Map,this.fieldNames=new Set,this.formValues=e;for(const e of t)this.fieldNames.add(e.name),e.visibilityState&&this.fieldStates.set(e.name,e.visibilityState);if(r)for(const[e,t]of r)this.fieldNames.add(e),t&&this.fieldStates.set(e,t)}evaluate(e,t){const r=this.evaluateInternal(e);return t&&(this.fieldStates.set(t,r),this.fieldNames.add(t)),r}evaluateInternal(e){if(!e)return"visibleEnabled";for(const t of e.if){const r=this.evaluateClause(t);if(!0===r)return t.then;if("unknown"===r)return this.resolveDefault(e)}return this.resolveDefault(e)}resolveDefault(e){return e.default?.value??"visibleEnabled"}evaluateClause(e){const t=(0,m.QdQ)(e)?e:{},r=Object.keys(t).filter((e=>e.startsWith("$")));if(0===r.length)return!0;let n=!1;for(const e of r){const r=this.evaluateCondition(e,t[e]);if(!1===r)return!1;"unknown"===r&&(n=!0)}return!n||"unknown"}evaluateCondition(e,t){switch(e){case"$equals":return this.evaluateEquals(t);case"$lessThan":return this.evaluateLessThan(t);case"$greaterThan":return this.evaluateGreaterThan(t);case"$matchesRegex":return this.evaluateMatchesRegex(t);case"$isEnabled":return this.evaluateIsEnabled(t);case"$isRuntimeValue":return this.evaluateIsRuntimeValue(t);case"$allOf":return this.evaluateAllOf(t);case"$anyOf":return this.evaluateAnyOf(t);case"$not":return this.evaluateNot(t);default:return!1}}evaluateEquals(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;const n=this.getParameterValue(t);if(void 0===n)return"unknown";if(void 0===r)return!1;return(0,m.sLt)(n)===(0,m.sLt)(r)}evaluateLessThan(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;if(null==r)return!1;const n=this.getParameterValue(t);return void 0===n?"unknown":this.compare(n,r,((e,t)=>e<t))}evaluateGreaterThan(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;if(null==r)return!1;const n=this.getParameterValue(t);return void 0===n?"unknown":this.compare(n,r,((e,t)=>e>t))}compare(e,t,r){const n=(0,m.sLt)(e),o=(0,m.sLt)(t),s=Number(n),i=Number(o);if(Number.isFinite(s)&&Number.isFinite(i))return r(s,i);const a=this.toLexString(n),l=this.toLexString(o);return r(a.localeCompare(l),0)}evaluateMatchesRegex(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t,regex:r}=e;if("string"!=typeof t||"string"!=typeof r)return!1;const n=this.getParameterValue(t);if(void 0===n)return"unknown";const o=this.toLexString((0,m.sLt)(n)),s=r.trim();if(!s)return!1;const a=(0,xe.rH)(s,"",{maxLength:i.Do});return a?a.test(o):((0,Ne.J)("VisibilityEvaluator: Unsafe regex blocked",{parameter:t,length:s.length}),!1)}evaluateIsEnabled(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t}=e;if("string"!=typeof t)return!1;if(!this.fieldNames.has(t))return!1;const r=this.fieldStates.get(t);return r?"visibleEnabled"===r||"hiddenEnabled"===r:"unknown"}evaluateIsRuntimeValue(e){if(!(0,m.QdQ)(e))return!1;const{parameter:t}=e;if("string"!=typeof t)return!1;const r=this.getParameterValue(t);if(void 0===r)return!1;const n=(0,m.NnH)(r);if(n)return n.startsWith("$");const o=(0,m.sLt)(r);return this.toLexString(o).startsWith("$")}evaluateAllOf(e){if(!Array.isArray(e)||0===e.length)return!1;let t=!1;for(const r of e){if(!(0,m.QdQ)(r))return!1;const e=r,n=Object.keys(e).filter((e=>e.startsWith("$")));if(n.length)for(const r of n){const n=this.evaluateCondition(r,e[r]);if(!1===n)return!1;"unknown"===n&&(t=!0)}}return!t||"unknown"}evaluateAnyOf(e){if(!Array.isArray(e)||0===e.length)return!1;let t=!1;for(const r of e){if(!(0,m.QdQ)(r)){(0,Ne.J)("Invalid condition in $anyOf (expected object)",r);continue}const e=r,n=Object.keys(e).filter((e=>e.startsWith("$")));if(n.length)for(const r of n){const n=this.evaluateCondition(r,e[r]);if(!0===n)return!0;"unknown"===n&&(t=!0)}else(0,Ne.J)("Invalid condition in $anyOf (no operators)",r)}return!!t&&"unknown"}evaluateNot(e){if(!(0,m.QdQ)(e))return!1;const t=e,r=Object.keys(t).filter((e=>e.startsWith("$")));if(!r.length)return!1;const n=this.evaluateCondition(r[0],t[r[0]]);return"unknown"===n?"unknown":!n}getParameterValue(e){const t=this.formValues[e];if(!(0,m.Ime)(t))return t}toLexString(e){return"string"==typeof e?e:String(e)}}var Pe=c(5938),Fe=c(3128);const je=e=>(0,m.wKo)(e)??"",Ue=(e,t)=>void 0!==t&&(0,m.$Xq)(e,t),Ve=(e,t)=>{if(t){if(Ue(e,t.checkedValue))return!0;if(Ue(e,t.uncheckedValue))return!1}return(e=>{const t=(0,m.Dr1)(e);if(void 0!==t)return t;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.trim();return""!==t&&"0"!==t}return Boolean(e)})(e)},We=(t,r,n,o,s={})=>{const{readOnly:i,maxLength:a,overrides:l}=s,c=(e=>"string"==typeof e||"number"==typeof e?String(e):"")(r),u=void 0!==l?.disabled?l.disabled:i;return(0,e.jsx)(me,{...l,type:"number"===t?"text":t,value:c,placeholder:n,onChange:e=>{o("number"===t?(e=>{if(""===e)return null;const t=Number(e.replace(/,/g,"."));return Number.isFinite(t)?t:null})(e):e)},disabled:u,maxLength:a})},Be=(e,t)=>{if(Array.isArray(e))return e.map((e=>{if((0,m.QdQ)(e)){const r={};for(const n of t)r[n.key]=e[n.key]??"";return r}return{value:e}}));if((0,m.YH$)(e)){const r=e.trim();try{const e=JSON.parse(r);return Array.isArray(e)?Be(e,t):[]}catch{return r.split(/\r?\n/).map((e=>e.trim())).filter(Boolean).map((e=>({value:e})))}}return[]},qe=e=>e?.accept?.length?e.accept.map((e=>(e=>{const t=(0,m.NnH)(e).toLowerCase();return t?"*/*"===t||t.endsWith("/*")||t.includes("/")?t:t.startsWith("*.")?`.${t.slice(2)}`:t.startsWith(".")?t:`.${t.replace(/^\*+/,"")}`:null})(e))).filter((e=>Boolean(e))):[],Ge=(e,t)=>{if(!e)return{valid:!1,error:"fileInvalid"};const r=qe(t),n="number"==typeof t?.maxSizeMb&&Number.isFinite(t.maxSizeMb)?t.maxSizeMb:void 0,o=void 0===n?i.vp.DEFAULT_MAX_SIZE_MB:n>0?n:void 0;if(void 0!==o&&e.size>o*i.vp.ONE_MB_IN_BYTES)return{valid:!1,error:"fileTooLarge",maxSizeMB:Math.floor(o)};const s=(e.name||"").toLowerCase(),a=(e.type||"").toLowerCase();if(r.length){if(!r.some((e=>{if("*/*"===e)return!0;if(e.endsWith("/*")){const t=e.slice(0,e.length-1);return!!a&&a.startsWith(t)}return e.includes("/")?!!a&&a===e:s.endsWith(e)})))return{valid:!1,error:"fileTypeNotAllowed"}}else{if(!i.vp.DEFAULT_ALLOWED_EXTENSIONS.some((e=>s.endsWith(e))))return{valid:!1,error:"fileTypeNotAllowed"};if(!i.vp.DEFAULT_ALLOWED_MIME_TYPES.has(a))return{valid:!1,error:"fileTypeNotAllowed"}}return{valid:!0}},Qe=(e,t)=>{if("string"==typeof e){return e.trim()||void 0}if("number"==typeof e||"boolean"==typeof e)return String(e);if(e){if((0,m.E$q)(e))return(0,m.SBV)(e,t);if(Array.isArray(e))for(const r of e){const e=Qe(r,t);if(e)return e}else if((0,m.QdQ)(e)){const r=e;for(const e of i.vp.FILE_DISPLAY_KEYS)if(e in r){const n=Qe(r[e],t);if(n)return n}}}},$e=({value:t,onChange:r,field:n,jimuMapView:o,disabled:s,placeholder:a})=>{const[l,c]=e.React.useState([]),[u,d]=e.React.useState(!1),[p,f]=e.React.useState(null);e.hooks.useEffectWithPreviousValues((()=>{if(n.choiceSetConfig&&"attributeNames"===n.choiceSetConfig.type)if(o){d(!0),f(null);try{const e=(0,m.RBD)(o),t=(0,m.Fmk)(e);c(t),d(!1)}catch(e){console.log("Failed to collect layer attributes",e),f("Failed to load attributes"),d(!1)}}else f("No map view available")}),[n.choiceSetConfig,o]);const h=n.options||[],g=0===l.length?h:(()=>{const e=new Set,t=[];return h.forEach((r=>{const n=String(r.value??"");n&&!e.has(n)&&(e.add(n),t.push({value:n,label:r.label??n}))})),l.forEach((r=>{e.has(r.value)||(e.add(r.value),t.push(r))})),t})();if(p)return(0,e.jsx)(Ae,{type:"warning",withIcon:!0},p);if(u)return(0,e.jsx)(Te,{value:t,options:[],placeholder:"Loading attributes...",disabled:!0,"aria-label":n.label});if(0===g.length)return(0,e.jsx)(me,{type:"text",value:je(t),placeholder:a||"Enter attribute name",onChange:e=>{const t=e.target.value;r(t)},disabled:s,"aria-label":n.label});const y=i.AR.has(n.type),E=g,v=(0,m.ZFl)(y,E),b=n.selectConfig;return(0,e.jsx)(Te,{value:t,options:g,placeholder:a||"Select attribute",onChange:e=>{r(e)},"aria-label":n.label,disabled:s,coerce:v,allowSearch:b?.allowSearch??!0,allowCustomValues:b?.allowCustomValues??!0,hierarchical:b?.hierarchical})},He=({field:t,value:r,onChange:n,translate:o,disabled:s,jimuMapView:a})=>{const l=e.hooks.useTranslation(S),c=o??l,u=re(),d=i.lY.has(t.type),p=t.type===i.Vw.TEXT_OR_FILE?r??null:(0,m.HeH)(r,d),f=(0,m.B_y)(c,t.label),h=Boolean(s||t.readOnly),[g,y]=e.React.useState(null),E=i.AR.has(t.type)||i.lY.has(t.type),v=t.options||[],b=E&&!d&&1===v.length,w=b?v[0]?.value:void 0,R=e.hooks.useEventCallback((()=>{if(void 0!==w){const e=p;Object.is(e,w)||n(w)}})),T=(0,m.ZFl)(E,v);e.hooks.useEffectWithPreviousValues((()=>{if(!b||void 0===w)return;const e=p;!(null==e||"string"==typeof e&&!(0,m.YH$)(e))&&Object.is(e,w)||n(w)}),[b,w,p,n]);const O=()=>{const o=t.tableConfig;if(!o?.columns?.length){const o=(0,m.H9i)(r),s=(e,t)=>{if(h)return;const r=[...o];r[e]=t,n(r)},i=()=>{h||n([...o||[],""])},a=e=>{if(h)return;const t=o.filter(((t,r)=>r!==e));n(t)};return(0,e.jsx)("div",{"data-testid":"table-field"},0===o.length?(0,e.jsx)("div",null,c("msgTableEmpty")):(0,e.jsx)(Se,{responsive:!0,hover:!0,"aria-label":t.label},(0,e.jsx)("tbody",null,o.map(((r,n)=>(0,e.jsx)("tr",{key:n},(0,e.jsx)("td",null,(0,e.jsx)(me,{type:"text",value:r,placeholder:t.placeholder||f.enter,onChange:e=>{const t=(0,m.BvY)(e);s(n,t)},disabled:h})),(0,e.jsx)("td",null,(0,e.jsx)(Oe,{text:c("btnDeleteRow"),variant:"text",type:"tertiary",onClick:()=>{a(n)},"aria-label":c("btnDeleteRow"),disabled:h}))))))),(0,e.jsx)(Oe,{text:c("btnAddRow"),variant:"outlined",onClick:i,"aria-label":c("btnAddRow"),disabled:h}))}const s=o.columns&&o.columns.length?o.columns:[{key:"value",label:t.label||c("lblColumnDefault"),type:"text"}],i=Be(r,s).map(((e,r)=>({...e,__rowId:`${t.name}-row-${r}-${Date.now()}`}))),a=o?.minRows??0,l=o?.maxRows,u=o?.allowReorder??!1,d=o?.showHeader??!0,p=o?.addRowLabel||c("btnAddRow"),g=o?.removeRowLabel||c("btnDeleteRow"),y=!h&&i.length>a,E=!h&&(void 0===l||i.length<l),v=(e,t,r)=>{if(h)return;const o=i.map(((n,o)=>o===e?{...n,[t]:r}:n));n(o)},b=(e,t)=>{if(h)return;const r=e+t;if(r<0||r>=i.length)return;const o=[...i],[s]=o.splice(e,1);o.splice(r,0,s),n(o)};return(0,e.jsx)("div",{"data-testid":"table-field"},0===i.length?(0,e.jsx)("div",null,c("msgTableEmpty")):(0,e.jsx)(Se,{responsive:!0,hover:!0,"aria-label":t.label},d?(0,e.jsx)("thead",null,(0,e.jsx)("tr",null,s.map((t=>(0,e.jsx)("th",{key:t.key},t.label))),(0,e.jsx)("th",null,c("lblActions")))):null,(0,e.jsx)("tbody",null,i.map((r=>(0,e.jsx)("tr",{key:r.__rowId||`fallback-${Math.random()}`},s.map((n=>(0,e.jsx)("td",{key:`${r.__rowId}-${n.key}`},((r,n,o)=>{const s=o[r.key],i=h||r.readOnly,a=r.placeholder||t.placeholder||f.enter;switch(r.type){case"number":return(0,e.jsx)(me,{type:"number",value:je(s),onChange:e=>{const t=""===e?null:Number(e.replace(/,/g,"."));v(n,r.key,Number.isFinite(t)?t:null)},disabled:i,placeholder:a});case"select":return(0,e.jsx)(Te,{value:s,options:r.options||[],placeholder:a,onChange:e=>{v(n,r.key,e)},disabled:i});case"boolean":return(0,e.jsx)(fe,{checked:Boolean(s),onChange:e=>{v(n,r.key,e.target.checked)},disabled:i,"aria-label":r.label});case"date":return(0,e.jsx)(me,{type:"date",value:je(s),onChange:e=>{v(n,r.key,e)},disabled:i,placeholder:a});case"time":return(0,e.jsx)(me,{type:"time",value:je(s),onChange:e=>{v(n,r.key,e)},disabled:i});case"datetime":return(0,e.jsx)(Ze,{value:je(s),onChange:e=>{v(n,r.key,e)},disabled:i,"aria-label":r.label});default:return(0,e.jsx)(me,{type:"text",value:je(s),onChange:e=>{v(n,r.key,e)},disabled:i,placeholder:a})}})(n,i.findIndex((e=>e.__rowId===r.__rowId)),r)))),(0,e.jsx)("td",null,(0,e.jsx)(Oe,{text:g,variant:"text",type:"tertiary",onClick:()=>{(e=>{if(h||!y)return;const t=i.filter(((t,r)=>r!==e));n(t)})(i.findIndex((e=>e.__rowId===r.__rowId)))},"aria-label":g,disabled:!y}),u?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(Oe,{text:c("btnMoveUp"),variant:"text",type:"tertiary",onClick:()=>{b(i.findIndex((e=>e.__rowId===r.__rowId)),-1)},"aria-label":c("btnMoveUp"),disabled:h||0===i.findIndex((e=>e.__rowId===r.__rowId))}),(0,e.jsx)(Oe,{text:c("btnMoveDown"),variant:"text",type:"tertiary",onClick:()=>{b(i.findIndex((e=>e.__rowId===r.__rowId)),1)},"aria-label":c("btnMoveDown"),disabled:h||i.findIndex((e=>e.__rowId===r.__rowId))===i.length-1})):null)))))),(0,e.jsx)(Oe,{text:p,variant:"outlined",onClick:()=>{(()=>{if(!E)return;const e=(e=>{const t={};for(const r of e)t[r.key]=void 0!==r.defaultValue?r.defaultValue:"";return t})(s);n([...i,e])})()},"aria-label":p,disabled:!E}))},A=()=>{const r=((e,t)=>{if(e&&"object"==typeof e&&!Array.isArray(e)&&"mode"in e){const r=e;if(r.mode===i.Wp.FILE&&(0,m.E$q)(r.file))return{mode:i.Wp.FILE,file:r.file,fileName:"string"==typeof r.fileName?r.fileName:(0,m.SBV)(r.file,t)};if(r.mode===i.Wp.TEXT)return{mode:i.Wp.TEXT,text:je(r.text)}}return(0,m.E$q)(e)?{mode:i.Wp.FILE,file:e,fileName:(0,m.SBV)(e,t)}:{mode:i.Wp.TEXT,text:je(e)}})(p,c),o=r.mode===i.Wp.FILE?i.Wp.FILE:i.Wp.TEXT,s=qe(t.fileConfig),a=s.length?s.join(","):void 0;return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(Ie,{items:[{value:i.Wp.TEXT,label:c("lblTextInput")},{value:i.Wp.FILE,label:c("lblFileInput")}],value:o,onChange:e=>{var t;t=e,h||(t===i.Wp.FILE?n({mode:i.Wp.FILE,file:(0,m.E$q)(r.file)?r.file:null,fileName:r.fileName}):n({mode:i.Wp.TEXT,text:je(r.text)}))},ariaLabel:t.label}),o===i.Wp.TEXT?(0,e.jsx)(ge,{value:je(r.text),placeholder:t.placeholder||f.enter,onChange:e=>{h||n({mode:i.Wp.TEXT,text:e})},disabled:h,rows:t.rows}):(0,e.jsx)("div",null,(0,e.jsx)(me,{type:"file",accept:a,onFileChange:e=>{if(h)return void(e.target.value="");const r=e.target.files,o=r&&r.length>0?r[0]:null;if(!o)return y(null),void n({mode:i.Wp.FILE,file:null,fileName:void 0});const s=Ge(o,t.fileConfig);if(!s.valid)return y("fileTooLarge"===s.error?c("errFileLarge",{maxSize:s.maxSizeMB}):"fileTypeNotAllowed"===s.error?c("errFileType"):c("errFileInvalid")),void(e.target.value="");y(null),n({mode:i.Wp.FILE,file:o,fileName:(0,m.SBV)(o,c)})},disabled:h,"aria-label":t.label}),g?(0,e.jsx)("div",{css:u.typo.errorMessage,"data-testid":"text-or-file-error",role:"alert"},g):null,(0,m.E$q)(r.file)&&!g?(0,e.jsx)("div",{"data-testid":"text-or-file-name"},r.fileName||(0,m.SBV)(r.file,c)):null))},I=()=>((t,r,n,o,s)=>(0,e.jsx)(me,{type:t,value:je(r),placeholder:n,onChange:e=>{o(e)},disabled:s}))(t.type===i.Vw.MONTH?"month":"week",p,(0,m.Tdo)(t,f,c),n,h);return(()=>{switch(t.type){case i.Vw.HIDDEN:return(0,e.jsx)(e.React.Fragment,null);case i.Vw.MESSAGE:return(()=>{const r=t.label||t.description||"";return r.trim()?(0,e.jsx)(Ae,{type:"info",withIcon:!0,open:!0,text:r,"aria-live":"polite"}):(0,e.jsx)(e.React.Fragment,null)})();case i.Vw.TEXT:case i.Vw.PASSWORD:case i.Vw.EMAIL:case i.Vw.PHONE:case i.Vw.SEARCH:return(()=>{const e={[i.Vw.PASSWORD]:"password",[i.Vw.EMAIL]:"email",[i.Vw.PHONE]:"tel",[i.Vw.SEARCH]:"search",[i.Vw.TEXT]:"text"}[t.type]||"text",r=t.type===i.Vw.PHONE?"phone":t.type===i.Vw.EMAIL?"email":t.type===i.Vw.SEARCH?"search":void 0,o=t.type===i.Vw.PASSWORD?(0,m.Tdo)(t,f,c):(0,m.Tdo)(t,f,c,r);return We(e,p,o,n,{readOnly:h,maxLength:t.maxLength})})();case i.Vw.NUMBER:return We("number",p,f.enter,n,{readOnly:h});case i.Vw.TEXTAREA:return(0,e.jsx)(ge,{value:je(p),placeholder:f.enter,onChange:e=>{n(e)},disabled:h,rows:t.rows});case i.Vw.URL:return(()=>{const r=je(p);return(0,e.jsx)(ye,{value:r,placeholder:t.placeholder||f.enter,onChange:e=>{h||n(e)}})})();case i.Vw.TABLE:return O();case i.Vw.COORDSYS:case i.Vw.DB_CONNECTION:case i.Vw.WEB_CONNECTION:case i.Vw.REPROJECTION_FILE:case i.Vw.SELECT:return(()=>{const r=t.options||[],o=t.selectConfig;if(0===r.length)return We("text",p,f.enter,n,{readOnly:h});if(b){const e=v[0],t=(0,m.NnH)((0,m.I0Z)(e?.label||"",c))||(0,m.NnH)(e?.value)||"";return We("text",t,f.select,R,{readOnly:!0,overrides:{readOnly:!0,disabled:!0}})}return(0,e.jsx)(Te,{value:p,options:r,placeholder:f.select,onChange:e=>{n(e)},"aria-label":t.label,disabled:h,coerce:T,allowSearch:o?.allowSearch,allowCustomValues:o?.allowCustomValues,hierarchical:o?.hierarchical})})();case i.Vw.ATTRIBUTE_NAME:case i.Vw.ATTRIBUTE_LIST:return(0,e.jsx)($e,{name:t.name,label:t.label,value:p,onChange:n,field:t,jimuMapView:a,disabled:h,placeholder:f.select});case i.Vw.DATE_TIME:return(()=>{const t="string"==typeof p?(0,m.hk0)(p):"";return(0,e.jsx)(Ze,{value:t,onChange:e=>{const t="string"==typeof p?p:void 0,r=(0,m.HKR)(e,t);n(r)},disabled:h})})();case i.Vw.MULTI_SELECT:return(()=>{const r=t.options||[],o=Array.isArray(p)?p:[],s=t.selectConfig;return(0,e.jsx)(tt,{options:r,values:[...o],placeholder:f.select,disabled:h,onChange:e=>{n(e)},allowSearch:s?.allowSearch,hierarchical:s?.hierarchical})})();case i.Vw.CHECKBOX:case i.Vw.SWITCH:return(()=>{const o=t.toggleConfig,s=null!=r&&""!==r?r:t.defaultValue,a=Ve(s,o),l=e=>{if(h)return;const t=((e,t)=>{const r=t?.checkedValue,n=t?.uncheckedValue;return e?void 0===r||r:void 0!==n&&n})(e,o);n(t)};return t.type===i.Vw.CHECKBOX?(0,e.jsx)(fe,{checked:a,onChange:e=>{l(e.target.checked)},disabled:h,"aria-label":t.label}):(0,e.jsx)(Ee,{checked:a,onChange:(e,t)=>{l(t)},disabled:h,"aria-label":t.label})})();case i.Vw.FILE:return(()=>{const o=(0,m.E$q)(r)?r:null,s=qe(t.fileConfig),i=s.length?s.join(","):void 0,a=o?Qe(t.defaultValue,c):Qe(r,c)??Qe(p,c)??Qe(t.defaultValue,c),l=(0,m.NnH)(a)||"",d=o?(0,m.SBV)(o,c):l,f=Boolean(d)?d:null;return(0,e.jsx)("div",null,(0,e.jsx)(me,{type:"file",accept:i,onFileChange:e=>{if(h)return void(e.target.value="");const r=e.target.files,o=r&&r.length>0?r[0]:null;if(!o)return y(null),void n(null);const s=Ge(o,t.fileConfig);if(!s.valid)return y("fileTooLarge"===s.error?c("errFileLarge",{maxSize:s.maxSizeMB}):"fileTypeNotAllowed"===s.error?c("errFileType"):c("errFileInvalid")),void(e.target.value="");y(null),n(o)},disabled:h,"aria-label":t.label}),g?(0,e.jsx)("div",{css:u.typo.errorMessage,"data-testid":"file-field-error",role:"alert"},g):null,f&&!g?(0,e.jsx)("div",{"data-testid":"file-field-display","aria-live":"polite",css:u.typo.hint},f):null)})();case i.Vw.TEXT_OR_FILE:return A();case i.Vw.SCRIPTED:return(()=>{const r=(0,m.YH$)(p)?p:je(t.defaultValue)||t.description||t.label;return(0,e.jsx)(et,{html:r||""})})();case i.Vw.RADIO:return(()=>{const r=t.options||[],o=(0,m.ZFl)(!0,r);let s;return s=null==p?void 0:"string"==typeof p?p:"number"==typeof p||"boolean"==typeof p?String(p):void 0,(0,e.jsx)(ve,{options:r.map((e=>({label:e.label,value:String(e.value)}))),value:s,onChange:e=>{if("number"!==o)n(e);else{const t=Number(e);if(Number.isFinite(t))n(t);else{const t=r.find((t=>String(t.value)===e));n(t?.value??e)}}},disabled:h,"aria-label":t.label})})();case i.Vw.GEOMETRY:return(()=>{const t=je(p).trim();if(!t)return(0,e.jsx)("div",{css:u.typo.hint,"data-testid":"geometry-field"},c("msgNoGeometry"));let r=0,n=0,o=t,s=!1;try{const e=JSON.parse(t),s=Array.isArray(e?.rings)?e.rings:[];r=s.length,n=s.reduce(((e,t)=>e+(Array.isArray(t)?t.filter(Array.isArray).length:0)),0),o=JSON.stringify(e,null,2)}catch{s=!0}const a=o.length>i.vp.GEOMETRY_PREVIEW_MAX_LENGTH?`${o.slice(0,i.vp.GEOMETRY_PREVIEW_MAX_LENGTH)}\u2026`:o;return(0,e.jsx)("div",{"data-testid":"geometry-field"},(0,e.jsx)("div",{css:u.typo.hint},s?c("errGeomParse"):c("msgGeomReady",{rings:r,vertices:n})),a?(0,e.jsx)("pre",{"aria-label":c("ariaGeomPreview")},a):null)})();case i.Vw.SLIDER:return(()=>{const r="number"==typeof p?p:(0,m.YH$)(p)?Number(p.trim()):"number"==typeof t.defaultValue?t.defaultValue:t.min??0,o=Number.isFinite(r)?r:t.min??0,s="number"==typeof t.decimalPrecision&&t.decimalPrecision>=0?t.decimalPrecision:void 0;return(0,e.jsx)(be,{value:o,min:t.min??0,max:t.max??i.EW.PERCENT_SLIDER_MAX,step:t.step??1,decimalPrecision:s,onChange:e=>{n(e)},disabled:h,"aria-label":t.label})})();case i.Vw.NUMERIC_INPUT:return(()=>{const r="number"==typeof p?p:(0,m.YH$)(p)?Number(p.trim()):void 0,o=void 0===r&&"number"==typeof t.defaultValue?t.defaultValue:void 0,s="number"==typeof t.decimalPrecision&&t.decimalPrecision>=0?t.decimalPrecision:2;let i=null;void 0!==r&&Number.isFinite(r)&&(0===s&&r%1!=0&&(i=c("valIntegerOnly")),i||"number"!=typeof t.min||(t.minExclusive?r<=t.min:r<t.min)&&(i=t.minExclusive?c("valGreaterThan",{value:t.min}):c("valAtLeast",{value:t.min})),i||"number"!=typeof t.max||(t.maxExclusive?r>=t.max:r>t.max)&&(i=t.maxExclusive?c("valLessThan",{value:t.max}):c("valAtMost",{value:t.max})));const a=void 0===r&&void 0!==o?{defaultValue:o}:{value:r};return(0,e.jsx)("div",null,(0,e.jsx)(we,{...a,placeholder:t.placeholder||f.enter,min:t.min,max:t.max,step:t.step,precision:s,disabled:h,"aria-label":t.label,"aria-invalid":!!i,"aria-describedby":i?`${t.name}-error`:void 0,onChange:e=>{n(void 0!==e?e:null)}}),i&&(0,e.jsx)("div",{id:`${t.name}-error`,css:u.typo.errorMessage,role:"alert","data-testid":"numeric-input-error"},i))})();case i.Vw.TAG_INPUT:return(()=>{const r=Array.isArray(p)?p:[];return(0,e.jsx)(Je,{value:r,placeholder:t.placeholder||c("phTags"),onChange:e=>{h||n(e)}})})();case i.Vw.COLOR:return(()=>{const r=t.colorConfig,o="string"==typeof p?(0,m.$em)(p,r)||p:void 0,s="string"==typeof o&&o.startsWith("#")?o:"#000000";return(0,e.jsx)(Re,{value:s,onChange:e=>{if(h)return;const t=(0,m.FKs)(e,r)||e;n(t)}})})();case i.Vw.DATE:return(()=>{const r="string"==typeof p?(0,m.Wxj)(p):"",o=r?`${r}T00:00:00`:"";return(0,e.jsx)(Ze,{mode:"date",value:o,onChange:e=>{const t=(0,m.BvY)(e).split("T")[0]||"",r=(0,m.OD1)(t);n(r)},"aria-label":t.label,disabled:h})})();case i.Vw.MONTH:case i.Vw.WEEK:return I();case i.Vw.TIME:return(()=>{const t="string"==typeof p?(0,m.BU)(p):"";return(0,e.jsx)(me,{type:"time",value:t,onChange:e=>{const t="string"==typeof p?p:void 0,r=(0,m.rIK)(e,t);n(r)},disabled:h})})()}})()},ze=()=>(0,Fe.MN)(),Ke=d.j_,Xe=(e,t)=>[...e,(0,m.RMY)(t)].filter(Boolean),Ye=(e,t)=>Xe([e.fullWidth],t),Je=({value:t,suggestions:r,placeholder:n,onChange:o,style:s})=>{const i=ze();return(0,e.jsx)(b.TagInput,{values:t,suggestions:r,placeholder:n,onChange:e=>{o?.(e)},css:Ye(i,s)})},Ze=({value:t,defaultValue:r,onChange:n,style:o,disabled:s,"aria-label":i,mode:a="date-time",format:l="iso"})=>{const c=ze(),[u,d]=Ke(t,r,n),p=()=>{const e=new Date;return"date"===a&&e.setHours(0,0,0,0),e},f=e.React.useRef(p());e.hooks.useUpdateEffect((()=>{f.current=p()}),[a]);const h=f.current,g=(0,m.dCw)(u)||(0,m.dCw)(r)||h,y=e.hooks.useEventCallback(((e,t)=>{if("number"==typeof e&&Number.isFinite(e)){const t=new Date(e);return"date"===a&&t.setHours(0,0,0,0),void d((0,m.JRh)(t,l))}if(e instanceof Date){const t=new Date(e.getTime());return"date"===a&&t.setHours(0,0,0,0),void d((0,m.JRh)(t,l))}null==e&&d("")})),E=Xe([c.fullWidth,c.relative],o),v=(0,e.jsx)("div",{css:E},(0,e.jsx)(Pe.DatePicker,{selectedDate:g,runtime:!1,showTimeInput:"date-time"===a,isLongTime:"date-time"===a,supportVirtualDateList:!1,disablePortal:!0,onChange:y,"aria-label":i}));return s?(0,e.jsx)("span",{"aria-disabled":"true",css:c.disabledPicker},v):v},et=({html:t,placeholder:r,className:n,style:o})=>t&&0!==t.trim().length?(0,e.jsx)(b.RichDisplayer,{className:n,css:(0,m.RMY)(o),value:t}):(0,e.jsx)("div",{className:n,css:(0,m.RMY)(o)},r||""),tt=({options:t=[],values:r,defaultValues:n=[],onChange:o,placeholder:s,disabled:i=!1,style:a,allowSearch:l=!1,hierarchical:c=!1})=>{const u=e.hooks.useTranslation(S),d=ze(),[p,f]=Ke(r,n),[h,g]=e.React.useState(""),y=s||u("phSelectOption"),E=(l?h.trim():"").toLowerCase(),v=(0,m.SP$)(t,c),w=(E?v.filter((({option:e})=>(e.label&&e.label.trim()?e.label.trim():String(e.value)).toLowerCase().includes(E))):v).map((({option:e,depth:t})=>{if(!e||null==e.value)return null;const r=e.label&&e.label.trim()?e.label.trim():String(e.value),n=c&&t>0?`${"- ".repeat(t)}${r}`:r;return{value:e.value,label:n,disabled:Boolean(e.disabled)}})).filter(Boolean),R=e.hooks.useEventCallback(((e,t)=>{const r=Array.isArray(t)?t.filter((e=>null!=e)):[];f(r),o?.(r)}));return(0,e.jsx)("div",{css:Xe([d.fullWidth],a)},l?(0,e.jsx)(me,{type:"search",value:h,placeholder:u("phSearch"),onChange:e=>{g((0,m.BvY)(e))},disabled:i}):null,(0,e.jsx)(b.MultiSelect,{values:p||[],defaultValues:n,onChange:R,placeholder:y,disabled:i,items:w,css:d.fullWidth}))};var rt=c(4945),nt=c.n(rt);const ot=e=>Boolean(e.modules||e.submission||e.workspaces||e.parameters||e.geometryValidation),st=e=>{if(!e?.length)return[];const t=[],r=new Set;for(const n of e){if(!n||n.type!==i.QL.GEOMETRY)continue;if("string"!=typeof n.name)continue;const e=n.name.trim();e&&!r.has(e)&&(r.add(e),t.push(e))}return t},it=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1){const n=e[r],o=t[r];if(!n||!o)return!1;if(n.name!==o.name)return!1;if((n.title||"")!==(o.title||""))return!1;if((0,m.NnH)(n?.repository)!==(0,m.NnH)(o?.repository))return!1}return!0},at=(e,t,r)=>{const n="string"==typeof e?e:(0,m.NnH)(e)??(e&&"object"==typeof e&&"message"in e?(0,m.NnH)(e.message):void 0)??"";if(!n)return r?r():"";try{const e=(0,m.I0Z)(n,t);if(e)return e}catch{}return r?r():n},lt=(e,t,r)=>{const n=e.current;if(n&&n.repository===r&&n.raw===t)return n.result;const o=((e,t)=>{if(!Array.isArray(e)||0===e.length)return i.R0;const r=(0,m.NnH)(t??void 0)??"",n=[];for(const t of e){if(!t||t.type!==i.h6)continue;if(!r){n.push(t);continue}const e=(0,m.NnH)(t?.repository);e&&e!==r||n.push(t)}return 0===n.length?i.R0:1===n.length?n:n.slice().sort(((e,t)=>(e.title||e.name).localeCompare(t.title||t.name,void 0,{sensitivity:"base"})))})(t,r);return n&&n.repository===r&&it(o,n.result)?(e.current={raw:t,repository:r,result:n.result},n.result):(e.current={raw:t,repository:r,result:o},o)},ct=(e,t,r)=>{const n=()=>e.convertParametersToFields(t);return{getFormConfig:n,validateValues:t=>{const o={...e.validateFormValues(t,(()=>{const e=r?.();return e&&e.length>0?e:n()})()).errors},s=t.start;if((0,m.YH$)(s))try{(0,E.Xz)(s.trim())||(o.start="invalidDateTimeFormat")}catch{o.start="invalidDateTimeFormat"}return{isValid:0===Object.keys(o).length,errors:o}},initializeValues:()=>(0,m.bE2)(n())}},ut=({orderResult:t,translate:r,onReuseGeography:n,onBack:o,onReset:s,config:a})=>{const l=(0,i.MN)(),[c,u]=e.React.useState(null);let d=null;if(t){const n=Boolean(t.cancelled),o=!n&&Boolean(t.success),s=a?.syncMode?"sync":"async",i="sync"===t.serviceMode||"async"===t.serviceMode?t.serviceMode:s;if(n){const n=(t.code||"").toString().toUpperCase().includes("TIMEOUT")?"alertCancelledTimeout":"alertCancelledUser";d=(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Ae,{type:"warning",withIcon:!0,text:r(n)}))}else if(o)d="async"===i?(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Ae,{type:"info",withIcon:!0,text:r("alertAsyncSuccess")})):(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Ae,{type:"success",withIcon:!0,text:r("alertSyncSuccess")}));else{const n=(t.code||"").toString().toUpperCase(),o=t.message||t.statusMessage||"",s="FME_JOB_FAILURE"===n||/FME\s*Flow\s*transformation\s*failed/i.test(o)?"alertJobFailed":"async"===i?"alertAsyncError":"alertSyncError";d=(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Ae,{type:"error",withIcon:!0,text:r(s)}))}}const p=(0,m.JoK)(t,a,r,{onReuseGeography:n,onBack:o,onReset:s},c);return e.hooks.useEffectOnce((()=>{u(null);let e=null,r=null;const n=()=>{if(null!==r&&clearTimeout(r),e){const t=e;setTimeout((()=>{try{URL.revokeObjectURL(t)}catch{}}),i.ST.BLOB_URL_CLEANUP_DELAY_MS)}};if(!t)return n;const o=!Boolean(t.cancelled)&&Boolean(t.success),s=a?.syncMode?"sync":"async",l="sync"===t.serviceMode||"async"===t.serviceMode?t.serviceMode:s;if(!o||"sync"!==l)return n;!t.downloadUrl&&t.blob&&(e=URL.createObjectURL(t.blob),u(e));const c=t.downloadUrl||e;return c?(r=setTimeout((()=>{try{const e=document.createElement("a");e.href=c,e.download=t.downloadFilename||"download",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch{}}),i.ST.AUTO_DOWNLOAD_DELAY_MS),n):n})),(0,e.jsx)(e.React.Fragment,null,d,(0,e.jsx)(_e,{state:p}))},dt=({workspaceParameters:t,workspaceName:r,workspaceItem:n,onBack:o,onSubmit:s,isSubmitting:a,translate:l,widgetId:c,config:u,geometryJson:p,jimuMapView:h})=>{const g=(0,m.qpp)(c),[y]=e.React.useState((()=>new f.DF)),[E,v]=e.React.useState([]),b=e.React.useRef([]),[w,S]=e.React.useState({}),R=p??null,[T,O]=e.React.useState((()=>(0,m.XTn)(R)));e.hooks.useEffectWithPreviousValues((()=>{const e=(0,m.XTn)(p??null);O((t=>t===e?t:e))}),[p]);const[A,I]=e.React.useState((()=>st(t)));e.hooks.useEffectWithPreviousValues((()=>{const e=st(t);I((t=>t.length===e.length&&t.every(((t,r)=>t===e[r]))?t:e))}),[t]);const _=e.hooks.useEventCallback((e=>l(1===e?"valSingleError":"valMultipleErrors"))),C=e.React.useRef(null),k=e.React.useRef(""),L=t.map((e=>e.name)).join(",");C.current&&k.current===L||(C.current=ct(y,t,(()=>b.current)),k.current=L);const M=C.current,N=(0,d.UA)(M);e.hooks.useEffectOnce((()=>{N.validateForm()})),e.hooks.useUpdateEffect((()=>{N.validateForm()}),[N.values,N.validateForm]),e.hooks.useUpdateEffect((()=>{N.resetForm(),S({}),b.current=[],v([])}),[r,t,N.resetForm]);const x=e.hooks.useEventCallback(((e,t)=>t instanceof File?(S((r=>({...r,[e]:t}))),void N.updateField(e,t.name)):null===t&&e in w?(S((t=>({...t,[e]:null}))),void N.updateField(e,"")):void N.updateField(e,t))),D=N.values,P=N.setValues,F=e.hooks.useLatest(D),j=e.hooks.useEventCallback((()=>{if(!M)return;const e=M.getFormConfig(),t=new Map;for(const e of b.current)t.set(e.name,e.visibilityState);const r=new De(F.current||{},e,t),n=e.map((e=>{const t=r.evaluate(e.visibility,e.name);return{...e,visibilityState:t}}));b.current=n,v(n);const o=[],s=[];for(const e of n)"hiddenDisabled"===e.visibilityState&&o.push(e.name),void 0!==e.visibilityState&&"visibleEnabled"!==e.visibilityState&&s.push(e.name);let i=!1;if(o.length){const e=F.current||{};let t;o.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&(t||(t={...e}),delete t[r])})),t&&(i=!0,P(t)),S((e=>{let t=null;return o.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&null!==e[r]&&(t||(t={...e}),t[r]=null)})),t??e}))}if(s.length){const e=N.errors;let t=null;s.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&(t||(t={...e}),delete t[r])})),t&&(N.setErrors(t),N.setIsValid(0===Object.keys(t).length))}i||N.validateForm()}));e.hooks.useEffectOnce((()=>{j()})),e.hooks.useUpdateEffect((()=>{j()}),[D,j]),e.hooks.useUpdateEffect((()=>{j()}),[M,j]),e.hooks.useEffectWithPreviousValues((()=>{if(!A.length)return;const e=T||"",t=F.current;if(!t)return;if(!A.some((r=>{const n=t?.[r];return(0,m.BvY)(n)!==e})))return;const r={...t};A.forEach((t=>{r[t]=e})),P(r)}),[A,T,F,P]);const U=e.hooks.useEventCallback((()=>{const e=N.validateForm();if(!e.isValid){const t=Object.keys(e.errors).length,r={message:_(t),type:i.By.VALIDATION,code:"FORM_INVALID",severity:i.MU.ERROR,recoverable:!0,timestampMs:Date.now(),kind:"serializable",userFriendlyMessage:"",suggestion:""};return void g.setError("general",r)}const t={...N.values};Object.keys(w).forEach((e=>{const r=w[e];r&&(t[e]=r)})),s({type:r,data:t})})),V=e.hooks.useEventCallback((e=>(0,m.OxR)(e))),W=e.hooks.useEventCallback((e=>{const t=(0,m.Z_x)(e);return t?(0,m.I0Z)(t,l):void 0}));return(0,e.jsx)(ke,{variant:"layout",title:n?.title||r,subtitle:n?.description?V(n.description):l("titleConfigParams"),onBack:o,onSubmit:U,isValid:N.isValid,loading:a},u?.allowRemoteDataset&&(0,e.jsx)(Le,{label:l("lblUploadFile"),helper:l("hintUploadFile")},(0,e.jsx)(He,{field:{name:"__upload_file__",label:l("lblUploadFile"),type:i.Vw.FILE,required:!1,readOnly:!1},value:N.values.__upload_file__,onChange:e=>x("__upload_file__",e),translate:l,jimuMapView:h})),u?.allowRemoteDataset&&u?.allowRemoteUrlDataset&&(0,e.jsx)(Le,{label:l("lblRemoteUrl"),helper:l("hintRemoteUrl")},(0,e.jsx)(ye,{value:N.values.__remote_dataset_url__||"",onChange:e=>x("__remote_dataset_url__",e)})),E.filter((e=>{const t=e.visibilityState??"visibleEnabled";return"visibleEnabled"===t||"visibleDisabled"===t})).map((t=>{if(!t||!t.name||!t.type)return null;const r=t.type===i.Vw.SWITCH||t.type===i.Vw.CHECKBOX,n="visibleDisabled"===t.visibilityState;return t.type===i.Vw.MESSAGE?(0,e.jsx)(He,{key:t.name,field:t,value:N.values[t.name],onChange:e=>x(t.name,e),translate:l,disabled:n,jimuMapView:h}):(0,e.jsx)(Le,{key:t.name,label:t.label,required:t.required,error:W(N.errors[t.name]),helper:t.helper,check:r},(0,e.jsx)(He,{field:t,value:N.values[t.name],onChange:e=>x(t.name,e),translate:l,disabled:n,jimuMapView:h}))})).filter(Boolean))},pt=t=>{const{widgetId:r,state:n,instructionText:o,loadingState:s,canStartDrawing:l,error:c,onFormBack:u,onFormSubmit:p,orderResult:f,onReuseGeography:h,onBack:g,drawnArea:y,showHeaderActions:v,drawingMode:b=i.hL.POLYGON,onDrawingModeChange:w,isDrawing:R,clickCount:T,isValidatingGeometry:O=!1,onReset:A,canReset:I=!0,config:_,onWorkspaceSelected:C,selectedWorkspace:k,workspaceItems:L,workspaceParameters:M,workspaceItem:N,isPrefetchingWorkspaces:x=!1,geometryJson:D,jimuMapView:P,startupValidationStep:F,startupValidationError:j,onRetryValidation:U,submissionPhase:V="idle",modeNotice:W,showCloseConfirmation:B=!1,onCloseConfirmNo:q,onCloseConfirmYes:G}=t,Q=e.hooks.useTranslation(S),$=(0,i.MN)(),H=e.React.useRef();H.current||(H.current=r&&r.trim()?r:`__local_${Date.now()}_${Math.random().toString(36).slice(2,11)}`);const z=H.current,K=(0,m.qpp)(z),X=e.ReactRedux.useDispatch(),Y=s??i.nc,[J,Z]=e.React.useState(Y),ee=e.hooks.useLatest(J),te=(0,d.d7)((e=>{Z(e)}),i.ST.MIN_LOADING_DELAY_MS);e.hooks.useEffectWithPreviousValues((()=>{const e=ee.current,t=Y;if(!(0,a.areLoadingStatesEqual)(e,t))return ot(t)?(te.cancel(),void Z(t)):void(ot(e)?te(t):Z(t));ot(t)||te.cancel()}),[Y.modules,Y.parameters,Y.workspaces,Y.submission,Y.geometryValidation,te]);const re=J,ne=Boolean(re.modules),oe=Boolean(re.submission),se=Boolean(re.workspaces),ie=l??!0,ae=e.React.useRef([]),le=e.hooks.useEventCallback((()=>i.qT.map((e=>({...e,label:Q(e.label),tooltip:Q(e.tooltip)})))));e.hooks.useUpdateEffect((()=>{ae.current=le()}),[le]),0===ae.current.length&&(ae.current=le());const ce=ae.current,ue=e.hooks.useEventCallback((()=>{const t=(0,m.YH$)(o)?o:Q("tipDrawMode");return(0,e.jsx)("div",{css:$.form.layout},(0,e.jsx)("div",{css:$.form.content},(0,e.jsx)("div",{css:[$.form.body,$.centered]},(0,e.jsx)("div",{css:$.typo.instruction,role:"status","aria-live":"polite","aria-atomic":!0},t),(0,e.jsx)(Ie,{items:ce,value:b,onChange:e=>{w?.(e)},"aria-label":Q("tipDrawMode")}))))})),de=e.hooks.useEventCallback(((t,r,n)=>{const o=[];if(Array.isArray(n))for(const e of n)null!=e&&o.push(e);const s=Q("msgPleaseWait"),a=o.some((e=>"string"==typeof e&&e===s));return s&&s!==t&&s!==r&&!a&&o.push(s),(0,e.jsx)(_e,{state:(0,i.aE)(t,r,o.length?o:void 0)})})),pe=e.hooks.useEventCallback(((t,r,n,o,s)=>{const a=[];n?a.push({label:Q("btnRetry"),onClick:n}):r&&a.push({label:Q("btnBack"),onClick:r});const l=(0,E.id)(_?.supportEmail),c=(0,m.EjJ)(Q,l,s),u=at(t,Q,(()=>t)),d=c?Me(l,Q,$,c):void 0;return(0,e.jsx)(_e,{state:(0,i.Qg)(u,{code:o,actions:a,detail:d})})})),fe=(0,m.NnH)(_?.repository)??"",he=e.hooks.usePrevious(fe)??"",me=(0,m.NnH)(_?.fmeServerUrl),ge=(0,m.NnH)(_?.fmeServerToken),ye=Boolean(me&&ge&&fe),[Ee,ve]=e.React.useState(null),be=(0,d.CH)({repository:fe||void 0,fmeServerUrl:me||void 0,fmeServerToken:ge||void 0},{enabled:ye}),we=(0,d.SB)(Ee?.name,{repository:Ee?.repository??fe??void 0,fmeServerUrl:me||void 0,fmeServerToken:ge||void 0},{enabled:Boolean(Ee&&ye)}),Se=e.hooks.useLatest(be.refetch),Re=e.React.useRef(null),Te=Array.isArray(L)?L:i.R0,Ce=fe||null,ke=Array.isArray(be.data)?be.data:i.R0,Le=lt(Re,ke,Ce);e.hooks.useEffectWithPreviousValues((()=>{var e,t;e=Le,t=Te,!ye||e===i.R0&&0===t.length||e===t||it(e,t)||K.setWorkspaceItems(Le)}),[Le,Te,ye]),e.hooks.useUpdateEffect((()=>{ye||(Te.length&&K.clearWorkspaceState(),Ee&&ve(null))}),[ye,Te.length,Ee]),e.hooks.useUpdateEffect((()=>{if(he===fe)return;if(ve(null),K.clearWorkspaceState(),!fe||!ye)return;const e=Se.current;"function"==typeof e&&e()}),[fe,he,ye]),e.hooks.useUpdateEffect((()=>{if(!Ee)return;const e=we.data;if(!e)return;const t=Ee.name;t&&(C?C(t,e.parameters,e.item):K.applyWorkspaceData({workspaceName:t,parameters:e.parameters,item:e.item}),ve(null))}),[Ee,we.data,C]);const Ne=Te.length>0,xe=Le.length>0,De=!!ye&&Boolean(be.isLoading||!Ne&&!xe&&be.isFetching),Pe=Boolean(we.isLoading),Fe=(0,d.bn)(X,r);e.hooks.useUpdateEffect((()=>{Fe("workspaces",De)}),[De,Fe]),e.hooks.useUpdateEffect((()=>{Fe("parameters",Pe)}),[Pe,Fe]);const je=e.hooks.useEventCallback(((e,t)=>!e||(0,m.zfx)(e)?null:at(t,Q,(()=>Q(t))))),Ue=be.isError&&ye?je(be.error,"failedToLoadWorkspaces"):null,Ve=(we.isError?je(we.error,"failedToLoadWorkspaceDetails"):null)||Ue,We=e.hooks.useEventCallback((()=>{if(ve(null),!ye)return void K.clearWorkspaceState();const e=Se.current;"function"==typeof e&&e()})),Be=e.hooks.useEventCallback((()=>Te.map(((t,r)=>{const n=t.title||t.name,o=t.name&&t.name.trim()?t.name:`workspace-${r}`;return(0,e.jsx)("div",{key:o,role:"listitem","aria-label":n},(0,e.jsx)(Oe,{text:n,icon:nt(),type:"tertiary",onClick:()=>{const e=(0,m.NnH)(t?.repository)??Ce??void 0;ve({name:t.name,repository:e})},logging:{enabled:!0,prefix:"FME-Export-WorkspaceSelection"}}))})))),qe=()=>{const e=Q("statusInitMap"),t=Q("msgLoadingDraw");return ne?de(e,t,[Q("tipDrawMode")]):ie?ue():de(e,t,[Q("tipDrawMode")])},Ge=()=>{switch(n){case i.nE.INITIAL:return qe();case i.nE.DRAWING:return 0===(T||0)?ue():(0,e.jsx)("div",{css:$.centered},(0,e.jsx)("div",{css:$.typo.instruction,role:"status","aria-live":"polite","aria-atomic":!0},o));case i.nE.EXPORT_OPTIONS:case i.nE.WORKSPACE_SELECTION:return Qe();case i.nE.EXPORT_FORM:return $e();case i.nE.ORDER_RESULT:return pe(Q("msgNoResult"),g);default:return qe()}},Qe=()=>{const t=Boolean(x&&Te.length&&n===i.nE.WORKSPACE_SELECTION);if((0,m.Ynv)(se||t,Te,n,Boolean(Ve))){const e=Q("statusLoadWorkspaces"),r=t?"":Q("statusLoadWorkspaces");return de(e,r)}if(Ve)return pe(Ve,g,We);if(!Te.length){const t=[{label:Q("btnRetry"),onClick:We},{label:Q("btnBack"),onClick:g}];return(0,e.jsx)(_e,{state:(0,i.Dd)(Q("msgNoWorkspaces"),t)})}return(0,e.jsx)("div",{css:$.selection.container},(0,e.jsx)("div",{css:$.btn.group,role:"list"},Be()))},$e=()=>u&&p?M&&k?(0,e.jsx)(e.React.Fragment,null,(()=>{if(!W)return null;const{messageKey:t,params:r,severity:n}=W;if(!t)return null;let o="";try{o=Q(t,r||{})}catch{o=Q(t)}if(!o)return null;const s="info"===n?"info":"warning";return(0,e.jsx)(Ae,{type:s,text:o,variant:"default",withIcon:!0})})(),(0,e.jsx)(dt,{widgetId:z,workspaceParameters:M,workspaceName:k,workspaceItem:N,onBack:u,onSubmit:p,isSubmitting:oe,translate:Q,config:_,geometryJson:D,jimuMapView:P})):de(Q("statusLoadWorkspaces")):pe(Q("errNoConfig"),g);return(0,e.jsx)("div",{css:$.parent},(0,e.jsx)("div",{css:$.header},v?(()=>{let t=null;if(n!==i.nE.INITIAL&&!(n===i.nE.DRAWING&&0===(T||0))){(0,m.ARn)(A,I,n,y??0,R,T)&&(t=(0,e.jsx)(Oe,{tooltip:Q("tipCancel"),tooltipPlacement:"bottom",onClick:A,color:"inherit",type:"default",variant:"contained",text:Q("btnCancel"),size:"sm","aria-label":Q("tipCancel"),logging:{enabled:!0,prefix:"FME-Export-Header"},block:!1}))}return t||null})():null),(0,e.jsx)("div",{css:$.content},B?(0,e.jsx)("div",{css:$.centered},(0,e.jsx)("div",{role:"alertdialog","aria-live":"assertive","aria-atomic":!0,"aria-labelledby":"close-confirm-message"},(0,e.jsx)("div",{css:$.typo.instruction},Q("msgCloseConfirmDetail"))),(0,e.jsx)("div",{css:$.btn.group},(0,e.jsx)(Oe,{text:Q("btnContinue"),onClick:q,variant:"contained",color:"primary",block:!0,"aria-label":Q("btnContinue")}),(0,e.jsx)(Oe,{text:Q("btnAbortAndClose"),onClick:G,variant:"outlined",type:"danger",block:!0,"aria-label":Q("btnAbortAndClose")}))):n===i.nE.STARTUP_VALIDATION?(()=>{if(j){const e=_?.supportEmail||"";return pe(j.message,void 0,U||(()=>{window.location.reload()}),j.code,j.userFriendlyMessage||e)}const e=F||Q("statusValidating");return de(e)})():n===i.nE.ORDER_RESULT&&f?(0,e.jsx)(ut,{orderResult:f,translate:Q,onReuseGeography:h,onBack:g,onReset:A,config:_}):oe?(()=>{const e=Boolean(_?.syncMode),t=Q(e?"submittingOrderSync":"submittingOrder");let r=null;switch(V){case"preparing":r="statusPreparing";break;case"uploading":r="statusUploading";break;default:r=null}return de(t,Q(r||(e?"msgProcessingWait":"msgPleaseWait")))})():Boolean(c)?pe(c.message,void 0,"info"!==c.severity?g:void 0,c.code,c.userFriendlyMessage):!O||n!==i.nE.DRAWING&&n!==i.nE.EXPORT_OPTIONS&&n!==i.nE.WORKSPACE_SELECTION?Ge():(0,e.jsx)(_e,{state:(0,i.aE)(Q("statusValidateGeom"),Q("msgCheckGeom"))})))},ft=e=>"object"==typeof e&&null!==e&&"function"==typeof e.then,ht=e=>e,mt=e=>e,gt=e=>e;function yt(r){const{id:n,widgetId:o,useMapWidgetIds:c,dispatch:u,config:v}=r,b=(0,m.P9t)({id:n,widgetId:o}),w=(0,a.createFmeSelectors)(b),R=e.ReactRedux.useSelector(w.selectViewMode),T=e.ReactRedux.useSelector(w.selectDrawingTool),O=e.ReactRedux.useSelector(w.selectGeometryJson),A=e.ReactRedux.useSelector(w.selectDrawnArea),I=e.ReactRedux.useSelector(w.selectWorkspaceItems),_=e.ReactRedux.useSelector(w.selectWorkspaceParameters),C=e.ReactRedux.useSelector(w.selectWorkspaceItem),k=e.ReactRedux.useSelector(w.selectSelectedWorkspace),L=e.ReactRedux.useSelector(w.selectOrderResult),M=e.ReactRedux.useSelector(w.selectLoading,s),N=e.ReactRedux.useSelector(w.selectLoadingFlag("submission")),x=e.ReactRedux.useSelector(w.selectLoadingFlag("geometryValidation")),D=e.ReactRedux.useSelector(w.selectCanExport),P=e.ReactRedux.useSelector(w.selectPrimaryError),F=e.hooks.usePrevious(R),j=e.hooks.useEventCallback((e=>{if(!e)return null;const t="number"==typeof e.timestampMs?e.timestampMs:Date.now();return{...e,timestamp:new Date(t),timestampMs:t,kind:"runtime"}})),U="general"===P?.scope?P.details:null,V=j(U),W=U?.severity===i.MU.ERROR,B=P?.details??null,q=v?.repository??null,G=(0,d.ho)(I,{repository:v?.repository??void 0,fmeServerUrl:v?.fmeServerUrl,fmeServerToken:v?.fmeServerToken},{enabled:R===i.nE.WORKSPACE_SELECTION&&I.length>0&&!W}),{isPrefetching:Q,progress:$,prefetchStatus:H}=G,z=$?{loaded:$.loaded,total:$.total}:null,K=re(),X=e.hooks.useTranslation(S),Y=e.hooks.useEventCallback((e=>X(e))),J=e.hooks.useCancelablePromiseMaker(),Z=e.hooks.useLatest(v),ee=e.hooks.useLatest(R),te=e.hooks.useLatest(T),[ne,oe]=e.React.useState(!1),[se,ie]=e.React.useState(!1),ae=e.React.useRef(!1),le=e.React.useRef(null),ce=e.React.useRef(null),ue=e.React.useRef(!1),de=e.React.useRef(null),pe=e.React.useRef(Symbol(`fme-popup-${b}`)),fe=e.hooks.usePrevious(b);e.hooks.useUpdateEffect((()=>{if(fe&&fe!==b){const e=pe.current;e&&m.Fv9.release(e),pe.current=Symbol(`fme-popup-${b}`)}}),[b,fe]);const he=e.React.useRef(null),me=(0,m.qpp)(b),[ge,ye]=e.React.useState({isActive:!1,clickCount:0}),[Ee,ve]=e.React.useState("idle"),[be,we]=e.React.useState(""),Se=e.hooks.useEventCallback((e=>{ye((t=>({...t,...e})))})),Re=e.hooks.useEventCallback((e=>{"normalizing"!==e?"resolvingDataset"!==e?"applyingDefaults"!==e&&"complete"!==e||ve("finalizing"):ve("uploading"):ve("preparing")})),Te=e.hooks.useEventCallback((e=>{te.current!==e&&me.setDrawingTool(e)})),[Oe,Ae]=e.React.useState(!1),[Ie,Ce]=e.React.useState(null),[ke,Le]=e.React.useState(),Ne=R===i.nE.STARTUP_VALIDATION,xe=Ne&&U?U:null,De=Ne?V:null,Pe=Ne&&!xe,Fe=Ne?ke:void 0,je=e.hooks.useEventCallback((e=>{Ae(Boolean(e))})),Ue=e.hooks.useEventCallback((()=>{Ce(null)})),Ve=e.hooks.useEventCallback((()=>N||x)),We=e.hooks.useEventCallback(((e,t,r)=>{if(!e)return void Ce(null);const n={};let o="forcedAsyncArea";"url_length"===e.reason?(o="forcedAsyncUrlLength","number"==typeof e.urlLength&&(n.urlLength=e.urlLength.toLocaleString())):("number"==typeof e.value&&(n.area=t&&r?.view?.spatialReference?(0,m.JdW)(e.value,t,r.view.spatialReference):Math.max(0,Math.round(e.value)).toLocaleString()),"number"==typeof e.threshold&&(n.threshold=t&&r?.view?.spatialReference?(0,m.JdW)(e.threshold,t,r.view.spatialReference):Math.max(0,Math.round(e.threshold)).toLocaleString())),Ce({messageKey:o,severity:"warning",params:n})})),Be=e.hooks.useEventCallback((()=>{null!=he.current&&("undefined"!=typeof window&&window.clearTimeout(he.current),he.current=null)}));e.hooks.useUpdateEffect((()=>{Ne||Le(void 0)}),[Ne]);const qe=e.hooks.useEventCallback((e=>{if(!e?.view)return;const t=e.view,r=t.popup;if(r){m.Fv9.acquire(pe.current,r,t);try{"function"==typeof t.closePopup&&t.closePopup()}catch(e){(0,m.fAF)("Failed to close map popup",e)}}})),Ge=e.hooks.useEventCallback((()=>{m.Fv9.release(pe.current)})),Qe=e.hooks.useEventCallback((()=>{const t=Z.current?.autoCloseOtherWidgets;if(void 0===t||t)try{const t="function"==typeof e.getAppStore?(0,e.getAppStore)():null,r=t?.getState?.(),n=r?.widgetsRuntimeInfo,o=Z.current?.widgetCloseExceptions,s=(0,m.UEQ)(n,b,o);if(s.length){const t=s.filter((e=>{const t=n?.[e];return Boolean(t?.isClassLoaded)}));t.length&&u(e.appActions.closeWidgets(t))}}catch(e){(0,m.fAF)("closeOtherWidgets error",e)}})),$e=(0,d.rG)(u,b),He=(0,m.bQb)(),ze=e.hooks.useEventCallback((e=>{me.clearError("export"),me.clearError("import"),me.setViewMode(e)})),Ke=v?.drawingColor||i.Ve,Xe={outlineWidth:v?.drawingOutlineWidth,fillOpacity:v?.drawingFillOpacity},Ye=e.React.useRef((0,m.gV5)((0,m.Xk1)(Ke),Xe)),Je=`${Ke}-${v?.drawingOutlineWidth}-${v?.drawingFillOpacity}`,Ze=e.hooks.usePrevious(Je);e.hooks.useUpdateEffect((()=>{Je!==Ze&&(Ye.current=(0,m.gV5)((0,m.Xk1)(Ke),Xe))}),[Je,Ze,Ke,Xe]);const et=e.hooks.useEventCallback((()=>{if(le.current?.dispose)try{le.current.dispose()}catch(e){(0,m.fAF)("Failed to dispose FME client",e)}le.current=null,ce.current=null})),tt=e.hooks.useEventCallback((()=>{const e=Z.current;if(!e)throw new Error("FME client configuration unavailable");const t=[e.fmeServerUrl??e.fme_server_url??"",e.fmeServerToken??e.fme_server_token??e.fmw_server_token??"",e.repository??"",e.requestTimeout??""].map((e=>null==e?"":"number"==typeof e?String(e):"string"==typeof e?e:"")).join("|");if(le.current&&ce.current===t||(et(),le.current=(0,l.ER)(e),ce.current=t),!le.current)throw new Error("Failed to initialize FME client");return le.current}));e.hooks.useUpdateEffect((()=>{v||et()}),[v]),e.hooks.useUpdateEffect((()=>{v?.fmeServerUrl&&v?.fmeServerToken||Be()}),[v?.fmeServerUrl,v?.fmeServerToken,v?.repository,Be]),e.hooks.useUnmount((()=>{He.cancel(),Ft.cancel(),et(),Ge(),Be(),(0,m.Wz3)(de.current),de.current=null}));const rt=e.hooks.useEventCallback((()=>{const e=te.current;me.resetState(),je(!1),me.clearWorkspaceState(),e&&me.setDrawingTool(e)})),nt=e.hooks.useEventCallback((()=>{me.resetToDrawing(),je(!1),Se({isActive:!1,clickCount:0})})),[ot,st]=e.React.useState(0),it=e.hooks.useEventCallback((()=>{st((e=>e+1))})),at=e.hooks.useEventCallback(((t,r)=>{if((0,m.bNn)(t))return null;const n=(0,E.id)(Z.current?.supportEmail),o=(0,m.OkK)(t,Y,n),s=o.message,a=(0,m.GCs)(t,{onRetry:r??(()=>{me.clearError("general");const e=(t?.code||"").toUpperCase();if("GEOMETRY_INVALID"===e||"INVALID_GEOMETRY"===e||"AREA_TOO_LARGE"===e){oe(!0),me.setViewMode(i.nE.DRAWING);try{!vt&&lt&&yt&&$t(yt)}catch{}}}),onReload:(0,m.xsy)()?()=>{try{const e=globalThis.location;e&&"function"==typeof e.reload?e.reload():console.warn("Page reload not available in current environment")}catch{}}:void 0},Y),l=(0,m.NnH)(o.hint),c=l?o.code?Me(n,Y,K,l):l:void 0;return(0,e.jsx)(_e,{state:(0,i.Qg)(s,{code:o.code,actions:a,detail:c})})})),{modules:lt,loading:ct,errorKey:ut}=(0,d.Gb)(ot),dt=(0,d.Vp)(),{jimuMapView:yt,setJimuMapView:Et,sketchViewModel:vt,setSketchViewModel:bt,graphicsLayer:wt,setGraphicsLayer:St,setCleanupHandles:Rt,teardownDrawingResources:Tt,cleanupResources:Ot}=dt,At=(0,d.bn)(u,r.id);e.hooks.useUpdateEffect((()=>{At("modules",Boolean(ct))}),[ct,At]),e.hooks.useUpdateEffect((()=>{ut&&$e(ut,i.By.MODULE,"MAP_MODULES_LOAD_FAILED")}),[ut,$e]),e.hooks.useUpdateEffect((()=>{!ct&&lt&&"MAP_MODULES_LOAD_FAILED"===V?.code&&me.clearError("general")}),[ct,lt,V?.code]),e.hooks.useUpdateEffect((()=>{if(R!==i.nE.WORKSPACE_SELECTION)if(R!==i.nE.EXPORT_FORM)if(R!==i.nE.ORDER_RESULT)we("");else{we(Y(L?.success?"msgOrderSuccess":"msgOrderFail"))}else we(Y("msgFormReady"));else we(Y("msgWorkspacesReady"))}),[R,L?.success,Y]);const It=e.hooks.useEventCallback((()=>{if(!O||!lt?.Polygon)return null;const e=lt.Polygon;try{if("function"==typeof e?.fromJSON)return e.fromJSON(O)}catch{return null}return null}));e.hooks.useUpdateEffect((()=>{if(R!==i.nE.EXPORT_FORM||!Z.current)return void Ue();let e=null;(0,m.MmJ)({data:{}},Z.current,{workspaceItem:C,areaWarning:Oe,drawnArea:A,onModeOverride:t=>{e=t}}),e?We(e,lt,yt):Ue()}),[R,C,Oe,A,lt,yt,v?.syncMode,v?.largeArea,Ue,We]);const _t=e.hooks.useWidgetActived(b),Ct=e.React.useRef((0,m.xry)(b));e.hooks.useUpdateEffect((()=>{Ct.current=(0,m.xry)(b)}),[b]);const kt=Ct.current,Lt=e.hooks.useEventCallback((e=>{oe(!1),e?.clearLocalGeometry&&Se({clickCount:0}),vt&&(0,d.uB)(vt),Se({isActive:!1})})),Mt=e.hooks.useEventCallback(((e,t)=>{Lt(t),me.setViewMode(e)})),Nt=e.hooks.useEventCallback((e=>{Le(e)})),xt=e.hooks.useEventCallback((()=>{Le(void 0),me.clearError("general"),me.completeStartup();const e=ee.current,t=null==e,r=e===i.nE.STARTUP_VALIDATION||e===i.nE.INITIAL;(t||r)&&ze(i.nE.DRAWING)})),Dt=e.hooks.useEventCallback((e=>{Le(void 0),me.setError("general",e)})),Pt=e.hooks.useEventCallback(((e,t)=>({message:Y(e||"errorStartupFailed"),type:i.By.CONFIG,code:t,severity:i.MU.ERROR,recoverable:!0,timestampMs:Date.now(),userFriendlyMessage:v?.supportEmail?String(v.supportEmail):"",suggestion:Y("btnRetryValidation"),kind:"serializable"}))),Ft=(0,m.bQb)(),jt=e.hooks.useEventCallback((async()=>{const e=Ft.abortAndCreate();me.clearError("general");try{await(0,f.MB)({config:v,useMapWidgetIds:c?[...c]:[],translate:Y,signal:e.signal,onProgress:Nt}),xt()}catch(e){if((0,m.zfx)(e))return;let t=null;try{e instanceof Error&&e.message&&(t=JSON.parse(e.message))}catch{}const r=t||e,n=t?.message||(0,g.fV)(r,(0,E.Ko)(r)),o="object"==typeof r&&null!==r&&"code"in r&&"string"==typeof r.code?r.code:"STARTUP_VALIDATION_FAILED";Dt(Pt(n,o))}finally{Ft.finalize(e)}})),Ut=e.hooks.useEventCallback((()=>{it(),jt()}));e.hooks.useEffectOnce((()=>(jt(),()=>{Ft.cancel()}))),e.hooks.useUpdateEffect((()=>{(0,h.setLoggingEnabled)(v?.enableLogging??!1)}),[v?.enableLogging]);const Vt=e.hooks.useEventCallback(((e=!1)=>{He.cancel(),Ft.cancel(),Le(void 0),oe(!1),e?Ot():Tt(),Se({isActive:!1,clickCount:0}),rt()}));e.hooks.useEffectWithPreviousValues((e=>{let t;const r=()=>{void 0!==t&&window.clearTimeout(t)},n=e[0];if(!n)return r;const o=v,s=n?.fmeServerUrl!==o?.fmeServerUrl||n?.fmeServerToken!==o?.fmeServerToken||n?.repository!==o?.repository;try{s&&(Vt(!1),t=window.setTimeout((()=>{jt()}),i.ST.POPUP_CLOSE_DELAY_MS))}catch{}return r}),[v]),e.hooks.useUpdateEffect((()=>{try{const e=Array.isArray(c)&&c.length>0;Vt(!e)}catch{}jt()}),[c]);const Wt=e.hooks.useEventCallback((()=>{(0,d.yN)(wt)})),Bt=e.hooks.useEventCallback((async e=>{if(!e.graphic?.geometry)return;if(ue.current)return;const t=de.current;(0,m.Wz3)(t);const r=new AbortController;de.current=r,ue.current=!0;try{Lt(),je(!1),At("geometryValidation",!0);const t=await(0,f.G1)({geometry:e.graphic.geometry,modules:lt,graphicsLayer:wt,config:{areaThreshold:v.maxArea,largeAreaThreshold:v.largeArea},signal:r.signal});if(r.signal.aborted)return void At("geometryValidation",!1);if(!t.success){try{wt?.remove(e.graphic)}catch{}return void(r.signal.aborted||(At("geometryValidation",!1),Tt(),me.setGeometry(null,0),je(!1),Mt(i.nE.INITIAL,{clearLocalGeometry:!0}),t.error&&("ZERO_AREA"===t.error.code?$e(Y("errGeomInvalid"),i.By.VALIDATION,"ZERO_AREA"):t.error.message?$e(t.error.message,i.By.VALIDATION,t.error.code):$e("GEOMETRY_ERROR",i.By.GEOMETRY,t.error.code))))}if(je(t.shouldWarn||!1),e.graphic&&t.geometry){e.graphic.geometry=t.geometry;const r=Ye.current?.HIGHLIGHT_SYMBOL;r&&(e.graphic.symbol=r)}t.geometry&&void 0!==t.area&&(me.completeDrawing(t.geometry,t.area,i.nE.WORKSPACE_SELECTION),At("geometryValidation",!1))}catch(e){r.signal.aborted||(je(!1),At("geometryValidation",!1),$e(Y("errDrawComplete"),i.By.VALIDATION,"DRAWING_COMPLETE_ERROR"))}finally{de.current===r&&(de.current=null),ue.current=!1}})),qt=e.hooks.useEventCallback((t=>{try{const r={jobId:t.jobId||t.code||"unknown",workspace:k||"unknown",status:t.success?"completed":"failed",downloadUrl:t.downloadUrl||"",message:t.message||"",timestamp:(new Date).toISOString(),serviceMode:t.serviceMode||"unknown"},n=new e.DataRecordSetChangeMessage(b,e.RecordSetChangeType.CreateUpdate,[r]);e.MessageManager.getInstance().publishMessage(n)}catch(e){}})),Gt=e.hooks.useEventCallback((e=>{kt.isInactive(Kt)||(me.setOrderResult(e),ze(i.nE.ORDER_RESULT),qt(e))})),Qt=e.hooks.useEventCallback((async t=>{if(N||!D)return;if(!kt.isActive(Kt))return void(v?.enableLogging&&console.log(`[FME Widget ${b}] Submission aborted: widget not active`));const r=(0,y.M4)(A,v?.maxArea);if(!r.ok&&r.message)return ve("idle"),void $e(r.message,i.By.VALIDATION,r.code);e.ReactDOM.unstable_batchedUpdates((()=>{me.setLoadingFlag("submission",!0),ve("preparing"),Ue()}));try{if(kt.isInactive(Kt))return v?.enableLogging&&console.log(`[FME Widget ${b}] Submission aborted during prep: widget inactive`),ve("idle"),void me.setLoadingFlag("submission",!1);const e=tt(),r=t?.data||{};(0,m.MmJ)({data:r},Z.current,{workspaceItem:C,areaWarning:Oe,drawnArea:A,onModeOverride:We});const n=await(0,f.JV)({formData:t,config:Z.current,geometryJson:O,geometry:It()||void 0,modules:lt,workspaceParameters:_,workspaceItem:C,selectedWorkspace:k,areaWarning:Oe,drawnArea:A,fmeClient:e,submissionAbort:He,widgetId:b,translate:Y,makeCancelable:J,onStatusChange:Re,getActiveGeometry:It});if(kt.isInactive(Kt))return void(v?.enableLogging&&console.log(`[FME Widget ${b}] Submission completed but widget inactive, skipping finalize`));if(!n.success&&n.error){const e=n.error;if(e&&"object"==typeof e&&"kind"in e)return ve("idle"),void me.setError("general",e)}if(n.result&&(Gt(n.result),n.result.success&&k))try{p.q.invalidateQueries({queryKey:["fme","workspace-item",k]})}catch(e){}}catch(e){(0,m.zfx)(e)||$e(Y("errJobSubmit"),i.By.MODULE,"SUBMISSION_UNEXPECTED_ERROR")}finally{ve("idle"),me.setLoadingFlag("submission",!1)}})),$t=e.hooks.useEventCallback((e=>{if(Et(e),lt)try{qe(e);const t=(0,f.fW)(e,lt,St);try{t.title=Y("lblDrawLayer")}catch{}const r=Ye.current.DRAWING_SYMBOLS,{sketchViewModel:n,cleanup:o}=(0,f.CY)({jmv:e,modules:lt,layer:t,onDrawComplete:Bt,dispatch:u,widgetId:b,symbols:{polygon:ht(r.polygon),polyline:mt(r.polyline),point:gt(r.point)},onDrawingSessionChange:Se,onSketchToolStart:Te});Rt(o),bt(n)}catch(e){$e(Y("errMapInit"),i.By.MODULE,"MAP_INIT_ERROR")}}));e.hooks.useUpdateEffect((()=>{lt&&yt&&!vt&&$t(yt)}),[lt,yt,vt,$t]),e.hooks.useUpdateEffect((()=>{if(!ne||!vt)return;oe(!1);const e=(T??i.hL.POLYGON)===i.hL.RECTANGLE?"rectangle":"polygon";if("function"==typeof vt.create)try{const t=vt.create.bind(vt)(e);ft(t)&&t.catch((e=>{(0,m.zfx)(e)||$e("errorStartDrawing",i.By.MODULE,"SKETCH_CREATE_FAILED"),(0,m.fAF)("Sketch create promise error",e)}))}catch(e){(0,m.fAF)("Sketch auto-start error",e)}}),[ne,vt,T]),e.hooks.useUpdateEffect((()=>{const e=Ye.current.DRAWING_SYMBOLS,t=ht(e.polygon),r=e=>{"polygon"===e.geometry?.type&&(e.symbol=t)};if(vt)try{const n=vt,o=mt(e.polyline),s=gt(e.point);n.polygonSymbol=t,n.polylineSymbol=o,n.pointSymbol=s;const i=n.viewModel,a=i?.graphic;a&&r(a);const l=i?.previewGraphic;l&&r(l);const c=i?.sketchGraphicsLayer;c?.graphics&&c.graphics.forEach((e=>{r(e)}))}catch{}if(wt?.graphics)try{wt.graphics.forEach((e=>{r(e)}))}catch{}}),[vt,wt,v?.drawingColor,v?.drawingOutlineWidth,v?.drawingFillOpacity]),e.hooks.useUpdateEffect((()=>{!_t&&vt&&(0,d.uB)(vt)}),[_t,vt]),e.hooks.useUpdateEffect((()=>{const e=yt;return()=>{e&&Ot()}}),[yt,Ot]),e.hooks.useEffectOnce((()=>()=>{He.cancel(),Ft.cancel(),et(),Ot(),me.removeWidgetState()}));const Ht=e.hooks.useEventCallback(((e,t)=>0===t?Y("hintClickMap"):e===i.hL.RECTANGLE?Y("hintDrawRect"):e===i.hL.POLYGON?Y(t<3?"hintDrawContinue":"hintDrawComplete"):Y("hintSelectMode"))),zt=e.hooks.useEventCallback((t=>{if(!vt)return;e.ReactDOM.unstable_batchedUpdates((()=>{Se({isActive:!0,clickCount:0}),me.setDrawingTool(t),me.setViewMode(i.nE.DRAWING),je(!1)})),Wt();try{const e=vt;Boolean("active"===e?.state||e?._creating)&&(0,d.uB)(vt)}catch{(0,d.uB)(vt)}const r=t===i.hL.RECTANGLE?"rectangle":"polygon";if(vt&&"function"==typeof vt.create)try{const e=vt.create.bind(vt)(r);ft(e)&&e.catch((e=>{(0,m.fAF)("Sketch create promise error",e)}))}catch(e){(0,m.fAF)("Sketch create error",e)}})),Kt=e.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo?.[b]?.state)),Xt=e.hooks.usePrevious(Kt),Yt=e.hooks.usePrevious(q),Jt=e.hooks.usePrevious(_t);e.hooks.useUpdateEffect((()=>{v?.enableLogging&&Xt!==Kt&&kt.log(Xt,Kt,{viewMode:R,isActive:_t,hasCriticalError:W})}),[Kt,Xt,R,_t,W,v?.enableLogging,kt]),e.hooks.useUpdateEffect((()=>{_t&&!Jt?(Qe(),yt&&qe(yt)):!_t&&Jt&&Lt({clearLocalGeometry:!1})}),[_t,Jt,Qe,yt,qe,Lt]);const Zt=R===i.nE.DRAWING&&0===ge.clickCount&&!ge.isActive&&!ue.current&&vt&&!N&&!W;e.hooks.useUpdateEffect((()=>{Zt&&kt.isActive(Kt)&&zt(T)}),[R,ge.clickCount,ge.isActive,T,vt,N,zt,Kt,W,kt]);const er=e.hooks.useEventCallback((()=>{ie(!1),ae.current=!1})),tr=e.hooks.useEventCallback((()=>{ie(!1),ae.current=!1,He.cancel(),e.ReactDOM.unstable_batchedUpdates((()=>{me.setLoadingFlag("submission",!1),me.setLoadingFlag("geometryValidation",!1)})),rr()})),rr=e.hooks.useEventCallback((()=>{He.cancel(),ve("idle"),Wt(),je(!1),Se({isActive:!1,clickCount:0}),vt&&(0,d.uB)(vt),nt(),Qe(),yt&&qe(yt)}));e.hooks.useUpdateEffect((()=>{if(kt.isTransition(Xt,Kt,m.zzz.TO_CLOSED)){if(ae.current)return;if(Ve())return ae.current=!0,void ie(!0);rr()}}),[Kt,Xt,rr,kt,Ve]),e.hooks.useUpdateEffect((()=>{if(kt.isTransition(Xt,Kt,m.zzz.FROM_CLOSED)){Qe(),yt&&qe(yt);const e=ee.current;e!==i.nE.ORDER_RESULT&&e!==i.nE.EXPORT_FORM&&e!==i.nE.WORKSPACE_SELECTION||nt(),jt()}}),[Kt,Xt,yt,Qe,qe,nt,kt,jt]),e.hooks.useUpdateEffect((()=>{W&&Tt()}),[W,Tt]),e.hooks.useUpdateEffect((()=>{if(!Boolean(O))return void(Oe&&je(!1));const e=(0,y.nW)(A,{maxArea:v?.maxArea,largeArea:v?.largeArea}).shouldWarn;e!==Oe&&je(e)}),[O,A,Oe,v?.largeArea,v?.maxArea,je]),e.hooks.useUpdateEffect((()=>{q!==Yt&&Oe&&je(!1)}),[q,Yt,Oe,je]),e.hooks.useUpdateEffect((()=>{kt.isInactive(Kt)&&Ge()}),[Kt,Ge,kt]),e.hooks.useUpdateEffect((()=>{yt||Ge()}),[yt,Ge]);const nr=e.hooks.useEventCallback(((e,t,r)=>{me.applyWorkspaceData({workspaceName:e,parameters:t,item:r}),ze(i.nE.EXPORT_FORM)})),or=e.hooks.useEventCallback((()=>{ze(i.nE.INITIAL)})),sr=e.hooks.useEventCallback((()=>{const e=ee.current??R,t=i.lh[e]||i.nE.INITIAL;ze(F&&F!==e?F:t)}));if(!b||"string"!=typeof b||!b.trim())return(0,e.jsx)("div",{css:K.parent},(0,e.jsx)(_e,{state:(0,i.Qg)(Y("errorWidgetIdMissing"),{code:"WIDGET_ID_MISSING"})}));if(ct)return(0,e.jsx)("div",{css:K.parent},(0,e.jsx)(_e,{state:{kind:"loading",message:Y("statusPreparingMapTools")}}));if(!lt)return(0,e.jsx)("div",{css:K.parent},at({message:"errorMapInit",type:i.By.MODULE,code:"MAP_MODULES_LOAD_FAILED",severity:i.MU.ERROR,recoverable:!0,timestamp:new Date,timestampMs:Date.now()},Ut));if(De)return(0,e.jsx)("div",{css:K.parent},at(De,jt));if(!Ne&&W&&V)return(0,e.jsx)("div",{css:K.parent},at(V));const ir=(ge.isActive||A>0)&&!N&&!ct,ar=Boolean(c&&1===c.length);let lr=v;if(v){const e={...v,fmeServerToken:v.fmeServerToken};delete e.fme_server_token,delete e.fmw_server_token,lr=e}return(0,e.jsx)("div",{css:K.parent},ar&&(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:c[0],onActiveViewChange:$t}),(0,e.jsx)("div",{"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",left:"-10000px",width:"1px",height:"1px",overflow:"hidden"}},be),(0,e.jsx)(pt,{widgetId:b,config:lr,geometryJson:O,workspaceItems:I,state:R,error:B,instructionText:Ht(T,ge.clickCount),loadingState:{...M,modules:ct,submission:N},isPrefetchingWorkspaces:Q,workspacePrefetchProgress:z,workspacePrefetchStatus:H,modules:lt,canStartDrawing:!!vt,submissionPhase:Ee,modeNotice:Ie,jimuMapView:yt?.view??null,onFormBack:()=>ze(i.nE.WORKSPACE_SELECTION),onFormSubmit:Qt,orderResult:L,onReuseGeography:()=>ze(i.nE.WORKSPACE_SELECTION),onBack:sr,drawnArea:A,areaWarning:Oe,formatArea:e=>(0,m.JdW)(e,lt,yt?.view?.spatialReference),drawingMode:T,onDrawingModeChange:e=>{me.setDrawingTool(e),vt&&((0,d.uB)(vt),Se({isActive:!1,clickCount:0}))},isDrawing:ge.isActive,clickCount:ge.clickCount,isCompleting:ue.current,isValidatingGeometry:x,showCloseConfirmation:se,onCloseConfirmNo:er,onCloseConfirmYes:tr,showHeaderActions:R!==i.nE.STARTUP_VALIDATION&&ir,onReset:rr,canReset:!0,onWorkspaceSelected:nr,onWorkspaceBack:or,selectedWorkspace:k,workspaceParameters:_,workspaceItem:C,isStartupValidating:Pe,startupValidationStep:Fe,startupValidationError:xe,onRetryValidation:jt}))}function Et(t){const o=()=>(0,m.P9t)({id:t.id,widgetId:t.widgetId});return e.hooks.useEffectOnce((()=>{(0,f.Ou)({widgetId:o(),config:t.config})})),e.hooks.useUpdateEffect((()=>{(0,f.c2)({widgetId:o(),config:t.config})}),[t.id,t.config]),(0,e.jsx)(r.Ht,{client:p.q},(0,e.jsx)(yt,{...t}),(0,e.jsx)(n,{initialIsOpen:!1}))}function vt(e){c.p=e}Reflect.set(Et,"mapExtraStateProps",((e,t)=>{const r=e["fme-state"],n=(0,m.P9t)({id:t?.id,widgetId:t?.widgetId});return{state:(n?r?.byId?.[n]:void 0)||a.initialFmeState}}))})(),u})())}}}));