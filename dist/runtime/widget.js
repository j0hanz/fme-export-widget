/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-arcgis","jimu-core/react","jimu-theme","jimu-ui/basic/color-picker","jimu-ui","jimu-ui/basic/date-picker"],(function(e,t){var r={},n={},s={},o={},i={},a={},l={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(o,"__esModule",{value:!0}),{setters:[function(e){r.DataRecordSetChangeMessage=e.DataRecordSetChangeMessage,r.MessageManager=e.MessageManager,r.React=e.React,r.ReactDOM=e.ReactDOM,r.ReactRedux=e.ReactRedux,r.RecordSetChangeType=e.RecordSetChangeType,r.SessionManager=e.SessionManager,r.WidgetState=e.WidgetState,r.appActions=e.appActions,r.css=e.css,r.getAppStore=e.getAppStore,r.hooks=e.hooks,r.jsx=e.jsx},function(e){Object.keys(e).forEach((function(t){n[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){s[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){o[t]=e[t]}))},function(e){i.ColorPicker=e.ColorPicker},function(e){a.AdvancedButtonGroup=e.AdvancedButtonGroup,a.Alert=e.Alert,a.Button=e.Button,a.Checkbox=e.Checkbox,a.FormGroup=e.FormGroup,a.Label=e.Label,a.Loading=e.Loading,a.LoadingType=e.LoadingType,a.MultiSelect=e.MultiSelect,a.NumericInput=e.NumericInput,a.Option=e.Option,a.Radio=e.Radio,a.RichDisplayer=e.RichDisplayer,a.SVG=e.SVG,a.Select=e.Select,a.Slider=e.Slider,a.Switch=e.Switch,a.Table=e.Table,a.TagInput=e.TagInput,a.TextArea=e.TextArea,a.TextInput=e.TextInput,a.Tooltip=e.Tooltip,a.UrlInput=e.UrlInput},function(e){l.DatePicker=e.DatePicker}],execute:function(){e((()=>{var e={71:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.3 15.6A7.3 7.3 0 1 0 8.3 1a7.3 7.3 0 0 0 0 14.6M8.3 2A6.3 6.3 0 1 1 2 8.3 6.307 6.307 0 0 1 8.3 2m3.5 6.8h-4v-5h1v4h3z" clip-rule="evenodd"></path></svg>'},657:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m4-3a4 4 0 0 1-4 4 6.5 6.5 0 0 0-6.5 6.5h-1a7.5 7.5 0 0 1 5.286-7.168A4 4 0 1 1 12 5m1 5.5v1h-2v-1a1 1 0 1 1 2 0m-3 0v1H9v4h6v-4h-1v-1a2 2 0 1 0-4 0m0 2v2h4v-2z" clip-rule="evenodd"></path></svg>'},884:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14 2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3.986l.001-.024L0 4a2 2 0 0 1 2-2zm1 2.934L8.277 9.416a.5.5 0 0 1-.554 0L1 4.935V12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1zM14 3H2a1 1 0 0 0-.97.752L8 8.398l6.97-4.646A1 1 0 0 0 14 3"></path></svg>'},930:(e,t,r)=>{"use strict";r.d(t,{$j:()=>w,Fh:()=>v,Mb:()=>d,XV:()=>h,c$:()=>p,dB:()=>g,gg:()=>c,hS:()=>S,lH:()=>R,m4:()=>y,qC:()=>m,qm:()=>E,xs:()=>l,yC:()=>b});var n=r(9244),s=r(3417),o=r(2238),i=r(4986),a=r(6920);const l=()=>{if("undefined"==typeof navigator)return!1;try{const e=globalThis.navigator;return Boolean(e&&!e.onLine)}catch{return!1}},c=e=>e?e.length<=4?"*".repeat(e.length):e.length<=8?`${e.slice(0,2)}${"*".repeat(e.length-4)}${e.slice(-2)}`:`${e.slice(0,4)}${"*".repeat(Math.max(4,e.length-8))}${e.slice(-4)}`:"",u=e=>{const t=(0,i.Nn)(e);if(!t)return"token:none";let r=0;for(let e=0;e<t.length;e+=1)r=31*r+t.charCodeAt(e)>>>0;return`token:${r.toString(36)}`},d=(e,t,r,n)=>{const a=(0,i.Nn)(e),l=(0,i.Nn)(t);if(!a||!l)return null;const c={fmeServerUrl:a,fmeServerToken:l,repository:(0,i.Nn)(r)||s.nu,...Number.isFinite(n)?{requestTimeout:n}:{}};try{return(0,o.ER)(c)}catch{return null}},p=(e,...t)=>f(e,t),f=(e,t)=>{const r=e.replace(/\/$/,""),n=t.filter((e=>"string"==typeof e&&e.length>0)).map((e=>e.split("/").filter((e=>Boolean(e)&&"."!==e&&".."!==e)).map((e=>encodeURIComponent(e))).join("/"))).join("/");return n?`${r}/${n}`:r},h=(e={},t=[],r=!1)=>{const n=new URLSearchParams;if("object"!=typeof e||null===e)return n;const s=new Set(t);for(const[t,r]of Object.entries(e)){if(null==r||s.has(t))continue;const e=(0,a.wc)(r);if(null==e)continue;if((0,i.E$)(e)){n.append(t,(0,a.SB)(e));continue}const o=(0,i.P6)(e);o?n.append(t,o):n.append(t,(0,i.N7)(e))}if(r){const t=t=>{const r=n.get(t);if(null!==r)return r;const s=e[t];return(0,i.Bv)(s)},r="xml"===(0,i.QK)(t("opt_responseformat"))?"xml":"json";n.set("opt_responseformat",r);const s="false"===(0,i.QK)(t("opt_showresult"))?"false":"true";n.set("opt_showresult",s);const o="sync"===(0,i.QK)(t("opt_servicemode"))?"sync":"async";n.set("opt_servicemode",o)}return n},m=(e,t,r,n)=>{},g=e=>{const t=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(`^https?://${t}`,"i")},y=(e,t)=>!!Array.isArray(e)&&e.some((e=>{if(!e||"object"!=typeof e)return!1;const r=e;if(!r._fmeInterceptor)return!1;const n=r.urls;return n instanceof RegExp?n.source===t.source&&n.flags===t.flags:"string"==typeof n&&t.test(n)}));function E(e,t,r){const n=`${e}::${t||""}::${r||""}`;let o=s.QB.DJB2_INITIAL;for(let e=0;e<n.length;e++)o=(o<<5)+o^n.charCodeAt(e);return Math.abs(o>>>0).toString(36)}const v=e=>(e??"").toLowerCase().includes("application/json"),b=e=>{const t=(0,i.P6)(e);if(!t)return null;try{return new URL(t)}catch{return null}},w=e=>{const t=b(e);return t&&t.hostname||null},S=async e=>{const t=await n.SessionManager.getInstance().getUserInfo(),r=(t?.email||e?.defaultRequesterEmail||"").trim().toLowerCase();if(!s.Xw.test(r)){const e=new Error("MISSING_REQUESTER_EMAIL");throw e.name="MISSING_REQUESTER_EMAIL",e}return r},R={fme:["fme"],workspaces:(e,t,r)=>[...R.fme,"workspaces",e||s.nu,t,u(r)],workspaceItem:(e,t,r,n)=>[...R.fme,"workspace-item",e,t||s.nu,r,u(n)],repositories:(e,t)=>[...R.fme,"repositories",e,u(t)],health:(e,t)=>[...R.fme,"health",e,u(t)]}},1020:(e,t,r)=>{"use strict";var n=r(8972),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,o={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:s,type:e,key:c,ref:u,props:o,_owner:a.current}}t.jsx=c},1138:(e,t,r)=>{"use strict";r.d(t,{$5:()=>y,GC:()=>f,Ok:()=>w,Wz:()=>c,bN:()=>p,fA:()=>d,fV:()=>g,ps:()=>u,r5:()=>b,sJ:()=>a,zf:()=>l});var n=r(3417),s=r(3890),o=r(4986),i=r(1181);const a=e=>{if("string"!=typeof e||!e.trim())return n.pC;const t=e.trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").toUpperCase();const r=n.iI[t];if(r)return r;const s=(e=>{for(const{token:t,icon:r}of n.f_)if(e.includes(t))return r})(t);return s||n.pC},l=e=>{if(!e)return!1;if("object"==typeof e&&null!==e){const t=e,r=(0,o.N7)(t.name??t.code);if(n.dv.has(r))return!0;if(!r||"Error"===r){const e=(0,o.N7)(t.message);return n.xG.test(e)||e.includes("signal is aborted")}return!1}return"string"==typeof e&&n.xG.test(e)},c=(e,t)=>{if(e)try{e.signal.aborted||e.abort(t)}catch{try{e.abort()}catch{}}},u=(e,t,r)=>{if(!e)return()=>{};if(e.aborted){const n=e.reason;return c(t,n),r&&r(n),()=>{}}const n=()=>{const n=e.reason;c(t,n),r&&r(n)};return e.addEventListener("abort",n),()=>{try{e.removeEventListener("abort",n)}catch{}}},d=(e,t)=>{},p=e=>{if(!e)return!0;const t=e.code||"",r=e.message||"";return"CANCELLED"===t||"ABORT"===t||/cancel/i.test(r)},f=(e,t,r)=>{const n=[];return t.onRetry&&n.push({label:r("actionRetry"),onClick:t.onRetry}),t.onReload&&n.push({label:r("actionReload"),onClick:t.onReload}),n},h=e=>{if("number"==typeof e)return n.YN.statusToKey[e]?n.YN.statusToKey[e]:void 0},m=(e,t,r="network")=>{const o=((e,t)=>{const r=t??(0,s.Ko)(e),n=e&&"object"==typeof e?e:null,o="string"==typeof n?.code?n.code:void 0;return{status:r,code:o,message:"string"==typeof n?.message?n.message:void 0,isRequestFailed:"REQUEST_FAILED"===o}})(e,t);if("network"===r&&o.isRequestFailed)return h(o.status);if(o.code&&n.YN.codeToKey[o.code])return n.YN.codeToKey[o.code];if("geometry"!==r){const e=h(o.status);if(e)return e}if(o.message){const e=(e=>{const t=e.toLowerCase();for(const{pattern:e,key:r}of n.YN.messagePatterns)if(e.test(t))return r})(o.message);if(e)return e}return"geometry"===r?"geometrySerializationFailedCode":void 0},g=(e,t)=>m(e,t,"network"),y=(e,t={})=>{const r=Date.now();return{message:e,type:t.type??n.By.NETWORK,code:t.code??"UNKNOWN",severity:t.severity??n.MU.ERROR,recoverable:t.recoverable??!0,timestamp:new Date,timestampMs:r,userFriendlyMessage:t.userFriendlyMessage??"",suggestion:t.suggestion??"",retry:t.retry,kind:"runtime"}},E=(e,t,r={})=>{const s=Date.now(),o=r.code??`${e.toUpperCase()}_ERROR`,i=r.scope??"general",a=r.recoverable??e!==n.By.MODULE;return{message:t,type:e,code:o,severity:r.severity??n.MU.ERROR,recoverable:a,timestampMs:s,userFriendlyMessage:r.userFriendlyMessage??"",suggestion:r.suggestion??"",details:r.details,kind:"serializable",errorId:`${i}_${o}`}},v={[n.By.NETWORK]:(e,t={})=>E(n.By.NETWORK,e,t),[n.By.VALIDATION]:(e,t={})=>E(n.By.VALIDATION,e,t),[n.By.CONFIG]:(e,t={})=>E(n.By.CONFIG,e,t),[n.By.GEOMETRY]:(e,t={})=>E(n.By.GEOMETRY,e,t),[n.By.MODULE]:(e,t={})=>E(n.By.MODULE,e,t)},b=(n.By.NETWORK,n.By.VALIDATION,n.By.CONFIG,v[n.By.GEOMETRY]),w=(n.By.MODULE,(e,t,r)=>{const n=e.code.toUpperCase(),s="GEOMETRY_INVALID"===n||"INVALID_GEOMETRY"===n,o="AREA_TOO_LARGE"===n,a="CONFIG_INCOMPLETE"===n,l=s||o||a,c=(0,i.I0)(e.message,t)||e.message,u=e.userFriendlyMessage||void 0;let d;return d=s?t("hintGeometryInvalid"):o?t("hintAreaTooLarge"):a?t("hintSetupWidget"):(0,i.Ej)(t,r,u),{message:c,code:l?void 0:e.code,hint:d}})},1181:(e,t,r)=>{"use strict";r.d(t,{$e:()=>j,$j:()=>l,BU:()=>_,Ej:()=>p,FK:()=>U,HK:()=>I,I0:()=>u,JR:()=>v,Jd:()=>G,LH:()=>$,OD:()=>T,Ox:()=>h,PE:()=>Q,RM:()=>g,SP:()=>b,WZ:()=>S,Wx:()=>O,Xk:()=>F,Z_:()=>m,dC:()=>E,hk:()=>A,kz:()=>z,q2:()=>d,rI:()=>C,xi:()=>c});var n=r(9244),s=r(3417),o=r(3890),i=r(4986),a=r(7389);const l=e=>{if(!(0,i.Bf)(e)||e<0)return null;const t=["B","KiB","MiB","GiB","TiB"];let r=e,n=0;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${n>0&&r<10?r.toFixed(1):Math.round(r).toString()} ${t[n]}`},c=(e,t)=>Number.isFinite(e)?"number"==typeof t&&t>=0?e.toFixed(t):e.toString():"";function u(e,t){return e?t(e):""}const d=e=>{const t=(0,i.Nn)(e);if(!t||!(0,o.B9)(t))return t||"";const r=t.indexOf("@");if(r<=1)return`**${t.slice(r)}`;const n=t.slice(0,r),s=t.slice(r);return`${n.slice(0,2)}****${s}`},p=(e,t,r)=>{const n=(0,i.Nn)(t);if(!n)return(0,i.Nn)(r)||"";return e("contactSupportEmail").replace(s.BY,n)},f=(e,t)=>{if(e.length>6)return"";if(!/^[0-9a-f]+$/i.test(e))return"";const r=Number.parseInt(e,t);if(!Number.isFinite(r)||r<0||r>s.g$)return"";try{return String.fromCodePoint(r)}catch{return""}},h=e=>{if(!e)return"";const t=(e=>{try{if("undefined"!=typeof DOMParser&&"function"==typeof DOMParser){const t=(new DOMParser).parseFromString(e,"text/html");return t?.body?.textContent||""}const t=document.createElement("div");return t.textContent=e,t.textContent||""}catch{}return null})(e);if(null!==t)return t.replace(/\s+/g," ").trim();const r=e.replace(/<\s*(script|style)[^>]*>[\s\S]*?<\s*\/\s*\1\s*>/gi,"").replace(/<[^>]*>/g,"");return r.replace(/&#(\d+);/g,((e,t)=>f(t,10))).replace(/&#x([\da-f]+);/gi,((e,t)=>f(t,16))).replace(s.cq,(e=>s.js[e]||e)).replace(/\s+/g," ").trim()},m=e=>{const t=(0,i.Nn)(e);if(!t)return"";return t.replace(s.N6,"").trim()||t},g=e=>e?(0,n.css)(e):void 0,y=e=>String(e).padStart(2,"0"),E=e=>{if(!e)return null;const t=e.trim();if(!t)return null;const r=t.includes("T")?t:`${t}T00:00:00`,[n="",o=""]=r.split("T"),i=s.tj.exec(n),a=s.MA.exec(o);if(!i||!a)return null;const l=Number(i[1]),c=Number(i[2]),u=Number(i[3]),d=Number(a[1]),p=Number(a[2]),f=a[3]?Number(a[3]):0;if(!(Number.isFinite(l)&&Number.isFinite(c)&&Number.isFinite(u)&&Number.isFinite(d)&&Number.isFinite(p)&&Number.isFinite(f)))return null;if(c<1||c>12)return null;if(u<1||u>31)return null;if(d<0||d>23)return null;if(p<0||p>59)return null;if(f<0||f>59)return null;const h=new Date(l,c-1,u,d,p,f,0);return h.getFullYear()!==l||h.getMonth()!==c-1||h.getDate()!==u||h.getHours()!==d||h.getMinutes()!==p||h.getSeconds()!==f||Number.isNaN(h.getTime())?null:h},v=(e,t="iso")=>{if(!e)return"";const r=e.getTime();if(Number.isNaN(r))return"";const n=e.getFullYear(),s=y(e.getMonth()+1),o=y(e.getDate()),i=y(e.getHours()),a=y(e.getMinutes()),l=y(e.getSeconds());return"fme"===t?`${n}-${s}-${o} ${i}:${a}:${l}`:`${n}-${s}-${o}T${i}:${a}:${l}`},b=(e,t,r=0,n=[])=>{if(!e)return n;for(const s of e)s&&null!=s.value&&(n.push({option:s,depth:r}),t&&s.children?.length&&b(s.children,t,r+1,n));return n},w=e=>{if(!e)return{base:"",fraction:"",offset:""};let t=e,r="";const n=s.GB.exec(t);n?.[1]&&(r=n[1],t=t.slice(0,-r.length));let o="";const i=s.BL.exec(t);return i?.[0]&&(o=i[0],t=t.slice(0,-o.length)),{base:t,fraction:o,offset:r}},S=e=>{const t=(e||"").trim();return w(t)},R=e=>{if(!e)return null;const t=Number(e);return(0,i.eF)(t)&&t<=99?y(t):null},O=e=>{const t=(e||"").replace(/\D/g,"");if(8!==t.length)return"";const r=t.slice(0,4),n=t.slice(4,6),s=t.slice(6,8),o=Number(r),i=Number(n),a=Number(s);return o<1e3||o>9999||i<1||i>12||a<1||a>31?"":`${r}-${n}-${s}`},T=e=>e?e.replace(/-/g,""):"",A=e=>{const{base:t}=S(e),r=t.replace(/\D/g,"");if(r.length<12)return"";const n=r.slice(0,4),s=r.slice(4,6),o=r.slice(6,8),i=r.slice(8,10),a=r.slice(10,12),l=r.length>=14?r.slice(12,14):"";return`${n}-${s}-${o}T${i}:${a}${l?`:${l}`:""}`},I=(e,t)=>{if(!e)return"";const r=e.trim(),[n,s]=r.split("T");if(!n||!s)return(0,a.J)("inputToFmeDateTime: Invalid ISO format",e),"";const[o,i,l]=n.split("-"),{base:c,fraction:u,offset:d}=w(s),[p,f,h]=c.split(":");if(!o||4!==o.length||!/^\d{4}$/.test(o))return(0,a.J)("inputToFmeDateTime: Invalid year",o),"";const m=R(i),g=R(l),y=R(p),E=R(f);if(!(m&&g&&y&&E))return(0,a.J)("inputToFmeDateTime: Invalid date/time components",{m:i,d:l,hh:p,mi:f}),"";const v=h?R(h):"00";if(null===v)return(0,a.J)("inputToFmeDateTime: Invalid seconds",h),"";const b=`${o}${m}${g}${y}${E}${v}`,O=t?S(t):null;return`${b}${u||O?.fraction||""}${d||O?.offset||""}`},_=e=>{const{base:t}=S(e),r=t.replace(/\D/g,"");return 4===r.length?`${r.slice(0,2)}:${r.slice(2,4)}`:r.length>=6?`${r.slice(0,2)}:${r.slice(2,4)}:${r.slice(4,6)}`:""},C=(e,t)=>{if(!e)return"";const{base:r,fraction:n,offset:s}=w(e),o=r.split(":").map((e=>e||"")),i=o[0]||"",a=o[1]||"",l=o[2]||"",c=Number(i),u=Number(a);if(!Number.isFinite(c)||!Number.isFinite(u))return"";const d=Number(l),p=Number.isFinite(d)?y(d):"00",f=`${y(c)}${y(u)}${p}`,h=t?S(t):null;return`${f}${n||h?.fraction||""}${s||h?.offset||""}`},k=(e,t,r)=>Number.isFinite(e)?Math.max(t,Math.min(r,e)):t,L=e=>k(e,0,1),M=e=>k(e,0,255),N=e=>Math.round(M(e)).toString(16).padStart(2,"0"),x=e=>Number(L(e).toFixed(6)).toString(),D=e=>x(e/255),P=(e,t,r)=>`#${N(e)}${N(t)}${N(r)}`,F=e=>{const t=/^#?([0-9a-f]{6})$/i.exec(e||""),r=t?parseInt(t[1],16):parseInt(s.Ve.slice(1),16);return[r>>16&255,r>>8&255,255&r]},j=(e,t)=>{const r=(e||"").split(",").map((e=>e.trim())).filter(Boolean).map(Number);if(!r.length)return null;if("cmyk"===t?.space||!t?.space&&!t?.alpha&&4===r.length){if(r.length<4||!r.slice(0,4).every(Number.isFinite))return null;const[e,t,n,s]=r,o=((e,t,r,n)=>{const s=L(e),o=L(t),i=L(r),a=L(n);return{r:M(255*(1-s)*(1-a)),g:M(255*(1-o)*(1-a)),b:M(255*(1-i)*(1-a))}})(e,t,n,s);return P(o.r,o.g,o.b)}if(r.length<3||!r.slice(0,3).every(Number.isFinite))return null;const[n,s,o]=r,i=M(Math.round(255*L(n))),a=M(Math.round(255*L(s))),l=M(Math.round(255*L(o)));return P(i,a,l)},U=(e,t)=>{const r=/^#?([0-9a-f]{6})$/i.exec(e||"");if(!r)return null;const n=parseInt(r[1],16),s=n>>16&255,o=n>>8&255,i=255&n;if("cmyk"===t?.space){const{c:e,m:t,y:r,k:n}=((e,t,r)=>{const n=L(e/255),s=L(t/255),o=L(r/255),i=1-Math.max(n,s,o);if(i>=.999999)return{c:0,m:0,y:0,k:1};const a=1-i;return{c:L((1-n-i)/a),m:L((1-s-i)/a),y:L((1-o-i)/a),k:L(i)}})(s,o,i);return[e,t,r,n].map(x).join(",")}return[s,o,i].map(D).join(",")},V=(e,t=!1)=>t?2:e>=100?0:e>=10?1:2,W=e=>e>=s.QC.M2_PER_KM2?{value:e/s.QC.M2_PER_KM2,label:"km\xb2",decimals:s.QC.AREA_DECIMALS}:e>=1?{value:Math.round(e),label:"m\xb2",decimals:0}:{value:Number(e.toFixed(2)),label:"m\xb2",decimals:2},B=(e,t)=>s.Pd.find((r=>((e,t)=>{if(!(0,i.Bf)(e))return!1;const r=Math.max(1e-9,1e-6*Math.abs(t));return Math.abs(e-t)<=r})(e,r.factor)||((e,t)=>t.some((t=>e.includes(t))))(t,r.keywords)))??null,q=(e,t)=>{if(!t)return W(e);const r=t.metersPerUnit;if(!(0,i.Bf)(r))return W(e);const n="string"==typeof t.unit?t.unit.toLowerCase():"",s=B(r,n);return s?((e,t,r)=>{const n=e/(t*t);if(r.largeUnit&&n>=r.largeUnit.threshold)return{value:n/r.largeUnit.factor,label:r.largeUnit.label,decimals:2};const s=V(n,r.label.includes("km\xb2")||r.label.includes("mi\xb2"));return{value:n,label:r.label,decimals:s}})(e,r,s):((e,t,r)=>{const n=e/(t*t),s=V(n),o="string"==typeof r?(e=>{if(!e)return"units\xb2";const t=e.replace(/^esri/i,"").trim();if(!t)return"units\xb2";const r=t.toLowerCase();switch(r){case"meters":return"m\xb2";case"feet":case"internationalfeet":case"ussfeet":return"ft\xb2";case"kilometers":return"km\xb2";case"miles":return"mi\xb2";case"yards":return"yd\xb2";case"inches":return"in\xb2";case"centimeters":return"cm\xb2";case"millimeters":return"mm\xb2";case"nauticalmiles":return"nm\xb2";default:return`${r}\xb2`}})(r):"units\xb2";return{value:n,label:o,decimals:s}})(e,r,t.unit)};function G(e,t,r){const n=Number.isFinite(e)&&e>0?e:0,s=q(n,r);if(!s.value||s.value<=0)return`0 ${s.label}`;return`${((e,r)=>{const n=t.intl,s=n?.formatNumber;if("function"==typeof s){const t=s(e,{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:r});return"number"==typeof t?t.toString():t}return e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:r})})(s.value,s.decimals)} ${s.label}`}const Q=e=>{if(!e)return"Unknown error";if("string"==typeof e)return e;if("number"==typeof e)return e.toString();if(e instanceof Error)return e.message||"Error object";if("object"==typeof e&&null!==e){const t=e;for(const e of["message","error","details","description"]){const r=t[e];if((0,i.YH)(r))return r.trim()}}return"Unknown error occurred"},$=(e,t="error")=>e?`${e}-${t}`:void 0,z=(e,t,r,n,s)=>{if(r)return r;const o=(0,i.P6)(e);if(o)return o;if(!t)return;return(0,i.P6)(n)||s}},1337:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 0a4 4 0 0 1 4 4v3a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2V4a4 4 0 0 1 4-4M5 7h1V4a2 2 0 1 1 4 0v3h1V4a3 3 0 0 0-6 0zm4 0V4a1 1 0 0 0-2 0v3zm3 1H4a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1M7 9h1v1h1v1H8v1h1v1H8v1H7z" clip-rule="evenodd"></path></svg>'},1618:(e,t,r)=>{"use strict";r.d(t,{Ad:()=>v,DU:()=>j,M4:()=>W,NV:()=>E,QC:()=>y,nW:()=>V,x0:()=>x});var n=r(3417),s=r(4986),o=r(1138),i=r(3314),a=r(7389);const l=(e,t)=>{if(!Array.isArray(e)||!Array.isArray(t)||e.length<2||t.length<2)return!1;const r=Math.min(e.length,t.length,2);for(let n=0;n<r;n++){const r=e[n],s=t[n];if("number"!=typeof r||"number"!=typeof s)return!1;if(!Number.isFinite(r)||!Number.isFinite(s))return!1;if(Math.abs(r-s)>1e-9)return!1}return!0},c=e=>"number"==typeof e&&Number.isFinite(e),u=e=>Array.isArray(e)&&e.length>=2&&e.length<=4&&e.every(c),d=e=>"object"==typeof e&&null!==e,p=e=>{if(!Array.isArray(e)||e.length<4)return!1;if(!e.every(u))return!1;const t=e[0],r=e[e.length-1];return l(t,r)},f=e=>{if(!d(e))return!1;const t="geometry"in e?e.geometry:e;if(!d(t))return!1;const r="rings"in t?t.rings:void 0;return Array.isArray(r)&&r.length>0&&r.every(p)},h=e=>{if("object"!=typeof e||null===e)return{};const t=e;return{wkid:"number"==typeof t.wkid?t.wkid:void 0,latestWkid:"number"==typeof t.latestWkid?t.latestWkid:void 0}},m=e=>{const t=e;if(t?.isWebMercator)return!0;const{wkid:r,latestWkid:n}=h(e);return 3857===r||3857===n},g=e=>{const t=e;if(t?.isGeographic||t?.isWGS84)return!0;const{wkid:r,latestWkid:n}=h(e);return 4326===r||4326===n},y=e=>{if(!e?.length)return[];const t=new Set,r=[];for(const o of e){if(!o||o.type!==n.QL.GEOMETRY)continue;const e=(0,s.Nn)(o.name);e&&!t.has(e)&&(t.add(e),r.push(e))}return r},E=(e,t,r,o,i,a)=>{const l=(0,s.E)(i?.aoiParamName,"AreaOfInterest"),c=((e,t)=>{if(f(e))return"geometry"in e?e.geometry:e;const r=t?.toJSON();return f(r)?r:null})(t,r);if(!c)return e;const u=(e=>{try{return JSON.stringify(e)}catch{return null}})(c);if(!u)return{...e,__aoi_error__:{message:"GEOMETRY_SERIALIZATION_FAILED",type:n.By.GEOMETRY,code:"GEOMETRY_SERIALIZATION_FAILED",severity:n.MU.ERROR,recoverable:!0,timestamp:new Date,timestampMs:Date.now()}};const d={...e,[l]:u};if(a?.length){const e=new Set;for(const t of a){if("string"!=typeof t)continue;const r=(0,s.E)(t,"");r&&r!==l&&e.add(r)}for(const t of e)d[t]=u}return d},v=e=>{void 0!==e.__aoi_error__&&delete e.__aoi_error__},b=e=>"object"==typeof e&&null!==e&&"then"in e&&"function"==typeof e.then,w=e=>"object"==typeof e&&null!==e&&"polygon"===e.type;let S,R,O,T;const A=e=>e.default??e,I=async(e,t,r)=>{if(!e)return 0;const n=e.geodesicArea;if(r&&"function"==typeof n)try{const e=await n(t,"square-meters");if(Number.isFinite(e)&&e>0)return e}catch(e){(0,a.J)("geodesicArea calculation failed, trying planar fallback",e)}const s=e.planarArea;if("function"==typeof s)try{const e=await s(t,"square-meters");if(Number.isFinite(e)&&e>0)return e}catch(e){(0,a.J)("planarArea calculation failed",e)}return 0},_=async e=>{try{const t=e?.esriConfig?.geometryServiceUrl;if("string"==typeof t&&t)return t;const r=await(async e=>{if(e?.esriConfig)return e.esriConfig;if(void 0!==T)return T;try{const[e]=await(0,i.ps9)(["esri/config"]);T=A(e)}catch{T=null}return T})(e);if(!r)return null;const n=r.geometryServiceUrl;if("string"==typeof n&&n)return n;const s=r.request?.geometryServiceUrl;if("string"==typeof s&&s)return s;const o=r.portalSelf?.helperServices?.geometry?.url||r.portalInfo?.helperServices?.geometry?.url||r.helperServices?.geometry?.url;if("string"==typeof o&&o)return o}catch{}return null},C=async e=>{if(!e)return null;try{const t=b(e)?await e:e;if(w(t))return t}catch(e){(0,a.J)("Polygon promise resolution failed",e)}return null},k=async(e,t,r,n)=>{const s=e?.[t];if("function"!=typeof s)return null;try{const e=s(r,...n);return await C(e)}catch{return null}},L=async(e,t)=>{const r=e?.spatialReference;if(!(g(r)||m(r)))return e;const n=await(async e=>{if(e?.normalizeUtils?.normalizeCentralMeridian)return e.normalizeUtils;if(void 0!==S)return S;try{const[e]=await(0,i.ps9)(["esri/geometry/support/normalizeUtils"]);S=A(e)}catch{S=null}return S})(t);if(!n?.normalizeCentralMeridian)return e;try{const t=await n.normalizeCentralMeridian([e]),r=Array.isArray(t)?t[0]:null;if(w(r)){if(r!==e){const t=e.extent,n=r.extent;t&&n&&Math.abs(t.xmin-n.xmin)>180&&(0,a.M)("[Geometry] Normalized dateline-crossing polygon",{originalExtent:t,normalizedExtent:n})}return r}}catch{}return e},M=async(e,t)=>{let r=e;return r=await L(r,t),r=await(async(e,t)=>{const r=e?.spatialReference,s=g(r)||m(r),o=g(r);let i=e;if(s){const e=[n.In,"meters"],r=await k(t?.geometryEngineAsync,"geodesicDensify",i,e)??await k(t?.geometryEngine,"geodesicDensify",i,e);r&&(i=r)}const a=[o?Math.max(n.In*n.qc,n.wF):n.In],l=await k(t?.geometryEngineAsync,"densify",i,a)??await k(t?.geometryEngine,"densify",i,a);return l&&(i=l),i})(r,t),r},N=async(e,t)=>{const r=await _(t);if(!r)return 0;const{geometryService:n,AreasAndLengthsParameters:s}=await(async()=>{if(void 0!==R&&void 0!==O)return{geometryService:R,AreasAndLengthsParameters:O};try{const[e,t]=await(0,i.ps9)(["esri/rest/geometryService","esri/rest/support/AreasAndLengthsParameters"]),r=A(e),n=A(t);if(!r||!n)return(0,a.J)("Geometry service modules returned null after unwrap"),R=null,O=null,{geometryService:null,AreasAndLengthsParameters:null};R=r,O=n}catch(e){(0,a.J)("Failed to load geometry service modules",e),R=null,O=null}return{geometryService:R,AreasAndLengthsParameters:O}})();if(!n?.areasAndLengths||"function"!=typeof n.areasAndLengths||!s)return 0;try{const t=new s({polygons:[e],areaUnit:"square-meters",lengthUnit:"meters",calculationType:"geodesic",geodesic:!0}),o=await n.areasAndLengths(r,t),i=o?.areas?.[0];if(Number.isFinite(i)&&Math.abs(i)>0)return Math.abs(i)}catch(e){(0,a.M)("Geometry service area calculation failed, using fallback",e)}return 0},x=async(e,t)=>{if(!e||"polygon"!==e.type)return 0;const r=e,s=r.rings?.reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)??0;s>n.VZ.MAX_GEOMETRY_VERTICES&&(0,a.M)("[Geometry] Processing complex polygon",{vertices:s,rings:r.rings?.length??0,estimatedProcessingTime:`${Math.round(s/n.QC.VERTICES_PER_MS_ESTIMATE)}ms`});let o=r;try{o=await M(r,t)}catch{o=r}const i=(e=>{try{if(g(e.spatialReference)||m(e.spatialReference))return!0;const t=e.toJSON?.();if(t&&"object"==typeof t){const e=t.spatialReference;return g(e)||m(e)}}catch{}return!1})(o),l=((e,t,r)=>{const n=[];return t?.geometryEngineAsync&&n.push((()=>I(t.geometryEngineAsync,e,r))),t?.geometryEngine&&n.push((()=>I(t.geometryEngine,e,r))),n})(o,t,i);for(const e of l)try{const t=await e();if(t>0)return t}catch{}const c=await N(o,t);return c>0?((0,a.M)("[Performance] Fell back to geometry service for area calculation",{polygonVertices:o.rings?.[0]?.length??0,spatialReference:o.spatialReference?.wkid}),c):0},D=async(e,t,r)=>(async(e,t,r)=>{const n=r?.simplify;if("function"==typeof n){const s=await n(e),o=await C(s);if(o){const e=r?.isSimple??t?.isSimple;if("function"!=typeof e)return o;{const t=e(o);if(b(t)?await t:t)return o}}}const s=t?.simplify;if("function"==typeof s){const r=await C(s(e));if(r){const e=t?.isSimple;if("function"!=typeof e)return r;{const t=e(r);if(b(t)?await t:t)return r}}}const o=t?.isSimple;if("function"==typeof o){const t=o(e);if(b(t)?await t:t)return e}return null})(e,t,r),P=e=>{if(!Array.isArray(e)||0===e.length)return!1;const t=e[0],r=e[e.length-1];return Boolean(t&&r&&Array.isArray(t)&&Array.isArray(r)&&t[0]===r[0]&&t[1]===r[1])},F=(e,t)=>({valid:!1,error:(0,o.r5)(e,{code:t,scope:"general"})}),j=async(e,t)=>{if(!e)return F("geometryMissingMessage","NO_GEOMETRY");if("polygon"!==e.type)return F("geometryPolygonRequired","INVALID_GEOMETRY_TYPE");if(!t?.geometryEngine&&!t?.geometryEngineAsync)return{valid:!0};try{const r=t.geometryEngine,n=t.geometryEngineAsync;let o=e;const i=await D(o,r,n);if(!i)return F("geometryNotSimple","INVALID_GEOMETRY");o=i;const a=o.rings,l=(0,s.eC)(a);if(!(e=>{if(!Array.isArray(e)||0===e.length)return!1;for(const t of e){if(!Array.isArray(t)||t.length<4)return!1;if(!P(t))return!1}return!0})(l))return F("geometryInvalidCode","GEOMETRY_INVALID");const c=await x(o,t);return!c||c<=0?F("geometryInvalidCode","GEOMETRY_INVALID"):((e,t,r,n)=>{if(e.length<=1)return!0;const s=r?.contains;if("function"!=typeof s)return!0;try{const r=n?.Polygon;if(!r)return!0;const o=r.fromJSON({rings:[e[0]],spatialReference:t.spatialReference});for(let n=1;n<e.length;n++)if(!s(o,r.fromJSON({rings:[e[n]],spatialReference:t.spatialReference})))return!1}catch{return!0}return!0})(l,o,r,t)?{valid:!0,simplified:o}:F("geometryInvalidCode","GEOMETRY_INVALID")}catch{return F("geometryValidationFailedMessage","GEOMETRY_VALIDATION_ERROR")}},U=e=>{if("number"==typeof e&&Number.isFinite(e)&&!(e<=0))return e},V=(e,t)=>{const r=Math.abs(e)||0,n=U(t?.maxArea),s=U(t?.largeArea),o="number"==typeof n&&r>n;return{area:r,maxThreshold:n,warningThreshold:s,exceedsMaximum:o,shouldWarn:!o&&"number"==typeof s&&r>s}},W=(e,t)=>{const r=U(t);return!r||e<=r?{ok:!0}:{ok:!1,message:"geometryAreaTooLargeCode",code:"AREA_TOO_LARGE"}}},1658:(e,t,r)=>{"use strict";r.d(t,{q:()=>y});var n=r(4880),s=r(9757),o=r(6261),i=r(6500),a=class extends i.Q{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const o=t.queryKey,i=t.queryHash??(0,n.F$)(o,t);let a=this.get(i);return a||(a=new s.X({client:e,queryKey:o,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(o)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){o.jG.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>(0,n.MK)(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>(0,n.MK)(e,t))):t}notify(e){o.jG.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){o.jG.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){o.jG.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},l=r(6158),c=class extends i.Q{constructor(e={}){super(),this.config=e,this.#t=new Set,this.#r=new Map,this.#n=0}#t;#r;#n;build(e,t,r){const n=new l.s({client:e,mutationCache:this,mutationId:++this.#n,options:e.defaultMutationOptions(t),state:r});return this.add(n),n}add(e){this.#t.add(e);const t=u(e);if("string"==typeof t){const r=this.#r.get(t);r?r.push(e):this.#r.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#t.delete(e)){const t=u(e);if("string"==typeof t){const r=this.#r.get(t);if(r)if(r.length>1){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}else r[0]===e&&this.#r.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=u(e);if("string"==typeof t){const r=this.#r.get(t),n=r?.find((e=>"pending"===e.state.status));return!n||n===e}return!0}runNext(e){const t=u(e);if("string"==typeof t){const r=this.#r.get(t)?.find((t=>t!==e&&t.state.isPaused));return r?.continue()??Promise.resolve()}return Promise.resolve()}clear(){o.jG.batch((()=>{this.#t.forEach((e=>{this.notify({type:"removed",mutation:e})})),this.#t.clear(),this.#r.clear()}))}getAll(){return Array.from(this.#t)}find(e){const t={exact:!0,...e};return this.getAll().find((e=>(0,n.nJ)(t,e)))}findAll(e={}){return this.getAll().filter((t=>(0,n.nJ)(e,t)))}notify(e){o.jG.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return o.jG.batch((()=>Promise.all(e.map((e=>e.continue().catch(n.lQ))))))}};function u(e){return e.options.scope?.id}var d=r(9658),p=r(6035);function f(e){return{onFetch:(t,r)=>{const s=t.options,o=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],a=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let r=!1;const u=(0,n.ZM)(t.options,t.fetchOptions),d=async(e,s,o)=>{if(r)return Promise.reject();if(null==s&&e.pages.length)return Promise.resolve(e);const i=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:s,direction:o?"backward":"forward",meta:t.options.meta};var n;return n=e,Object.defineProperty(n,"signal",{enumerable:!0,get:()=>(t.signal.aborted?r=!0:t.signal.addEventListener("abort",(()=>{r=!0})),t.signal)}),e})(),a=await u(i),{maxPages:l}=t.options,c=o?n.ZZ:n.y9;return{pages:c(e.pages,a,l),pageParams:c(e.pageParams,s,l)}};if(o&&i.length){const e="backward"===o,t={pages:i,pageParams:a},r=(e?m:h)(s,t);l=await d(t,r,e)}else{const t=e??i.length;do{const e=0===c?a[0]??s.initialPageParam:h(s,l);if(c>0&&null==e)break;l=await d(l,e),c++}while(c<t)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=u}}}function h(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function m(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var g=r(3096);const y=new class{#s;#o;#i;#a;#l;#c;#u;#d;constructor(e={}){this.#s=e.queryCache||new a,this.#o=e.mutationCache||new c,this.#i=e.defaultOptions||{},this.#a=new Map,this.#l=new Map,this.#c=0}mount(){this.#c++,1===this.#c&&(this.#u=d.m.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#s.onFocus())})),this.#d=p.t.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#s.onOnline())})))}unmount(){this.#c--,0===this.#c&&(this.#u?.(),this.#u=void 0,this.#d?.(),this.#d=void 0)}isFetching(e){return this.#s.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#o.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#s.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#s.build(this,t),s=r.state.data;return void 0===s?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime((0,n.d2)(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return this.#s.findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),o=this.#s.get(s.queryHash),i=o?.state.data,a=(0,n.Zw)(t,i);if(void 0!==a)return this.#s.build(this,s).setData(a,{...r,manual:!0})}setQueriesData(e,t,r){return o.jG.batch((()=>this.#s.findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,r)]))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#s.get(t.queryHash)?.state}removeQueries(e){const t=this.#s;o.jG.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const r=this.#s;return o.jG.batch((()=>(r.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e,t={}){const r={revert:!0,...t},s=o.jG.batch((()=>this.#s.findAll(e).map((e=>e.cancel(r)))));return Promise.all(s).then(n.lQ).catch(n.lQ)}invalidateQueries(e,t={}){return o.jG.batch((()=>(this.#s.findAll(e).forEach((e=>{e.invalidate()})),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=o.jG.batch((()=>this.#s.findAll(e).filter((e=>!e.isDisabled()&&!e.isStatic())).map((e=>{let t=e.fetch(void 0,r);return r.throwOnError||(t=t.catch(n.lQ)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(s).then(n.lQ)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const r=this.#s.build(this,t);return r.isStaleByTime((0,n.d2)(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(n.lQ).catch(n.lQ)}fetchInfiniteQuery(e){return e.behavior=f(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(n.lQ).catch(n.lQ)}ensureInfiniteQueryData(e){return e.behavior=f(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return p.t.isOnline()?this.#o.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#s}getMutationCache(){return this.#o}getDefaultOptions(){return this.#i}setDefaultOptions(e){this.#i=e}setQueryDefaults(e,t){this.#a.set((0,n.EN)(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#a.values()],r={};return t.forEach((t=>{(0,n.Cp)(e,t.queryKey)&&Object.assign(r,t.defaultOptions)})),r}setMutationDefaults(e,t){this.#l.set((0,n.EN)(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#l.values()],r={};return t.forEach((t=>{(0,n.Cp)(e,t.mutationKey)&&Object.assign(r,t.defaultOptions)})),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#i.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=(0,n.F$)(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===n.hT&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#i.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#s.clear(),this.#o.clear()}}({defaultOptions:{queries:{staleTime:g.ST.FIVE_MINUTES,gcTime:g.ST.TEN_MINUTES,retry:(e,t)=>{const r=t?.status||t?.response?.status;return r!==g.jL.UNAUTHORIZED&&r!==g.jL.FORBIDDEN&&(!(r&&r>=g.H4.CLIENT_ERROR_MIN&&r<g.H4.SERVER_ERROR_MIN)&&e<g.WC.MAX_RETRY_ATTEMPTS)},refetchOnWindowFocus:!1,refetchOnReconnect:!1}}})},1692:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(2775),s=r(4880),o=class{#p;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,s.gn)(this.gcTime)&&(this.#p=n.zs.setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(s.S$?1/0:3e5))}clearGcTimeout(){this.#p&&(n.zs.clearTimeout(this.#p),this.#p=void 0)}}},1787:(e,t,r)=>{"use strict";r.d(t,{DF:()=>g,fW:()=>j,CY:()=>V,JV:()=>x,G1:()=>U,MB:()=>_,Ou:()=>W.setupFmeDebugTools,c2:()=>W.updateFmeDebugTools});class n{constructor(){this.cache=new Map}async execute(e,t){const r=this.cache.get(e);if(r)return r;const n=t();return this.cache.set(e,n),n.finally((()=>{this.cache.delete(e)}))}}const s={healthCheck:new n,validateConnection:new n};var o=r(3096),i=r(3314),a=r(3890);const l=e=>"object"!=typeof e||null===e||Array.isArray(e)?null:e,c=(e,t)=>{let r=e;for(const e of t){if("object"!=typeof r||null===r)return;r=r[e]}return r},u=e=>o.o0.some((t=>e.toLowerCase().includes(t.toLowerCase())));function d(e){if(!e)return"";const t=l(e),r=t?.data??e,n=l(r),s=n?.status,i=n?.version,a=n?.build;if("string"==typeof s&&"ok"===s&&!(null!=i&&""!==i)&&!(null!=a&&""!==a))return"";const u=/\bFME\s+(?:Flow|Server)\s+(\d{4}(?:\.\d+)?)\b/i,d=/\b(\d+\.\d+(?:\.\d+)?|20\d{2}(?:\.\d+)?)\b/,p=["version","fmeVersion","fmeflowVersion","app.version","about.version","server.version","edition","build","productName","product","name","message"];for(const e of p){const t=e.includes(".")?c(n,e.split(".")):n?n[e]:void 0;if("string"==typeof t){const e=t.match(u);if(e)return e[1];const r=t.match(d);if(r)return r[1]}if("number"==typeof t&&Number.isFinite(t)){if(t>=o.aP.MIN_YEAR&&t<o.aP.MAX_YEAR)return String(t);if(t>0&&t<o.aP.MAX_MINOR_VERSION)return String(t)}}try{const e=(f=r,Array.isArray(f)?f:"object"==typeof f&&null!==f?Object.values(f):"string"==typeof f?[f]:[]);for(const t of e)if("string"==typeof t){const e=t.match(u);if(e)return e[1];const r=t.match(d);if(r)return r[1]}if("string"==typeof r){const e=r.match(u);if(e)return e[1];const t=r.match(d);if(t)return t[1]}}catch{}var f;return""}async function p(e,t,r){const n=`${e}|${t}`;return(0,a.dC)(e).ok?await s.healthCheck.execute(n,(async()=>{const n=Date.now();try{const s=(0,i.MbC)(e,t),a=await s.testConnection(r),l=Date.now()-n,c=Number.isFinite(l)&&l>=0&&l<o.ST.MAX_RESPONSE_TIME?l:l<0?0:o.ST.MAX_RESPONSE_TIME;return{reachable:!0,version:d(a),responseTime:c}}catch(t){const r=Date.now()-n,l=Number.isFinite(r)&&r>=0&&r<o.ST.MAX_RESPONSE_TIME?r:r<0?0:o.ST.MAX_RESPONSE_TIME,c=(0,a.Ko)(t),u=(0,i.PEb)(t);if(c===o.jL.UNAUTHORIZED||c===o.jL.FORBIDDEN){if(s=u,o.K2.some((e=>s.toLowerCase().includes(e.toLowerCase())))){if(!(0,a.dC)(e,{strict:!0}).ok)return{reachable:!1,responseTime:l,error:"invalidUrl",status:c}}return{reachable:!0,responseTime:l,error:u,status:c}}return{reachable:!1,responseTime:l,error:u,status:c}}var s})):{reachable:!1,responseTime:0,error:"invalidUrl",status:0}}var f=r(3417),h=r(7389),m=r(2779);class g{constructor(){this.metadataCache=new WeakMap,this.optionsCache=new WeakMap,this.fieldCache=new WeakMap,this.scriptedNodesCache=new WeakMap,this.separatorRegexCache=new Map}deepFreeze(e){if(Array.isArray(e))return e.forEach((e=>this.deepFreeze(e))),Object.freeze(e),e;if(e&&"object"==typeof e&&(0,i.QdQ)(e)){const t=e;return Object.keys(t).forEach((e=>{this.deepFreeze(t[e])})),Object.freeze(t),e}return e}getSeparatorRegex(e){const t=(e?e.slice(0,f.uV):"|")||"|",r=this.separatorRegexCache.get(t);if(r)return{regex:r,usedFallback:r===f.wq&&"|"!==t,key:t};const n=`[${(0,m.yK)(t)}]`,s=(0,m.rH)(n,"",{maxLength:n.length+2})||f.wq;return this.separatorRegexCache.set(t,s),{regex:s,usedFallback:s===f.wq&&"|"!==t,key:t}}getOptionsForParameter(e){const t=this.optionsCache.get(e);if(t)return t;const r=this.mapListOptions(e),n=r?this.deepFreeze(r):void 0;return this.optionsCache.set(e,n),n}isRenderableParam(e){if(!e||"string"!=typeof e.name)return!1;if(f.oh.has(e.name))return!1;if(f.vN.has(e.type))return!1;if(f.np.has(e.type)){const t=e.control&&(0,i.QdQ)(e.control)?e.control.choiceSettings:void 0,r=t&&(0,i.QdQ)(t)?t.choices:void 0;return r&&Array.isArray(r)&&r.length>0||null!==e.defaultValue&&void 0!==e.defaultValue&&""!==e.defaultValue}return!0}getRenderableParameters(e){return e.filter((e=>this.isRenderableParam(e)))}mapListOptions(e){const t=e,r=t.choiceSettings;if(!r||!Array.isArray(r.choices))return;const n=t.nodeDelimiter,s=e.type===f.QL.tree;return r.choices.map((e=>{const t=e.value??e.id??e.code,r=(0,i.sLt)(t),o=e.display??e.caption??e.label??e.name,a=(0,i.P6s)(o,String(r)),l=s&&n&&"string"==typeof o?o:"string"==typeof e.path&&e.path?e.path:void 0;return{label:a,value:r,...e.description&&{description:e.description},...l&&{path:l},...e.disabled&&{disabled:!0},...e.metadata&&{metadata:e.metadata}}}))}extractToggleMetaValue(e,t){if(e)for(const r of t){if(!(r in e))continue;const t=(0,i.psb)(e[r]);if(void 0!==t)return t}}getDecimalPrecision(e){const t=e.decimalPrecision;if("number"!=typeof t||!Number.isFinite(t)||t<0)return;const r=Math.floor(t);return r>=0?Math.min(r,6):void 0}getSliderMeta(e,t,r){const n="boolean"==typeof e.minimumExclusive&&e.minimumExclusive,s="boolean"==typeof e.maximumExclusive&&e.maximumExclusive;if(e.type!==f.QL.RANGE_SLIDER)return{min:"number"==typeof e.minimum?e.minimum:void 0,max:"number"==typeof e.maximum?e.maximum:void 0,minExclusive:n,maxExclusive:s};const o="number"==typeof e.minimum,i="number"==typeof e.maximum,a="number"==typeof t&&t>=0?Math.floor(t):void 0,l=o?e.minimum:r?0:void 0,c=i?e.maximum:r?100:void 0;let u;return void 0!==a?u=a>0?Number(`0.${"0".repeat(a-1)}1`):1:r&&(u=1),{min:l,max:c,step:u,minExclusive:n,maxExclusive:s}}shouldUseRangeSliderUi(e){if(e.type!==f.QL.RANGE_SLIDER)return!1;if(e.control&&"object"==typeof e.control){const t=e.control;if("boolean"==typeof t.useRangeSlider)return t.useRangeSlider;if("boolean"==typeof t.useSlider)return t.useSlider}const t=(e.description||"").toLowerCase();return!f.xH.some((e=>t.includes(e)))}getParameterMetadata(e){const t=this.metadataCache.get(e);if(t)return t;const r=(0,i.QdQ)(e.defaultValue)?e.defaultValue:void 0,n=(0,i.W1g)([e.metadata,e.attributes,e.definition,e.control,e.schema,e.ui,e.extra,r])||{},s=this.deepFreeze(n);return this.metadataCache.set(e,s),s}normalizeOptionItem(e,t){if(null==e)return null;if((0,i.w$k)(e)){const t=(0,i.sLt)(e);return{label:String(t),value:t,isLeaf:!0}}if(!(0,i.QdQ)(e))return null;const r=e,n=(0,i.XlQ)(r,["caption","label","name","title","displayName"])??`Option ${t+1}`,s=r.value??r.id??r.code??r.path??r.name??r.key??n??t,o=(0,i.sLt)(s),a=(0,i.vqZ)(r.children),l=a?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));return{label:n,value:o,...(0,i.XlQ)(r,["description","detail","tooltip","hint","helper"])&&{description:(0,i.XlQ)(r,["description","detail","tooltip","hint","helper"])},...(0,i.XlQ)(r,["path","fullPath","groupPath","folder"])&&{path:(0,i.XlQ)(r,["path","fullPath","groupPath","folder"])},...(!0===r.disabled||!0===r.readOnly||!1===r.selectable)&&{disabled:!0},...l?.length&&{children:l},...(0,i.ITI)(r)&&{metadata:(0,i.ITI)(r)},...l?.length?{}:{isLeaf:!0}}}collectMetaOptions(e){const t=["options","items","values","choices","entries","list","records","data","nodes","children"];for(const r of t){const t=(0,i.vqZ)(e[r]);if(!t?.length)continue;const n=t.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));if(n.length)return n}}extractScriptedOptions(e,t){const r=this.getParameterMetadata(e),n=this.collectMetaOptions(r);return n?.length?n:t}buildScriptedNodes(e,t){if(!e?.length)return;const r=t||"/";let n=this.scriptedNodesCache.get(e);if(n||(n=new Map,this.scriptedNodesCache.set(e,n)),n.has(r))return n.get(r);const s=this.buildScriptedNodeTree(e,r);return n.set(r,s),s}buildScriptedNodeTree(e,t){return e.some((e=>e.children&&e.children.length>0))?this.buildNodesFromHierarchy(e,t):this.buildNodesFromPaths(e,t)}buildNodesFromHierarchy(e,t){const r=(e,n)=>{const s=e.path?e.path.split(t).map((e=>e.trim())).filter(Boolean):n?[...n,e.label]:[e.label],o=e.metadata&&"string"==typeof e.metadata.id&&e.metadata.id||(null!=e.value?String(e.value):s.join("|")),i=e.children?.length?e.children.map((e=>r(e,s))):void 0;return{id:o,label:e.label,path:s,...void 0!==e.value?{value:e.value}:{},...e.disabled?{disabled:!0}:{},...e.metadata?{metadata:e.metadata}:{},...i&&i.length?{children:i}:{isLeaf:!0}}};return e.map((e=>r(e,void 0)))}buildNodesFromPaths(e,t){const{regex:r,usedFallback:n,key:s}=this.getSeparatorRegex(t);n&&(0,h.J)("ParameterFormService: Using fallback path separator",{separatorLength:s.length});const o=[],i=new Map,a=(e,t)=>{const r=e.join("|")||(t?String(t.value):"root"),n=i.get(r);if(n)return n;const s={id:r,label:e[e.length-1]||t?.label||r,path:[...e],children:[]};if(i.set(r,s),e.length>1){const t=e.slice(0,-1);a(t).children.push(s)}else o.push(s);return s};for(const t of e){const e=t.path?t.path.split(r).map((e=>e.trim())).filter(Boolean):[t.label],n=a(e,t);n.value=t.value,t.metadata&&(n.metadata={...n.metadata||{},...t.metadata}),t.disabled&&(n.disabled=!0),t.description&&(n.metadata={...n.metadata||{},description:t.description})}const l=e=>{const t=e.children.map((e=>l(e)));return{id:e.id,label:e.label,path:e.path,...void 0!==e.value?{value:e.value}:{},...e.disabled?{disabled:!0}:{},...e.metadata?{metadata:e.metadata}:{},...t.length?{children:t}:{isLeaf:!0}}};return o.map((e=>l(e)))}deriveTableConfig(e){const t=this.getParameterMetadata(e),r=(0,i.vqZ)(t.columns)??(0,i.vqZ)(t.fields)??(0,i.vqZ)(t.tableColumns)??(0,i.vqZ)(t.schema);if(!r?.length)return;const n=r.map(((e,t)=>this.normalizeTableColumn(e,t))).filter((e=>null!=e)),s=this.validateTableColumns(n);if(!s.length)return;const o=(0,i.hUO)(t,["minRows","minimumRows","minRowCount"]),a=(0,i.hUO)(t,["maxRows","maximumRows","maxRowCount"]),l=this.normalizeRowBounds(o,a);return{columns:s,...void 0!==l.minRows&&{minRows:l.minRows},...void 0!==l.maxRows&&{maxRows:l.maxRows},...(0,i.XlQ)(t,["addRowLabel","addLabel"])&&{addRowLabel:(0,i.XlQ)(t,["addRowLabel","addLabel"])},...(0,i.XlQ)(t,["removeRowLabel","removeLabel"])&&{removeRowLabel:(0,i.XlQ)(t,["removeRowLabel","removeLabel"])},...(0,i.XlQ)(t,["helper","helperText","instructions"])&&{helperText:(0,i.XlQ)(t,["helper","helperText","instructions"])},...(0,i.CqL)(t,["allowReorder","reorder"],!1)&&{allowReorder:!0},...(0,i.CqL)(t,["showHeader","displayHeader"],!0)&&{showHeader:!0}}}validateTableColumns(e){if(!e?.length)return[];const t=new Set,r=[];for(const n of e)n?.key&&(t.has(n.key)||("select"!==n.type||n.options&&0!==n.options.length)&&(r.push(n),t.add(n.key)));return r}normalizeRowBounds(e,t){const r="number"==typeof e&&(0,i.eF2)(e)?Math.floor(e):void 0;let n="number"==typeof t&&(0,i.eF2)(t)?Math.floor(t):void 0;return void 0!==r&&void 0!==n&&r>n&&(n=r),{minRows:r,maxRows:n}}normalizeTableColumn(e,t){if(!(0,i.QdQ)(e))return null;const r=e,n=(0,i.XlQ)(r,["key","name","field","id"])??`column_${t}`,s=(0,i.XlQ)(r,["label","title","caption","name"])??n,o=(0,i.XlQ)(r,["type","inputType","fieldType"]),a=o?{text:"text",string:"text",number:"number",numeric:"number",float:"number",integer:"number",select:"select",choice:"select",dropdown:"select",list:"select",boolean:"boolean",checkbox:"boolean",date:"date",time:"time",datetime:"datetime","date-time":"datetime"}[o.toLowerCase()]:void 0,l=(0,i.vqZ)(r.options)??(0,i.vqZ)(r.choices)??(0,i.vqZ)(r.values),c=l?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e));return{key:n,label:s,...a&&{type:a},...(0,i.CqL)(r,["required","isRequired"],!1)&&{required:!0},...(0,i.CqL)(r,["readOnly","readonly"],!1)&&{readOnly:!0},...(0,i.XlQ)(r,["placeholder","prompt"])&&{placeholder:(0,i.XlQ)(r,["placeholder","prompt"])},...void 0!==(0,i.hUO)(r,["min","minimum"])&&{min:(0,i.hUO)(r,["min","minimum"])},...void 0!==(0,i.hUO)(r,["max","maximum"])&&{max:(0,i.hUO)(r,["max","maximum"])},...void 0!==(0,i.hUO)(r,["step","increment"])&&{step:(0,i.hUO)(r,["step","increment"])},...(0,i.XlQ)(r,["pattern","regex"])&&{pattern:(0,i.XlQ)(r,["pattern","regex"])},...c?.length&&{options:c},...(0,i.XlQ)(r,["description","detail","helper","hint"])&&{description:(0,i.XlQ)(r,["description","detail","helper","hint"])},...void 0!==r.defaultValue&&{defaultValue:r.defaultValue},...void 0!==r.width&&{width:r.width}}}deriveScriptedConfig(e,t){if(e.type!==f.QL.SCRIPTED)return;const r=this.getParameterMetadata(e),n=this.extractScriptedOptions(e,t),s=e,o=("string"==typeof s.nodeDelimiter?s.nodeDelimiter:void 0)||("string"==typeof s.delimiter?s.delimiter:void 0)||(0,i.XlQ)(r,["breadcrumbSeparator","pathSeparator","delimiter"])||"/",a=this.buildScriptedNodes(n,o),l=(0,i.CqL)(r,["allowMultiple","multiple","multiSelect","supportsMultiple"],Array.isArray(e.defaultValue)),c=(0,i.CqL)(r,["allowManualEntry","allowManual","allowCustom","allowFreeform"],!1),u=(0,i.CqL)(r,["allowSearch","searchable","enableSearch","supportsSearch"],(n?.length??0)>15),d=(0,i.hUO)(r,["pageSize","page_size","limit","pageLimit"]),p=(0,i.XlQ)(r,["instructions","instruction","helper","hint"])||(0,i.NnH)(e.description),h=(0,i.XlQ)(r,["searchPlaceholder","searchLabel","searchPrompt"]),m=(0,i.CqL)(r,["autoSelectSingleLeaf","autoSelectSingle","autoSelect"],!0),g=(0,i.XlQ)(r,["maxResultsHint","resultsHint","resultsMessage"]);return{allowMultiple:l,allowSearch:u,hierarchical:Boolean(a?.some((e=>e.children&&e.children.length>0))),allowManualEntry:c,searchPlaceholder:h,instructions:p,breadcrumbSeparator:o,pageSize:d,maxResultsHint:g,autoSelectSingleLeaf:m,nodes:a}}deriveDateTimeConfig(e){if(![f.QL.DATE_TIME,f.QL.DATETIME,f.QL.TIME].includes(e.type))return;const t=this.getParameterMetadata(e),r=(0,i.CqL)(t,["includeSeconds","showSeconds","seconds"],!0),n="string"==typeof e.defaultValue?e.defaultValue:void 0,s=n?(0,i.WZF)(n):{fraction:"",offset:"",base:""},o=(0,i.CqL)(t,["includeMilliseconds","milliseconds","fractional"],!1)||s.fraction&&s.fraction.length>1,a=(0,i.vqZ)(t.timezones)??(0,i.vqZ)(t.timezoneOptions),l=a?.map(((e,t)=>this.normalizeOptionItem(e,t))).filter((e=>null!=e)),c=(0,i.XlQ)(t,["defaultTimezone","timezoneDefault"])||(0,i.XlQ)(t,["timezoneOffset","defaultOffset"])||s.offset||void 0,u=(0,i.XlQ)(t,["timezoneMode","timezone","tzMode"]),d="fixed"===u||"select"===u?u:l?.length?"select":s.offset||"offset"===u?"offset":void 0;return{includeSeconds:r,includeMilliseconds:o,...d&&{timezoneMode:d},...s.offset&&{timezoneOffset:s.offset},...l?.length&&{timezoneOptions:l},...c&&{defaultTimezone:c},...(0,i.XlQ)(t,["helper","hint","instructions"])&&{helperText:(0,i.XlQ)(t,["helper","hint","instructions"])},showTimezoneBadge:Boolean(s.offset)}}deriveSelectConfig(e,t,r){if(!new Set([f.Vw.SELECT,f.Vw.MULTI_SELECT,f.Vw.COORDSYS,f.Vw.ATTRIBUTE_NAME,f.Vw.ATTRIBUTE_LIST,f.Vw.DB_CONNECTION,f.Vw.WEB_CONNECTION,f.Vw.REPROJECTION_FILE]).has(e))return;const n=this.getParameterMetadata(t),s=t.type===f.QL.tree,o=Boolean(r?.some((e=>e.path||e.children&&e.children.length>0))),a=(0,i.CqL)(n,["hierarchical","tree","grouped","nested"],s||o),l=(0,i.CqL)(n,["allowSearch","searchable","enableSearch"],(r?.length??0)>25),c=(0,i.CqL)(n,["allowCustomValues","allowCustom","allowManual","allowFreeform"],!1),u=(0,i.hUO)(n,["pageSize","page_size","limit","pageLimit"]),d=(0,i.XlQ)(n,["instructions","hint","helper"]);return l||c||u||d||a?{allowSearch:l,allowCustomValues:c,hierarchical:a,...u&&{pageSize:u},...d&&{instructions:d}}:void 0}deriveFileConfig(e,t){if(!new Set([f.Vw.FILE,f.Vw.TEXT_OR_FILE,f.Vw.REPROJECTION_FILE]).has(e))return;const r=this.getParameterMetadata(t),n=r.accept??r.accepted??r.extensions,s=(()=>{if(n){if(Array.isArray(n)){const e=n.map((e=>(0,i.NnH)(e))).filter((e=>Boolean(e)));return e.length?e:void 0}if("string"==typeof n){const e=n.split(/[,;\s]+/).map((e=>e.trim())).filter(Boolean);return e.length?e:void 0}}})(),o=(0,i.hUO)(r,["maxSizeMb","maxSize","fileSizeMb","maxUploadMb"]),a=(0,i.CqL)(r,["allowMultiple","multiple","multi"],!1),l=(0,i.XlQ)(r,["helper","hint","instructions"]),c=(0,i.XlQ)(r,["capture","captureMode"]);return s||o||a||l||c?{...s&&{accept:s},...void 0!==o&&{maxSizeMb:o},...a&&{multiple:!0},...l&&{helperText:l},...c&&{capture:c}}:void 0}extractChoiceSetConfig(e){if(!e||!e.choiceSet)return;const t=e.choiceSet,r=t.type;if(r)switch(r){case"attributeNames":return{type:"attributeNames",...t};case"coordinateSystems":return{type:"coordinateSystems",...t};case"dbConnections":return{type:"dbConnections",...t};case"webConnections":return{type:"webConnections",...t}}}parseToggleOptionEntries(e){return Array.isArray(e)?e.map((e=>({value:(0,i.psb)(e?.value),label:(0,i.NnH)(e?.label)??void 0}))).filter((e=>void 0!==e.value||e.label)):[]}resolveToggleOptionsFromEntries(e,t,r){let n=this.extractToggleMetaValue(r,["checkedValue","checked_value","trueValue","true_value","onValue","on_value","yesValue","yes_value"]),s=this.extractToggleMetaValue(r,["uncheckedValue","unchecked_value","falseValue","false_value","offValue","off_value","noValue","no_value"]);if(2===e.length){const[r,o]=e;if(void 0!==t&&void 0===s&&(void 0!==r.value&&(0,i.$Xq)(r.value,t)?(s=r.value,void 0===n&&void 0!==o.value&&(n=o.value)):void 0!==o.value&&(0,i.$Xq)(o.value,t)&&(s=o.value,void 0===n&&void 0!==r.value&&(n=r.value))),void 0===n){const e=r.value??o.value;void 0!==e&&(n=e)}if(void 0===s){const e=o.value??r.value;void 0!==e&&void 0!==n&&(0,i.$Xq)(e,n)&&void 0!==r.value&&!(0,i.$Xq)(r.value,n)?s=r.value:void 0!==e&&(s=e)}}else 1===e.length&&void 0===n&&void 0!==e[0].value&&(n=e[0].value);return{checkedValue:n,uncheckedValue:s}}applyToggleDefaults(e,t,r,n){let s=e,o=t;return void 0!==n&&(void 0===s&&n&&(s=(0,i.psb)(!0)),void 0!==o||n||(o=(0,i.psb)(!1))),void 0===o&&void 0!==r&&(o=r),void 0!==s&&void 0!==o&&(0,i.$Xq)(s,o)&&(o=void 0),{checkedValue:s,uncheckedValue:o}}extractToggleLabels(e,t,r,n){return{checkedLabel:(0,i.XlQ)(e,["checkedLabel","checked_caption","checkedText","checked_label","trueLabel"])||t.find((e=>e.label&&void 0!==r&&void 0!==e.value&&(0,i.$Xq)(e.value,r)))?.label,uncheckedLabel:(0,i.XlQ)(e,["uncheckedLabel","unchecked_caption","uncheckedText","unchecked_label","falseLabel"])||t.find((e=>e.label&&void 0!==n&&void 0!==e.value&&(0,i.$Xq)(e.value,n)))?.label}}deriveToggleConfig(e,t,r){if(e!==f.Vw.SWITCH&&e!==f.Vw.CHECKBOX)return;const n=this.getParameterMetadata(t),s=(0,i.psb)(t.defaultValue),o=(0,i.Dr1)(t.defaultValue),a=this.parseToggleOptionEntries(r);let{checkedValue:l,uncheckedValue:c}=this.resolveToggleOptionsFromEntries(a,s,n);const u=this.applyToggleDefaults(l,c,s,o);l=u.checkedValue,c=u.uncheckedValue;const{checkedLabel:d,uncheckedLabel:p}=this.extractToggleLabels(n,a,l,c),h={...void 0!==l&&{checkedValue:l},...void 0!==c&&{uncheckedValue:c},...d&&{checkedLabel:d},...p&&{uncheckedLabel:p}};return Object.keys(h).length?h:void 0}deriveColorConfig(e){if(e.type!==f.QL.COLOR&&e.type!==f.QL.COLOR_PICK)return;const t=this.getParameterMetadata(e),r=(0,i.XlQ)(t,["colorSpace","colourSpace","space","colorModel","colourModel"]),n=r?(0,i.QKA)(r):void 0;let s;if("cmyk"===n?s="cmyk":"rgb"===n&&(s="rgb"),!s){const t=("string"==typeof e.defaultValue?e.defaultValue:"").split(",").map((e=>e.trim())).filter(Boolean);s||(4===t.length?s="cmyk":3===t.length&&(s="rgb"))}const o=(0,i.CqL)(t,["alpha","allowAlpha","hasAlpha","supportsAlpha","includeAlpha"],!1);return s||o?{...s&&{space:s},...o&&{alpha:!0}}:void 0}validateParameters(e,t){const r=[],n=this.getRenderableParameters(t);for(const t of n){if(t.type===f.QL.GEOMETRY)continue;const n=e[t.name];if(!t.optional&&(0,i.Ime)(n))r.push(`${t.name}:required`);else if(!(0,i.Ime)(n)){const e=(0,a.ut)(t.type,t.name,n);if(e){r.push(e);continue}const s=t.control&&(0,i.QdQ)(t.control)?t.control.choiceSettings:void 0,o=s&&(0,i.QdQ)(s)?s.choices:void 0,l=(0,i.uAi)(Array.isArray(o)?o:void 0),c=(0,a.sW)(t.name,n,l,f.d8.has(t.type));c&&r.push(c)}}return{isValid:0===r.length,errors:r}}parseConditionClause(e){const t=this.parseVisibilityState(e.then);if(!t)return null;const r=Object.keys(e).filter((e=>e.startsWith("$")));if(0===r.length)return{then:t};const n={then:t};for(const t of r)n[t]=e[t];return n}buildVisibilityExpression(e,t){const r=(0,i.QdQ)(t)?this.parseVisibilityState(t.value):void 0;return{if:e,...r&&{default:{value:r,override:(0,i.CqL)(t,["override"],!1)}}}}deriveVisibilityConfig(e){const t=this.getParameterMetadata(e).visibility;if(!(0,i.QdQ)(t))return;const r=t,n=(0,i.vqZ)(r.if);if(!n?.length)return;const s=[];for(const e of n){if(!(0,i.QdQ)(e))continue;const t=e,r=this.parseConditionClause(t);r&&s.push(r)}return s.length?this.buildVisibilityExpression(s,r.default):void 0}parseVisibilityState(e){if("string"!=typeof e)return;switch((0,i.QKA)(e)){case"visibleenabled":case"visible_enabled":return"visibleEnabled";case"visibledisabled":case"visible_disabled":return"visibleDisabled";case"hiddenenabled":case"hidden_enabled":return"hiddenEnabled";case"hiddendisabled":case"hidden_disabled":return"hiddenDisabled";default:return}}convertParametersToFields(e){if(!e?.length)return[];const t=this.getRenderableParameters(e);if(!t.length)return[];const r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=this.getFieldConfig(t[e]);return r}getFieldConfig(e){const t=this.fieldCache.get(e);if(t)return t;const r=this.buildFieldConfig(e),n=this.deepFreeze(r);return this.fieldCache.set(e,n),n}buildFieldConfig(e){const t=this.getFieldType(e),r=this.getDecimalPrecision(e),n=e.type===f.QL.RANGE_SLIDER&&this.shouldUseRangeSliderUi(e),s=e.type!==f.QL.RANGE_SLIDER||n?t:f.Vw.NUMERIC_INPUT,o=this.getOptionsForParameter(e),a=this.deriveScriptedConfig(e,o),l=this.deriveTableConfig(e),c=this.deriveDateTimeConfig(e),u=this.deriveSelectConfig(s,e,o),d=this.deriveFileConfig(s,e),p=this.deriveColorConfig(e),h=this.deriveToggleConfig(s,e,o),m=this.deriveVisibilityConfig(e),g=this.extractChoiceSetConfig(e),y=this.isReadOnlyField(s,a),E=a?.instructions??l?.helperText??c?.helperText??d?.helperText??u?.instructions,{min:v,max:b,step:w,minExclusive:S,maxExclusive:R}=this.getSliderMeta(e,r,n),O=(()=>{if(s===f.Vw.PASSWORD)return"";if(e.type===f.QL.GEOMETRY)return"";if(s===f.Vw.MULTI_SELECT)return(0,i.$rL)(e.defaultValue);if((s===f.Vw.SWITCH||s===f.Vw.CHECKBOX)&&h){const t=(0,i.psb)(e.defaultValue);if(void 0!==t&&void 0!==h.checkedValue&&(0,i.$Xq)(t,h.checkedValue))return h.checkedValue;if(void 0!==t&&void 0!==h.uncheckedValue&&(0,i.$Xq)(t,h.uncheckedValue))return h.uncheckedValue;const r=(0,i.Dr1)(e.defaultValue);if(void 0!==r){if(r&&void 0!==h.checkedValue)return h.checkedValue;if(!r&&void 0!==h.uncheckedValue)return h.uncheckedValue}if(void 0!==t)return t;if(void 0!==h.uncheckedValue)return h.uncheckedValue;if(void 0!==h.checkedValue)return h.checkedValue}return e.defaultValue})(),T=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.prompt:void 0;return{name:e.name,label:(0,i.wKo)(T)||e.description||e.name,type:s,required:!e.optional,readOnly:y,description:(0,i.wKo)(T)||e.description,defaultValue:O,placeholder:(0,i.wKo)(T)||e.description||"",...o?.length&&{options:o},...e.type===f.QL.TEXT_EDIT&&{rows:3},...(void 0!==v||void 0!==b||void 0!==w)&&{min:v,max:b,step:w},...(s===f.Vw.SLIDER||s===f.Vw.NUMERIC_INPUT)&&void 0!==r&&{decimalPrecision:r},...(s===f.Vw.SLIDER||s===f.Vw.NUMERIC_INPUT)&&void 0!==S&&{minExclusive:S},...(s===f.Vw.SLIDER||s===f.Vw.NUMERIC_INPUT)&&void 0!==R&&{maxExclusive:R},...E&&{helper:E},...a&&{scripted:a},...l&&{tableConfig:l},...c&&{dateTimeConfig:c},...u&&{selectConfig:u},...d&&{fileConfig:d},...p&&{colorConfig:p},...h&&{toggleConfig:h},...g&&{choiceSetConfig:g},...m&&{visibility:m}}}getFieldType(e){if(f.d8.has(e.type))return f.Vw.MULTI_SELECT;const t=e.control&&(0,i.QdQ)(e.control)?e.control.choiceSettings:void 0,r=t&&(0,i.QdQ)(t)?t.choices:void 0;if(r&&Array.isArray(r)&&r.length>0){return Array.isArray(e.defaultValue)?f.Vw.MULTI_SELECT:f.Vw.SELECT}const n=f.xA[e.type];if(n)return n;if(e.type===f.QL.text||e.type===f.QL.TEXT){const t=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.editor:void 0,r=(0,i.wKo)(t);if("plaintext"===r)return f.Vw.TEXTAREA;if("url"===r)return f.Vw.URL;const n=e.attributes&&(0,i.QdQ)(e.attributes)?e.attributes.valueType:void 0;if("stringEncoded"===(0,i.wKo)(n))return f.Vw.TEXTAREA}return f.Vw.TEXT}isReadOnlyField(e,t){if(e===f.Vw.MESSAGE||e===f.Vw.GEOMETRY)return!0;if(e===f.Vw.SCRIPTED){return!Boolean(t?.allowManualEntry||t?.nodes&&t.nodes.length>0)}return!1}validateFormValues(e,t){if(!e||!t?.length)return{isValid:!0,errors:{}};const r={};for(const n of t){const t=n.visibilityState;if(t&&"visibleEnabled"!==t)continue;const s=e[n.name],o=!(0,i.Ime)(s);if(n.type!==f.Vw.GEOMETRY)if(n.type!==f.Vw.TEXT_OR_FILE){if(n.required&&!o)r[n.name]="";else if(o&&(n.type===f.Vw.NUMBER||n.type===f.Vw.NUMERIC_INPUT)&&!(0,i.BfI)(s)&&!(0,i.P3$)(s)){r[n.name]="";continue}if(o&&(n.type===f.Vw.NUMBER||n.type===f.Vw.NUMERIC_INPUT||n.type===f.Vw.SLIDER)){const e=Number(s);if(!Number.isFinite(e)){r[n.name]="";continue}if("number"==typeof n.min){if(n.minExclusive?e<=n.min:e<n.min){r[n.name]="";continue}}if("number"==typeof n.max){if(n.maxExclusive?e>=n.max:e>n.max){r[n.name]="";continue}}}if(o&&n.type===f.Vw.NUMERIC_INPUT&&"number"==typeof n.decimalPrecision&&n.decimalPrecision>=0&&Number.isFinite(Number(s))){const e=Number(s),t=Math.pow(10,n.decimalPrecision);if(Number.isFinite(t)){const s=e*t,o=Math.round(s);Math.abs(s-o)>Number.EPSILON&&(r[n.name]="")}else r[n.name]=""}}else{const e=s,t=(0,i.YH$)(e?.text),o=(0,i.E$q)(e?.file);!n.required||t||o||(r[n.name]="")}}return{isValid:0===Object.keys(r).length,errors:r}}}var y=r(1138);const E=(e,t="aborted")=>({success:!1,steps:e,error:{message:t,type:"generic",status:0}}),v=(e,t)=>({success:!1,steps:e,error:{message:"errorServerUnreachable",type:"server",status:t}}),b=(e,t)=>({success:!1,steps:e,error:{message:"errorTokenIssue",type:"token",status:t}}),w=(e,t)=>({success:!1,steps:e,error:{message:"errorRepositoryIssue",type:"repository",status:t}}),S=(e,t,r)=>{const n=0===r?"network":"server";return{success:!1,steps:t,error:{message:(0,y.fV)(e,r),type:n,status:r}}},R=async(e,t)=>{const{steps:r,status:n,serverUrl:s,token:o,signal:a}=e;if(t)return r.serverUrl=f.OX.FAIL,r.token=f.OX.SKIP,v(r,n);try{const e=await p(s,o,a),t=((e,t)=>e?.aborted?E(t):null)(a,r);return t||(e?.reachable?(r.serverUrl=f.OX.OK,r.token=f.OX.FAIL,b(r,n)):(r.serverUrl=f.OX.FAIL,r.token=f.OX.SKIP,v(r,n)))}catch(e){return(0,i.fAF)("Health check during 403 handling failed",e),r.serverUrl=f.OX.FAIL,r.token=f.OX.SKIP,v(r,n)}},O=async e=>{try{const t=await e.client.testConnection(e.signal);return e.steps.serverUrl=f.OX.OK,e.steps.version=d(t),null}catch(t){return(async e=>{const{error:t,steps:r,serverUrl:n,token:s,signal:o}=e;if((0,i.zfx)(t))return E(r,t.message);const l=(0,a.Ko)(t);if(l===f.jL.UNAUTHORIZED)return r.serverUrl=f.OX.OK,r.token=f.OX.FAIL,b(r,l);if(l===f.jL.FORBIDDEN){const e=(0,i.PEb)(t),a=u(e);return R({steps:r,status:l,serverUrl:n,token:s,signal:o},a)}return r.serverUrl=f.OX.FAIL,r.token=f.OX.SKIP,S(t,r,l)})({error:t,steps:e.steps,serverUrl:e.serverUrl,token:e.token,signal:e.signal})}},T=async e=>{if(!e.token)return e.steps.token=f.OX.FAIL,b(e.steps,0);try{return await e.client.getRepositories(e.signal),e.steps.token=f.OX.OK,e.steps.repository=f.OX.SKIP,null}catch(t){if((0,i.zfx)(t))return E(e.steps,t.message);const r=(0,a.Ko)(t);if(r===f.jL.UNAUTHORIZED)return e.steps.token=f.OX.FAIL,b(e.steps,r);if(r===f.jL.FORBIDDEN){const n=(0,i.PEb)(t),s=u(n);return R({steps:e.steps,status:r,serverUrl:e.serverUrl,token:e.token,signal:e.signal},s)}return e.steps.token=f.OX.FAIL,S(t,e.steps,r)}},A=async e=>{const t=[];if(!e.repository)return{warnings:t};try{return await e.client.validateRepository(e.repository,e.signal),e.steps.repository=f.OX.OK,e.steps.token=f.OX.OK,{warnings:t}}catch(r){const n=(0,a.Ko)(r);return n===f.jL.UNAUTHORIZED||n===f.jL.FORBIDDEN?(e.steps.repository=f.OX.SKIP,e.steps.token=f.OX.FAIL,t.push("repositoryNotAccessible"),{warnings:t,failure:b(e.steps,n)}):(e.steps.repository=f.OX.FAIL,{warnings:t,failure:w(e.steps,n)})}};async function I(e){const{config:t,translate:r,signal:n,mapConfigured:o}=e;if(!t)return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,y.$5)("errorSetupRequired",{type:f.By.CONFIG,code:"configMissing",suggestion:r("actionOpenSettings"),userFriendlyMessage:r("hintSetupWidget")})};if(!(0,a.Rv)(t,r,{mapConfigured:o??!0}).isValid)return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,y.$5)("errorSetupRequired",{type:f.By.CONFIG,code:"CONFIG_INCOMPLETE"})};try{const e=await async function(e){const{serverUrl:t,token:r,repository:n,signal:o}=e,l=`${t}|${r}|${n||"_"}`,c={serverUrl:f.OX.PENDING,token:f.OX.PENDING,repository:n?f.OX.PENDING:f.OX.SKIP,version:""};return await s.validateConnection.execute(l,(async()=>{try{const e=(0,i.MbC)(t,r,n);if(!e)return{success:!1,steps:c,error:{message:void 0,type:"server",status:0}};const s=await O({client:e,steps:c,serverUrl:t,token:r,signal:o});if(s)return s;if(!n){const n=await T({client:e,steps:c,serverUrl:t,token:r,signal:o});if(n)return n}const{warnings:a,failure:l}=await A({client:e,repository:n,signal:o,steps:c});return l||{success:!0,version:"string"==typeof c.version?c.version:"",steps:c,warnings:a.length?a:void 0}}catch(e){if((0,i.zfx)(e))return E(c,e.message);const t=(0,a.Ko)(e);return{success:!1,steps:c,error:{message:(0,y.fV)(e,t),type:"generic",status:t}}}}))}({serverUrl:t.fmeServerUrl,token:t.fmeServerToken,repository:t.repository,signal:n});if(!e.success){const t=e.error?.message||"errorValidationFailed",n=e.error?.type||"server";return{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,y.$5)(t,{type:f.By.NETWORK,code:e.error?.type?.toUpperCase()||"CONNECTION_ERROR",suggestion:r("token"===n?"tokenSettingsHint":"server"===n?"serverUrlSettingsHint":"repository"===n?"repositorySettingsHint":"connectionSettingsHint")})}}return{isValid:!0,canProceed:!0,requiresSettings:!1}}catch(e){return(0,i.zfx)(e)?{isValid:!1,canProceed:!1,requiresSettings:!1}:{isValid:!1,canProceed:!1,requiresSettings:!0,error:(0,y.$5)("errorStartupFailed",{type:f.By.NETWORK,code:"STARTUP_NETWORK_ERROR",suggestion:r("networkConnectionHint")})}}}async function _(e){const{config:t,useMapWidgetIds:r,translate:n,signal:s,onProgress:o}=e;o(n("validatingStartup")),o(n("statusValidatingMap"));const a=Array.isArray(r)&&r.length>0;o(n("statusValidatingConnection"));const l=await I({config:t,translate:n,signal:s,mapConfigured:a});if(!l.isValid){if(l.error)throw new Error(JSON.stringify(l.error));if(l.requiresSettings){const e=(0,y.$5)("configurationInvalid",{type:f.By.CONFIG,code:"VALIDATION_FAILED"});throw new Error(JSON.stringify(e))}return{success:!1}}if(!t?.syncMode){o(n("statusValidatingEmail"));try{const e=await(0,i.hSq)(t);if(!(0,i.B9Y)(e)){const e=(0,y.$5)("userEmailMissingError",{type:f.By.CONFIG,code:"UserEmailMissing"});throw new Error(JSON.stringify(e))}}catch(e){if((0,i.zfx)(e))return{success:!1};const t=(0,y.$5)("userEmailMissingError",{type:f.By.CONFIG,code:"UserEmailMissing"});throw new Error(JSON.stringify(t))}}return{success:!0}}var C=r(3040);const k=e=>"error"===e.status,L=e=>"error"===e.status,M=async e=>{const t=(e=>{const t=e?.data;return t&&"object"==typeof t&&!Array.isArray(t)?t:{}})(e.formData),r=(0,i.MmJ)({data:t},e.config,{workspaceItem:e.workspaceItem,areaWarning:e.areaWarning,drawnArea:e.drawnArea,onModeOverride:()=>{}}),n="sync"===r||"async"===r?r:null,s="async"===n?await(0,i.hSq)(e.config):"",o=e.selectedWorkspace;return o?{status:"success",context:{workspace:o,serviceMode:n,userEmail:s,rawFormData:t}}:{status:"error",result:{success:!1,error:new Error("No workspace selected"),serviceMode:n}}},N=async e=>{const t=await async function({rawFormData:e,userEmail:t,geometryJson:r,geometry:n,modules:s,config:o,workspaceParameters:a,workspaceItem:l,selectedWorkspaceName:c,areaWarning:u,drawnArea:d,makeCancelable:p,fmeClient:f,signal:h,remoteDatasetSubfolder:m,onStatusChange:g}){g?.("normalizing");const{sanitizedFormData:y,uploadFile:E,remoteUrl:v}=(0,i.sqe)(e),b=(0,i.EoF)(o||void 0),w=(0,i.cLk)({data:y},t,r,n||void 0,s,{config:b,workspaceParameters:a,workspaceItem:l,areaWarning:u,drawnArea:d}),S=w.__aoi_error__;if(S)return g?.("complete"),{params:null,aoiError:S};const R={...w};Boolean(E||(0,i.YH$)(v))&&g?.("resolvingDataset");await async function({params:e,remoteUrl:t,uploadFile:r,config:n,workspaceParameters:s,makeCancelable:o,fmeClient:a,signal:l,subfolder:c,workspaceName:u}){if((0,i.dd1)(e,n),(0,i.rBs)(t,n))return void(e.opt_geturl=t);if(!(0,i.pZA)(n,r))return;const d=(0,i.NnH)(u);if(!d)throw new Error("REMOTE_DATASET_WORKSPACE_REQUIRED");void 0!==e.opt_geturl&&delete e.opt_geturl;const p=await o(a.uploadToTemp(r,{subfolder:c,signal:l,repository:n?.repository,workspace:d})),f=p.data?.path;(0,i.sIn)({finalParams:e,uploadedPath:f,parameters:s,explicitTarget:(0,i.yol)(n)})}({params:R,remoteUrl:v,uploadFile:E,config:b,workspaceParameters:a,makeCancelable:p,fmeClient:f,signal:h,subfolder:m,workspaceName:(0,i.NnH)(l?.name)||(0,i.NnH)(c)||null}),g?.("applyingDefaults");const O=(0,i._RB)(R,b);return(0,i.Ad4)(O),g?.("complete"),{params:O}}({rawFormData:e.rawFormData,userEmail:e.userEmail,geometryJson:e.geometryJson,geometry:e.geometry,modules:e.modules,config:e.config,workspaceParameters:e.workspaceParameters,workspaceItem:e.workspaceItem,selectedWorkspaceName:e.selectedWorkspaceName,areaWarning:e.areaWarning,drawnArea:e.drawnArea,makeCancelable:e.makeCancelable,fmeClient:e.fmeClient,signal:e.signal,remoteDatasetSubfolder:e.remoteDatasetSubfolder,onStatusChange:e.onStatusChange});return t.aoiError?{status:"error",result:{success:!1,error:t.aoiError,serviceMode:e.serviceMode}}:{status:"success",params:t.params??null}};async function x(e){const{formData:t,config:r,geometryJson:n,modules:s,workspaceParameters:o,workspaceItem:l,selectedWorkspace:c,areaWarning:u,drawnArea:d,fmeClient:p,submissionAbort:f,widgetId:h,translate:m,makeCancelable:g,onStatusChange:y,getActiveGeometry:E}=e;let v=null,b=null,w="",S="",R={};try{const e=await M({formData:t,config:r,workspaceItem:l,areaWarning:u,drawnArea:d,selectedWorkspace:c});if(k(e)){const t=e.result;return b=t.serviceMode??b,t}b=e.context.serviceMode,w=e.context.userEmail,S=e.context.workspace,R=e.context.rawFormData,v=f.abortAndCreate();const i=`widget_${h||"fme"}`,a=await N({rawFormData:R,userEmail:w,geometryJson:n,geometry:E()||void 0,modules:s,config:r,workspaceParameters:o,workspaceItem:l,selectedWorkspaceName:S,areaWarning:u,drawnArea:d,makeCancelable:g,fmeClient:p,signal:v.signal,remoteDatasetSubfolder:i,onStatusChange:y,serviceMode:b});if(L(a))return a.result;const O=a.params;if(!O)throw new Error("Submission parameter preparation failed");y?.("submitting");const T=await g(p.runWorkspace(S,O,void 0,v.signal));if(v.signal.aborted)return{success:!1,serviceMode:b};const A=function(e,t,r,n,s){return{...(0,C.Hz)(e,t,r,n),...s?{serviceMode:s}:{}}}(T,S,w,m,b);return{success:!0,result:A,serviceMode:b}}catch(e){const t=function(e,t,r,n){if((0,i.zfx)(e))return null;const s=(0,i.fVY)(e);let o="";if(s)try{o=(0,i.I0Z)(s,t)}catch{o=""}const a=(0,i.EjJ)(t,r);return{success:!1,message:[t("errorOrderFailed"),o,a].filter(Boolean).join(". "),code:e.code||"SUBMISSION_ERROR",...n?{serviceMode:n}:{}}}(e,m,(0,a.id)(r?.supportEmail),b);return t?{success:!1,result:t,error:e,serviceMode:b}:{success:!1,serviceMode:b}}finally{f.finalize(v)}}var D=r(5880),P=r(2242),F=r(1618);function j(e,t,r){const n=new t.GraphicsLayer(f.PJ);return e.view.map.add(n),r(n),n}async function U(e){const{geometry:t,modules:r,config:n,signal:s}=e;if(!t)return{success:!1,error:{code:"NO_GEOMETRY"}};if(s.aborted)return{success:!1,error:{code:"ABORTED"}};const o=await(0,F.DU)(t,r);if(s.aborted)return{success:!1,error:{code:"ABORTED"}};if(!o.valid)return{success:!1,error:o.error};const i=o.simplified??t,a=await(0,F.x0)(i,r);if(s.aborted)return{success:!1,error:{code:"ABORTED"}};if(!a||a<=0)return{success:!1,error:{code:"ZERO_AREA",message:"geometryInvalidCode"}};const l=Math.abs(a),c=(0,F.nW)(l,{maxArea:n?.areaThreshold,largeArea:n?.largeAreaThreshold});if(s.aborted)return{success:!1,error:{code:"ABORTED"}};if(c.exceedsMaximum){const e=(0,F.M4)(l,n?.areaThreshold);return{success:!1,error:{code:e.code,message:e.message||"geometryAreaTooLargeCode"}}}return{success:!0,geometry:i,area:l,shouldWarn:c.shouldWarn}}function V({jmv:e,modules:t,layer:r,onDrawComplete:n,dispatch:s,widgetId:o,symbols:a,onDrawingSessionChange:l,onSketchToolStart:c}){const u=new t.SketchViewModel({view:e.view,layer:r,polygonSymbol:a.polygon,polylineSymbol:a.polyline,pointSymbol:a.point,defaultCreateOptions:{hasZ:!1,mode:"click"},defaultUpdateOptions:{tool:"reshape",toggleToolOnClick:!1,enableRotation:!0,enableScaling:!0,preserveAspectRatio:!1},snappingOptions:{enabled:!0,selfEnabled:!0,featureEnabled:!0},tooltipOptions:{enabled:!0,inputEnabled:!0,visibleElements:{area:!0,totalLength:!0,distance:!0,coordinates:!1,elevation:!1,rotation:!1,scale:!1,size:!1,radius:!0,direction:!0,header:!0,helpMessage:!0}},valueOptions:{directionMode:"relative",displayUnits:{length:"meters",verticalLength:"meters",area:"square-meters"},inputUnits:{length:"meters",verticalLength:"meters",area:"square-meters"}}}),d=function({sketchViewModel:e,onDrawComplete:t,dispatch:r,widgetId:n,onDrawingSessionChange:s,onSketchToolStart:o}){let a=0;const l=e.on("create",(l=>{switch(l.state){case"start":{a=0;const t=(0,i.wk6)(l.tool);if(!t)return(0,P.uB)(e),void s({isActive:!1,clickCount:0});s({isActive:!0,clickCount:0}),o("rectangle"===t?f.hL.RECTANGLE:f.hL.POLYGON);break}case"active":{const e=(0,i.wk6)(l.tool);if("polygon"===e&&l.graphic?.geometry){const e=l.graphic.geometry,t=e.rings?.[0],o=t?Math.max(0,t.length-1):0;o>a&&(a=o,s({clickCount:o,isActive:!0}),1===o&&r(D.fmeActions.setViewMode(f.nE.DRAWING,n)))}else"rectangle"===e&&1!==a&&(a=1,s({clickCount:1,isActive:!0}));break}case"complete":a=0,s({isActive:!1,clickCount:0});try{t(l)}catch(e){(0,i.fAF)("onDrawComplete error",e)}break;case"cancel":a=0,s({isActive:!1,clickCount:0})}})),c=e.on("update",(e=>{if("complete"===e.state&&Array.isArray(e.graphics)&&e.graphics.length>0&&e.graphics[0]?.geometry){const r=(0,i.wk6)(e?.tool);try{t({graphic:e.graphics[0],state:"complete",tool:r??e.tool})}catch(e){(0,i.fAF)("onDrawComplete update error",e)}}}));return()=>{try{l?.remove()}catch{}try{c?.remove()}catch{}try{e.__fmeCleanup__=void 0}catch{}}}({sketchViewModel:u,onDrawComplete:n,dispatch:s,widgetId:o,onDrawingSessionChange:l,onSketchToolStart:c});return u.__fmeCleanup__=d,{sketchViewModel:u,cleanup:d}}var W=r(5009)},1888:e=>{"use strict";e.exports=o},1920:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},2238:(e,t,r)=>{"use strict";r.d(t,{ER:()=>ce,IH:()=>h,VM:()=>f});var n=r(3096),s=r(3417),o=r(5009),i=r(3314),a=r(1138),l=r(3040),c=r(3890);const u={...n.mR},d=[];function p(e){for(d.push(e);d.length>n.WC.MAX_HISTORY_SIZE;)d.shift()}function f(){return[...d]}function h(){d.length=0}async function m(e){if(!u.enabled)return e.execute();const t=e.method.toUpperCase(),r=e.correlationId||g(),s=Date.now();try{const o=await e.execute(),a=Date.now()-s,l=(0,i.eF2)(a)?a:0,c=e.responseInterpreter?.status?.(o),u=e.responseInterpreter?.ok?.(o)??function(e){return"number"!=typeof e?void 0:(0,n.ar)(e)}(c),d=e.responseInterpreter?.size?.(o),f={timestamp:s,method:t,url:E(e.url,e.query),path:b(e.url),status:c,ok:u,durationMs:l,correlationId:r,caller:e.caller,transport:e.transport,retryAttempt:e.retryAttempt,responseSize:d,isAbort:!1};return T("success",f,e.body),p(f),o}catch(n){const o=Date.now()-s,l=(0,i.eF2)(o)?o:0,u=(0,c.Ko)(n),d=(0,a.zf)(n),f={timestamp:s,method:t,url:E(e.url,e.query),path:b(e.url),status:u,ok:!1,durationMs:l,correlationId:r,caller:e.caller,transport:e.transport,retryAttempt:e.retryAttempt,isAbort:d};throw T("error",f,e.body,n),p(f),n instanceof Error?n:new Error((0,i.PEb)(n))}}function g(e="net"){const t=Date.now().toString(36);let r=Math.random().toString(36).slice(2,10);for(;r.length<8;)r+=Math.random().toString(36).slice(2);return`${e}_${t}_${r.slice(0,8)}`}const y=(e,t)=>e?`${e.origin}${e.pathname}`:R(t.split("?")[0]||"");function E(e,t){const r=v(e),n=function(e,t){const r=new URLSearchParams(e?.search||"");t&&w(r,t);return r}(r,t),s=function(e){const t=new URLSearchParams;for(const[r,n]of e.entries())S(r.toLowerCase())?t.set(r,"[TOKEN]"):t.set(r,R(n));return t}(n),o=function(e){const t=[];for(const[r,n]of e.entries())t.push([r,n]);return t.sort((([e],[t])=>e>t?1:e<t?-1:0)),t.map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(s),i=y(r,e);return o?`${i}?${o}`:i}function v(e){if(!e)return null;try{return(0,i.yCG)(e)||new URL(e,"http://localhost")}catch{return null}}function b(e){const t=v(e);return t?.pathname||e.split("?")[0]||e}const w=(e,t)=>{"string"!=typeof t?t instanceof URLSearchParams?t.forEach(((t,r)=>{e.set(r,t)})):Object.entries(t).forEach((([t,r])=>{if(null!=r)if(Array.isArray(r))e.delete(t),r.forEach((r=>{e.append(t,String(r))}));else{const n="string"==typeof r||"number"==typeof r||"boolean"==typeof r?String(r):JSON.stringify(r);e.set(t,n)}})):new URLSearchParams(t).forEach(((t,r)=>{e.set(r,t)}))};function S(e){const t=e.toLowerCase();return n.wS.some((e=>t.includes(e)))}function R(e){return e.replace(n.zw,'authorization="[TOKEN]"').replace(n.si,"$1=[TOKEN]")}function O(e,t){return e.length<=t?e:`${e.slice(0,t-1)}\u2026`}function T(e,t,r,n){if("silent"===u.logLevel)return;const s=r?function(e){if(null==e)return"";if("string"==typeof e)return O(R(e),u.bodyPreviewLimit);if("object"!=typeof e)try{return O(R(JSON.stringify(e)),u.bodyPreviewLimit)}catch{return"[Object]"}if("undefined"!=typeof FormData&&e instanceof FormData)return"[FormData]";if("undefined"!=typeof Blob&&e instanceof Blob)return`[Blob:${e.size}]`;if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)return`[Binary:${e instanceof ArrayBuffer?e.byteLength:e.buffer?.byteLength||0}]`;try{return O(R(JSON.stringify(e)),u.bodyPreviewLimit)}catch{return"[Object]"}}(r):void 0,a=n?(0,i.PEb)(n):void 0;try{if("debug"===u.logLevel){const r="success"===e?"\u2713":"\u2717",n={phase:e,method:t.method,url:t.url,status:t.status,durationMs:t.durationMs,correlationId:t.correlationId,caller:t.caller,transport:t.transport};void 0!==t.responseSize&&(n.responseSize=t.responseSize),void 0!==t.retryAttempt&&(n.retry=t.retryAttempt),t.isAbort&&(n.aborted=!0),s&&(n.body=s),a&&(n.error=a),(0,o.conditionalLog)(`[FME][net] ${r}`,n)}else if("warn"===u.logLevel){const r=`[FME][net] ${e} ${t.method} ${t.path} ${t.status||"?"} ${t.durationMs}ms`;(0,o.conditionalLog)(r,{correlationId:t.correlationId,...t.caller&&{caller:t.caller}})}t.durationMs>=u.warnSlowMs&&(0,o.conditionalLog)("[FME][net] slow",{method:t.method,path:t.path,durationMs:t.durationMs,correlationId:t.correlationId})}catch{}}const A=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),I=(e,t=0)=>{if(null==e)return null;if("string"==typeof e){const t=e.trim();return t||null}if("number"==typeof e||"boolean"==typeof e)return String(e);if(Array.isArray(e)){if(t>=3)return null;const r=e.map((e=>I(e,t+1))).filter((e=>Boolean(e)));if(!r.length)return null;return O(r.join(", "),n.Us)}if(A(e)){if(t>=3)return null;for(const r of n.xW){const n=I(e[r],t+1);if(n)return n}}return null},_=e=>{if(!e)return;const t={};if(Array.isArray(e))return e.forEach(((e,r)=>{if(null!=e)if(A(e)){const s=e,o="string"==typeof s.name?s.name:void 0,a="string"==typeof s.field?s.field:void 0,l="string"==typeof s.parameter?s.parameter:void 0,c=(0,i.P6s)(o)||(0,i.P6s)(a)||(0,i.P6s)(l)||String(r),u=I(e,1)||I(s.value,1);u&&(t[c]=O(u,n.Us))}else{const s=I(e,1);s&&(t[String(r)]=O(s,n.Us))}})),Object.keys(t).length?t:void 0;if(A(e)){for(const r of Object.keys(e)){const s=I(e[r]);s&&(t[r]=O(s,n.Us))}return Object.keys(t).length?t:void 0}const r=I(e);return r?(t.general=O(r,n.Us),t):void 0},C=(e,t)=>{let r=e;for(const e of t){if(!A(r))return;r=r[e]}return r},k=e=>{if(!e||"object"!=typeof e)return;const t=[["details"],["response","details"],["response","data","details"],["data","details"],["body","details"],["error","details"]];for(const r of t){const t=C(e,r);if(void 0!==t){const e=_(t);if(e)return e}}},L=e=>{if(void 0!==e)return e;if("function"==typeof DOMException)return new DOMException("Aborted","AbortError");const t=new Error("Aborted");return t.name="AbortError",t},M=()=>{};new class{constructor(){this.controllers=new Map,this.listeners=new Map,this.pendingReasons=new Map}register(e,t){if(!e)return;this.controllers.set(e,t);const r=this.pendingReasons.get(e);void 0!==r&&((0,a.Wz)(t,r),this.pendingReasons.delete(e))}release(e,t){if(!e)return;const r=this.controllers.get(e);if(t&&r&&r!==t)return;this.controllers.delete(e),this.pendingReasons.delete(e);const n=this.listeners.get(e);if(n?.size){for(const e of n)try{e.signal.removeEventListener("abort",e.handler)}catch{}this.listeners.delete(e)}}abort(e,t){if(!e)return;const r=this.controllers.get(e);if(!r)return void this.pendingReasons.set(e,t??L());const n=t??L();(0,a.Wz)(r,n),this.release(e,r)}linkExternal(e,t){if(!e||!t)return M;if(t.aborted)return this.abort(e,t.reason),M;const r={signal:t,handler:()=>{const r=t.reason;this.abort(e,r)}};t.addEventListener("abort",r.handler);let n=this.listeners.get(e);return n||(n=new Set,this.listeners.set(e,n)),n.add(r),()=>{try{t.removeEventListener("abort",r.handler)}catch{}const n=this.listeners.get(e);n&&(n.delete(r),0===n.size&&this.listeners.delete(e))}}abortAll(e){const t=Array.from(this.controllers.entries());for(const[r,n]of t)this.abort(r,e),this.release(r,n)}};const N=(e,t)=>new s.VQ(e,e,t,(e=>(0,n.PS)(e))(t)),x=e=>{if(!e||"object"!=typeof e)return{};const t=e,r={...t};if(t.type&&(r.type=(e=>{if("string"!=typeof e)return"TEXT";const t=(0,i.QKA)(e),r=n.Tv[t];return r||e.toUpperCase()})(t.type)),"number"===t.type&&!0===t.showSlider&&(r.type="RANGE_SLIDER"),"datetime"===t.type&&"date"===t.format&&(r.type="DATE"),"file"===t.type&&t.itemsToSelect){const e="string"==typeof t.itemsToSelect?t.itemsToSelect.toLowerCase():"";"folders"===e||"directories"===e?r.type=t.validateExistence?"DIRNAME_MUSTEXIST":"DIRNAME":"files"===e&&(r.type=t.validateExistence?"FILENAME_MUSTEXIST":"FILENAME")}"text"===t.type&&"url"===t.editor&&(r.type="URL");const s=t.choiceSettings;if(s?.choices&&!t.listOptions){const e=Array.isArray(s.choices)?s.choices:[];r.listOptions=e.map((e=>{const t=e,r=t.value??t.caption;return{caption:t.display??t.caption??r,value:r,...t.description&&{description:t.description},...t.path&&{path:t.path},...t.disabled&&{disabled:t.disabled},...t.metadata&&{metadata:t.metadata}}})),"text"===t.type&&"URL"!==r.type&&(r.type="CHOICE")}return"tree"===t.type&&t.nodeDelimiter&&(r.metadata={...r.metadata||{},breadcrumbSeparator:t.nodeDelimiter,pathSeparator:t.nodeDelimiter}),t.prompt&&!t.description&&(r.description=t.prompt),"required"in t?r.optional=!t.required:"optional"in t||(r.optional=!1),"number"!==t.type&&"RANGE_SLIDER"!==r.type||("number"==typeof t.minimum&&(r.minimum=t.minimum),"number"==typeof t.maximum&&(r.maximum=t.maximum),"boolean"==typeof t.minimumExclusive&&(r.minimumExclusive=t.minimumExclusive),"boolean"==typeof t.maximumExclusive&&(r.maximumExclusive=t.maximumExclusive),"number"==typeof t.multipleOf&&(r.decimalPrecision=1===t.multipleOf?0:void 0)),"color"===t.type&&t.colorSpace&&(r.metadata={...r.metadata||{},colorSpace:t.colorSpace}),t.visibility&&(r.visibility=t.visibility),"group"===t.type&&Array.isArray(t.parameters)&&(r.parameters=t.parameters.map(x)),r},D=e=>{const t=A(e)&&Array.isArray(e.value)?e.value:e;if(!Array.isArray(t))return[];const r=t.map(x),n=[];for(const e of r)n.push(e),"GROUP"===e.type&&Array.isArray(e.parameters)&&n.push(...e.parameters);return n},P=e=>{const t=e?.httpStatus,r=e?.status;return"number"==typeof t?t:"number"==typeof r?r:void 0},F=e=>{const t=P(e);if("number"==typeof t)return(0,n.ar)(t)},j=e=>{try{const t=e?.data;if(!t)return;if("string"==typeof t)return t.length;return JSON.stringify(t).length}catch{return}},U=e=>{if(e&&"object"==typeof e&&"default"in e){const t=e;if(void 0!==t.default)return t.default}return e};let V,W,B,q,G,Q=null;const $=Object.create(null),z=e=>n.FB[e];async function H(){if(Boolean(V&&W&&B&&q&&G))return;if(Q)return Q;const e=(async()=>{const e=(()=>{try{const e=globalThis;return s._$.some((t=>t in e))?e:null}catch{return null}})();if(e)(e=>{if(!e)return;const t={esriRequest:e=>{V=e},esriConfig:e=>{W=e},projection:e=>{B=e},webMercatorUtils:e=>{q=e},SpatialReference:e=>{G=e}};for(const r of s._$){const n=(r in e?e[r]:void 0)??z(r);t[r](n)}})(e);else try{await(async()=>{const[e,t,r,n,s]=await(0,i.ps9)(["esri/request","esri/config","esri/geometry/projection","esri/geometry/support/webMercatorUtils","esri/geometry/SpatialReference"]);V=U(e),W=U(t),B=U(r),q=U(n),G=U(s);const o=ee(B);o?.load&&await o.load()})()}catch{throw new Error("ARCGIS_MODULE_ERROR")}})();Q=e;try{await e}catch(e){throw V=void 0,W=void 0,B=void 0,q=void 0,G=void 0,Q=null,oe=null,e instanceof Error?e:new Error(String(e))}}async function K(){return await H(),Z(W)}const X=e=>{if(!A(e))return!1;const t=e,{before:r,error:n}=t;if(void 0!==r&&"function"!=typeof r)return!1;if(void 0!==n&&"function"!=typeof n)return!1;const{urls:s}=t;return void 0===s||("string"==typeof s||s instanceof RegExp||!!Array.isArray(s))};const Y=e=>Boolean(e&&"object"==typeof e),J=e=>"function"==typeof e?e:null,Z=e=>{if(!Y(e))return null;const t=e;return t.request&&Array.isArray(t.request.interceptors)?t:null},ee=e=>Y(e)?e:null,te=(e,t,r)=>{const n=new Error(e);return n.code=e,null!=t&&(n.status=t),void 0!==r&&(n.cause=r),n},re=async e=>{let t;try{t=await K()}catch{return}!function(e,t){if(Array.isArray(e)&&e.length)for(let r=e.length-1;r>=0;r--){const n=e[r];if(!X(n)||!n._fmeInterceptor)continue;const s=n.urls;let o=!1;s instanceof RegExp?o=s.source===t.source&&s.flags===t.flags:Array.isArray(s)?o=s.some((e=>t.test(String(e??"")))):"string"==typeof s&&(o=t.test(s)),o&&e.splice(r,1)}}(t?.request?.interceptors,e)},ne=(e,t)=>({urls:t,before(t){if(!(e=>{if("string"==typeof e)return n.KC.test(e);if(e instanceof URL)return n.KC.test(e.pathname);if(e&&"object"==typeof e){const t="string"==typeof e.href?e.href:"string"==typeof e.url?e.url:null;return!!t&&n.KC.test(t)}return!1})(t?.url))return;t?.requestOptions||(t.requestOptions={});const r=t.requestOptions,s=r.headers??{},o=r.query??{};r.headers=s,r.query=o;const i=(e=>$[e])(e);i&&(o.fmetoken||(o.fmetoken=i),s.Authorization=`fmetoken token=${i}`)},_fmeInterceptor:!0});async function se(e,t){if(!e)return;const r=(0,i.$j5)(e);if(!r)return;const n=r.toLowerCase(),s=(0,i.dBM)(r);if(!t){const e=(e=>Object.prototype.hasOwnProperty.call($,e))(n);return(e=>{delete $[e]})(n),void(e&&await re(s))}let o;((e,t)=>{$[e]=t})(n,t);try{o=await K()}catch(e){throw e instanceof Error?e:new Error(String(e))}o?.request?.interceptors&&((0,i.m4N)(o.request.interceptors,s)||o.request.interceptors.push(ne(n,s)))}let oe=null;const ie=(e,t)=>{const r=(e=>{const t=(0,l.Lz)(e?.tm_ttc),r=(0,l.Lz)(e?.tm_ttl),n=(0,i.NnH)(e?.tm_tag),s={};return void 0!==t&&(s.ttc=t),void 0!==r&&(s.ttl=r),n&&(s.tag=n),s})(t),n={publishedParameters:e};return Object.keys(r).length>0&&(n.TMDirectives=r),n};class ae{constructor(e){this.basePath=s.vA.BASE_PATH,this.disposed=!1,this.config=Object.freeze({...e}),this.setupPromise=Promise.resolve(),this.queueSetup(e)}queueSetup(e){this.setupPromise=(this.setupPromise||Promise.resolve()).catch((()=>{})).then((async()=>{try{await async function(){const e=await K();e&&(e.request.maxUrlLength=Math.max(Number(e.request.maxUrlLength)||0,s.vA.MAX_URL_LENGTH))}(),await se(e.serverUrl,e.token)}catch(e){throw e instanceof Error?e:new Error(String(e))}}))}queueTeardown(e){this.setupPromise=(this.setupPromise||Promise.resolve()).catch((()=>{})).then((()=>se(e,""))).catch((()=>{}))}dispose(){this.disposed||(this.disposed=!0,this.queueTeardown(this.config.serverUrl))}async uploadToTemp(e,t){if(t?.signal?.aborted)throw new DOMException("Aborted","AbortError");const r=this.resolveRepository(t?.repository),o=(0,i.P6s)(t?.workspace);if(!o)throw N("DATA_UPLOAD_ERROR");const a=((0,i.P6s)(e instanceof File?e.name:void 0)||`upload_${Date.now()}`).replace(/[^A-Za-z0-9._-]/g,"_").slice(0,n.vp.MAX_FILENAME_LENGTH)||`upload_${Date.now()}`,l=(0,i.P6s)(t?.subfolder).replace(/[^A-Za-z0-9_-]/g,"-").slice(0,n.vp.MAX_NAMESPACE_LENGTH)||g("upload"),c=(0,i.c$7)(this.config.serverUrl,"fmedataupload",r,o,a),u={opt_fullpath:"true",opt_responseformat:"json",opt_namespace:l},d={Accept:"application/json","Content-Type":e instanceof File&&e.type?e.type:"application/octet-stream"},p=await this.request(c,{method:s.ym.PUT,headers:d,body:e,query:u,signal:t?.signal,cacheHint:!1,repositoryContext:r}),f=p.data?.file,h=(0,i.NnH)(f?.path)??null;if(!h)throw N("DATA_UPLOAD_ERROR",p.status);return{data:{path:h},status:p.status,statusText:p.statusText}}resolveRepository(e){return e||this.config.repository}formatJobParams(e={}){if(A(t=e)&&Array.isArray(t.publishedParameters))return e;var t;const r=Object.entries(e).filter((([e])=>!s.d.has(e))).map((([e,t])=>({name:e,value:t})));return ie(r,e)}repoEndpoint(e,...t){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"repositories",e,...t)}jobsEndpoint(){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"jobs")}workspaceEndpoint(e,t,...r){return(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"workspaces",e,t,...r)}async withApiError(e,t,r){try{return await e()}catch(e){const n=(0,c.Ko)(e),o=(0,c.$d)(e),i=e instanceof s.VQ?e:null,a=i?.details??k(e),l=i?.severity,u="number"==typeof n?n:"number"==typeof i?.httpStatus?i.httpStatus:0;throw new s.VQ(t,r,u,o,l,a)}}async testConnection(e){return this.request("/healthcheck/liveness",{signal:e})}async validateRepository(e,t){const r=this.resolveRepository(e),n=this.repoEndpoint(r);return this.request(n,{signal:t})}async getRepositories(e){return this.withApiError((async()=>{const t=(0,i.c$7)(this.config.serverUrl,this.basePath.slice(1),"repositories"),r=await this.request(t,{signal:e,cacheHint:!1,query:{limit:n.WC.API_QUERY_LIMIT,offset:0}}),s=r?.data;return{data:(0,i.o44)(s).map((e=>({name:e}))),status:r.status,statusText:r.statusText}}),"REPOSITORIES_ERROR","REPOSITORIES_ERROR")}async getWorkspaceParameter(e,t,r,n){const s=this.resolveRepository(r),o=this.workspaceEndpoint(s,e,"parameters",t),i=await this.request(o,{signal:n,cacheHint:!1,repositoryContext:s});return{...i,data:x(i.data)}}async getWorkspaceParameters(e,t,r){const n=this.resolveRepository(t),s=this.workspaceEndpoint(n,e,"parameters");return this.withApiError((async()=>{const e=await this.request(s,{signal:r,cacheHint:!1,repositoryContext:n});return{...e,data:D(e.data)}}),"WORKSPACE_PARAMETERS_ERROR","WORKSPACE_PARAMETERS_ERROR")}async getRepositoryItems(e,t,r,n,s){const o=this.resolveRepository(e),i=this.repoEndpoint(o,"items"),a={};return t&&(a.type=t),"number"==typeof r&&(a.limit=r),"number"==typeof n&&(a.offset=n),this.withApiError((()=>this.request(i,{signal:s,cacheHint:!1,repositoryContext:o,query:a})),"REPOSITORY_ITEMS_ERROR","REPOSITORY_ITEMS_ERROR")}async getWorkspaceItem(e,t,r){const n=this.resolveRepository(t),s=this.workspaceEndpoint(n,e);return this.withApiError((()=>this.request(s,{signal:r,cacheHint:!1,repositoryContext:n})),"WORKSPACE_ITEM_ERROR","WORKSPACE_ITEM_ERROR")}async submitJob(e,t={},r,n){const o=this.resolveRepository(r),i=this.jobsEndpoint(),a={repository:o,workspace:e,...this.formatJobParams(t)};return this.withApiError((()=>this.request(i,{method:s.ym.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:n,cacheHint:!1})),"JOB_SUBMISSION_ERROR","JOB_SUBMISSION_ERROR")}async runDataDownload(e,t={},r,n){const s=this.resolveRepository(r);return await this.runDownloadWebhook(e,t,s,n)}async runWorkspace(e,t={},r,n){return await this.runDataDownload(e,t,r,n)}async runDownloadWebhook(e,t={},r,n){try{const o={requireHttps:this.config.requireHttps},{baseUrl:c,params:u,fullUrl:d}=(0,l.vl)(this.config.serverUrl,r,e,t,this.config.token,o),p=(()=>{const e=(()=>{if("undefined"==typeof window)return;const e=window?.esriConfig?.request?.maxUrlLength,t=(0,i.MeA)(e)??Number(e);return Number.isFinite(t)&&t>0?t:void 0})();if(void 0!==e)return e;if(null!==oe)return oe;const t=Z(W),r=t?.request?.maxUrlLength,n="number"==typeof r?r:Number(r);return oe=Number.isFinite(n)&&n>0?n:1900,oe})();if(Number.isFinite(p)&&p>0&&d.length>p)throw te("URL_TOO_LONG",0);(0,i.qCC)("WEBHOOK_CALL",c,u,s.vA.WEBHOOK_LOG_WHITELIST),await H();const f=J(V);if(!f)throw N("ARCGIS_MODULE_ERROR");const h={Accept:"application/json","Cache-Control":"no-cache"},y=new AbortController;let E=null,v=!1;const b=()=>{y.abort()};try{n&&(n.aborted?y.abort():n.addEventListener("abort",b));const e="number"==typeof this.config.timeout&&this.config.timeout>0?this.config.timeout:void 0;e&&(E=setTimeout((()=>{v=!0;try{y.abort()}catch{}}),e));const t=await m({method:"GET",url:d,transport:"fme-webhook",query:u,correlationId:g("webhook"),responseInterpreter:{status:P,ok:F,size:j},execute:()=>{const t={method:"get",responseType:"json",headers:h,signal:y.signal};return"number"==typeof e&&e>0&&(t.timeout=e),f(d,t)}});return this.parseWebhookResponse(t)}catch(e){if((0,a.zf)(e)&&v)throw te("WEBHOOK_TIMEOUT",408,e);throw e instanceof Error?e:new Error(String(e))}finally{E&&clearTimeout(E);try{n&&n.removeEventListener("abort",b)}catch{}}}catch(e){if(e instanceof s.VQ)throw e;if(e?.code)throw e instanceof Error?e:new Error(String(e));const t=(0,c.Ko)(e);throw N("DATA_DOWNLOAD_ERROR",t||0)}}async parseWebhookResponse(e){const t="number"==typeof(r=e).status?r.status:"httpStatus"in r&&"number"==typeof r.httpStatus?r.httpStatus??0:0;var r;if(401===t||403===t)throw te("WEBHOOK_AUTH_ERROR",t);const n=e instanceof Response||"object"==typeof e.headers&&e.headers&&"get"in e.headers&&"function"==typeof e.headers.get?e.headers:void 0,s=n?.get("content-type")||void 0,o=await(async e=>{if(e instanceof Response)try{return await e.json()}catch(e){throw te("WEBHOOK_NON_JSON",t,e)}if("function"==typeof e.json)try{return await e.json()}catch(e){throw te("WEBHOOK_NON_JSON",t,e)}return void 0!==e.data?e.data:void 0!==e.json?e.json:"function"==typeof e.text||"string"==typeof e.text?(async e=>{try{let t="";if("function"==typeof e)t=await e();else if("string"==typeof e)t=e;else if("number"==typeof e||"boolean"==typeof e)t=String(e);else{if(null!=e)throw new Error("Unsupported text source type");t=""}return t?JSON.parse(t):{}}catch(e){throw te("WEBHOOK_NON_JSON",t,e)}})(e.text):void 0})(e);if(!o||"object"!=typeof o)throw te("WEBHOOK_NON_JSON",t,e);if(s&&!(0,i.Fhj)(s))throw te("WEBHOOK_NON_JSON",t,{contentType:s});const a=e instanceof Response?e.statusText:e.statusText??"";return{data:o,status:t,statusText:a}}async request(e,t={}){if(this.disposed)throw N("CLIENT_DISPOSED");try{await this.setupPromise}catch(e){this.queueSetup(this.config);try{await this.setupPromise}catch{throw N("ARCGIS_MODULE_ERROR")}}await H();const r=e=>e.startsWith("/")?e.slice(1):e,o=r(this.basePath||""),l=o?[o]:[],u=r(e),d=e.startsWith("http")?e:e.startsWith("/fme")?(0,i.c$7)(this.config.serverUrl,u):u?(0,i.c$7)(this.config.serverUrl,...l,u):(0,i.c$7)(this.config.serverUrl,...l),p={...t.headers||{}},f={...t.query||{}};if(!t.method||t.method===s.ym.GET){const e=(0,i.qmZ)(this.config.serverUrl,this.config.token,t.repositoryContext);void 0===f.__scope&&(f.__scope=e)}const h={method:(t.method??s.ym.GET).toLowerCase(),query:f,responseType:"json",headers:p,signal:t.signal};try{const e=(0,i.$j5)(this.config.serverUrl)?.toLowerCase(),r=(0,i.yCG)(d);if(!r)throw N("INVALID_REQUEST_URL");if(this.config.requireHttps&&r.protocol&&"https:"!==r.protocol.toLowerCase())throw N("HTTPS_REQUIRED");const s=(r.hostname||"").toLowerCase();if(e&&s===e&&this.config.token){f.fmetoken||(f.fmetoken=this.config.token);const e={...h.headers??{}};e.Authorization=`fmetoken token=${this.config.token}`,h.headers=e}const o="number"==typeof t.timeout?t.timeout:"number"==typeof this.config.timeout?this.config.timeout:void 0;"number"==typeof o&&o>0&&(h.timeout=o),void 0!==t.cacheHint&&(h.cacheHint=t.cacheHint),void 0!==t.body&&(h.body=t.body);const a=J(V);if(!a)throw N("ARCGIS_MODULE_ERROR");const l=g("fme"),c=await m({method:"string"==typeof h.method?h.method.toUpperCase():"GET",url:d,transport:"fme-flow-api",body:h.body,query:f,correlationId:l,responseInterpreter:{status:P,ok:F,size:j},execute:()=>a(d,h)});return{data:c.data,status:c.httpStatus??c.status??n.jL.OK,statusText:c.statusText??""}}catch(e){if("AbortError"===e?.name)return{data:void 0,status:0,statusText:"requestAborted"};if(e instanceof s.VQ)throw e;const t=(0,c.Ko)(e)||0,r=(0,c.$d)(e);let n="REQUEST_FAILED";(0,i.PEb)(e).includes("Unexpected token")&&(n="INVALID_RESPONSE_FORMAT");const o=(0,a.fV)(e,t),l=k(e),u=o||n;throw new s.VQ(u,n,t,r,void 0,l)}}}const le=e=>({serverUrl:(0,i.P6s)(e.fmeServerUrl)||(0,i.P6s)(Reflect.get(e,"fme_server_url"))||"",token:(0,i.P6s)(e.fmeServerToken)||(0,i.P6s)(Reflect.get(e,"fme_server_token"))||(0,i.P6s)(Reflect.get(e,"fmw_server_token"))||"",repository:e.repository||"",timeout:e.requestTimeout,requireHttps:e.requireHttps});function ce(e){const t=le(e);try{(0,c.e6)(t)}catch{throw N("INVALID_CONFIG")}return new ae({...t,serverUrl:t.serverUrl.replace(/\/$/,"")})}},2242:(e,t,r)=>{"use strict";r.d(t,{CH:()=>T,Gb:()=>m,SB:()=>A,UA:()=>E,Vp:()=>g,YG:()=>b,bQ:()=>O,bn:()=>_,d7:()=>h,ho:()=>I,j_:()=>w,kg:()=>R,qp:()=>C,rG:()=>y,uB:()=>p,yN:()=>f});var n=r(9244),s=r(3930),o=r(7665),i=r(3417),a=r(5880),l=(r(1787),r(3314));const c=e=>!(!e||"object"!=typeof e)&&"string"==typeof e.name,u=e=>Array.isArray(e),d=(e,t)=>{if(e)try{t(e)}catch{}},p=e=>{d(e,(e=>{e.cancel()}))},f=e=>{d(e,(e=>{e.removeAll()}))},h=(e,t,r)=>{const s=(0,l.eF2)(t)?t:0,o=n.React.useRef(null),i=n.React.useRef(!1),a=n.React.useRef(null),c=n.hooks.useLatest(e),u=n.hooks.useLatest(r),d=n.hooks.useEventCallback((e=>{if(i.current===e)return;i.current=e;const t=u.current?.onPendingChange;if("function"==typeof t)try{t(e)}catch{}})),p=n.hooks.useEventCallback((()=>{o.current&&(clearTimeout(o.current),o.current=null),a.current=null,i.current&&d(!1)})),f=n.hooks.useEventCallback(((...e)=>{a.current=e,o.current&&clearTimeout(o.current),d(!0),o.current=setTimeout((()=>{o.current=null,a.current=null;try{c.current(...e)}finally{d(!1)}}),s)})),h=n.hooks.useEventCallback((()=>{if(!a.current)return;const e=a.current;p(),c.current(...e)})),m=n.React.useRef(null),g=n.hooks.useLatest(f),y=n.hooks.useLatest(p),E=n.hooks.useLatest(h);if(!m.current){const e=(...e)=>{g.current(...e)};e.cancel=()=>y.current(),e.flush=()=>E.current(),e.isPending=()=>i.current,m.current=e}const v=n.hooks.useLatest(p);n.hooks.useEffectOnce((()=>()=>{v.current()}));const b=m.current;if(!b)throw new Error("debounceUnavailable");return b},m=e=>{const[t,r]=n.React.useState({modules:null,loading:!0,errorKey:null});return n.hooks.useEffectWithPreviousValues((()=>{let t=!1;r((t=>({modules:0===e?t.modules:null,loading:!0,errorKey:null})));return(async()=>{try{const n=await(0,l.ps9)(i.RF);if(t)return;const[s,o,a,c,u,d,p,f,h,m,g]=n;try{"object"==typeof(e=d)&&null!==e&&"function"==typeof Reflect.get(e,"load")&&await d.load()}catch(e){}r({modules:{SketchViewModel:s,GraphicsLayer:o,geometryEngine:a,geometryEngineAsync:c,webMercatorUtils:u,projection:d,SpatialReference:p,normalizeUtils:f,Polyline:h,Polygon:m,Graphic:g},loading:!1,errorKey:null})}catch(e){t||r({modules:null,loading:!1,errorKey:"errorMapInit"})}var e})(),()=>{t=!0}}),[e]),t},g=()=>{const[e,t]=n.React.useState({jimuMapView:null,sketchViewModel:null,graphicsLayer:null,cleanupHandles:null}),r=n.hooks.useEventCallback(((e,r)=>{t((t=>{if("sketchViewModel"===e&&t.sketchViewModel&&t.sketchViewModel!==r)try{const e=t.sketchViewModel?.__fmeCleanup__;"function"==typeof e&&e()}catch{}if("cleanupHandles"===e&&t.cleanupHandles&&t.cleanupHandles!==r)try{t.cleanupHandles()}catch{}return{...t,[e]:r}}))})),s=n.hooks.useEventCallback((r=>{const{sketchViewModel:n,graphicsLayer:s,jimuMapView:o,cleanupHandles:i}=e;if(i)try{i()}catch{}var a,l;p(n),d(n,(e=>{"function"==typeof e.destroy&&e.destroy()})),a=o,l=s,a?.view?.map&&d(l,(e=>{e.parent&&a.view.map.remove(e)})),f(s),(e=>{d(e,(e=>{const t=e.destroy;"function"==typeof t&&t.call(e)}))})(s),t((e=>({...e,jimuMapView:r?null:e.jimuMapView,sketchViewModel:null,graphicsLayer:null,cleanupHandles:null})))})),o=n.hooks.useEventCallback((()=>{s(!1)})),i=n.hooks.useEventCallback((()=>{s(!0)}));return{...e,setJimuMapView:e=>r("jimuMapView",e),setSketchViewModel:e=>r("sketchViewModel",e),setGraphicsLayer:e=>r("graphicsLayer",e),setCleanupHandles:e=>r("cleanupHandles",e),teardownDrawingResources:o,cleanupResources:i}},y=(e,t)=>n.hooks.useEventCallback(((r,n,s)=>{const o={message:r,type:n,code:s||"UNKNOWN",severity:i.MU.ERROR,recoverable:!0,timestampMs:Date.now(),kind:"serializable",userFriendlyMessage:"",suggestion:""};e(a.fmeActions.setError("general",o,t))})),E=(e,t)=>{const[r,s]=n.React.useState((()=>e.initializeValues())),[o,i]=n.React.useState(!0),[a,l]=n.React.useState({}),c=n.hooks.useEventCallback((e=>{s(e),t?.(e)})),u=n.hooks.useEventCallback(((e,t)=>{const n={...r,[e]:t};c(n)})),d=n.hooks.useEventCallback((()=>{const t=e.validateValues(r);return i(t.isValid),l(t.errors),t})),p=n.hooks.useEventCallback((()=>{const t=e.initializeValues();l({}),i(!0),c(t)}));return{values:r,isValid:o,errors:a,updateField:u,validateForm:d,resetForm:p,setValues:c,setIsValid:i,setErrors:l}};let v=0;const b=()=>{const e=n.React.useRef();return e.current||(v>=Number.MAX_SAFE_INTEGER&&(v=0),v+=1,e.current=`fme-${v}`),e.current},w=(e,t,r)=>{const[s,o]=n.hooks.useControlled({controlled:e,default:t});return[s,n.hooks.useEventCallback((e=>{o(e),r?.(e)}))]},S=e=>{if(!e)return null;const t=e.message,r=e.detail,n=e.messages,s=Array.isArray(n)?n.filter((e=>null!=e)):void 0;return null!=t||null!=r||s&&0!==s.length?{message:t,detail:r,messages:s}:null},R=(e,t)=>{const r=(0,l.eF2)(t)?t:0,[s,o]=n.React.useState("loading"===e.kind),i=n.React.useRef("loading"===e.kind?Date.now():null),a=n.React.useRef("loading"===e.kind?S(e):null),c=n.hooks.useEventCallback((()=>{o(!1),i.current=null,a.current=null}));n.hooks.useEffectWithPreviousValues((()=>{if("loading"===e.kind)return a.current=S(e),null==i.current&&(i.current=Date.now()),void o(!0);if(null==i.current)return void c();const t=Date.now()-i.current,n=(0,l.eF2)(t)?t:0,s=Math.max(0,r-n);if(0===s)return void c();const u=setTimeout((()=>{c()}),s);return()=>{clearTimeout(u)}}),[e,r,c]);const u="loading"===e.kind;return{showLoading:u||s,snapshot:u?S(e):a.current}},O=()=>{const e=n.React.useRef(null),t=n.hooks.useEventCallback((()=>{const t=e.current;(0,l.Wz3)(t),e.current=null})),r=n.hooks.useEventCallback((()=>{t();const r=new AbortController;return e.current=r,r})),s=n.hooks.useEventCallback((t=>{t&&e.current===t&&(e.current=null)}));return{controllerRef:e,abortAndCreate:r,cancel:t,finalize:s}};function T(e,t){return(0,s.I)({queryKey:l.lHd.workspaces(e.repository||i.nu,e.fmeServerUrl,e.fmeServerToken),queryFn:async({signal:t})=>{const r=(0,l.MbC)(e.fmeServerUrl,e.fmeServerToken,e.repository);if(!r)throw new Error("FME client not initialized");const n=e.repository||i.nu,s=await r.getRepositoryItems(n,i.h6,void 0,void 0,t);return Array.isArray(s?.data?.items)?s.data.items:[]},enabled:(t?.enabled??!0)&&Boolean(e.fmeServerUrl&&e.fmeServerToken)})}function A(e,t,r){return(0,s.I)({queryKey:l.lHd.workspaceItem(e,t.repository||i.nu,t.fmeServerUrl,t.fmeServerToken),queryFn:async({signal:r})=>{if(!e)throw new Error("Workspace name required");const n=(0,l.MbC)(t.fmeServerUrl,t.fmeServerToken,t.repository);if(!n)throw new Error("FME client not initialized");const s=t.repository||i.nu,[o,a]=await Promise.allSettled([n.getWorkspaceItem(e,s,r),n.getWorkspaceParameters(e,s,r)]);if("rejected"===o.status){const e=o.reason;throw e instanceof Error?e:new Error("string"==typeof e&&e.trim()?e:"Failed to fetch workspace item")}let d=[];"fulfilled"===a.status&&u(a.value?.data)&&(d=a.value.data);const p=o.value?.data;if(!c(p))throw new Error("Workspace item missing data");return{item:p,parameters:d}},enabled:(r?.enabled??!0)&&Boolean(e&&t.fmeServerUrl&&t.fmeServerToken),staleTime:i.ST.TEN_MINUTES,refetchOnMount:!1})}function I(e,t,r){const s=(0,o.jE)(),[a,c]=n.React.useState((()=>({isPrefetching:!1,progress:null,prefetchStatus:"idle"}))),u=r?.enabled??!0,d=r?.chunkSize??10,p=n.hooks.useLatest(t),f=n.hooks.useLatest(e),h=n.hooks.useLatest(r?.onProgress);return n.hooks.useEffectWithPreviousValues((()=>{const e=f.current;let t=!1;const r=new Set,n=e=>{r.forEach((t=>{(0,l.Wz3)(t,e)})),r.clear()},o=()=>{t=!0,n()};if(!u||!e?.length)return c({isPrefetching:!1,progress:null,prefetchStatus:"idle"}),o;const a=p.current??{},m=a.repository||i.nu,g=a.fmeServerUrl,y=a.fmeServerToken;if(!g||!y)return o;const E=(0,l.MbC)(g,y,m);if(!E)return o;const v=e=>(r.add(e),()=>{r.delete(e)}),b=(e,t)=>(0,l.psn)(e,t);return(async()=>{c({isPrefetching:!0,progress:{loaded:0,total:e.length},prefetchStatus:"loading"});const r=[];for(let t=0;t<e.length;t+=d)r.push(e.slice(t,t+d));let o=0;try{for(const n of r){if(t)break;const r=i.WC.MAX_CONCURRENT_PREFETCH,a={active:0,queue:[]},u=async e=>{for(;a.active>=r;)await new Promise((e=>a.queue.push(e)));a.active++;try{return await e()}finally{a.active--;const e=a.queue.shift();e&&e()}};if(await Promise.allSettled(n.map((e=>u((()=>s.prefetchQuery({queryKey:l.lHd.workspaceItem(e.name,m,g,y),queryFn:async({signal:t})=>{const r=new AbortController,n=v(r),s=b(t,r);try{const t=r.signal,[n,s]=await Promise.all([E.getWorkspaceItem(e.name,m,t),E.getWorkspaceParameters(e.name,m,t)]);return{item:n.data,parameters:Array.isArray(s?.data)?s.data:[]}}finally{s(),n()}},staleTime:i.ST.TEN_MINUTES})))))),t)break;o+=n.length,c((t=>({...t,progress:{loaded:o,total:e.length}}))),h.current?.(o,e.length)}t||c({isPrefetching:!1,progress:null,prefetchStatus:"success"})}catch(e){t||((0,l.fAF)("Workspace prefetch error",e),c({isPrefetching:!1,progress:null,prefetchStatus:"error"}))}finally{n()}})(),o}),[u,s,d,h,t?.repository,t?.fmeServerUrl,t?.fmeServerToken,e]),a}function _(e,t,r=i.ST.MIN_LOADING_DELAY_MS){const s=n.React.useRef({}),o=n.React.useRef({}),l=n.React.useRef(!0),c=e=>{const t=o.current[e];"number"==typeof t&&("undefined"!=typeof window?window.clearTimeout(t):clearTimeout(t),delete o.current[e])},u=n.hooks.useEventCallback(((n,i)=>{if(i)s.current[n]=Date.now(),c(n),e(a.fmeActions.setLoadingFlag(n,!0,t));else{const i=s.current[n];if(i){const u=Date.now()-i,d=Math.max(0,r-u);if(d>0){c(n);const r=("undefined"!=typeof window?window.setTimeout:setTimeout)((()=>{delete o.current[n],l.current&&(e(a.fmeActions.setLoadingFlag(n,!1,t)),delete s.current[n])}),d);o.current[n]=r}else e(a.fmeActions.setLoadingFlag(n,!1,t)),delete s.current[n]}else c(n),e(a.fmeActions.setLoadingFlag(n,!1,t))}}));return n.hooks.useUnmount((()=>{l.current=!1,Object.keys(o.current).forEach((e=>{c(e)}))})),u}function C(e){const t=n.ReactRedux.useDispatch(),r=n.React.useRef({setDrawingTool:r=>{t(a.fmeActions.setDrawingTool(r,e))},setViewMode:r=>{t(a.fmeActions.setViewMode(r,e))},setError:(r,n)=>{t(a.fmeActions.setError(r,n,e))},clearError:r=>{t(a.fmeActions.clearError(r,e))},setGeometry:(r,n)=>{t(a.fmeActions.setGeometry(r,n,e))},setWorkspaceItems:(r,n)=>{t(a.fmeActions.setWorkspaceItems(r,n,e))},applyWorkspaceData:r=>{t(a.fmeActions.applyWorkspaceData(r,e))},completeDrawing:(r,n,s)=>{t(a.fmeActions.completeDrawing(r,n,s,e))},clearWorkspaceState:r=>{t(a.fmeActions.clearWorkspaceState(r,e))},resetState:()=>{t(a.fmeActions.resetState(e))},resetToDrawing:()=>{t(a.fmeActions.resetToDrawing(e))},setLoadingFlag:(r,n)=>{t(a.fmeActions.setLoadingFlag(r,n,e))},setOrderResult:r=>{t(a.fmeActions.setOrderResult(r,e))},completeStartup:()=>{t(a.fmeActions.completeStartup(e))},removeWidgetState:()=>{t(a.fmeActions.removeWidgetState(e))}});return n.hooks.useUpdateEffect((()=>{r.current={setDrawingTool:r=>{t(a.fmeActions.setDrawingTool(r,e))},setViewMode:r=>{t(a.fmeActions.setViewMode(r,e))},setError:(r,n)=>{t(a.fmeActions.setError(r,n,e))},clearError:r=>{t(a.fmeActions.clearError(r,e))},setGeometry:(r,n)=>{t(a.fmeActions.setGeometry(r,n,e))},setWorkspaceItems:(r,n)=>{t(a.fmeActions.setWorkspaceItems(r,n,e))},applyWorkspaceData:r=>{t(a.fmeActions.applyWorkspaceData(r,e))},completeDrawing:(r,n,s)=>{t(a.fmeActions.completeDrawing(r,n,s,e))},clearWorkspaceState:r=>{t(a.fmeActions.clearWorkspaceState(r,e))},resetState:()=>{t(a.fmeActions.resetState(e))},resetToDrawing:()=>{t(a.fmeActions.resetToDrawing(e))},setLoadingFlag:(r,n)=>{t(a.fmeActions.setLoadingFlag(r,n,e))},setOrderResult:r=>{t(a.fmeActions.setOrderResult(r,e))},completeStartup:()=>{t(a.fmeActions.completeStartup(e))},removeWidgetState:()=>{t(a.fmeActions.removeWidgetState(e))}}}),[t,e]),r.current}},2606:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1 1v14h14V1zm9.082 13c-.005-.037-.113-.274-.122-.309a1.5 1.5 0 0 0 .718-1.267 1.2 1.2 0 0 0-.053-.358c.152-.176.263-.383.326-.607q.046.003.093.003c.3.002.593-.091.836-.266q.06.066.126.124c.42.412.977.654 1.564.68H14v2h-3.918M14 11h-.43a1.46 1.46 0 0 1-.906-.433c-.264-.23-.258-.782-.617-.782-.482 0-.52.677-1.003.677-.219 0-.38-.177-.599-.177-.193 0-.445.102-.445.293v.502c0 .424-.506.508-.506.934 0 .171.184.236.184.41 0 .58-.893.502-.893 1.08 0 .191.215.305.215.486V14H6.375q.087-.243.09-.502c0-.547-1.043-.393-1.207-.72-.407-.813.693-1.022.693-1.673 0-.16-.082-.488-.334-.513-.351-.035-.443.154-.797.154a.406.406 0 0 1-.437-.36c0-.386.308-.566.308-.952 0-.25-.102-.393-.102-.643a.62.62 0 0 1 .59-.643c.323 0 .464.264.618.54a.64.64 0 0 0 .617.308c.49 0 .798-.61.798-.977a.47.47 0 0 1 .437-.488c.347 0 .476.36.824.36.57 0 .55-.756 1.053-1.03.618-.332.438-1.052.36-1.44-.032-.169.29-.5.464-.487.72.05.412-.54.412-.823q0-.073.022-.142c.111-.332.595-.438.595-.836 0-.281-.233-.41-.233-.693a.65.65 0 0 1 .22-.44H14zM2 14V2h8.278c-.013.077-.132.356-.132.44 0 .194.038.387.112.567a1.6 1.6 0 0 0-.422.643 1.4 1.4 0 0 0-.074.442 1.7 1.7 0 0 0-.536.43 1.32 1.32 0 0 0-.32 1.091q.046.205.066.414a2 2 0 0 0-.649.67 1.46 1.46 0 0 0-.674-.166 1.45 1.45 0 0 0-1.383 1.086 1.44 1.44 0 0 0-1.086-.469 1.62 1.62 0 0 0-1.591 1.643c0 .254.113.293.084.574s-.29.535-.29 1.022a1.37 1.37 0 0 0 .984 1.29 1.58 1.58 0 0 0-.003 1.549c.143.286.636.774.534.774z"></path></svg>'},2686:e=>{"use strict";e.exports=n},2775:(e,t,r)=>{"use strict";r.d(t,{Zq:()=>o,zs:()=>s});var n={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},s=new class{#f=n;#h=!1;setTimeoutProvider(e){this.#f=e}setTimeout(e,t){return this.#f.setTimeout(e,t)}clearTimeout(e){this.#f.clearTimeout(e)}setInterval(e,t){return this.#f.setInterval(e,t)}clearInterval(e){this.#f.clearInterval(e)}};function o(e){setTimeout(e,0)}},2779:(e,t,r)=>{"use strict";r.d(t,{rH:()=>s,yK:()=>n});const n=e=>e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),s=(e,t="",r)=>{const n=r?.maxLength??512;if(e.length>n)return null;try{return new RegExp(e,t)}catch{return null}}},3040:(e,t,r)=>{"use strict";r.d(t,{Eo:()=>g,Hz:()=>A,Jo:()=>m,Lz:()=>b,Mm:()=>y,_R:()=>v,cL:()=>w,j$:()=>h,o4:()=>S,vl:()=>k});var n=r(9244),s=r(3417),o=r(5132),i=r(3890),a=r(4986),l=r(6920),c=r(1181),u=r(1618),d=r(930);const p=e=>"object"!=typeof e||null===e||Array.isArray(e)?null:e,f=e=>{const t=p(e),r=t?.data;return p(r)??{}},h=(e,t)=>{const r=Boolean(e),n=Boolean(e?.cancelled),s=r&&!n&&Boolean(e?.success),o=t?.syncMode?"sync":"async";return{hasResult:r,isCancelled:n,isSuccess:s,serviceMode:"sync"===e?.serviceMode||"async"===e?.serviceMode?e.serviceMode:o}},m=(e,t,r,s,i,a)=>{if(!e)return(0,o.Qg)(r("msgNoResult"),{code:"NO_RESULT",actions:s.onBack?[{label:r("btnBack"),onClick:s.onBack}]:void 0});const{isCancelled:l,isSuccess:u,serviceMode:d}=h(e,t),p=!l&&!u,f=[];void 0!==e.jobId&&null!==e.jobId&&f.push(`${r("lblJobId")}: ${e.jobId}`),e.workspaceName&&f.push(`${r("lblWorkspace")}: ${e.workspaceName}`);const m="async"===d?"optAsyncMode":"optSyncMode";if(f.push(`${r("lblDelivery")}: ${r(m)}`),e.downloadFilename&&f.push(`${r("lblFilename")}: ${e.downloadFilename}`),e.status&&f.push(`${r("lblFmeStatus")}: ${e.status}`),e.statusMessage&&e.statusMessage!==e.message&&f.push(`${r("lblFmeMessage")}: ${e.statusMessage}`),e.blobMetadata?.type&&f.push(`${r("lblBlobType")}: ${e.blobMetadata.type}`),e.blobMetadata?.size){const t=(0,c.$j)(e.blobMetadata.size);t&&f.push(`${r("lblBlobSize")}: ${t}`)}if("sync"!==d&&e.email){const n=t?.maskEmailOnSuccess&&u?(0,c.q2)(e.email):e.email;f.push(`${r("lblEmail")}: ${n}`)}e.code&&p&&f.push(`${r("lblErrorCode")}: ${e.code}`);let g=null;if(l){g=r((e.code||"").toString().toUpperCase().includes("TIMEOUT")?"msgOrderTimeout":"msgOrderCancelled")}else if(u)"async"===d&&(g=r("msgEmailSent"));else{const t=(e.code||"").toString().toUpperCase(),n=e.message||e.statusMessage||"";g="FME_JOB_CANCELLED_TIMEOUT"===t?r("msgJobTimeout"):"FME_JOB_CANCELLED"===t?r("msgJobCancelled"):"FME_JOB_FAILURE"===t||/FME\s*Flow\s*transformation\s*failed/i.test(n)?r("errTransformFailed"):n||r("msgJobFailed")}const y=[];l?y.push({label:r("btnNewOrder"),onClick:()=>{s.onReuseGeography?.()},type:"primary"}):u?y.push({label:r("btnReuseArea"),onClick:()=>{s.onReuseGeography?.()},type:"primary"}):y.push({label:r("btnRetry"),onClick:()=>{s.onBack?.()},type:"primary"}),y.push({label:r("btnEnd"),onClick:()=>{s.onReset?s.onReset():s.onBack?.()},type:"default"});const E=f.length>0?(0,n.jsx)(n.React.Fragment,null,...f.map(((e,t)=>(0,n.jsx)("div",{key:t},e)))):null;let v=null;if(u&&"sync"===d){const t=e.downloadUrl||a||null;t&&(v=(0,n.jsx)("div",{style:{marginBottom:"0.5rem"}},(0,n.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",download:e.downloadFilename||"download"},r("btnDownloadFallback"))))}const b=i||E||v||g?(0,n.jsx)(n.React.Fragment,null,i,E,v,g&&(0,n.jsx)("div",null,g)):void 0;if(p){const t=r("titleOrderFailed");return(0,o.Qg)(t,{code:e.code,actions:y,detail:b})}return{kind:"success",title:r(l?"titleOrderCancelled":"sync"===d?"titleOrderComplete":"titleOrderConfirmed"),message:void 0,actions:y,detail:b}},g=e=>{if(!e)return e??void 0;const t=e.syncMode;let r="boolean"==typeof t?t:(0,a.Dr)(t);if(void 0===r&&(r=Boolean(t)),"boolean"==typeof t&&t===r)return e;const n={...e,syncMode:r};var s;return"object"!=typeof(s=e)||null===s||Array.isArray(s)||"function"!=typeof s.set||Object.defineProperty(n,"set",{value:e.set,writable:!0,configurable:!0}),n},y=(e,t,r)=>{const n=f(e),o=n._serviceMode,i=(0,a.P6)((0,a.Bv)(o)).toLowerCase();let l;l="sync"===i||"async"===i?i:t?.syncMode?"sync":"async";const c=((e,t)=>{if(!t)return null;if(t.areaWarning)return{reason:"area",value:t.drawnArea,threshold:e?.largeArea};if("number"==typeof e?.largeArea&&null!=t.drawnArea&&t.drawnArea>e.largeArea)return{reason:"area",value:t.drawnArea,threshold:e.largeArea};if(t.formData&&e)try{const r=t.formData?.data||{},n=E({data:r},t.userEmail||"","sync",e),o=t.workspaceItem?.name;if(o&&e.fmeServerUrl&&e.repository&&L({serverUrl:e.fmeServerUrl,repository:e.repository,workspace:o,parameters:n,token:e.fmeServerToken,options:{requireHttps:e.requireHttps}})){const{fullUrl:t}=k(e.fmeServerUrl,e.repository,o,n,e.fmeServerToken,{requireHttps:e.requireHttps});return{reason:"url_length",urlLength:t.length,threshold:s.vA.MAX_URL_LENGTH}}}catch{}return null})(t,{workspaceItem:r?.workspaceItem,areaWarning:r?.areaWarning,drawnArea:r?.drawnArea,formData:e,userEmail:"string"==typeof n.opt_requesteremail?n.opt_requesteremail:""});return c&&"sync"===l?(r?.onModeOverride?.({forcedMode:"async",previousMode:"sync",reason:c.reason,value:c.value,threshold:c.threshold,urlLength:c.urlLength}),"async"):l},E=(e,t,r="async",n)=>{const o=f(e),i=s.qS.includes(r)?r:"async",l={...o,opt_servicemode:i,opt_responseformat:"json",opt_showresult:n?.showResult??!0?"true":"false"},c=(0,a.P6)(t);return"async"===i&&c&&(l.opt_requesteremail=c),l},v=(e,t)=>{if(!t)return e;const r={...e},n=e=>{const t=b(e);if(!(void 0===t||t<=0))return t},s=(()=>{const t=e.opt_servicemode;if("string"==typeof t)return t;const n=r.opt_servicemode;return(0,a.Bv)(n)})(),o=(0,a.P6)(s).toLowerCase(),i="sync"===o||!o&&Boolean(t?.syncMode);if(i||void 0===r.tm_ttc){if(i&&!("tm_ttc"in r)){const e=n(t?.tm_ttc);void 0!==e&&(r.tm_ttc=e)}}else delete r.tm_ttc;if(!("tm_ttl"in r)){const e=n(t?.tm_ttl);void 0!==e&&(r.tm_ttl=e)}return r},b=e=>{if("number"==typeof e&&Number.isFinite(e)){if(e<0)return;return Math.floor(e)}const t=(0,a.Nn)(e);if(!t||!/^\d+$/.test(t))return;const r=Number(t);return!Number.isFinite(r)||r<0?void 0:Math.floor(r)},w=(e,t,r,n,s,o)=>{const{config:i,workspaceParameters:a,workspaceItem:c,areaWarning:d,drawnArea:p}=o||{},f=g(i),h=e?.data||{},m=y({data:h},f,{workspaceItem:c,areaWarning:d,drawnArea:p}),{_serviceMode:b,__upload_file__:w,__remote_dataset_url__:S,...R}=h,O=E({data:R},t,m,f),T=(0,u.QC)(a),A=(0,u.NV)(O,r,n,s,f,T),I=v(A,f);return(0,l.dd)(I,f),I},S=e=>{if(Array.isArray(e))return(0,l.is)((0,l.YD)(e,"name"));const t="object"==typeof e&&null!==e?e:null,r=t?.items;return Array.isArray(r)?(0,l.is)((0,l.YD)(r,"name")):[]},R=(e,t,r)=>({success:!0,blob:e,email:r,workspaceName:t,downloadFilename:`${t}_export.zip`,blobMetadata:{type:(0,a.Nn)(e.type),size:"number"==typeof e.size&&Number.isFinite(e.size)?e.size:void 0}}),O=(e,t,r)=>({success:!0,jobId:"number"==typeof e.jobId?e.jobId:void 0,email:r,workspaceName:t,downloadUrl:e.url,downloadFilename:e.url?`${t}_export.zip`:void 0,status:e.status,statusMessage:e.message}),T=(e,t,r="FME_JOB_FAILURE")=>({success:!1,message:e,code:r,..."number"==typeof t?.jobId&&{jobId:t.jobId},...t?.status&&{status:t.status},...t?.message&&{statusMessage:t.message}}),A=(e,t,r,n)=>{const s=p(e),o=s?.data;if(!o)return{success:!1,message:n("noDataInResponse"),code:"NO_DATA"};const i=p(o),l=i?.blob;if(l instanceof Blob)return R(l,t,r);const c=I(e),u=(c.status||"").toString().trim().toUpperCase();if("ABORTED"===u){const e=c.message||"",t=e.toLowerCase(),r=["timeout","time limit","time-limit","max execution","maximum execution","max runtime","maximum runtime","max run time"].some((e=>t.includes(e)));return{success:!1,cancelled:!0,message:n(r?"jobCancelledTimeout":"jobCancelled"),code:r?"FME_JOB_CANCELLED_TIMEOUT":"FME_JOB_CANCELLED",status:c.status,statusMessage:e,jobId:"number"==typeof c.jobId?c.jobId:void 0}}if(new Set(["FAILURE","FAILED","JOB_FAILURE","FME_FAILURE"]).has(u)){const e=(0,a.Nn)(c.message)||n("jobFailed");return T(e,c,"FME_JOB_FAILURE")}var d;return"SUCCESS"===u||"string"==typeof(d=c.url)&&/^https?:\/\//.test(d)||"number"==typeof c.jobId&&c.jobId>0?O(c,t,r):T(c.message||n("errorJobSubmission"),c)},I=e=>{const t=e||{},r=t?.data?.serviceResponse||t?.data||t,n=r?.statusInfo?.status||r?.status,s=r?.statusInfo?.message||r?.message,o="number"==typeof r?.jobID?r.jobID:r?.id,i=r?.url;return{status:n,message:s,jobId:o,url:i}},_=e=>Array.from(e.entries()).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),C=(e,t={})=>{for(const r of s.T5){const n=b(t[r]);void 0!==n&&e.set(r,String(n))}const r=((e,t)=>{const r=(0,a.Nn)(e);return r?r.slice(0,t):void 0})(t.tm_tag,128);r&&e.set("tm_tag",r)},k=(e,t,r,n={},o,a)=>{const l=(0,d.c$)(e,"fmedatadownload",t,r),c=(0,d.yC)(e)??(0,d.yC)(l)??void 0,u=c?.hostname||"",p=a?.requireHttps??!0,f=a?.strict??(!(e=>{if(!e)return!1;const t=e.replace(/^\[|\]$/g,"").toLowerCase();return"localhost"===t||"::1"===t||t===s.Ef||!!t.startsWith("127.")})(u)&&p),h=(0,i._Y)(l,{strict:f,requireHttps:p});if(!h.ok)throw((e,t,r)=>{const n=new Error(e);return n.code=e,null!=t&&(n.status=t),void 0!==r&&(n.cause=r),n})("WEBHOOK_AUTH_ERROR",0,h.errorKey||"invalid_url");const m=(0,d.XV)(n,[...s.GR],!0);return o&&m.set("token",o),C(m,n),{baseUrl:l,params:m,fullUrl:`${l}?${_(m)}`}},L=e=>{const{serverUrl:t,repository:r,workspace:n,parameters:o={},maxLen:i=s.vA.MAX_URL_LENGTH,token:a,options:l}=e,{fullUrl:c}=k(t,r,n,o,a,l);return"number"==typeof i&&i>0&&c.length>i}},3096:(e,t,r)=>{"use strict";r.d(t,{BL:()=>X,BY:()=>$,Bd:()=>ne,Do:()=>G,EW:()=>ye,Ef:()=>pe,FB:()=>c,FS:()=>de,GB:()=>K,GR:()=>T,H4:()=>te,In:()=>f,K2:()=>ae,KC:()=>v,KF:()=>ue,LZ:()=>q,MA:()=>H,N6:()=>Z,P9:()=>ve,PJ:()=>u,PS:()=>se,Pd:()=>y,QB:()=>Ne,QC:()=>g,R0:()=>C,RF:()=>a,ST:()=>ge,T5:()=>S,Tv:()=>R,Us:()=>ke,VZ:()=>B,Ve:()=>d,WC:()=>oe,Xw:()=>Q,YN:()=>Oe,_$:()=>l,_A:()=>j,a0:()=>xe,aP:()=>Me,ar:()=>re,bD:()=>Ae,cq:()=>_e,cr:()=>W,d:()=>A,d8:()=>N,dv:()=>J,f_:()=>Se,g$:()=>Ce,h6:()=>I,iI:()=>we,j2:()=>Ee,jL:()=>ee,js:()=>Ie,lh:()=>o,m2:()=>ce,mR:()=>ie,nc:()=>i,np:()=>M,nu:()=>_,o0:()=>le,oh:()=>k,pC:()=>be,qS:()=>b,qT:()=>p,qc:()=>m,si:()=>me,tj:()=>z,uV:()=>D,vA:()=>E,vH:()=>V,vN:()=>L,vp:()=>U,wF:()=>h,wS:()=>fe,wq:()=>P,xA:()=>x,xG:()=>Y,xH:()=>F,xW:()=>Le,zo:()=>Te,zw:()=>he});var n=r(9244),s=r(6055);Object.freeze([s.ZW.SET_VIEW_MODE,s.ZW.RESET_STATE,s.ZW.SET_GEOMETRY,s.ZW.SET_DRAWING_TOOL,s.ZW.COMPLETE_DRAWING,s.ZW.SET_ORDER_RESULT,s.ZW.SET_WORKSPACE_ITEMS,s.ZW.SET_WORKSPACE_PARAMETERS,s.ZW.SET_SELECTED_WORKSPACE,s.ZW.SET_WORKSPACE_ITEM,s.ZW.SET_ERROR,s.ZW.SET_ERRORS,s.ZW.CLEAR_WORKSPACE_STATE,s.ZW.CLEAR_ERROR,s.ZW.RESET_TO_DRAWING,s.ZW.COMPLETE_STARTUP,s.ZW.REMOVE_WIDGET_STATE,s.ZW.SET_LOADING_FLAG,s.ZW.APPLY_WORKSPACE_DATA]);const o={[s.nE.STARTUP_VALIDATION]:s.nE.STARTUP_VALIDATION,[s.nE.EXPORT_FORM]:s.nE.WORKSPACE_SELECTION,[s.nE.WORKSPACE_SELECTION]:s.nE.INITIAL,[s.nE.EXPORT_OPTIONS]:s.nE.INITIAL,[s.nE.ORDER_RESULT]:s.nE.INITIAL,[s.nE.DRAWING]:s.nE.INITIAL,[s.nE.INITIAL]:s.nE.INITIAL},i=Object.freeze({modules:!1,submission:!1,workspaces:!1,parameters:!1,geometryValidation:!1}),a=Object.freeze(["esri/widgets/Sketch/SketchViewModel","esri/layers/GraphicsLayer","esri/geometry/geometryEngine","esri/geometry/geometryEngineAsync","esri/geometry/support/webMercatorUtils","esri/geometry/projection","esri/geometry/SpatialReference","esri/geometry/support/normalizeUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/Graphic"]),l=Object.freeze(["esriRequest","esriConfig","projection","webMercatorUtils","SpatialReference"]),c=Object.freeze({esriRequest:()=>Promise.resolve({data:null}),esriConfig:{request:{maxUrlLength:4e3,interceptors:[]}},projection:{},webMercatorUtils:{},SpatialReference:()=>({})}),u=Object.freeze({title:"",listMode:"hide",elevationInfo:{mode:"on-the-ground"}}),d="#0079C1",p=Object.freeze([{value:s.hL.POLYGON,label:"optPolygon",icon:"polygon",tooltip:"tipDrawPolygon",hideLabel:!0},{value:s.hL.RECTANGLE,label:"optRectangle",icon:"rectangle",tooltip:"tipDrawRectangle",hideLabel:!0}]),f=(Object.freeze({WGS84:4326,WEB_MERCATOR:3857}),50),h=1e-6,m=1/111319.49079327358,g=Object.freeze({M2_PER_KM2:1e6,AREA_DECIMALS:2,METERS_PER_KILOMETER:1e3,SQUARE_FEET_PER_SQUARE_MILE:27878400,VERTICES_PER_MS_ESTIMATE:100}),y=Object.freeze([{factor:.3048,label:"ft\xb2",keywords:["foot","feet"],largeUnit:{threshold:g.SQUARE_FEET_PER_SQUARE_MILE,factor:g.SQUARE_FEET_PER_SQUARE_MILE,label:"mi\xb2"}},{factor:.3048006096,label:"ft\xb2",keywords:[]},{factor:1609.344,label:"mi\xb2",keywords:["mile"]},{factor:g.METERS_PER_KILOMETER,label:"km\xb2",keywords:["kilometer"]},{factor:.9144,label:"yd\xb2",keywords:["yard"]},{factor:.0254,label:"in\xb2",keywords:["inch"]},{factor:.01,label:"cm\xb2",keywords:["centimeter"]},{factor:.001,label:"mm\xb2",keywords:["millimeter"]},{factor:1852,label:"nm\xb2",keywords:["nautical"]},{factor:1,label:"m\xb2",keywords:["meter"]}]),E=Object.freeze({BASE_PATH:"/fmeapiv4",MAX_URL_LENGTH:4e3,WEBHOOK_EXCLUDE_KEYS:[],WEBHOOK_LOG_WHITELIST:Object.freeze(["opt_responseformat","opt_showresult","opt_servicemode"])}),v=/\/(?:fmedatadownload|fmedataupload|fmeapiv4)\b/i,b=Object.freeze(["sync","async"]),w=Object.freeze(["tm_ttc","tm_ttl","tm_tag"]),S=Object.freeze(["tm_ttc","tm_ttl"]),R=Object.freeze({text:"TEXT",string:"STRING",text_edit:"TEXT_EDIT",textedit:"TEXT_EDIT",textarea:"TEXT_EDIT",password:"PASSWORD",url:"URL",integer:"INTEGER",int:"INTEGER",float:"FLOAT",number:"FLOAT",decimal:"FLOAT",boolean:"BOOLEAN",bool:"BOOLEAN",checkbox:"CHECKBOX",choice:"CHOICE",dropdown:"CHOICE",select:"CHOICE",listbox:"LISTBOX",lookup_choice:"LOOKUP_CHOICE",lookup_listbox:"LOOKUP_LISTBOX",tree:"SCRIPTED",range:"RANGE_SLIDER",filename:"FILENAME",file:"FILENAME",filename_mustexist:"FILENAME_MUSTEXIST",dirname:"DIRNAME",directory:"DIRNAME",dirname_mustexist:"DIRNAME_MUSTEXIST",dirname_src:"DIRNAME_SRC",lookup_file:"LOOKUP_FILE",date:"DATE",time:"TIME",datetime:"DATETIME",date_time:"DATE_TIME",month:"MONTH",week:"WEEK",color:"COLOR",colour:"COLOR",color_pick:"COLOR_PICK",colorpick:"COLOR_PICK",coordsys:"COORDSYS",coordinate_system:"COORDSYS",geometry:"GEOMETRY",message:"MESSAGE",range_slider:"RANGE_SLIDER",slider:"RANGE_SLIDER",text_or_file:"TEXT_OR_FILE",attribute_name:"ATTRIBUTE_NAME",attribute_list:"ATTRIBUTE_LIST",db_connection:"DB_CONNECTION",web_connection:"WEB_CONNECTION",reprojection_file:"REPROJECTION_FILE",scripted:"SCRIPTED",group:"GROUP"}),O=Object.freeze(["opt_servicemode","opt_responseformat","opt_showresult","opt_requesteremail"]),T=Object.freeze([...E.WEBHOOK_EXCLUDE_KEYS,...w]),A=new Set([...w,...O]),I="workspace",_="_",C=Object.freeze([]),k=(Object.freeze({DEFAULT_CHUNK_SIZE:5,MIN_CHUNK_SIZE:1,MAX_CHUNK_SIZE:15}),Object.freeze(new Set(["MAXX","MINX","MAXY","MINY","AreaOfInterest","AREA","ExtentGeoJson","tm_ttc","tm_ttl","tm_tag"]))),L=Object.freeze(new Set([s.QL.NOVALUE,s.QL.GROUP,s.QL.group])),M=Object.freeze(new Set([s.QL.DB_CONNECTION,s.QL.WEB_CONNECTION,s.QL.ATTRIBUTE_NAME,s.QL.ATTRIBUTE_LIST,s.QL.COORDSYS,s.QL.REPROJECTION_FILE])),N=Object.freeze(new Set([s.QL.LISTBOX,s.QL.LOOKUP_LISTBOX,s.QL.ATTRIBUTE_LIST,s.QL.listbox])),x=Object.freeze({[s.QL.text]:s.Vw.TEXT,[s.QL.number]:s.Vw.NUMBER,[s.QL.checkbox]:s.Vw.CHECKBOX,[s.QL.dropdown]:s.Vw.RADIO,[s.QL.listbox]:s.Vw.MULTI_SELECT,[s.QL.tree]:s.Vw.SELECT,[s.QL.password]:s.Vw.PASSWORD,[s.QL.datetime]:s.Vw.DATE_TIME,[s.QL.message]:s.Vw.MESSAGE,[s.QL.group]:s.Vw.HIDDEN,[s.QL.file]:s.Vw.FILE,[s.QL.color]:s.Vw.COLOR,[s.QL.range]:s.Vw.SLIDER,[s.QL.FLOAT]:s.Vw.NUMERIC_INPUT,[s.QL.INTEGER]:s.Vw.NUMBER,[s.QL.TEXT_EDIT]:s.Vw.TEXTAREA,[s.QL.PASSWORD]:s.Vw.PASSWORD,[s.QL.BOOLEAN]:s.Vw.SWITCH,[s.QL.CHECKBOX]:s.Vw.SWITCH,[s.QL.CHOICE]:s.Vw.RADIO,[s.QL.LOOKUP_CHOICE]:s.Vw.RADIO,[s.QL.LISTBOX]:s.Vw.MULTI_SELECT,[s.QL.LOOKUP_LISTBOX]:s.Vw.MULTI_SELECT,[s.QL.FILENAME]:s.Vw.FILE,[s.QL.FILENAME_MUSTEXIST]:s.Vw.FILE,[s.QL.DIRNAME]:s.Vw.FILE,[s.QL.DIRNAME_MUSTEXIST]:s.Vw.FILE,[s.QL.DIRNAME_SRC]:s.Vw.FILE,[s.QL.DATE_TIME]:s.Vw.DATE_TIME,[s.QL.DATETIME]:s.Vw.DATE_TIME,[s.QL.URL]:s.Vw.URL,[s.QL.LOOKUP_URL]:s.Vw.URL,[s.QL.LOOKUP_FILE]:s.Vw.FILE,[s.QL.DATE]:s.Vw.DATE,[s.QL.TIME]:s.Vw.TIME,[s.QL.MONTH]:s.Vw.MONTH,[s.QL.WEEK]:s.Vw.WEEK,[s.QL.COLOR]:s.Vw.COLOR,[s.QL.COLOR_PICK]:s.Vw.COLOR,[s.QL.RANGE_SLIDER]:s.Vw.SLIDER,[s.QL.MESSAGE]:s.Vw.MESSAGE,[s.QL.TEXT_OR_FILE]:s.Vw.TEXT_OR_FILE,[s.QL.REPROJECTION_FILE]:s.Vw.REPROJECTION_FILE,[s.QL.COORDSYS]:s.Vw.COORDSYS,[s.QL.ATTRIBUTE_NAME]:s.Vw.ATTRIBUTE_NAME,[s.QL.ATTRIBUTE_LIST]:s.Vw.ATTRIBUTE_LIST,[s.QL.DB_CONNECTION]:s.Vw.DB_CONNECTION,[s.QL.WEB_CONNECTION]:s.Vw.WEB_CONNECTION,[s.QL.SCRIPTED]:s.Vw.SCRIPTED}),D=(Object.freeze({FLOAT:"number",INTEGER:"number",BOOLEAN:"boolean",STRING:"text",TEXT:"text"}),64),P=/\|/,F=Object.freeze(["no slider","noslider","without slider"]),j=Object.freeze(["FILENAME","FILENAME_MUSTEXIST","DIRNAME","DIRNAME_MUSTEXIST","DIRNAME_SRC","LOOKUP_FILE","REPROJECTION_FILE"]),U=Object.freeze({DEFAULT_MAX_SIZE_MB:150,ONE_MB_IN_BYTES:1048576,GEOMETRY_PREVIEW_MAX_LENGTH:1500,MAX_FILENAME_LENGTH:128,MAX_NAMESPACE_LENGTH:64,DEFAULT_ALLOWED_EXTENSIONS:Object.freeze([".zip",".kmz",".json",".geojson",".gml"]),DEFAULT_ALLOWED_MIME_TYPES:Object.freeze(new Set(["application/zip","application/x-zip-compressed","application/vnd.google-earth.kmz","application/json","application/geo+json","application/gml+xml","text/plain",""].map((e=>e.toLowerCase())))),FILE_DISPLAY_KEYS:Object.freeze(["text","path","location","value","dataset","defaultValue","fileName","filename","file_path","file","uri","url","name"])}),V=/\.(zip|kmz|json|geojson|gml)(\?.*)?$/i,W=(new Set(["SELECT","COORDSYS","ATTRIBUTE_NAME","DB_CONNECTION","WEB_CONNECTION","REPROJECTION_FILE"]),new Set(["MULTI_SELECT","ATTRIBUTE_LIST"]),Object.freeze({TEXT:"text",FILE:"file"}),Object.freeze(["text","email","tel","search","password","number"]),Object.freeze({email:"phEmail",phone:"phPhone",search:"phSearch"})),B=Object.freeze({MAX_TEXT_LENGTH:5e3,IPV4_OCTET_MAX:255,IPV4_OCTET_MIN:0,MAX_GEOMETRY_VERTICES:5e3,SLIDER_DEFAULT_MAX:100,RGB_MAX:255,RGB_MIN:0}),q=(Object.freeze({VALIDATION:{DEFAULT_TTL_VALUE:"",DEFAULT_TTC_VALUE:""},LIMITS:{MAX_M2_CAP:1e10,MAX_REQUEST_TIMEOUT_MS:6e5},DIRECTIVES:{DESCRIPTION_MAX:512,TAG_MAX:128},COLORS:{BACKGROUND_DARK:"#181818"},TEXT:{LARGE_AREA_MESSAGE_MAX:200}}),Object.freeze(["fmeServerUrl","fmeServerToken","repository"])),G=512,Q=/^[^\s@]{1,64}@[^\s@]{1,253}\.[^\s@]{2,63}$/,$=/\{\s*email\s*\}/i,z=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/,H=/^([0-9]{2}):([0-9]{2})(?::([0-9]{2}))?$/,K=/(Z|[+-]\d{2}(?::?\d{2})?)$/i,X=/\.(\d{1,9})$/,Y=/\baborted?\b/i,J=Object.freeze(new Set(["AbortError","ABORT_ERR","ERR_ABORTED"])),Z=/^(?:error|fel|warning|varning|info)\s*[:\-\u2013\u2014]?\s*/i,ee=Object.freeze({OK:200,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,BAD_REQUEST:400,TIMEOUT:408,GATEWAY_TIMEOUT:504,TOO_MANY_REQUESTS:429,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,NETWORK_ERROR:0,SERVER_ERROR_MIN:500,SERVER_ERROR_MAX:599}),te=Object.freeze({SUCCESS_MIN:200,SUCCESS_MAX:399,CLIENT_ERROR_MIN:400,CLIENT_ERROR_MAX:499,SERVER_ERROR_MIN:500,SERVER_ERROR_MAX:599,MIN_VALID:100,MAX_VALID:599}),re=e=>"number"==typeof e&&e>=te.SUCCESS_MIN&&e<=te.SUCCESS_MAX,ne=e=>"number"==typeof e&&e>=te.MIN_VALID&&e<=te.MAX_VALID,se=e=>!e||e<te.MIN_VALID||(!!(e=>"number"==typeof e&&e>=te.SERVER_ERROR_MIN)(e)||(e===ee.TIMEOUT||e===ee.TOO_MANY_REQUESTS)),oe=Object.freeze({MAX_HISTORY_SIZE:100,API_QUERY_LIMIT:500,RANDOM_ID_LENGTH:8,MAX_RETRY_ATTEMPTS:3,MAX_CONCURRENT_PREFETCH:6}),ie=Object.freeze({enabled:!0,logLevel:"debug",bodyPreviewLimit:1024,warnSlowMs:1e3}),ae=Object.freeze(["failed to fetch","networkerror","net::","dns","enotfound","econnrefused","timeout","name or service not known","err_name_not_resolved","unable to load","/sharing/proxy","proxy"]),le=Object.freeze(["unable to load","/sharing/proxy","proxy"]),ce=4e3,ue=Object.freeze(["localhost",".localhost",".local",".internal",".intranet",".home",".lan",".localdomain"]),de=Object.freeze([{start:[10,0,0,0],end:[10,255,255,255]},{start:[100,64,0,0],end:[100,127,255,255]},{start:[127,0,0,0],end:[127,255,255,255]},{start:[169,254,0,0],end:[169,254,255,255]},{start:[172,16,0,0],end:[172,31,255,255]},{start:[192,168,0,0],end:[192,168,255,255]},{start:[0,0,0,0],end:[0,255,255,255]}]),pe="0:0:0:0:0:0:0:1",fe=Object.freeze(["token","auth","secret","key","password"]),he=/authorization="?[^"]+"?/gi,me=/(token|fmetoken)=([^&\s]+)/gi,ge=Object.freeze({SECOND:1e3,MINUTE:6e4,FIVE_MINUTES:3e5,TEN_MINUTES:6e5,MAX_RESPONSE_TIME:3e5,SLOW_REQUEST_THRESHOLD:1e3,DEBOUNCE_VALIDATION_MS:300,AUTO_DOWNLOAD_DELAY_MS:150,POPUP_CLOSE_DELAY_MS:100,BLOB_URL_CLEANUP_DELAY_MS:12e4,STARTUP_TIMEOUT_MS:15e3,MIN_LOADING_DELAY_MS:400}),ye=Object.freeze({OPACITY_SCALE_FACTOR:100,OUTLINE_WIDTH_SLIDER_MIN:0,OUTLINE_WIDTH_SLIDER_MAX:10,OUTLINE_WIDTH_MIN:.1,OUTLINE_WIDTH_MAX:5,OUTLINE_WIDTH_INCREMENT:.5,OUTLINE_WIDTH_PRECISION:10,AREA_INPUT_STEP:1e3,PERCENT_SLIDER_MAX:100,ICON_SIZE_SMALL:16,ICON_SIZE_MEDIUM:18,ICON_SIZE_LARGE:24,LOADING_SPINNER_SIZE:32}),Ee=Object.freeze({DELAY_ENTER_MS:500,DELAY_NEXT_MS:300,DELAY_LEAVE_MS:300,DELAY_TOUCH_MS:700}),ve=Object.freeze({DELAY_MS:1e3,DETAIL_DELAY_MS:2e3,CYCLE_INTERVAL_MS:4e3}),be=(Object.freeze({TO_ACTIVE:{fromStates:[n.WidgetState.Closed,n.WidgetState.Hidden],toStates:[n.WidgetState.Opened,n.WidgetState.Active]},TO_INACTIVE:{fromStates:[n.WidgetState.Opened,n.WidgetState.Active],toStates:[n.WidgetState.Closed,n.WidgetState.Hidden]},TO_CLOSED:{fromStates:[n.WidgetState.Opened,n.WidgetState.Active],toStates:[n.WidgetState.Closed]},FROM_CLOSED:{fromStates:[n.WidgetState.Closed],toStates:[n.WidgetState.Opened,n.WidgetState.Active]}}),Object.freeze({error:"error.svg",map:"map.svg",polygon:"polygon.svg",rectangle:"rectangle.svg",warning:"warning.svg","person-lock":"person-lock.svg",folder:"folder.svg",data:"data.svg","shared-no":"shared-no.svg","feature-service":"feature-service.svg","link-tilted":"link-tilted.svg",time:"time.svg",setting:"setting.svg",email:"email.svg",info:"info.svg",success:"success.svg"}),Object.freeze({warning:"warning",error:"error",info:"info",success:"success"}),"error"),we=Object.freeze({GEOMETRY_SERIALIZATION_FAILED:"polygon",MAP_MODULES_LOAD_FAILED:"map",FORM_INVALID:"warning"}),Se=Object.freeze([{token:"GEOMETRY",icon:"polygon"},{token:"AREA",icon:"polygon"},{token:"MAP",icon:"map"},{token:"MODULE",icon:"map"},{token:"FORM",icon:"warning"},{token:"TOKEN",icon:"person-lock"},{token:"AUTH",icon:"person-lock"},{token:"REPOSITORY",icon:"folder"},{token:"REPO",icon:"folder"},{token:"DATA",icon:"data"},{token:"NETWORK",icon:"shared-no"},{token:"OFFLINE",icon:"shared-no"},{token:"CONNECTION",icon:"shared-no"},{token:"REQUEST",icon:"shared-no"},{token:"SERVER",icon:"feature-service"},{token:"GATEWAY",icon:"feature-service"},{token:"URL",icon:"link-tilted"},{token:"TIMEOUT",icon:"time"},{token:"CONFIG",icon:"setting"},{token:"EMAIL",icon:"email"}]),Re=(Object.freeze({CANCELLED_PROMISE:"CancelledPromiseError",ABORT:"AbortError"}),Object.freeze([{pattern:/timeout/i,key:"requestTimedOut"},{pattern:/cors/i,key:"corsBlocked"},{pattern:/url.*too/i,key:"urlTooLongMessage"},{pattern:/remote_dataset_workspace_required/i,key:"REMOTE_DATASET_WORKSPACE_REQUIRED"}])),Oe=Object.freeze({codeToKey:{INVALID_RESPONSE_FORMAT:"errorTokenIssue",WEBHOOK_AUTH_ERROR:"errorTokenIssue",WEBHOOK_TIMEOUT:"requestTimedOut",REPOSITORIES_ERROR:"errorRepositoryAccess",REPOSITORY_ITEMS_ERROR:"errorRepositoryAccess",JOB_SUBMISSION_ERROR:"errorJobSubmission",INVALID_CONFIG:"errorSetupRequired",CONFIG_INCOMPLETE:"errorSetupRequired",configMissing:"errorSetupRequired",HTTPS_REQUIRED:"require_https",INVALID_REQUEST_URL:"invalid_url",GEOMETRY_MISSING:"geometryMissingCode",GEOMETRY_TYPE_INVALID:"geometryTypeInvalidCode",GEOMETRY_SERIALIZATION_FAILED:"geometrySerializationFailedCode",URL_TOO_LONG:"urlTooLongMessage",WEBHOOK_URL_TOO_LONG:"urlTooLongMessage",PARAMETER_VALIDATION_ERROR:"errorParameterValidation",WORKSPACE_PARAMETERS_ERROR:"errorWorkspaceParameters"},statusToKey:{401:"errorTokenIssue",408:"requestTimedOut",429:"rateLimitExceeded",431:"headersTooLargeMessage"},messagePatterns:Re}),Te={require_https:"require_https",no_query_or_hash:"invalid_url",invalid_url:"invalid_url"},Ae=Object.freeze(["status","statusCode","httpStatus"]),Ie=(Object.freeze({ERROR:3,WARNING:2,INFO:1}),Object.freeze({general:0,export:1,import:2}),Object.freeze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"})),_e=/&(?:amp|lt|gt|quot|#39);/g,Ce=1114111,ke=320,Le=Object.freeze(["message","error","detail","description","reason","text"]),Me=(Object.freeze({success:"color: #28a745; font-weight: bold",info:"color: #007bff; font-weight: bold",warn:"color: #ffc107; font-weight: bold",error:"color: #dc3545; font-weight: bold",action:"color: #0078d4; font-weight: bold"}),Object.freeze({MIN_YEAR:2020,MAX_YEAR:2100,MAX_MINOR_VERSION:100})),Ne=Object.freeze({DJB2_INITIAL:5381}),xe=Object.freeze({MAX_WINDOW_HIERARCHY_ITERATIONS:100})},3128:(e,t,r)=>{"use strict";r.d(t,{$W:()=>i,MN:()=>c});var n=r(9244),s=r(1888),o=r(3096);const i={icon:{small:o.EW.ICON_SIZE_SMALL,medium:o.EW.ICON_SIZE_MEDIUM,large:o.EW.ICON_SIZE_LARGE},tooltip:{delay:{enter:o.j2.DELAY_ENTER_MS,next:o.j2.DELAY_NEXT_MS,leave:o.j2.DELAY_LEAVE_MS,touch:o.j2.DELAY_TOUCH_MS},position:{top:"top",bottom:"bottom",left:"left",right:"right"},showArrow:!0},button:{defaults:{block:!0,tooltipPosition:"top"},offset:"10px",textPadding:"18px"},zIndex:{selectMenu:1005,overlay:1e3},loading:{width:o.EW.LOADING_SPINNER_SIZE,height:o.EW.LOADING_SPINNER_SIZE,delay:o.P9.DELAY_MS,detailDelay:o.P9.DETAIL_DELAY_MS,cycleInterval:o.P9.CYCLE_INTERVAL_MS},required:"*"},a=e=>({fontFamily:e?.fontFamily,fontWeight:e?.fontWeight?.toString(),fontSize:e?.fontSize,fontStyle:e?.fontStyle,lineHeight:e?.lineHeight,color:e?.color}),l=(e,t={})=>(0,n.css)({display:"inline"===e?"inline-flex":"flex",flexFlow:"column"===e?"column nowrap":"inline"===e?"row wrap":void 0,...t}),c=()=>(e=>{const t=e.sys.spacing,r=e.sys.color,s=e.sys.typography,o=t?.(2),c="1 1 auto";return{row:l("row",{gap:o}),buttonGroup:l("column",{inlineSize:"100%",gap:o}),fullWidth:l("column",{inlineSize:"100%",flex:c,minInlineSize:0}),relative:(0,n.css)({position:"relative"}),rowAlignCenter:(0,n.css)({alignItems:"center"}),disabledPicker:l("row",{pointerEvents:"none"}),textareaResize:(0,n.css)({resize:"vertical"}),parent:l("column",{overflowY:"auto",blockSize:"100%",position:"relative",gap:o,padding:t?.(1),backgroundColor:r?.surface?.paper}),header:l("row",{alignItems:"center",justifyContent:"flex-end",gap:o,marginBlockEnd:t?.(2)}),headerAlert:(0,n.css)({marginInlineEnd:"auto",display:"flex",alignItems:"center"}),content:l("column",{flex:c,minBlockSize:0,gap:o}),centered:l("column",{placeContent:"center",alignItems:"center",textAlign:"center",flex:c,minBlockSize:0,gap:o}),loadingText:(0,n.css)({}),loadingSpinner:(0,n.css)({"& .donut-loading":{top:"60% !important"}}),overlay:(0,n.css)({position:"absolute",inset:"50% auto auto 50%",transform:"translate(-50%, -50%)",textAlign:"center",zIndex:i.zIndex.overlay}),alert:(0,n.css)({width:"100% !important"}),alertInline:(0,n.css)({opacity:.8}),alertContent:l("row",{alignItems:"flex-start",gap:o}),alertMessage:(0,n.css)({flex:c,...a(s?.label2)}),alertIcon:(0,n.css)({display:"inline-flex",alignItems:"center",justifyContent:"center",flex:"0 0 auto"}),typo:{caption:(0,n.css)({...a(s?.body1),marginBlockEnd:t?.(3)}),label:(0,n.css)({...a(s?.label1),fontWeight:"400",marginBlockEnd:0}),title:(0,n.css)({...a(s?.title1),margin:`${t?.(1)} 0`}),instruction:(0,n.css)({textAlign:"center",...a(s?.body1),margin:`${t?.(3)} 0`}),link:(0,n.css)({...a(s?.body1),color:r?.action.link?.default,textDecoration:"underline",wordBreak:"break-all","&:hover":{color:r?.action.link?.hover,textDecoration:"underline"}}),loadingMessage:(0,n.css)({...a(s?.label2)}),required:(0,n.css)({marginInlineStart:t?.(1)}),hint:(0,n.css)({...a(s?.label3),marginBlockStart:t?.(1)}),errorMessage:(0,n.css)({...a(s?.label3),color:r?.error?.main,marginBlockStart:t?.(1)})},btn:{flex:(0,n.css)({flex:c}),group:l("column",{inlineSize:"100%",gap:o}),text:e=>(0,n.css)({flex:c,textAlign:e||"start",paddingInlineEnd:i.button.textPadding}),icon:(0,n.css)({position:"absolute",zIndex:1,insetBlockStart:"50%",insetInlineEnd:i.button.offset,transform:"translateY(-50%)"})},form:{layout:l("column",{flex:c,minBlockSize:0,gap:o}),header:(0,n.css)({flex:"0 0 auto"}),sliderField:l("row",{alignItems:"center",width:"100%",gap:o}),sliderValue:(0,n.css)({...a(s?.label2),textAlign:"center"}),content:l("column",{flex:c,gap:o}),body:l("column",{flex:c,gap:o,overflowY:"auto"}),footer:l("column",{flex:"0 0 auto",gap:o})},field:(0,n.css)({marginBlockEnd:t?.(3)}),checkLabel:l("row",{alignItems:"center",justifyContent:"space-between",inlineSize:"100%"}),selection:{container:l("column",{flex:c,gap:o,minBlockSize:0}),warning:(0,n.css)({marginBlockStart:"auto"}),message:(0,n.css)({marginBlockStart:"auto",...a(s?.body2)})},tooltipWrap:{block:l("row",{inlineSize:"100%",minInlineSize:0}),inline:l("inline",{minInlineSize:0}),anchor:l("row",{flex:c,minInlineSize:0,"& > *":{flex:c,minInlineSize:0}})},stateView:{frame:l("column",{inlineSize:"100%",blockSize:"100%",minBlockSize:0}),error:l("column",{flex:c,inlineSize:"100%",blockSize:"100%",minBlockSize:0,gap:o,alignItems:"stretch"}),errorContent:l("column",{gap:o,flex:"1 1 auto",justifyContent:"center"}),errorIcon:(0,n.css)({marginBlockEnd:t?.(2)??0}),errorActions:(0,n.css)({inlineSize:"100%",marginBlockStart:"auto",alignSelf:"stretch"}),infoLine:(0,n.css)({marginBlockEnd:t?.(2)??0})}}})((0,s.useTheme)())},3314:(e,t,r)=>{"use strict";r.d(t,{zzz:()=>O,_RB:()=>l._R,sIn:()=>i.sI,$Xq:()=>n.$X,LHE:()=>s.LH,Fmk:()=>S,uAi:()=>n.uA,JoK:()=>l.Jo,EjJ:()=>s.Ej,gV5:()=>p,c$7:()=>R.c$,ARn:()=>i.AR,RBD:()=>w,ZFl:()=>A.ZF,UEQ:()=>b,GCs:()=>a.GC,MbC:()=>R.Mb,dBM:()=>R.dB,xry:()=>T,j$x:()=>l.j$,MmJ:()=>l.Mm,eCr:()=>n.eC,PEb:()=>s.PE,$j5:()=>R.$j,o44:()=>l.o4,WZF:()=>s.WZ,SP$:()=>s.SP,hk0:()=>s.hk,Wxj:()=>s.Wx,BU:()=>s.BU,JdW:()=>s.Jd,OkK:()=>a.Ok,JRh:()=>s.JR,xik:()=>s.xi,kzc:()=>s.kz,hSq:()=>R.hS,sJ:()=>a.sJ,SBV:()=>i.SB,Tdo:()=>n.Td,FKs:()=>s.FK,Xk1:()=>s.Xk,bE2:()=>i.bE,OD1:()=>s.OD,HKR:()=>s.HK,rIK:()=>s.rI,m4N:()=>R.m4,zfx:()=>a.zf,Ime:()=>n.Im,E$q:()=>n.E$,BfI:()=>n.Bf,IAu:()=>n.IA,Fhj:()=>R.Fh,xsy:()=>R.xs,YH$:()=>n.YH,eF2:()=>n.eF,P3$:()=>n.P3,QdQ:()=>n.Qd,w$k:()=>n.w$,B9Y:()=>A.B9,psn:()=>a.ps,ps9:()=>m,fAF:()=>a.fA,B_y:()=>n.B_,qmZ:()=>R.qm,fVY:()=>a.fV,W1g:()=>n.W1,HeH:()=>n.He,sLt:()=>n.sL,EoF:()=>l.Eo,wk6:()=>f,QKA:()=>n.QK,psb:()=>n.ps,P9t:()=>_,$em:()=>s.$e,dCw:()=>s.dC,sqe:()=>i.sq,H9i:()=>A.H9,CqL:()=>n.Cq,hUO:()=>n.hU,XlQ:()=>n.Xl,Fv9:()=>v,cLk:()=>l.cL,lHd:()=>R.lH,Ad4:()=>o.Ad,I0Z:()=>s.I0,yol:()=>i.yo,Wz3:()=>a.Wz,qCC:()=>R.qC,yCG:()=>R.yC,XTn:()=>C,dd1:()=>i.dd,rBs:()=>A.rB,Ynv:()=>i.Yn,bNn:()=>a.bN,pZA:()=>A.pZ,Z_x:()=>s.Z_,OxR:()=>s.Ox,RMY:()=>s.RM,$rL:()=>n.$r,Dr1:()=>n.Dr,ITI:()=>n.IT,P6s:()=>n.P6,MeA:()=>n.Me,wKo:()=>n.wK,NnH:()=>n.Nn,BvY:()=>n.Bv,vqZ:()=>n.vq,qpp:()=>I.qp,bQb:()=>I.bQ});r(5880);var n=r(4986),s=r(1181),o=r(1618),i=r(6920),a=r(1138),l=r(3040),c=r(9244);const u=e=>null!=e&&"object"==typeof e,d=new Map,p=(e,t)=>{const r=[e[0],e[1],e[2]],n="number"==typeof t?.outlineWidth?t.outlineWidth:2,s=Math.min(5,Math.max(.1,n)),o="number"==typeof t?.fillOpacity?t.fillOpacity:.2,i=Math.min(1,Math.max(0,o)),a={type:"simple-fill",color:[...r,i],outline:{color:r,width:s}};return{HIGHLIGHT_SYMBOL:a,DRAWING_SYMBOLS:{polygon:a,polyline:{type:"simple-line",color:r,width:s},point:{type:"simple-marker",style:"circle",size:8,color:r,outline:{color:[255,255,255],width:1}}}}},f=e=>{if(!e)return null;const t=e.toLowerCase();return"extent"===t||"rectangle"===t?"rectangle":"polygon"===t?"polygon":null},h=e=>e?.default??e;async function m(e){if(!Array.isArray(e)||!e.length)return[];const t=globalThis?.__ESRI_TEST_STUB__;if("function"==typeof t)return t(e);const n=e.filter((e=>"string"==typeof e&&e.length>0));if(!n.length)return[];const s=JSON.stringify(n),o=d.get(s);if(o)return o;const i=(async()=>{try{const e=await Promise.resolve().then(r.bind(r,2686)),t=e?.loadArcGISJSAPIModules;if("function"!=typeof t)throw new Error("ARCGIS_MODULE_ERROR");return(await t(n)||[]).map(h)}catch(e){throw d.delete(s),console.log("Critical: Failed to load jimu-arcgis module",e),new Error("ARCGIS_MODULE_ERROR")}})();return d.set(s,i),i}const g=(e,t)=>{try{if(e&&"function"==typeof e.closePopup)return void e.closePopup();t&&u(t)&&"function"==typeof t.close&&t.close()}catch{}},y=(e,t)=>{if(!e||!u(e))return null;const r=e,n="boolean"==typeof r.autoOpenEnabled?r.autoOpenEnabled:void 0;g(t,e);try{r.autoOpenEnabled=!1}catch{}let s=null;if("function"==typeof r.watch)try{s=r.watch("visible",(r=>{r&&g(t,e)}))}catch{}return{popup:e,view:t||null,handle:s,prevAutoOpen:n}},E=e=>{if(e){try{e.handle?.remove?.()}catch{}(e=>{const t=e.popup;if(!u(t))return;const r=t;try{const t="boolean"!=typeof e.prevAutoOpen||e.prevAutoOpen;r.autoOpenEnabled=t}catch{}})(e)}};const v=new class{constructor(){this.record=null,this.owners=new Set}acquire(e,t,r){if(!t)return void this.release(e);const n=this.record?.popup;if(!n||n!==t){this.teardown(),this.owners.clear();const e=y(t,r);if(!e)return;this.record=e}this.owners.add(e)}release(e){this.owners.delete(e)&&0===this.owners.size&&this.teardown()}releaseAll(){(0!==this.owners.size||this.record)&&(this.owners.clear(),this.teardown())}teardown(){this.record&&(E(this.record),this.record=null)}},b=(e,t,r)=>{if(!e)return[];const n=[],s=new Set(r||[]);for(const[r,o]of Object.entries(e)){if(r===t||!o)continue;if(s.has(r))continue;const e=o.state;if(!e)continue;const i=String(e).toUpperCase();i!==c.WidgetState.Closed&&i!==c.WidgetState.Hidden&&n.push(r)}return n};function w(e){const t=[];let r=0,n=!1;if(!e)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};const s=e.map;if(!s||!s.layers)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};try{const e=s.allLayers||s.layers;if(!e)return{attributes:t,layerCount:r,totalAttributeCount:0,hasGeometry:n};e.forEach((e=>{if(!e||"object"!=typeof e)return;const s=e;if(!s.type)return;const o="feature"===s.type,i="graphics"===s.type;if(!o&&!i)return;const a=s.fields;if(!a||!Array.isArray(a)||0===a.length)return;r++;const l=s.title||s.name||s.id||"Unknown Layer",c=s.id,u=s.geometryType;u&&(n=!0),a.forEach((e=>{if(!e||!e.name)return;let r;if(e.domain)if("coded-value"===e.domain.type){const t=e.domain;r={type:t.type||"unknown",codedValues:t.codedValues?.map((e=>({name:e.name,code:e.code})))}}else r={type:e.domain.type||"unknown"};const n={name:e.name,alias:e.alias||e.name,type:e.type||"string",nullable:e.nullable??!0,editable:e.editable??!0,layerName:l,layerId:c,geometryType:u,domain:r};t.push(n)}))}))}catch(e){console.log("Error collecting layer attributes",e)}return{attributes:t,layerCount:r,totalAttributeCount:t.length,hasGeometry:n}}function S(e){if(!e||!e.attributes||0===e.attributes.length)return[];const t=new Set,r=[];return e.attributes.forEach((e=>{if(!e||!e.name)return;if(t.has(e.name))return;t.add(e.name);const n=e.layerName&&"Unknown Layer"!==e.layerName?`${e.name} (${e.layerName})`:e.alias||e.name;r.push({value:e.name,label:n})})),r.sort(((e,t)=>e.label.localeCompare(t.label))),r}var R=r(930);const O={TO_ACTIVE:{fromStates:[c.WidgetState.Closed,c.WidgetState.Hidden],toStates:[c.WidgetState.Opened,c.WidgetState.Active]},TO_INACTIVE:{fromStates:[c.WidgetState.Opened,c.WidgetState.Active],toStates:[c.WidgetState.Closed,c.WidgetState.Hidden]},TO_CLOSED:{fromStates:[c.WidgetState.Opened,c.WidgetState.Active],toStates:[c.WidgetState.Closed]},FROM_CLOSED:{fromStates:[c.WidgetState.Closed],toStates:[c.WidgetState.Opened,c.WidgetState.Active]}},T=e=>({isTransition:(e,t,r)=>((e,t,r)=>{if(!e||!t)return!1;const n=r.fromStates.includes(e),s=r.toStates.includes(t);return n&&s})(e,t,r),log:(t,r,n)=>{((e,t,r,n)=>{const s=t||"undefined",o=r||"undefined";console.log(`[FME Widget ${e}] State transition: ${s} \u2192 ${o}`,n?{...n}:"")})(e,t,r,n)},isActive:e=>(e=>{if(!e)return!1;const t=String(e).toUpperCase();return t===c.WidgetState.Opened||t===c.WidgetState.Active})(e),isInactive:e=>(e=>{if(!e)return!0;const t=String(e).toUpperCase();return t===c.WidgetState.Closed||t===c.WidgetState.Hidden})(e)});var A=r(3890),I=r(2242);const _=e=>{const t=e.id;if("string"==typeof t&&t)return t;const r=e.widgetId;return"string"==typeof r&&r?r:""},C=e=>{if(!e)return"";try{return JSON.stringify(e)}catch{return""}}},3417:(e,t,r)=>{"use strict";r.d(t,{$W:()=>i.$W,BL:()=>s.BL,BY:()=>s.BY,Bd:()=>s.Bd,By:()=>n.By,Dd:()=>o.Dd,Do:()=>s.Do,Ef:()=>s.Ef,FS:()=>s.FS,GB:()=>s.GB,GR:()=>s.GR,In:()=>s.In,KF:()=>s.KF,LZ:()=>s.LZ,MA:()=>s.MA,MN:()=>i.MN,MU:()=>n.MU,N6:()=>s.N6,OX:()=>n.OX,PJ:()=>s.PJ,PS:()=>s.PS,Pd:()=>s.Pd,QB:()=>s.QB,QC:()=>s.QC,QL:()=>n.QL,Qg:()=>o.Qg,R0:()=>s.R0,RF:()=>s.RF,ST:()=>s.ST,T5:()=>s.T5,VQ:()=>o.VQ,VZ:()=>s.VZ,Ve:()=>s.Ve,Vw:()=>n.Vw,WC:()=>s.WC,Xw:()=>s.Xw,YN:()=>s.YN,ZW:()=>n.ZW,_$:()=>s._$,_A:()=>s._A,a0:()=>s.a0,aE:()=>o.aE,bD:()=>s.bD,cq:()=>s.cq,d:()=>s.d,d8:()=>s.d8,dv:()=>s.dv,f_:()=>s.f_,g$:()=>s.g$,h6:()=>s.h6,hL:()=>n.hL,iI:()=>s.iI,jL:()=>s.jL,js:()=>s.js,lh:()=>s.lh,m2:()=>s.m2,nE:()=>n.nE,nc:()=>s.nc,np:()=>s.np,nu:()=>s.nu,oh:()=>s.oh,pC:()=>s.pC,qS:()=>s.qS,qT:()=>s.qT,qc:()=>s.qc,tj:()=>s.tj,uV:()=>s.uV,vA:()=>s.vA,vH:()=>s.vH,vN:()=>s.vN,vp:()=>s.vp,wF:()=>s.wF,wq:()=>s.wq,xA:()=>s.xA,xG:()=>s.xG,xH:()=>s.xH,ym:()=>n.ym,zo:()=>s.zo});var n=r(6055),s=r(3096),o=r(5132),i=r(3128)},3624:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},3744:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},3890:(e,t,r)=>{"use strict";r.d(t,{$d:()=>w,B9:()=>E,CL:()=>o,H9:()=>a,Ko:()=>b,Rv:()=>O,Xz:()=>T,ZF:()=>i,_Y:()=>h,dC:()=>m,e6:()=>S,id:()=>v,pZ:()=>u,rB:()=>c,sW:()=>p,ut:()=>d});var n=r(3417),s=r(3314);const o=e=>{const t=(0,s.BvY)(e);if(!t||t.length>n.m2)return!1;let r;try{r=new URL(t)}catch{return!1}if(r.username||r.password||"https:"!==r.protocol)return!1;const o=r.hostname.toLowerCase();if(!o||(e=>{const t=e.toLowerCase();return n.KF.some((e=>t===e||t.endsWith(e)))})(o))return!1;const i=(e=>{const t=e.split(".");if(4!==t.length)return null;const r=t.map((e=>{if(!/^\d+$/.test(e))return NaN;const t=Number(e);return t>=n.VZ.IPV4_OCTET_MIN&&t<=n.VZ.IPV4_OCTET_MAX?t:NaN}));return r.every(Number.isInteger)?Object.freeze(r):null})(o);if(i&&(a=i,n.FS.some((({start:e,end:t})=>a.every(((r,n)=>r>=e[n]&&r<=t[n]))))))return!1;var a;if(o.includes(":")&&(e=>{const t=e.toLowerCase();return"::1"===t||t.startsWith("::1:")||"0:0:0:0:0:0:0:1"===t||t.startsWith("fc")||t.startsWith("fd")||/^fe[89ab][0-9a-f]/i.test(t)})(o))return!1;if(/\.[^/]+$/.test(r.pathname)){const e=`${r.pathname}${r.search}`;if(!n.vH.test(e))return!1}return!0},i=(e,t)=>{if(!e||!t?.length)return;return t.every((e=>(e=>{if((0,s.BfI)(e))return!0;if("string"!=typeof e)return!1;const t=e.trim();if(!t)return!1;const r=Number(t);return Number.isFinite(r)&&String(r)===t})(e.value)))?"number":void 0},a=e=>{if(Array.isArray(e))return e.map((e=>"string"==typeof e?e:String(e)));if("string"==typeof e)try{const t=JSON.parse(e);return(0,s.eCr)(t).map(String).filter(Boolean)}catch{return e?[e]:[]}return[]},l=e=>Boolean(e?.allowRemoteDataset),c=(e,t)=>{if(!l(t))return!1;if(!t?.allowRemoteUrlDataset)return!1;const r=(0,s.NnH)(e);return!!r&&o(r)},u=(e,t)=>!!l(e)&&(!!t&&("undefined"!=typeof Blob&&t instanceof Blob||(0,s.E$q)(t))),d=(e,t,r)=>{switch(e){case"integer":return(0,s.IAu)(r)?null:`${t}:integer`;case"float":return(0,s.BfI)(r)||(0,s.P3$)(r)?null:`${t}:number`;default:return null}},p=(e,t,r,n)=>{if(!r)return null;const s=e=>"number"==typeof e&&Number.isFinite(e)||"string"==typeof e?e:"boolean"==typeof e?e?"true":"false":JSON.stringify(e??null);if(n){if((Array.isArray(t)?t:[t]).some((e=>!r.has(s(e)))))return`${e}:choice`}else if(!r.has(s(t)))return`${e}:choice`;return null},f=e=>{const t=(0,s.yCG)(e||"");if(!t)return"";t.search="",t.hash="",t.username="",t.password="";const r="/"===t.pathname?"":t.pathname.replace(/\/$/,"");return`${t.origin}${r}`};function h(e,t){const r=(0,s.NnH)(e);if(!r)return{ok:!1,errorKey:"invalid_url"};const n=m(r,t);if(!n.ok){const e="reason"in n?n.reason:void 0;return{ok:!1,errorKey:g(e)}}return{ok:!0,normalized:f(r)||r}}function m(e,t){const r=(0,s.BvY)(e);if(!r)return{ok:!1,reason:"invalid_url"};try{const e=new URL(r),n=e.protocol.toLowerCase();if("http:"!==n&&"https:"!==n)return{ok:!1,reason:"invalid_url"};if(t?.requireHttps&&"https:"!==n)return{ok:!1,reason:"require_https"};if(e.username||e.password)return{ok:!1,reason:"invalid_url"};if(e.search||e.hash)return{ok:!1,reason:"no_query_or_hash"};if(e.hostname.endsWith("."))return{ok:!1,reason:"invalid_url"};if(t?.strict){const t=e.hostname||"";if(!t.includes(".")||t.length<4)return{ok:!1,reason:"invalid_url"}}return{ok:!0}}catch{return{ok:!1,reason:"invalid_url"}}}const g=e=>e&&n.zo[e]||"invalid_url",y=/^no[-_]?reply@/i,E=e=>!("string"!=typeof e||!e)&&(!y.test(e)&&n.Xw.test(e)),v=e=>{const t=(0,s.NnH)(e);return t&&E(t)?t:void 0},b=e=>{if(!e||"object"!=typeof e)return;const t=e;for(const e of n.bD){const r=t[e];if((0,n.Bd)(r))return r}const r=t.details;if(r&&"object"==typeof r){const e=r,t=e.httpStatus??e.status;if((0,n.Bd)(t))return t}const o=(0,s.PEb)(e);if("string"==typeof o){const e=/status:\s*(\d{3})/i.exec(o);if(e){const t=parseInt(e[1],10);if((0,n.Bd)(t))return t}}},w=e=>{if(e&&"object"==typeof e){const t=e;if("boolean"==typeof t.isRetryable)return t.isRetryable}const t=b(e);return(0,n.PS)(t)},S=e=>{if(!e.serverUrl||!e.token||!e.repository)throw new Error("Missing required configuration")},R=e=>e?n.LZ.filter((t=>!e[t]?.trim())):[...n.LZ];const O=(e,t,r)=>{const n=R(e),s=r?.mapConfigured??!0;return n.length>0||!s?{isValid:!1,canProceed:!1,requiresSettings:!0}:{isValid:!0,canProceed:!0,requiresSettings:!1}},T=e=>{const t=e.trim();return/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(t)}},3930:(e,t,r)=>{"use strict";r.d(t,{I:()=>C});var n=r(9658),s=r(6261),o=r(9757),i=r(6500),a=r(4658),l=r(4880),c=r(2775),u=class extends i.Q{constructor(e,t){super(),this.options=t,this.#m=e,this.#g=null,this.#y=(0,a.T)(),this.bindMethods(),this.setOptions(t)}#m;#E=void 0;#v=void 0;#b=void 0;#w;#S;#y;#g;#R;#O;#T;#A;#I;#_;#C=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#E.addObserver(this),d(this.#E,this.options)?this.#k():this.updateResult(),this.#L())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return p(this.#E,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return p(this.#E,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#M(),this.#N(),this.#E.removeObserver(this)}setOptions(e){const t=this.options,r=this.#E;if(this.options=this.#m.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.Eh)(this.options.enabled,this.#E))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#E.setOptions(this.options),t._defaulted&&!(0,l.f8)(this.options,t)&&this.#m.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#E,observer:this});const n=this.hasListeners();n&&f(this.#E,r,this.options,t)&&this.#k(),this.updateResult(),!n||this.#E===r&&(0,l.Eh)(this.options.enabled,this.#E)===(0,l.Eh)(t.enabled,this.#E)&&(0,l.d2)(this.options.staleTime,this.#E)===(0,l.d2)(t.staleTime,this.#E)||this.#D();const s=this.#P();!n||this.#E===r&&(0,l.Eh)(this.options.enabled,this.#E)===(0,l.Eh)(t.enabled,this.#E)&&s===this.#_||this.#F(s)}getOptimisticResult(e){const t=this.#m.getQueryCache().build(this.#m,e),r=this.createResult(t,e);return function(e,t){if(!(0,l.f8)(e.getCurrentResult(),t))return!0;return!1}(this,r)&&(this.#b=r,this.#S=this.options,this.#w=this.#E.state),r}getCurrentResult(){return this.#b}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"!==r||this.options.experimental_prefetchInRender||"pending"!==this.#y.status||this.#y.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(e,r))})}trackProp(e){this.#C.add(e)}getCurrentQuery(){return this.#E}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#m.defaultQueryOptions(e),r=this.#m.getQueryCache().build(this.#m,t);return r.fetch().then((()=>this.createResult(r,t)))}fetch(e){return this.#k({...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),this.#b)))}#k(e){this.#x();let t=this.#E.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.lQ)),t}#D(){this.#M();const e=(0,l.d2)(this.options.staleTime,this.#E);if(l.S$||this.#b.isStale||!(0,l.gn)(e))return;const t=(0,l.j3)(this.#b.dataUpdatedAt,e)+1;this.#A=c.zs.setTimeout((()=>{this.#b.isStale||this.updateResult()}),t)}#P(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#E):this.options.refetchInterval)??!1}#F(e){this.#N(),this.#_=e,!l.S$&&!1!==(0,l.Eh)(this.options.enabled,this.#E)&&(0,l.gn)(this.#_)&&0!==this.#_&&(this.#I=c.zs.setInterval((()=>{(this.options.refetchIntervalInBackground||n.m.isFocused())&&this.#k()}),this.#_))}#L(){this.#D(),this.#F(this.#P())}#M(){this.#A&&(c.zs.clearTimeout(this.#A),this.#A=void 0)}#N(){this.#I&&(c.zs.clearInterval(this.#I),this.#I=void 0)}createResult(e,t){const r=this.#E,n=this.options,s=this.#b,i=this.#w,c=this.#S,u=e!==r?e.state:this.#v,{state:p}=e;let m,g={...p},y=!1;if(t._optimisticResults){const s=this.hasListeners(),i=!s&&d(e,t),a=s&&f(e,r,t,n);(i||a)&&(g={...g,...(0,o.k)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(g.fetchStatus="idle")}let{error:E,errorUpdatedAt:v,status:b}=g;m=g.data;let w=!1;if(void 0!==t.placeholderData&&void 0===m&&"pending"===b){let e;s?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(e=s.data,w=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#T?.state.data,this.#T):t.placeholderData,void 0!==e&&(b="success",m=(0,l.pl)(s?.data,e,t),y=!0)}if(t.select&&void 0!==m&&!w)if(s&&m===i?.data&&t.select===this.#R)m=this.#O;else try{this.#R=t.select,m=t.select(m),m=(0,l.pl)(s?.data,m,t),this.#O=m,this.#g=null}catch(e){this.#g=e}this.#g&&(E=this.#g,m=this.#O,v=Date.now(),b="error");const S="fetching"===g.fetchStatus,R="pending"===b,O="error"===b,T=R&&S,A=void 0!==m,I={status:b,fetchStatus:g.fetchStatus,isPending:R,isSuccess:"success"===b,isError:O,isInitialLoading:T,isLoading:T,data:m,dataUpdatedAt:g.dataUpdatedAt,error:E,errorUpdatedAt:v,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>u.dataUpdateCount||g.errorUpdateCount>u.errorUpdateCount,isFetching:S,isRefetching:S&&!R,isLoadingError:O&&!A,isPaused:"paused"===g.fetchStatus,isPlaceholderData:y,isRefetchError:O&&A,isStale:h(e,t),refetch:this.refetch,promise:this.#y,isEnabled:!1!==(0,l.Eh)(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===I.status?e.reject(I.error):void 0!==I.data&&e.resolve(I.data)},n=()=>{const e=this.#y=I.promise=(0,a.T)();t(e)},s=this.#y;switch(s.status){case"pending":e.queryHash===r.queryHash&&t(s);break;case"fulfilled":"error"!==I.status&&I.data===s.value||n();break;case"rejected":"error"===I.status&&I.error===s.reason||n()}}return I}updateResult(){const e=this.#b,t=this.createResult(this.#E,this.options);if(this.#w=this.#E.state,this.#S=this.options,void 0!==this.#w.data&&(this.#T=this.#E),(0,l.f8)(t,e))return;this.#b=t;this.#j({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#C.size)return!0;const n=new Set(r??this.#C);return this.options.throwOnError&&n.add("error"),Object.keys(this.#b).some((t=>{const r=t;return this.#b[r]!==e[r]&&n.has(r)}))})()})}#x(){const e=this.#m.getQueryCache().build(this.#m,this.options);if(e===this.#E)return;const t=this.#E;this.#E=e,this.#v=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#L()}#j(e){s.jG.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e(this.#b)})),this.#m.getQueryCache().notify({query:this.#E,type:"observerResultsUpdated"})}))}};function d(e,t){return function(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&p(e,t,t.refetchOnMount)}function p(e,t,r){if(!1!==(0,l.Eh)(t.enabled,e)&&"static"!==(0,l.d2)(t.staleTime,e)){const n="function"==typeof r?r(e):r;return"always"===n||!1!==n&&h(e,t)}return!1}function f(e,t,r,n){return(e!==t||!1===(0,l.Eh)(n.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&h(e,r)}function h(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&e.isStaleByTime((0,l.d2)(t.staleTime,e))}var m=r(8972),g=r(7665);r(4848);function y(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var E=m.createContext(y()),v=()=>m.useContext(E),b=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},w=e=>{m.useEffect((()=>{e.clearReset()}),[e])},S=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&void 0===e.data||(0,l.GU)(r,[e.error,n])),R=m.createContext(!1),O=()=>m.useContext(R),T=(R.Provider,e=>{if(e.suspense){const t=1e3,r=e=>"static"===e?e:Math.max(e??t,t),n=e.staleTime;e.staleTime="function"==typeof n?(...e)=>r(n(...e)):r(n),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}}),A=(e,t)=>e.isLoading&&e.isFetching&&!t,I=(e,t)=>e?.suspense&&t.isPending,_=(e,t,r)=>t.fetchOptimistic(e).catch((()=>{r.clearReset()}));function C(e,t){return function(e,t,r){const n=O(),o=v(),i=(0,g.jE)(r),a=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(a),a._optimisticResults=n?"isRestoring":"optimistic",T(a),b(a,o),w(o);const c=!i.getQueryCache().get(a.queryHash),[u]=m.useState((()=>new t(i,a))),d=u.getOptimisticResult(a),p=!n&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback((e=>{const t=p?u.subscribe(s.jG.batchCalls(e)):l.lQ;return u.updateResult(),t}),[u,p]),(()=>u.getCurrentResult()),(()=>u.getCurrentResult())),m.useEffect((()=>{u.setOptions(a)}),[a,u]),I(a,d))throw _(a,u,o);if(S({result:d,errorResetBoundary:o,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw d.error;if(i.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!l.S$&&A(d,n)){const e=c?_(a,u,o):i.getQueryCache().get(a.queryHash)?.promise;e?.catch(l.lQ).finally((()=>{u.updateResult()}))}return a.notifyOnChangeProps?d:u.trackResult(d)}(e,u,t)}},4321:e=>{"use strict";e.exports=a},4337:e=>{"use strict";e.exports=i},4658:(e,t,r)=>{"use strict";function n(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));function n(e){Object.assign(r,e),delete r.resolve,delete r.reject}return r.status="pending",r.catch((()=>{})),r.resolve=t=>{n({status:"fulfilled",value:t}),e(t)},r.reject=e=>{n({status:"rejected",reason:e}),t(e)},r}r.d(t,{T:()=>n})},4712:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1.333 0h4c.737 0 1.334.597 1.334 1.333v1.334h8C15.403 2.667 16 3.264 16 4v10.667c0 .736-.597 1.333-1.333 1.333H1.333A1.333 1.333 0 0 1 0 14.667V1.333C0 .597.597 0 1.333 0m0 7.333v7.334h13.334V7.333zm0-1.333h13.334V4H5.334V1.335h-4z" clip-rule="evenodd"></path></svg>'},4848:(e,t,r)=>{"use strict";e.exports=r(1020)},4880:(e,t,r)=>{"use strict";r.d(t,{Cp:()=>m,EN:()=>h,Eh:()=>u,F$:()=>f,GU:()=>_,MK:()=>d,S$:()=>s,ZM:()=>I,ZZ:()=>T,Zw:()=>i,d2:()=>c,f8:()=>E,gn:()=>a,hT:()=>A,j3:()=>l,lQ:()=>o,nJ:()=>p,pl:()=>R,y9:()=>O,yy:()=>S});var n=r(2775),s="undefined"==typeof window||"Deno"in globalThis;function o(){}function i(e,t){return"function"==typeof e?e(t):e}function a(e){return"number"==typeof e&&e>=0&&e!==1/0}function l(e,t){return Math.max(e+(t||0)-Date.now(),0)}function c(e,t){return"function"==typeof e?e(t):e}function u(e,t){return"function"==typeof e?e(t):e}function d(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:o,queryKey:i,stale:a}=e;if(i)if(n){if(t.queryHash!==f(i,t.options))return!1}else if(!m(t.queryKey,i))return!1;if("all"!==r){const e=t.isActive();if("active"===r&&!e)return!1;if("inactive"===r&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&((!s||s===t.state.fetchStatus)&&!(o&&!o(t)))}function p(e,t){const{exact:r,status:n,predicate:s,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(r){if(h(t.options.mutationKey)!==h(o))return!1}else if(!m(t.options.mutationKey,o))return!1}return(!n||t.state.status===n)&&!(s&&!s(t))}function f(e,t){return(t?.queryKeyHashFn||h)(e)}function h(e){return JSON.stringify(e,((e,t)=>b(t)?Object.keys(t).sort().reduce(((e,r)=>(e[r]=t[r],e)),{}):t))}function m(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every((r=>m(e[r],t[r]))))}var g=Object.prototype.hasOwnProperty;function y(e,t){if(e===t)return e;const r=v(e)&&v(t);if(!(r||b(e)&&b(t)))return t;const n=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),o=s.length,i=r?new Array(o):{};let a=0;for(let l=0;l<o;l++){const o=r?l:s[l],c=e[o],u=t[o];if(c===u){i[o]=c,(r?l<n:g.call(e,o))&&a++;continue}if(null===c||null===u||"object"!=typeof c||"object"!=typeof u){i[o]=u;continue}const d=y(c,u);i[o]=d,d===c&&a++}return n===o&&a===n?e:i}function E(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function v(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function b(e){if(!w(e))return!1;const t=e.constructor;if(void 0===t)return!0;const r=t.prototype;return!!w(r)&&(!!r.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function w(e){return"[object Object]"===Object.prototype.toString.call(e)}function S(e){return new Promise((t=>{n.zs.setTimeout(t,e)}))}function R(e,t,r){return"function"==typeof r.structuralSharing?r.structuralSharing(e,t):!1!==r.structuralSharing?y(e,t):t}function O(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function T(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var A=Symbol();function I(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==A?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function _(e,t){return"function"==typeof e?e(...t):!!e}},4945:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M28 6h2v20h-2zM17 6l-1.43 1.393L23.15 15H2v2h21.15l-7.58 7.573L17 26l10-10z"></path></svg>'},4986:(e,t,r)=>{"use strict";r.d(t,{$X:()=>F,$r:()=>A,B_:()=>q,Bf:()=>v,Bv:()=>h,Cq:()=>k,Dr:()=>O,E:()=>U,E$:()=>R,Gt:()=>W,He:()=>V,IA:()=>w,IT:()=>x,Im:()=>d,Me:()=>T,N7:()=>j,Nn:()=>g,P3:()=>S,P6:()=>m,QK:()=>f,Qd:()=>E,Td:()=>G,W1:()=>M,Xl:()=>C,YH:()=>p,eC:()=>I,eF:()=>b,hU:()=>L,ps:()=>P,sL:()=>D,uA:()=>B,vq:()=>N,w$:()=>l,wK:()=>y});var n=r(3096);const s=(e,t)=>{if("string"==typeof e){const r=e.trim();return r||t?.allowEmpty?r:t?.nullable?null:void 0}return t?.allowNumeric&&"number"==typeof e&&Number.isFinite(e)?String(e):t?.nullable?null:void 0},o=e=>"string"==typeof e,i=e=>"number"==typeof e,a=e=>"boolean"==typeof e,l=e=>"string"==typeof e||"number"==typeof e,c=e=>null===e,u=e=>null==e,d=e=>null==e||""===e||(Array.isArray(e)?0===e.length:!!o(e)&&0===e.trim().length),p=e=>o(e)&&e.trim().length>0,f=e=>o(e)?e.trim().toLowerCase():"",h=e=>g(e)??"",m=(e,t="")=>{const r=g(e);return r&&r.length>0?r:t},g=e=>s(e,{allowNumeric:!1}),y=e=>s(e,{allowNumeric:!0}),E=e=>"object"==typeof e&&!c(e)&&!Array.isArray(e),v=e=>i(e)&&Number.isFinite(e),b=e=>v(e)&&e>=0,w=e=>v(e)&&Number.isInteger(e),S=e=>{if(!o(e))return!1;const t=e.trim();if(!t)return!1;const r=Number(t);return Number.isFinite(r)},R=e=>e instanceof File,O=e=>{if(a(e))return e;if(i(e)){if(!Number.isFinite(e))return;return 0!==e}const t=s(e,{allowNumeric:!1});if(!t)return;const r=t.toLowerCase();return!!["true","1","yes","y","on"].includes(r)||!["false","0","no","n","off"].includes(r)&&void 0},T=e=>{if(v(e))return e;const t=s(e,{allowNumeric:!1});if(!t)return;const r=Number(t);return Number.isFinite(r)?r:void 0},A=e=>Array.isArray(e)?e:null==e?[]:[e],I=e=>Array.isArray(e)?e:[],_=(e,t,r,n)=>{if(!e)return n;for(const n of t){const t=r(e[n]);if(void 0!==t)return t}return n},C=(e,t)=>_(e,t,y),k=(e,t,r=!1)=>_(e,t,O,r)??r,L=(e,t)=>_(e,t,T),M=e=>{const t={};for(const r of e)if(E(r))for(const[e,n]of Object.entries(r))null==n||e in t||(t[e]=n);return t},N=e=>{if(Array.isArray(e))return e;if(E(e))for(const t of["data","items","options"]){const r=e[t];if(Array.isArray(r))return r}},x=e=>{if(!E(e))return;const t=Object.entries(e).filter((([,e])=>void 0!==e));return t.length?Object.fromEntries(t):void 0},D=e=>v(e)||o(e)?e:a(e)?e?"true":"false":JSON.stringify(e??null),P=e=>{if(!u(e)){if(o(e)){const t=e.trim();if(!t)return;return D(t)}return i(e)||a(e)?D(e):void 0}},F=(e,t)=>{const r=P(e);if(void 0===r)return!1;const n=P(t);return void 0!==n&&r===n},j=e=>{if(o(e))return e;if(i(e)||a(e))return String(e);if(void 0===e)return"undefined";if(c(e))return"null";if("object"==typeof e)try{return JSON.stringify(e)}catch{return Object.prototype.toString.call(e)}return Object.prototype.toString.call(e)},U=(e,t)=>(g(e)??"").replace(/[^A-Za-z0-9_\-]/g,"").trim()||t,V=(e,t)=>u(e)?t?[]:"":t?Array.isArray(e)?e:[e]:o(e)||i(e)||a(e)?e:"",W=(e,t)=>{if(!e||(o(r=e)||"function"!=typeof r?.[Symbol.iterator]))return[];var r;const n=[];let s=0;for(const r of e){const e=t(r,s++);null!=e&&n.push(e)}return n},B=e=>e?.length?new Set(e.map((e=>D(e.value)))):null,q=(e,t)=>({enter:e("phEnter",{field:t}),select:e("phSelect",{field:t})}),G=(e,t,r,s)=>e?.placeholder?e.placeholder:s?r(n.cr[s]):t.enter},5009:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEBUG_STYLES:()=>y,conditionalLog:()=>f,conditionalTable:()=>h,conditionalWarn:()=>m,criticalError:()=>g,getLoggingEnabled:()=>p,setLoggingEnabled:()=>d,setupFmeDebugTools:()=>k,updateFmeDebugTools:()=>L});var n=r(9244),s=r(3417),o=r(5880),i=r(2238),a=r(1658),l=r(1181),c=r(930);let u=!1;const d=e=>{u=e},p=()=>u,f=(...e)=>{u&&console.log(...e)},h=(e,t)=>{u&&console.table(e,t)},m=(...e)=>{u&&console.warn(...e)},g=(...e)=>{console.error(...e)},y={success:"color: #28a745; font-weight: bold",info:"color: #007bff; font-weight: bold",warn:"color: #ffc107; font-weight: bold",error:"color: #dc3545; font-weight: bold",action:"color: #0078d4; font-weight: bold"},E=(e,t="info",...r)=>{u&&console.log(`%c[FME Debug] ${e}`,y[t],...r)},v=()=>"undefined"==typeof window?null:window.__FME_DEBUG__??null,b=e=>e?{serverUrl:e.fmeServerUrl||"[NONE]",repository:e.repository||"[NONE]",token:e.fmeServerToken?(0,c.gg)(e.fmeServerToken):"[NONE]",timeout:e.requestTimeout,largeArea:e.largeArea,maxArea:e.maxArea}:null,w=e=>({method:e.method??"[UNKNOWN]",path:e.path??"[UNKNOWN]",status:e.status??"?",duration:(e.durationMs??0)+"ms",ok:void 0===e.ok?"?":e.ok?"\u2713":"\u2717",time:new Date(e.timestamp).toLocaleTimeString()}),S=e=>{try{return e.__FME_DEBUG__??null}catch{return null}},R=(e,t)=>{t.forEach((t=>{((e,t)=>{try{Object.defineProperty(e,"__FME_DEBUG__",{configurable:!0,enumerable:!1,writable:!0,value:t})}catch{try{e.__FME_DEBUG__=t}catch{}}})(t,e)}))},O=e=>{for(const t of e){const e=S(t);if(e)return e}return null},T=e=>(t=s.By.NETWORK,r="TEST_ERROR")=>{const n=v();n&&(n.dispatch(n.actions.setError("general",{type:t,code:r,message:"Test error message",severity:s.MU.ERROR,recoverable:!0,timestampMs:Date.now()},e)),E("Test error dispatched","warn"))},A=()=>e=>{const t=v();if(!t)return;const r=((e,t)=>{let r=[...e];return t?.failed&&(r=r.filter((e=>void 0!==e.ok&&!e.ok))),t?.slow&&(r=r.filter((e=>e.durationMs>s.ST.SLOW_REQUEST_THRESHOLD))),r})(t.getNetworkHistory?.()??[],e);0!==r.length?(E(`Network History (${r.length} requests):`,"warn"),h(r.map(w))):E("No network requests found","warn")},I=()=>()=>{const e=v();if(!e)return"";const t=e.getState?.(),r=e.getConfig?.(),n=e.getNetworkHistory?.()??[],o=e.getQueryCache?.()??[],i=b(r),a=(e=>e?{viewMode:e.viewMode,drawingTool:e.drawingTool,hasGeometry:!!e.geometryJson,drawnArea:e.drawnArea,selectedWorkspace:e.selectedWorkspace,hasError:!!(e.errors&&Object.keys(e.errors).length>0)}:null)(t),l=(e=>{const t=e.filter((e=>void 0!==e.ok&&!e.ok)),r=e.filter((e=>e.durationMs>s.ST.SLOW_REQUEST_THRESHOLD)),n=e.length>0?Math.round(e.reduce(((e,t)=>e+t.durationMs),0)/e.length):0;return{total:e.length,failed:t.length,avgDurationMs:n,slowRequests:r.length}})(n),c={timestamp:(new Date).toISOString(),widgetId:e.widgetId,config:i,state:a,networkSummary:l,queryCacheSize:o.length,recentRequests:n.slice(-10).map((e=>({method:e.method,path:e.path,status:e.status,ok:e.ok,durationMs:e.durationMs,time:new Date(e.timestamp).toISOString()})))},u=JSON.stringify(c,null,2);return E("Debug Package:","success"),f(u),(e=>{const t=navigator.clipboard;t&&t.writeText?t.writeText(e).then((()=>{E("Copied to clipboard","success")}),(e=>{E("Could not copy to clipboard","error"),f("Clipboard error:",e)})):E("Clipboard API not available","warn")})(u),u},_=e=>{return{widgetId:e.widgetId,getConfig:()=>e.config,getState:()=>(e=>{const t=(0,n.getAppStore)().getState()["fme-state"];return t?.byId?.[e]??null})(e.widgetId),getQueryCache:()=>a.q.getQueryCache().getAll().map((e=>({queryKey:e.queryKey,state:e.state,queryHash:e.queryHash}))),getMutationCache:()=>a.q.getMutationCache().getAll().map((e=>({mutationId:e.mutationId,state:e.state}))),clearQueryCache:()=>{a.q.clear(),E("Query cache cleared","warn")},invalidateQueries:e=>{a.q.invalidateQueries(e),E("Queries invalidated","warn",e)},getAppState:()=>(0,n.getAppStore)().getState(),dispatch:e=>{const t=(0,n.getAppStore)();E("Dispatching action:","action",e),t.dispatch(e)},actions:o.fmeActions,getNetworkHistory:()=>(0,i.VM)(),clearNetworkHistory:()=>{(0,i.IH)(),E("Network history cleared","warn")},utils:{maskToken:e=>(0,c.gg)(e),formatArea:(e,t)=>(0,l.Jd)(e,{intl:{formatNumber:(e,t)=>e.toLocaleString(void 0,{minimumFractionDigits:t?.minimumFractionDigits??0,maximumFractionDigits:t?.maximumFractionDigits??2})}},t),safeLogParams:e=>e},helpers:{inspectState:()=>{const e=v();if(!e)return;const t=e.getState?.();t?(E("Widget State:","success"),h({viewMode:t.viewMode,drawingTool:t.drawingTool,hasGeometry:!!t.geometryJson,drawnArea:t.drawnArea,selectedWorkspace:t.selectedWorkspace})):E("No state found","error")},inspectQueries:()=>{const e=v();if(!e)return;const t=e.getQueryCache?.()??[];E("Query Cache:","info"),h(t.map((e=>({queryKey:JSON.stringify(e.queryKey),status:e.state.status,hasData:!!e.state.data}))))},resetToDrawing:(t=e.widgetId,()=>{const e=v();e&&(e.dispatch(e.actions.resetState(t)),E("Widget reset to drawing state","success"))}),testError:T(e.widgetId),inspectNetwork:A(),showFullState:()=>{const e=v();if(!e)return;const t=e.getState?.();t?(E("Full Widget State:","success"),f(t)):E("No state found","error")},showConfig:()=>{const e=v();if(!e)return;const t=e.getConfig?.(),r=b(t);r?(E("Widget Config:","success"),h(r)):E("No config found","error")},showTimeline:()=>{const e=v();if(!e)return;const t=e.getNetworkHistory?.()??[],r=e.getState?.();if(0===t.length)return void E("No timeline data","warn");E("Timeline:","info");const n=t.map((e=>{return{time:new Date(e.timestamp).toLocaleTimeString(),event:`${e.method} ${e.path}`,status:(t=e,`${void 0===t.ok?"?":t.ok?"\u2713":"\u2717"} ${t.status??(void 0===t.ok||t.ok?"":"error")}`),duration:e.durationMs+"ms"};var t}));h(n),r&&(f("Current State:"),f("  View Mode:",r.viewMode),f("  Has Geometry:",!!r.geometryJson),f("  Selected Workspace:",r.selectedWorkspace||"[NONE]"))},exportDebugInfo:I()}};var t},C=e=>{const t=(e=>{if("string"!=typeof e)return null;const t=e.trim();return t.length?t:null})(e.widgetId);if(!t||!e.config)return null;const r=(()=>{if("undefined"==typeof window)return[];const e=[],t=new Set,r=r=>{r&&!t.has(r)&&(t.add(r),e.push(r))};let n=window,o=0;const i=s.a0.MAX_WINDOW_HIERARCHY_ITERATIONS;for(;n&&o<i;){r(n);try{const e=n.parent;if(!e||e===n||t.has(e))break;n=e}catch{break}o++}try{r(window.opener)}catch{}return e})();return 0===r.length?null:{widgetId:t,config:e.config,targets:r}},k=e=>{const t=C(e);if(!t)return;const{widgetId:r,config:n,targets:s}=t,o=Boolean(O(s)),i=_({widgetId:r,config:n});R(i,s),o||(E("Global debug object available at window.__FME_DEBUG__","action"),E("Try: __FME_DEBUG__.getState() or __FME_DEBUG__.getConfig()","action"),E("Helpers: __FME_DEBUG__.helpers.inspectState() | inspectQueries() | inspectNetwork()","action"),E("Export: __FME_DEBUG__.helpers.exportDebugInfo() | showTimeline() | showConfig()","action"))},L=e=>{const t=C(e);if(!t)return;const{widgetId:r,config:n,targets:s}=t;if(!O(s))return;const o=_({widgetId:r,config:n});R(o,s)}},5132:(e,t,r)=>{"use strict";r.d(t,{Dd:()=>o,Qg:()=>i,VQ:()=>a,aE:()=>s});var n=r(6055);const s=(e,t,r)=>({kind:"loading",message:e,detail:t,messages:r}),o=(e,t)=>({kind:"empty",message:e,actions:t}),i=(e,t)=>({kind:"error",message:e,code:t?.code,actions:t?.actions,recoverable:t?.recoverable,detail:t?.detail});class a extends Error{constructor(e,t,r,s,o=n.MU.ERROR,i){super(e),this.name="FmeFlowApiError",this.code=t,this.httpStatus=r,this.status=r,this.retryable=Boolean(s),this.isRetryable=this.retryable,this.severity=o,this.details=i?Object.freeze({...i}):void 0}}},5160:(e,t,r)=>{"use strict";var n=r(8972);var s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=n.useSyncExternalStore,i=n.useRef,a=n.useEffect,l=n.useMemo,c=n.useDebugValue},5502:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 4.429V15h14V1L6.833 7.857zM14 3v11H2V6.114l4.182 2.51a1.2 1.2 0 0 0 1.398-.118z" clip-rule="evenodd"></path></svg>'},5668:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"></path><path fill="#000" fill-rule="evenodd" d="m11.002 7.002-3 3-3-3v-4a2.893 2.893 0 0 1 3-3 2.893 2.893 0 0 1 3 3zm-3-6h-.038a1.893 1.893 0 0 0-1.963 1.962l.001.018v3.606l2 2 2-2V2.964A1.894 1.894 0 0 0 8.04 1z" clip-rule="evenodd"></path><path fill="#000" d="M4.072 1.908a10.4 10.4 0 0 1-1.939-.433L0 13.077c1.2.504 2.493.746 3.793.711A10.7 10.7 0 0 0 7 13.31v1.678H2v1h11v-1H8v-2a11.9 11.9 0 0 1 4.207-.8A6.62 6.62 0 0 1 16 13.277L13.867 1.674a8.2 8.2 0 0 0-2.236-.61 3.5 3.5 0 0 1 .336 1.066q.514.097 1.009.27l1.72 9.163a8.3 8.3 0 0 0-2.489-.376 12.8 12.8 0 0 0-4.526.852l-.604.204-.363.108a9.7 9.7 0 0 1-2.921.436 9.5 9.5 0 0 1-2.668-.363l1.81-9.697q.53.115 1.068.18v-.173a3.4 3.4 0 0 1 .069-.826"></path></svg>'},5880:(e,t,r)=>{"use strict";r.d(t,{areLoadingStatesEqual:()=>b,createFmeSelectors:()=>R,fmeActions:()=>m,initialFmeState:()=>g});var n=r(7390),s=r.n(n);function o(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var i=e=>Array.isArray(e)?e:[e];function a(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const r=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var l="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function c(e,t={}){let r={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:n}=t;let s,o=0;function i(){let t=r;const{length:i}=arguments;for(let e=0,r=i;e<r;e++){const r=arguments[e];if("function"==typeof r||"object"==typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);const n=e.get(r);void 0===n?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=n}else{let e=t.p;null===e&&(t.p=e=new Map);const n=e.get(r);void 0===n?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=n}}const a=t;let c;if(1===t.s)c=t.v;else if(c=e.apply(null,arguments),o++,n){const e=s?.deref?.()??s;null!=e&&n(e,c)&&(c=e,0!==o&&o--);s="object"==typeof c&&null!==c||"function"==typeof c?new l(c):c}return a.s=1,a.v=c,c}return i.clearCache=()=>{r={s:0,v:void 0,o:null,p:null},i.resetResultsCount()},i.resultsCount=()=>o,i.resetResultsCount=()=>{o=0},i}function u(e,...t){const r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,n=(...e)=>{let t,n=0,s=0,l={},u=e.pop();"object"==typeof u&&(l=u,u=e.pop()),o(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...l},{memoize:p,memoizeOptions:f=[],argsMemoize:h=c,argsMemoizeOptions:m=[],devModeChecks:g={}}=d,y=i(f),E=i(m),v=a(e),b=p((function(){return n++,u.apply(null,arguments)}),...y);const w=h((function(){s++;const e=function(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}(v,arguments);return t=b.apply(null,e),t}),...E);return Object.assign(w,{resultFunc:u,memoizedResultFunc:b,dependencies:v,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>t,recomputations:()=>n,resetRecomputations:()=>{n=0},memoize:p,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var d=u(c),p=Object.assign(((e,t=d)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const r=Object.keys(e);return t(r.map((t=>e[t])),((...e)=>e.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})))}),{withTypes:()=>p}),f=r(3417),h=r(3314);const m={setViewMode:(e,t)=>({type:f.ZW.SET_VIEW_MODE,viewMode:e,widgetId:t}),resetState:e=>({type:f.ZW.RESET_STATE,widgetId:e}),setGeometry:(e,t,r)=>({type:f.ZW.SET_GEOMETRY,geometryJson:v(e),drawnArea:t,widgetId:r}),setDrawingTool:(e,t)=>({type:f.ZW.SET_DRAWING_TOOL,drawingTool:e,widgetId:t}),completeDrawing:(e,t,r,n)=>({type:f.ZW.COMPLETE_DRAWING,geometryJson:v(e),drawnArea:t,nextViewMode:r,widgetId:n}),setOrderResult:(e,t)=>({type:f.ZW.SET_ORDER_RESULT,orderResult:e,widgetId:t}),setWorkspaceItems:(e,t,r)=>({type:f.ZW.SET_WORKSPACE_ITEMS,workspaceItems:e,repository:t,widgetId:r}),setWorkspaceParameters:(e,t,r,n)=>({type:f.ZW.SET_WORKSPACE_PARAMETERS,workspaceParameters:e,workspaceName:t,repository:r,widgetId:n}),setSelectedWorkspace:(e,t,r)=>({type:f.ZW.SET_SELECTED_WORKSPACE,workspaceName:e,repository:t,widgetId:r}),setWorkspaceItem:(e,t,r)=>({type:f.ZW.SET_WORKSPACE_ITEM,workspaceItem:e,repository:t,widgetId:r}),setError:(e,t,r)=>({type:f.ZW.SET_ERROR,scope:e,error:t,widgetId:r}),setErrors:(e,t)=>{const r={};for(const[t,n]of Object.entries(e))void 0!==n&&(r[t]=n);return{type:f.ZW.SET_ERRORS,errors:r,widgetId:t}},clearError:(e,t)=>({type:f.ZW.CLEAR_ERROR,scope:e,widgetId:t}),clearWorkspaceState:(e,t)=>({type:f.ZW.CLEAR_WORKSPACE_STATE,newRepository:e,widgetId:t}),resetToDrawing:e=>({type:f.ZW.RESET_TO_DRAWING,widgetId:e}),completeStartup:e=>({type:f.ZW.COMPLETE_STARTUP,widgetId:e}),setLoadingFlag:(e,t,r)=>({type:f.ZW.SET_LOADING_FLAG,flag:e,value:t,widgetId:r}),applyWorkspaceData:(e,t)=>({type:f.ZW.APPLY_WORKSPACE_DATA,workspaceName:e.workspaceName,workspaceParameters:e.parameters,workspaceItem:e.item,widgetId:t}),removeWidgetState:e=>({type:f.ZW.REMOVE_WIDGET_STATE,widgetId:e})},g={viewMode:f.nE.STARTUP_VALIDATION,drawingTool:f.hL.POLYGON,geometryJson:null,drawnArea:0,orderResult:null,workspaceItems:[],selectedWorkspace:null,workspaceParameters:[],workspaceItem:null,currentRepository:null,loading:{workspaces:!1,parameters:!1,modules:!1,submission:!1,geometryValidation:!1},errors:{}},y=s().default??s(),E=e=>(0,h.NnH)(e)??null,v=e=>{if(!e)return null;if("object"!=typeof e)return null;const t=Reflect.get(e,"toJSON");if("function"!=typeof t)return null;try{return t.call(e)}catch{return null}};function b(e,t){return e.workspaces===t.workspaces&&e.parameters===t.parameters&&e.modules===t.modules&&e.submission===t.submission&&e.geometryValidation===t.geometryValidation}const w={[f.MU.ERROR]:3,[f.MU.WARNING]:2,[f.MU.INFO]:1},S={general:0,export:1,import:2};const R=e=>{const t=t=>((e,t)=>{const r=e,n=r?.["fme-state"]?.byId?.[t];return n??null})(t,e),r=e=>t(e)?.geometryJson??null,n=e=>t(e)?.drawnArea??g.drawnArea,s=e=>t(e)?.selectedWorkspace??g.selectedWorkspace,o=e=>t(e)?.workspaceParameters??g.workspaceParameters,i=e=>t(e)?.workspaceItem??g.workspaceItem,a=e=>t(e)?.errors??g.errors,l=e=>t(e)?.loading??g.loading,c=d([r,n],((e,t)=>Boolean(e)&&t>0)),u=d([a],(e=>(e=>{let t=null,r=-1,n=Number.POSITIVE_INFINITY;for(const[s,o]of Object.entries(e)){if(!o)continue;if(!(o.severity in w))continue;if(!(s in S))continue;const e=w[o.severity],i=S[s];(e>r||e===r&&i<n)&&(t={scope:s,details:o},r=e,n=i)}return t})(e))),p=d([r,n,s,o,i,a],((e,t,r,n,s,o)=>{const i=Boolean(e)&&Number.isFinite(t)&&t>0,a=Boolean(E(r)),l=n.length>0||null!==s,c=o?.general,u=!!c&&(w[c.severity]??0)>=w[f.MU.ERROR];return i&&a&&l&&!u})),h=d([l],(e=>e.workspaces||e.parameters||e.modules||e.submission));return{selectSlice:t,selectViewMode:e=>t(e)?.viewMode??g.viewMode,selectDrawingTool:e=>t(e)?.drawingTool??g.drawingTool,selectGeometryJson:r,selectDrawnArea:n,selectWorkspaceItems:e=>t(e)?.workspaceItems??g.workspaceItems,selectWorkspaceParameters:o,selectWorkspaceItem:i,selectSelectedWorkspace:s,selectOrderResult:e=>t(e)?.orderResult??g.orderResult,selectErrors:a,selectErrorByScope:e=>r=>t(r)?.errors?.[e]??null,selectLoading:l,selectLoadingFlag:e=>r=>t(r)?.loading?.[e]??g.loading[e],selectHasValidAoi:c,selectPrimaryError:u,selectCanExport:p,selectIsBusy:h}};y({byId:{}})},5938:e=>{"use strict";e.exports=l},6035:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(6500),s=r(4880),o=new class extends n.Q{#U=!0;#V;#W;constructor(){super(),this.#W=e=>{if(!s.S$&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#V||this.setEventListener(this.#W)}onUnsubscribe(){this.hasListeners()||(this.#V?.(),this.#V=void 0)}setEventListener(e){this.#W=e,this.#V?.(),this.#V=e(this.setOnline.bind(this))}setOnline(e){this.#U!==e&&(this.#U=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#U}}},6055:(e,t,r)=>{"use strict";var n,s,o,i,a,l,c,u,d,p;r.d(t,{By:()=>a,MU:()=>i,OX:()=>l,QL:()=>u,Vw:()=>o,ZW:()=>p,hL:()=>s,nE:()=>n,ym:()=>c}),function(e){e.STARTUP_VALIDATION="startup-validation",e.INITIAL="initial",e.DRAWING="drawing",e.WORKSPACE_SELECTION="workspace-selection",e.EXPORT_FORM="export-form",e.EXPORT_OPTIONS="export-options",e.ORDER_RESULT="order-result"}(n||(n={})),function(e){e.POLYGON="polygon",e.RECTANGLE="rectangle"}(s||(s={})),function(e){e.TEXT="text",e.NUMBER="number",e.TEXTAREA="textarea",e.SELECT="select",e.MULTI_SELECT="multi-select",e.CHECKBOX="checkbox",e.PASSWORD="password",e.FILE="file",e.DATE_TIME="date-time",e.URL="url",e.SWITCH="switch",e.RADIO="radio",e.SLIDER="slider",e.NUMERIC_INPUT="numeric-input",e.TAG_INPUT="tag-input",e.COLOR="color",e.DATE="date",e.TIME="time",e.EMAIL="email",e.PHONE="phone",e.SEARCH="search",e.MESSAGE="message",e.TABLE="table",e.MONTH="month",e.WEEK="week",e.COORDSYS="coord-sys",e.ATTRIBUTE_NAME="attribute-name",e.ATTRIBUTE_LIST="attribute-list",e.DB_CONNECTION="db-connection",e.WEB_CONNECTION="web-connection",e.TEXT_OR_FILE="text-or-file",e.REPROJECTION_FILE="reprojection-file",e.SCRIPTED="scripted",e.GEOMETRY="geometry",e.HIDDEN="hidden"}(o||(o={})),function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(i||(i={})),function(e){e.VALIDATION="validation",e.CONFIG="config",e.NETWORK="network",e.MODULE="module",e.GEOMETRY="geometry"}(a||(a={})),function(e){e.IDLE="idle",e.PENDING="pending",e.OK="ok",e.FAIL="fail",e.SKIP="skip"}(l||(l={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(c||(c={})),function(e){e.text="text",e.number="number",e.checkbox="checkbox",e.dropdown="dropdown",e.listbox="listbox",e.tree="tree",e.password="password",e.datetime="datetime",e.message="message",e.group="group",e.file="file",e.color="color",e.range="range",e.TEXT="TEXT",e.INTEGER="INTEGER",e.FLOAT="FLOAT",e.BOOLEAN="BOOLEAN",e.CHECKBOX="CHECKBOX",e.CHOICE="CHOICE",e.LISTBOX="LISTBOX",e.LOOKUP_LISTBOX="LOOKUP_LISTBOX",e.LOOKUP_CHOICE="LOOKUP_CHOICE",e.TEXT_OR_FILE="TEXT_OR_FILE",e.TEXT_EDIT="TEXT_EDIT",e.PASSWORD="PASSWORD",e.FILENAME="FILENAME",e.FILENAME_MUSTEXIST="FILENAME_MUSTEXIST",e.DIRNAME="DIRNAME",e.DIRNAME_MUSTEXIST="DIRNAME_MUSTEXIST",e.DIRNAME_SRC="DIRNAME_SRC",e.COORDSYS="COORDSYS",e.STRING="STRING",e.URL="URL",e.LOOKUP_URL="LOOKUP_URL",e.LOOKUP_FILE="LOOKUP_FILE",e.DATE_TIME="DATE_TIME",e.DATETIME="DATETIME",e.DATE="DATE",e.TIME="TIME",e.MONTH="MONTH",e.WEEK="WEEK",e.COLOR="COLOR",e.COLOR_PICK="COLOR_PICK",e.RANGE_SLIDER="RANGE_SLIDER",e.GEOMETRY="GEOMETRY",e.MESSAGE="MESSAGE",e.ATTRIBUTE_NAME="ATTRIBUTE_NAME",e.ATTRIBUTE_LIST="ATTRIBUTE_LIST",e.DB_CONNECTION="DB_CONNECTION",e.WEB_CONNECTION="WEB_CONNECTION",e.REPROJECTION_FILE="REPROJECTION_FILE",e.SCRIPTED="SCRIPTED",e.NOVALUE="NOVALUE",e.GROUP="GROUP"}(u||(u={})),function(e){e.QUEUED="QUEUED",e.PULLED="PULLED",e.RUNNING="RUNNING",e.SUCCESS="SUCCESS",e.FME_FAILURE="FME_FAILURE",e.JOB_FAILURE="JOB_FAILURE",e.ABORTED="ABORTED"}(d||(d={})),function(e){e.SET_VIEW_MODE="fme/SET_VIEW_MODE",e.RESET_STATE="fme/RESET_STATE",e.SET_GEOMETRY="fme/SET_GEOMETRY",e.SET_DRAWING_TOOL="fme/SET_DRAWING_TOOL",e.COMPLETE_DRAWING="fme/COMPLETE_DRAWING",e.SET_ORDER_RESULT="fme/SET_ORDER_RESULT",e.SET_WORKSPACE_ITEMS="fme/SET_WORKSPACE_ITEMS",e.SET_WORKSPACE_PARAMETERS="fme/SET_WORKSPACE_PARAMETERS",e.SET_SELECTED_WORKSPACE="fme/SET_SELECTED_WORKSPACE",e.SET_WORKSPACE_ITEM="fme/SET_WORKSPACE_ITEM",e.SET_ERROR="fme/SET_ERROR",e.SET_ERRORS="fme/SET_ERRORS",e.CLEAR_WORKSPACE_STATE="fme/CLEAR_WORKSPACE_STATE",e.CLEAR_ERROR="fme/CLEAR_ERROR",e.RESET_TO_DRAWING="fme/RESET_TO_DRAWING",e.COMPLETE_STARTUP="fme/COMPLETE_STARTUP",e.REMOVE_WIDGET_STATE="fme/REMOVE_WIDGET_STATE",e.SET_LOADING_FLAG="fme/SET_LOADING_FLAG",e.APPLY_WORKSPACE_DATA="fme/APPLY_WORKSPACE_DATA"}(p||(p={}))},6158:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});var n=r(6261),s=r(1692),o=r(8904),i=class extends s.k{#m;#B;#o;#q;constructor(e){super(),this.#m=e.client,this.mutationId=e.mutationId,this.#o=e.mutationCache,this.#B=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#B.includes(e)||(this.#B.push(e),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#B=this.#B.filter((t=>t!==e)),this.scheduleGc(),this.#o.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#B.length||("pending"===this.state.status?this.scheduleGc():this.#o.remove(this))}continue(){return this.#q?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#G({type:"continue"})},r={client:this.#m,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#q=(0,o.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#G({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#G({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#o.canRun(this)});const n="pending"===this.state.status,s=!this.#q.canStart();try{if(n)t();else{this.#G({type:"pending",variables:e,isPaused:s}),await(this.#o.config.onMutate?.(e,this,r));const t=await(this.options.onMutate?.(e,r));t!==this.state.context&&this.#G({type:"pending",context:t,variables:e,isPaused:s})}const o=await this.#q.start();return await(this.#o.config.onSuccess?.(o,e,this.state.context,this,r)),await(this.options.onSuccess?.(o,e,this.state.context,r)),await(this.#o.config.onSettled?.(o,null,this.state.variables,this.state.context,this,r)),await(this.options.onSettled?.(o,null,e,this.state.context,r)),this.#G({type:"success",data:o}),o}catch(t){try{throw await(this.#o.config.onError?.(t,e,this.state.context,this,r)),await(this.options.onError?.(t,e,this.state.context,r)),await(this.#o.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,r)),await(this.options.onSettled?.(void 0,t,e,this.state.context,r)),t}finally{this.#G({type:"error",error:t})}}finally{this.#o.runNext(this)}}#G(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),n.jG.batch((()=>{this.#B.forEach((t=>{t.onMutationUpdate(e)})),this.#o.notify({mutation:this,type:"updated",action:e})}))}}},6261:(e,t,r)=>{"use strict";r.d(t,{jG:()=>s});var n=r(2775).Zq;var s=function(){let e=[],t=0,r=e=>{e()},s=e=>{e()},o=n;const i=n=>{t?e.push(n):o((()=>{r(n)}))};return{batch:n=>{let i;t++;try{i=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&o((()=>{s((()=>{t.forEach((e=>{r(e)}))}))}))})()}return i},batchCalls:e=>(...t)=>{i((()=>{e(...t)}))},schedule:i,setNotifyFunction:e=>{r=e},setBatchNotifyFunction:e=>{s=e},setScheduler:e=>{o=e}}}()},6278:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14M8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},6500:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}},6920:(e,t,r)=>{"use strict";r.d(t,{AR:()=>f,SB:()=>u,YD:()=>g,Yn:()=>h,bE:()=>p,dd:()=>l,is:()=>m,sI:()=>a,sq:()=>i,wc:()=>d,yo:()=>c});var n=r(3417),s=r(3890),o=r(4986);const i=e=>{const{__upload_file__:t,__remote_dataset_url__:r,opt_geturl:n,...s}=e,i=(0,o.Nn)(n),a={...s};i&&(a.opt_geturl=i);return{sanitizedFormData:(e=>{const t={};for(const[r,n]of e)t[r]=d(n);return t})(Object.entries(a)),uploadFile:t instanceof File?t:null,remoteUrl:(0,o.Nn)(r)??""}},a=({finalParams:e,uploadedPath:t,parameters:r,explicitTarget:s})=>{if(!t)return;if(s)return void(e[s]=t);const o=(e=>{if(e)for(const t of e){if(!t)continue;const e=String(t.type);if(n._A.includes(e)&&t.name)return t.name}})(r);o?e[o]=t:void 0===e.SourceDataset&&(e.SourceDataset=t)},l=(e,t)=>{if(!e)return;if(!Boolean(t?.allowRemoteDataset&&t?.allowRemoteUrlDataset))return void(void 0!==e.opt_geturl&&delete e.opt_geturl);const r=(0,o.Nn)(e.opt_geturl);r&&(0,s.CL)(r)?e.opt_geturl=r:void 0!==e.opt_geturl&&delete e.opt_geturl},c=e=>{if(!e?.uploadTargetParamName)return null;return(0,o.E)(e.uploadTargetParamName,"")||null},u=(e,t)=>{const r=(0,o.Nn)(e.name);return r||(t?t("lblUnnamedFile"):"unnamed-file")},d=e=>{if(!e||"object"!=typeof e||Array.isArray(e))return e;if(!(e=>"object"==typeof e&&null!==e&&!Array.isArray(e)&&"mode"in e)(e))return e;const t=e;if("file"===t.mode)return(e=>(0,o.E$)(e.file)?e.file:(0,o.Nn)(e.fileName)??(0,o.wK)(e.fileName??e.file)??"")(t);if("text"===t.mode){return(0,o.wK)(t.text)??""}return e},p=e=>{const t={};for(const r of e)r?.name&&"string"==typeof r.name&&(t[r.name]=r.defaultValue??"");return t},f=(e,t,r,n,s,o)=>!(!e||!t||"order-result"===r)&&("drawing"===r?Boolean(o&&o>0)||Boolean(s):n>0&&"initial"!==r),h=(e,t,r,n)=>{if(n)return!1;return("workspace-selection"===r||"export-options"===r)&&e},m=e=>{const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r},g=(e,t)=>(0,o.Gt)(e,(e=>{if("object"!=typeof e||null===e)return;const r=e;return(0,o.Nn)(r[t])}))},7389:(e,t,r)=>{"use strict";r.d(t,{J:()=>a,M:()=>i});let n=null,s=null;const o=(e,t)=>{(n?Promise.resolve(n):(s||(s=Promise.resolve().then(r.bind(r,5009)).then((e=>(n=e,e)))),s)).then((r=>{const n=e(r);"function"==typeof n&&n(...t)})).catch((()=>{}))},i=(...e)=>{o((e=>e.conditionalLog),e)},a=(...e)=>{o((e=>e.conditionalWarn),e)}},7390:(e,t,r)=>{var n;!function(){"use strict";var s=function e(t){var r,n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),s={use_static:!1};function o(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function i(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:r})}"object"!=typeof(r=t)||Array.isArray(r)||null===r||void 0!==t.use_static&&(s.use_static=Boolean(t.use_static));var a="__immutable_invariants_hold";function l(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,a)))}function c(e,t){return e===t||e!=e&&t!=t}function u(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var d=["setPrototypeOf"],p=(d.concat(["push","pop","sort","splice","shift","unshift","reverse"]),["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]));function f(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function h(e,t){return i(e,a,!0),e}function m(e,t){var r=e[t];i(e,t,(function(){return B(r.apply(e,arguments))}))}function g(e,t,r){var n=r&&r.deep;if(e in this&&(n&&this[e]!==t&&u(t)&&u(this[e])&&(t=B.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var s=R.call(this);return s[e]=B(t),v(s)}d.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]),f.prototype=new Error,f.prototype.constructor=Error;var y=B([]);function E(e,t,r){var n=e[0];if(1===e.length)return g.call(this,n,t,r);var s,o=e.slice(1),i=this[n];if("object"==typeof i&&null!==i)s=B.setIn(i,o,t);else{var a=o[0];s=""!==a&&isFinite(a)?E.call(y,o,t):N.call(M,o,t)}if(n in this&&i===s)return this;var l=R.call(this);return l[n]=s,v(l)}function v(e){for(var t in p){if(p.hasOwnProperty(t))m(e,p[t])}s.use_static||(i(e,"flatMap",w),i(e,"asObject",O),i(e,"asMutable",R),i(e,"set",g),i(e,"setIn",E),i(e,"update",D),i(e,"updateIn",F),i(e,"getIn",j));for(var r=0,n=e.length;r<n;r++)e[r]=B(e[r]);return h(e)}function b(){return new Date(this.getTime())}function w(e){if(0===arguments.length)return this;var t,r=[],n=this.length;for(t=0;t<n;t++){var s=e(this[t],t,this);Array.isArray(s)?r.push.apply(r,s):r.push(s)}return v(r)}function S(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,r){"number"==typeof e&&(r[t]=e.toString())})),e=function(e,r){return-1!==t.indexOf(r)}}var r=o(this);for(var n in this)this.hasOwnProperty(n)&&!1===e(this[n],n)&&(r[n]=this[n]);return W(r)}function R(e){var t,r,n=[];if(e&&e.deep)for(t=0,r=this.length;t<r;t++)n.push(T(this[t]));else for(t=0,r=this.length;t<r;t++)n.push(this[t]);return n}function O(e){"function"!=typeof e&&(e=function(e){return e});var t,r={},n=this.length;for(t=0;t<n;t++){var s=e(this[t],t,this),o=s[0],i=s[1];r[o]=i}return W(r)}function T(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,a)||e instanceof Date?e:B.asMutable(e,{deep:!0})}function A(e,t){for(var r in e)Object.getOwnPropertyDescriptor(e,r)&&(t[r]=e[r]);return t}function I(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var r,n,s=Array.isArray(e),i=t&&t.deep,a=t&&t.mode||"merge",l=t&&t.merger;function d(e,n,s){var a,d=B(n[s]),p=l&&l(e[s],d,t),f=e[s];void 0===r&&void 0===p&&e.hasOwnProperty(s)&&c(d,f)||(c(f,a=void 0!==p?p:i&&u(f)&&u(d)?B.merge(f,d,t):d)&&e.hasOwnProperty(s)||(void 0===r&&(r=A(e,o(e))),r[s]=a))}if(s)for(var p=0,f=e.length;p<f;p++){var h=e[p];for(n in h)h.hasOwnProperty(n)&&d(void 0!==r?r:this,h,n)}else{for(n in e)Object.getOwnPropertyDescriptor(e,n)&&d(this,e,n);"replace"===a&&function(e,t){for(var n in e)t.hasOwnProperty(n)||(void 0===r&&(r=A(e,o(e))),delete r[n])}(this,e)}return void 0===r?this:W(r)}function _(e,t){var r=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return B.merge(this,e,{deep:r,mode:"replace"})}var C,k,L,M=B({});function N(e,t,r){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var n=e[0];if(1===e.length)return x.call(this,n,t,r);var s,i=e.slice(1),a=this[n];if(s=this.hasOwnProperty(n)&&"object"==typeof a&&null!==a?B.setIn(a,i,t):N.call(M,i,t),this.hasOwnProperty(n)&&a===s)return this;var l=A(this,o(this));return l[n]=s,W(l)}function x(e,t,r){var n=r&&r.deep;if(this.hasOwnProperty(e)&&(n&&this[e]!==t&&u(t)&&u(this[e])&&(t=B.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var s=A(this,o(this));return s[e]=B(t),W(s)}function D(e,t){var r=Array.prototype.slice.call(arguments,2),n=this[e];return B.set(this,e,t.apply(n,[n].concat(r)))}function P(e,t){for(var r=0,n=t.length;null!=e&&r<n;r++)e=e[t[r]];return r&&r==n?e:void 0}function F(e,t){var r=Array.prototype.slice.call(arguments,2),n=P(this,e);return B.setIn(this,e,t.apply(n,[n].concat(r)))}function j(e,t){var r=P(this,e);return void 0===r?t:r}function U(e){var t,r=o(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(r[t]=T(this[t]));else for(t in this)this.hasOwnProperty(t)&&(r[t]=this[t]);return r}function V(){return{}}function W(e){return s.use_static||(i(e,"merge",I),i(e,"replace",_),i(e,"without",S),i(e,"asMutable",U),i(e,"set",x),i(e,"setIn",N),i(e,"update",D),i(e,"updateIn",F),i(e,"getIn",j)),h(e)}function B(e,t,r){if(l(e)||function(e){return"object"==typeof e&&null!==e&&(60103===e.$$typeof||e.$$typeof===n)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(B);if(Array.isArray(e))return v(e.slice());if(e instanceof Date)return o=new Date(e.getTime()),s.use_static||i(o,"asMutable",b),h(o);var o,a=t&&t.prototype,c=(a&&a!==Object.prototype?function(){return Object.create(a)}:V)();for(var u in e)Object.getOwnPropertyDescriptor(e,u)&&(c[u]=B(e[u],void 0,r));return W(c)}function q(e){return function(){var t=[].slice.call(arguments),r=t.shift();return e.apply(r,t)}}function G(e,t){return function(){var r=[].slice.call(arguments),n=r.shift();return Array.isArray(n)?t.apply(n,r):e.apply(n,r)}}return B.from=B,B.isImmutable=l,B.ImmutableError=f,B.merge=q(I),B.replace=q(_),B.without=q(S),B.asMutable=(C=U,k=R,L=b,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?k.apply(t,e):t instanceof Date?L.apply(t,e):C.apply(t,e)}),B.set=G(x,g),B.setIn=G(N,E),B.update=q(D),B.updateIn=q(F),B.getIn=q(j),B.flatMap=q(w),B.asObject=q(O),s.use_static||(B.static=e({use_static:!0})),Object.freeze(B),B}();void 0===(n=function(){return s}.call(t,r,t,e))||(e.exports=n)}()},7413:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 1 8 1a7 7 0 0 1 0 14" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M11.53 5.47a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-2-2a.75.75 0 0 1 1.06-1.06L7 8.94l3.47-3.47a.75.75 0 0 1 1.06 0" clip-rule="evenodd"></path></svg>'},7665:(e,t,r)=>{"use strict";r.d(t,{Ht:()=>a,jE:()=>i});var n=r(8972),s=r(4848),o=n.createContext(void 0),i=e=>{const t=n.useContext(o);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},a=({client:e,children:t})=>(n.useEffect((()=>(e.mount(),()=>{e.unmount()})),[e]),(0,s.jsx)(o.Provider,{value:e,children:t}))},7711:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8M13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97"></path><path fill="#000" d="M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828z"></path></svg>'},8418:(e,t,r)=>{"use strict";r(5160)},8904:(e,t,r)=>{"use strict";r.d(t,{II:()=>u,cc:()=>c,v_:()=>l});var n=r(9658),s=r(6035),o=r(4658),i=r(4880);function a(e){return Math.min(1e3*2**e,3e4)}function l(e){return"online"!==(e??"online")||s.t.isOnline()}var c=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function u(e){let t,r=!1,u=0;const d=(0,o.T)(),p=()=>"pending"!==d.status,f=()=>n.m.isFocused()&&("always"===e.networkMode||s.t.isOnline())&&e.canRun(),h=()=>l(e.networkMode)&&e.canRun(),m=e=>{p()||(t?.(),d.resolve(e))},g=e=>{p()||(t?.(),d.reject(e))},y=()=>new Promise((r=>{t=e=>{(p()||f())&&r(e)},e.onPause?.()})).then((()=>{t=void 0,p()||e.onContinue?.()})),E=()=>{if(p())return;let t;const n=0===u?e.initialPromise:void 0;try{t=n??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(m).catch((t=>{if(p())return;const n=e.retry??(i.S$?0:3),s=e.retryDelay??a,o="function"==typeof s?s(u,t):s,l=!0===n||"number"==typeof n&&u<n||"function"==typeof n&&n(u,t);!r&&l?(u++,e.onFail?.(u,t),(0,i.yy)(o).then((()=>f()?void 0:y())).then((()=>{r?g(t):E()}))):g(t)}))};return{promise:d,status:()=>d.status,cancel:t=>{if(!p()){const r=new c(t);g(r),e.onCancel?.(r)}},continue:()=>(t?.(),d),cancelRetry:()=>{r=!0},continueRetry:()=>{r=!1},canStart:h,start:()=>(h()?E():y().then(E),d)}}},8972:e=>{"use strict";e.exports=s},9124:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C1 1.567 4.134 0 8 0s7 1.567 7 3.5M2 5.304V6.5C2 7.692 4.615 9 8 9s6-1.308 6-2.5V5.304C12.775 6.32 10.546 7 8 7s-4.775-.68-6-1.696M8 10c2.546 0 4.775-.68 6-1.696V9.5c0 1.192-2.615 2.5-6 2.5s-6-1.308-6-2.5V8.304C3.225 9.32 5.454 10 8 10m6 1.304C12.775 12.32 10.546 13 8 13s-4.775-.68-6-1.696V12.5C2 13.692 4.615 15 8 15s6-1.308 6-2.5zM14 3.5C14 4.692 11.385 6 8 6S2 4.692 2 3.5 4.615 1 8 1s6 1.308 6 2.5" clip-rule="evenodd"></path></svg>'},9244:e=>{"use strict";e.exports=r},9658:(e,t,r)=>{"use strict";r.d(t,{m:()=>o});var n=r(6500),s=r(4880),o=new class extends n.Q{#Q;#V;#W;constructor(){super(),this.#W=e=>{if(!s.S$&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#V||this.setEventListener(this.#W)}onUnsubscribe(){this.hasListeners()||(this.#V?.(),this.#V=void 0)}setEventListener(e){this.#W=e,this.#V?.(),this.#V=e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#Q!==e&&(this.#Q=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"==typeof this.#Q?this.#Q:"hidden"!==globalThis.document?.visibilityState}}},9757:(e,t,r)=>{"use strict";r.d(t,{X:()=>a,k:()=>l});var n=r(4880),s=r(6261),o=r(8904),i=r(1692),a=class extends i.k{#$;#z;#H;#m;#q;#i;#K;constructor(e){super(),this.#K=!1,this.#i=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#m=e.client,this.#H=this.#m.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#$=c(this.options),this.state=e.state??this.#$,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#q?.promise}setOptions(e){if(this.options={...this.#i,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=c(this.options);void 0!==e.data&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#$=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#H.remove(this)}setData(e,t){const r=(0,n.pl)(this.state.data,e,this.options);return this.#G({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#G({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#q?.promise;return this.#q?.cancel(e),t?t.then(n.lQ).catch(n.lQ):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#$)}isActive(){return this.observers.some((e=>!1!==(0,n.Eh)(e.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===n.hT||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some((e=>"static"===(0,n.d2)(e.options.staleTime,this)))}isStale(){return this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!(0,n.j3)(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#q?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#q?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#H.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#q&&(this.#K?this.#q.cancel({revert:!0}):this.#q.cancelRetry()),this.scheduleGc()),this.#H.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#G({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#q?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#q)return this.#q.continueRetry(),this.#q.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const r=new AbortController,s=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#K=!0,r.signal)})},i=()=>{const e=(0,n.ZM)(this.options,t),r=(()=>{const e={client:this.#m,queryKey:this.queryKey,meta:this.meta};return s(e),e})();return this.#K=!1,this.options.persister?this.options.persister(e,r,this):e(r)},a=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#m,state:this.state,fetchFn:i};return s(e),e})();this.options.behavior?.onFetch(a,this),this.#z=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===a.fetchOptions?.meta||this.#G({type:"fetch",meta:a.fetchOptions?.meta}),this.#q=(0,o.II)({initialPromise:t?.initialPromise,fn:a.fetchFn,onCancel:e=>{e instanceof o.cc&&e.revert&&this.setState({...this.#z,fetchStatus:"idle"}),r.abort()},onFail:(e,t)=>{this.#G({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#G({type:"pause"})},onContinue:()=>{this.#G({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0});try{const e=await this.#q.start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#H.config.onSuccess?.(e,this),this.#H.config.onSettled?.(e,this.state.error,this),e}catch(e){if(e instanceof o.cc){if(e.silent)return this.#q.promise;if(e.revert){if(void 0===this.state.data)throw e;return this.state.data}}throw this.#G({type:"error",error:e}),this.#H.config.onError?.(e,this),this.#H.config.onSettled?.(this.state.data,e,this),e}finally{this.scheduleGc()}}#G(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...l(t.data,this.options),fetchMeta:e.meta??null};case"success":const r={...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#z=e.manual?r:void 0,r;case"error":const n=e.error;return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),s.jG.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#H.notify({query:this,type:"updated",action:e})}))}};function l(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:(0,o.v_)(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function c(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,r=void 0!==t,n=r?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}}},t={};function c(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,c),s.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{__set_webpack_public_path__:()=>bt,default:()=>vt});var e=c(9244),t=c(2686),r=c(7665);c(8972),c(8418);function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function s(e,t){if(n(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!n(e[r[s]],t[r[s]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;"undefined"!=typeof globalThis&&globalThis;var o=c(3417),i=c(5880),a=c(2238),l=c(2242),d=c(1658),p=c(1787),f=c(5009),h=c(3314),m=c(1138),g=c(1618),y=c(3890),E=c(4337),v=c(4321);const b={btnBack:"Back",btnSubmit:"Submit Export",btnCancel:"Cancel",btnRetry:"Retry",btnNewOrder:"New Export",btnEnd:"Close",btnDownload:"Download",btnDownloadFallback:"Click here if download didn't start",btnAddRow:"Add Row",btnDeleteRow:"Delete Row",btnMoveUp:"Move Up",btnMoveDown:"Move Down",btnReuseArea:"New Export with Same Area",btnReload:"Reload Page",btnRetryValidation:"Retry",btnOpenSettings:"Open Settings",lblJobId:"Job ID",lblWorkspace:"Workspace",lblEmail:"Email Address",lblFilename:"Filename",lblDelivery:"Delivery Method",lblFmeStatus:"FME Flow Status",lblFmeMessage:"FME Flow Message",lblErrorCode:"Error Code",lblBlobType:"File Type",lblBlobSize:"File Size",lblGeomPreview:"Geometry Preview (Esri JSON)",lblUploadFile:"Upload File (TEMP Resource)",lblRemoteUrl:"Remote URL (HTTPS)",lblTableValue:"Value",lblTableActions:"Actions",lblUnnamedFile:"Unnamed File",lblActions:"Actions",lblDrawLayer:"Drawing Layer",titleOrderConfirmed:"Export Submitted",titleOrderComplete:"Export Completed",titleOrderFailed:"Export Failed",titleOrderCancelled:"Export Cancelled",titleConfigParams:"Configure Workspace Parameters",actionRetry:"Retry",actionReload:"Reload",actionOpenSettings:"Open Settings",statusSubmitting:"Submitting job\u2026",statusProcessing:"FME Flow processing\u2026",statusValidating:"Checking settings\u2026",statusPreparing:"Preparing\u2026",statusUploading:"Uploading\u2026",statusTransforming:"Transforming\u2026",statusDownloading:"Downloading\u2026",statusInitMap:"Preparing map tools\u2026",statusLoadWorkspaces:"Fetching workspaces\u2026",statusLoadParams:"Fetching workspace parameters\u2026",statusValidateGeom:"Validating geometry\u2026",statusPreparingMapTools:"Preparing map tools\u2026",statusValidatingMap:"Verifying map configuration\u2026",statusValidatingConnection:"Testing connection to FME Flow\u2026",statusValidatingEmail:"Validating email address\u2026",statusCheckMap:"Verifying map configuration\u2026",statusCheckConnection:"Testing connection to FME Flow\u2026",statusCheckEmail:"Validating email address\u2026",validatingStartup:"Validating widget startup\u2026",submittingOrder:"Submitting export job\u2026",submittingOrderSync:"Processing export\u2026",msgOrderCancelled:"Export cancelled",msgOrderTimeout:"Export cancelled due to time limit. FME Flow workspace exceeded maximum runtime",msgNoResult:"Nothing available",msgJobCancelled:"Job cancelled",msgJobTimeout:"Job exceeded time limit",msgJobFailed:"Job failed in FME Flow",msgProcessingWait:"Processing. Please wait\u2026",msgValidating:"Validating parameter values\u2026",msgUploading:"Uploading data source\u2026",msgConfiguring:"Configuring FME Flow job\u2026",msgProcessingOrder:"Processing export\u2026",msgTransforming:"FME Flow transforming data\u2026",msgPrepDownload:"Preparing download\u2026",msgLoadingDraw:"Loading drawing tools\u2026",msgCheckGeom:"Validating geometry\u2026",msgPleaseWait:"This can take a few minutes\u2026",msgProcessingActive:"FME Flow processing\u2026",msgLargeArea:"The area ({current}) is large and may result in longer processing time",msgLargeAreaThreshold:"The area {current} is large and may result in longer processing time. Recommended area is below {threshold}",msgNoWorkspaces:"No workspaces found in this repository",msgAsyncForced:"The area {area} is large and may result in longer processing time",forcedAsyncArea:"The area {area} is large and may result in longer processing time",forcedAsyncUrlLength:"URL length ({urlLength} characters) exceeds limit. Automatically switched to email notification mode",msgNoGeometry:"No area selected. Draw an area on the map",msgGeomReady:"Area defined ({rings} polygons, {vertices} vertices)",msgContactSupport:"Please contact support at {email}",msgEmailSent:"Email notification will be sent when job is complete",msgTableEmpty:"No rows have been added",msgSetupWidget:"Widget needs to be configured before it can be used",msgCheckSettings:"Check connection settings in configuration panel",msgCheckToken:"Verify API token in settings",msgCheckUrl:"Check FME Flow server URL in settings",msgCheckRepo:"Select a valid repository in settings",msgCheckNetwork:"Check network connection and firewall settings",msgServerUrlReq:"Enter FME Flow server URL",msgTokenReq:"Enter API token for FME Flow",msgUrlTooLong:"URL exceeds maximum allowed length",msgHeadersLarge:"Request headers are too large",msgOffline:"No network connection",msgCorsBlock:"Request was blocked by CORS policy",msgRateLimit:"Too many requests. Please wait and try again",msgConfigInvalid:"Invalid widget configuration",msgCancelled:"Request was cancelled by user",msgTimeout:"Request exceeded time limit",msgWorkspacesReady:"Workspaces available for selection",msgFormReady:"Parameters ready for input",msgOrderSuccess:"Export was submitted",msgOrderFail:"Export failed",msgJobCompletionPublished:"Export job completion notification sent to other widgets",msgJobMessagePublishFailed:"Failed to notify other widgets about export completion",errNoSetup:"Widget is not configured",errTokenInvalid:"API token is missing or invalid",errNoRepository:"Repository cannot be accessed",errNoAccess:"Repository could not be verified with current API token. Check permissions or select another repository",errServerUnreach:"FME Flow server cannot be reached",errConnectFail:"Connection to FME Flow failed",errAuthFail:"Authentication to FME Flow failed",errValidateFail:"Server invalid or incorrect configuration",errStartupFail:"Widget could not start",errSubmitFail:"Job could not be submitted",errWorkspaceLoad:"Workspace could not be loaded",errParamsLoad:"Workspace parameters could not be fetched",errRepoLoad:"Repository could not be loaded",errDatasetResolve:"Data source could not be determined",errGeomProcess:"Geometry processing failed",errNoServerUrl:"FME Flow server URL is missing",errNoToken:"API token is missing",errTokenSpace:"API token cannot contain spaces",errNoRepoSelected:"No repository has been selected",errNoWorkspace:"No workspace has been selected",errRepoInvalid:"Invalid repository",errWorkspaceInvalid:"Invalid workspace",errOrderFail:"Export order failed",errJobSubmit:"FME Flow job could not be submitted",errMapInit:"Map could not be initialized",errDrawComplete:"Drawing could not be completed",errNoUserEmail:"User email address is missing",errLoadTimeout:"Loading exceeded time limit",errEmailInvalid:"Invalid email address",errTransformFailed:"FME Flow transformation failed. See log file above for details",errLoadWorkspaces:"Could not fetch workspaces from repository",errLoadParams:"Could not fetch workspace parameters",errNoConfig:"Export configuration is missing",errGeomParse:"Could not parse geometry JSON",errFileLarge:"File is too large. Max {maxSize} MB allowed",errFileType:"File type not supported. Please use one of the following formats: .zip, .kmz, .json, .geojson, .gml",errFileInvalid:"Invalid file",errDateTimeFormat:"Invalid date format. Use YYYY-MM-DD HH:MM:SS",errGeomMissing:"Geometry is missing",errGeomType:"Only polygon geometry is allowed",errGeomInvalid:"Invalid geometry",errGeomSerialize:"Geometry could not be serialized",errGeomNotSimple:"Polygon intersects itself",errGeomValidate:"Geometry could not be validated",errAreaLarge:"Area exceeds maximum limit",errGeomReq:"No geometry has been specified",errGeomPolygon:"Geometry must be a polygon",errorTokenIssue:"API token is missing or invalid",errorServerUnreachable:"FME Flow server cannot be reached",errorSetupRequired:"Widget is not configured",errorValidationFailed:"Server invalid or incorrect configuration",errorStartupFailed:"Widget could not start",errorRepositoryAccess:"Repository cannot be accessed",errorJobSubmission:"FME Flow job could not be submitted",errorMapInit:"Map could not be initialized",errorOrderFailed:"Export failed",errorWidgetIdMissing:"Widget ID is missing or invalid",configurationInvalid:"Invalid widget configuration",userEmailMissingError:"User email address is missing",geometryMissingCode:"Geometry is missing",geometryTypeInvalidCode:"Only polygon geometry is allowed",geometrySerializationFailedCode:"Geometry could not be serialized",geometryInvalidCode:"Invalid geometry",geometryAreaTooLargeCode:"Area exceeds maximum limit",urlTooLongMessage:"URL exceeds maximum allowed length",requestTimedOut:"Request exceeded time limit",requestAborted:"Request was aborted",rateLimitExceeded:"Too many requests. Please wait and try again",headersTooLargeMessage:"Request headers are too large",corsBlocked:"Request was blocked by CORS policy",REMOTE_DATASET_WORKSPACE_REQUIRED:"FME Flow workspace requires remote dataset configuration",failedToLoadWorkspaces:"Failed to load workspaces",valRequiredField:"This field is required",valSingleError:"Fill in the required field",valMultipleErrors:"Fill in all required fields",valIntegerOnly:"Only integers allowed (no decimals)",valInvalidNumber:"Invalid numeric value",valGreaterThan:"Must be greater than {value}",valAtLeast:"Must be at least {value}",valLessThan:"Must be less than {value}",valAtMost:"Must be at most {value}",phSelect:"Select {field}\u2026",phEnter:"Enter {field}\u2026",phTags:"Enter tags (separate with commas)",phEmail:"example@example.com",phPhone:"+46 70-123 45 67",phSearch:"Search\u2026",phSelectOption:"Select an option",optSyncMode:"Direct Download",optAsyncMode:"Email Notification",optPolygon:"Polygon",optRectangle:"Rectangle",optTextInput:"Text Input",optFileInput:"File Upload",tipDrawMode:"Select drawing mode to define export area",tipDrawPolygon:"Draw a polygon to define export area",tipDrawRectangle:"Draw a rectangle to define export area",tipSubmitOrder:"Submit export to FME Flow",tipCancel:"Cancel and start over",tipReuseArea:"Create new export with same area",tipNewOrder:"Create new export with same area",hintUploadFile:"Select file to use as input to workspace",hintRemoteUrl:"Enter secure HTTPS URL to remote data source",hintFileFormats:"Allowed formats: .zip, .kmz, .json, .geojson, .gml (max 150 MB)",hintUrlFormat:"Example: https://fmeflow.example.com",hintClickMap:"Click on map to define export area",hintDrawRect:"Drag to draw a rectangle",hintDrawContinue:"Click to add more corner points",hintDrawComplete:"Double-click to complete polygon",hintSelectMode:"Select drawing mode to start",hintGeomInvalid:"Polygon is invalid (not closed, self-intersecting, or without area)",hintAreaLarge:"Reduce area size for faster export",hintGeometryInvalid:"Polygon is invalid (not closed, self-intersecting, or without area)",hintAreaTooLarge:"Large area may result in longer export time. Consider reducing size",hintSetupWidget:"Widget needs to be configured before it can be used",contactSupportEmail:"Contact support at {email}",tokenSettingsHint:"Verify API token in settings",serverUrlSettingsHint:"Check FME Flow server URL in settings",repositorySettingsHint:"Select a valid repository in settings",connectionSettingsHint:"Check connection settings in configuration panel",networkConnectionHint:"Check network connection and firewall settings",largeAreaWarning:"The drawn area ({current}) is very large",largeAreaWarningWithThreshold:"The drawn area ({current}) exceeds the recommended limit ({threshold}). Consider reducing the area",ariaButton:"Button",ariaLoading:"Loading",ariaErrorActions:"Error Handling",ariaEmptyActions:"Empty Results",ariaSuccessActions:"Successful Action",ariaRequired:"Required Field",alertSyncSuccess:"Download started automatically",alertSyncFallback:"If download didn't start, use the link below",alertAsyncSuccess:"You will receive an email when the export is complete",alertAsyncQueued:"Export job submitted and queued for processing",alertSyncError:"Export failed during processing",alertAsyncError:"Export job could not be completed",alertCancelledTimeout:"Export cancelled due to timeout",alertCancelledUser:"Export was cancelled",alertJobFailed:"FME Flow transformation failed",alertTransformError:"Data transformation could not be completed"};var w=c(9124),S=c.n(w),R=c(884),O=c.n(R),T=c(6278),A=c.n(T),I=c(5668),_=c.n(I),C=c(4712),k=c.n(C),L=c(3744),M=c.n(L),N=c(7711),x=c.n(N),D=c(2606),P=c.n(D),F=c(657),j=c.n(F),U=c(5502),V=c.n(U),W=c(3624),B=c.n(W),q=c(1337),G=c.n(q),Q=c(7413),$=c.n(Q),z=c(71),H=c.n(z),K=c(1920),X=c.n(K);const Y=o.$W,J={error:A(),map:P(),polygon:V(),warning:X(),"person-lock":j(),folder:k(),data:S(),"shared-no":G(),"feature-service":_(),"link-tilted":x(),time:H(),setting:B(),email:O(),info:M(),success:$()},Z={warning:"warning",error:"error",info:"info",success:"success"},ee=()=>(0,o.MN)(),te=l.YG,re=l.j_,ne=(e,t)=>[...e,(0,h.RMY)(t)].filter(Boolean),se=(e,t)=>ne([e.fullWidth],t),oe=e=>{const{id:t,required:r,errorText:n,errorSuffix:s}=e||{};return{"aria-required":!!r,"aria-invalid":!!n,"aria-describedby":n&&t?(0,h.LHE)(t,s):void 0}},ie=(t,r)=>{const{tooltip:n,placement:s,block:o,jimuCss:i,jimuStyle:a,styles:l}=r;if(!n)return t;const c=Array.isArray(i)?i.filter(Boolean):i?[i]:[],u=ne([...c,o?l.tooltipWrap.block:l.tooltipWrap.inline],a),d=ae(s);return(0,e.jsx)("span",{css:u},(0,e.jsx)(de,{content:n,placement:d},(0,e.jsx)("span",{css:l.tooltipWrap.anchor},t)))},ae=e=>"auto"===e?Y.tooltip.position.top:e,le=(t,r)=>(0,e.jsx)(de,{content:t("valRequiredField"),placement:"bottom"},(0,e.jsx)("span",{css:r.typo.required,"aria-label":t("ariaRequired"),role:"img","aria-hidden":"false"},Y.required)),ce=({loading:t,children:r,text:n,icon:s,alignText:o})=>{const i=ee();if(t)return(0,e.jsx)(v.Loading,{type:v.LoadingType.Donut});if(r)return(0,e.jsx)(e.React.Fragment,null,r);const a="string"==typeof s&&s.length>0||null!=s&&e.React.isValidElement(s),l=!!n;if(!a&&!l)return null;if(a&&!l)return"string"==typeof s?(0,e.jsx)(ue,{src:s,size:Y.icon.large}):s;if(l&&!a)return(0,e.jsx)(e.React.Fragment,null,n);const c="string"==typeof s?(0,e.jsx)(ue,{src:s,size:Y.icon.medium}):s,u=(0,e.jsx)("span",{css:i.btn.icon,"aria-hidden":"true"},c);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("div",{css:i.btn.text(o)},n),u)},ue=({src:t,size:r=Y.icon.medium,className:n,style:s,role:o="img","aria-label":i,"aria-hidden":a,...l})=>{const c=J[t]??t,u=a??!i;return(0,e.jsx)(v.SVG,{...l,src:c,size:r,className:n,role:o,"aria-label":i,"aria-hidden":u,css:ne([],s)})},de=({content:t,children:r,showArrow:n=Y.tooltip.showArrow,placement:s=Y.tooltip.position.top,disabled:o=!1,...i})=>{const a=t;if(!e.React.isValidElement(r)||!a||o)return(0,e.jsx)(e.React.Fragment,null,r);const l=((t,r)=>{const n=t.props||{};if(!n.disabled&&!n["aria-disabled"])return t;const s="string"==typeof r?r:void 0;return(0,e.jsx)("span",{"aria-disabled":"true","aria-label":s},t)})(r,a),c=ae(s);return(0,e.jsx)(v.Tooltip,{title:a,showArrow:n,placement:c,...i},l)},pe=t=>(0,e.jsx)(v.Checkbox,{...t}),fe=t=>{const{value:r,defaultValue:n,required:s=!1,maxLength:o,errorText:i,type:a="text",step:l,onChange:c,onBlur:u,onFileChange:d,style:p,id:f,...h}=t,m=ee(),g="file"===a,[y,E]=re(r,n||""),[b,w]=g?[void 0,void 0]:[y,E],S=e.hooks.useEventCallback((e=>{const t=e.target.value;g||w(t),g&&d?d(e):c&&c(t)})),R=e.hooks.useEventCallback((e=>{u&&u(g?"":e.target.value)})),O=oe({id:f,required:s,errorText:i});if(g)return(0,e.jsx)("input",{...h,id:f,style:p,type:"file",onChange:S,onBlur:R,required:s,title:i,...O,css:se(m,p)});const T=new Set(["text","email","password","search","tel","date","datetime-local","month","time","week","datetime","select","file"]),A="number"!==a&&T.has(a)?a:"text",I="number"==typeof b||"string"==typeof b?b:"";return(0,e.jsx)(v.TextInput,{...h,id:f,style:p,type:A,value:I,step:l,onChange:S,onBlur:R,required:s,maxLength:o,title:i,...O,css:se(m,p)})},he=({value:t,defaultValue:r,onChange:n,rows:s=2,onBlur:o,...i})=>{const a=ee(),[l,c]=re(t,r||""),u=e.hooks.useEventCallback((e=>{const t=e.target.value;c(t),n?.(t)})),d=e.hooks.useEventCallback((e=>{o?.(e.target.value)})),p=i.validationMessage??i.errorText,f=oe({id:i.id,required:i.required,errorText:p,errorSuffix:"error"}),h={...i,value:l,onChange:u,onBlur:d,css:ne([a.fullWidth,a.textareaResize],i.style),...f,rows:s};return(0,e.jsx)(v.TextArea,{...h})},me=({value:t,defaultValue:r,placeholder:n,style:s,onChange:o})=>{const i=ee();return(0,e.jsx)(v.UrlInput,{value:t,defaultValue:r,placeholder:n,schemes:["https"],onChange:e=>{const t=(e?.value||"").trim();o?.(t)},css:se(i,s)})},ge=t=>(0,e.jsx)(v.Switch,{...t}),ye=({options:t,value:r,defaultValue:n,onChange:s,style:o,disabled:i,"aria-label":a})=>{const l=ee(),c=void 0!==r;return(0,e.jsx)("div",{css:se(l,o),role:"radiogroup","aria-label":a},t.map(((t,o)=>(0,e.jsx)(v.Label,{key:`${t.value}-${o}`,check:!0,centric:!0},(0,e.jsx)(v.Radio,{value:t.value,...c?{checked:r===t.value}:{defaultChecked:n===t.value},disabled:i,onChange:e=>{s?.(e.target.value)}}),t.label))))},Ee=({value:t,defaultValue:r,min:n,max:s,step:o,onChange:i,style:a,disabled:l,"aria-label":c,decimalPrecision:u,showValue:d=!0,valueFormatter:p})=>{const f=ee(),m=e.hooks.useEventCallback((e=>"function"==typeof p?p(e):(0,h.xik)(e,u))),g="number"==typeof t&&Number.isFinite(t)?t:"number"==typeof r&&Number.isFinite(r)?r:void 0,y=d&&"number"==typeof g?m(g):"";return(0,e.jsx)("div",{css:f.form.sliderField},(0,e.jsx)(v.Slider,{value:t,defaultValue:r,min:n,max:s,step:o,disabled:l,"aria-label":c,onChange:e=>{const t=parseFloat(e.target.value);!Number.isNaN(t)&&Number.isFinite(t)&&i?.(t)},css:se(f,a)}),d&&""!==y?(0,e.jsx)("div",{css:f.form.sliderValue,"aria-live":"polite",role:"status"},y):null)},ve=({style:t,onChange:r,...n})=>{const s=ee();return(0,e.jsx)(v.NumericInput,{...n,onChange:e=>{"number"!=typeof e||Number.isNaN(e)?(null==e||Number.isNaN(e))&&r?.(void 0):r?.(e)},css:se(s,t)})},be=t=>(0,e.jsx)(v.Table,{...t}),we=({value:t,defaultValue:r,onChange:n,style:s,"aria-label":o})=>{const i=ee();return(0,e.jsx)(E.ColorPicker,{color:t||r||"#000000",onChange:e=>{n?.(e)},"aria-label":o,css:se(i,s),showArrow:!0})},Se=({options:t=[],value:r,defaultValue:n,onChange:s,placeholder:o,disabled:i=!1,style:a,coerce:l,allowSearch:c=!1,allowCustomValues:u=!1,hierarchical:d=!1})=>{const p=e.hooks.useTranslation(b),f=ee(),[m,g]=re(r,n),[y,E]=e.React.useState(""),w=o||p("phSelectOption"),S=e.hooks.useEventCallback((e=>{if("number"===l&&"string"==typeof e){const t=Number(e);return Number.isFinite(t)?t:e}return e})),R=e.hooks.useEventCallback(((e,t)=>{const r=S(void 0!==t?t:e?.target?.value);g(r),s?.(r)})),O=e.hooks.useEventCallback((e=>{if(!u)return;const t=e.trim();if(!t)return;const r=S(t);Object.is(r,m)||(g(r),s?.(r))})),T=c||u,A=(0,h.SP$)(t,d),I=T?y.trim():"",_=I.toLowerCase();let C=_?A.filter((({option:e})=>(e.label&&e.label.trim()?e.label.trim():String(e.value)).toLowerCase().includes(_))):A;if(u){if((e=>{if(null==e||"string"!=typeof e&&"number"!=typeof e)return;const t=String(e);C.some((({option:e})=>String(e.value)===t))||(C=[...C,{option:{value:e,label:t},depth:0}])})(m),I){const e=S(I),t="number"==typeof e||"string"==typeof e?e:I,r=String(t);C.some((({option:e})=>String(e.value)===r))||(C=[{option:{value:t,label:I},depth:0},...C])}}const k=null==m||"string"!=typeof m&&"number"!=typeof m?void 0:String(m),L=ne([f.fullWidth],a);return(0,e.jsx)("div",{css:L},T?(0,e.jsx)(fe,{type:"search",value:y,placeholder:p("phSearch"),onChange:e=>{E("string"==typeof e?e:"")},onKeyDown:e=>{"Enter"===e.key&&u&&(e.preventDefault(),O(e.currentTarget.value),E(""))},disabled:i}):null,(0,e.jsx)(v.Select,{value:k,onChange:R,disabled:i,placeholder:w,zIndex:Y.zIndex.selectMenu,css:f.fullWidth},C.map((({option:t,depth:r},n)=>{if(!t||null==t.value)return null;const s=String(t.value),o=s===k,i=t.label&&t.label.trim()?t.label.trim():s,a=(0,h.I0Z)(i,p),l=t.hideLabel?"":d&&r>0?`${"- ".repeat(r)}${a}`:a;return(0,e.jsx)(v.Option,{key:`${s}-${r}-${n}`,value:t.value,active:o,disabled:Boolean(t.disabled),onClick:()=>{t.disabled||s===k||R(void 0,t.value)}},t.hideLabel?null:l)})).filter(Boolean)))},Re=({text:t,icon:r,alignText:n="start",tooltip:s,type:o,tooltipDisabled:i=!1,tooltipPlacement:a=Y.button.defaults.tooltipPosition,loading:l=!1,onClick:c,children:u,block:d=Y.button.defaults.block,size:p,variant:f="contained",color:m,htmlType:g="button",...y})=>{const E=ee(),w=e.hooks.useTranslation(b),S=e.hooks.useEventCallback((()=>{y.disabled||l||!c||c()})),R=y["aria-label"],O=(0,h.kzc)(t,!!r,R,s,w("ariaButton")),{style:T,css:A,...I}=y,_=Array.isArray(A)?[...A]:A?[A]:[],C=!!s&&!i,k=C?[E.relative]:ne([E.relative,..._],T),L=o,M=m,N=p,x=f,D=(0,e.jsx)(v.Button,{...I,type:L,color:M,variant:x,size:N,htmlType:g,icon:!t&&!!r,onClick:S,disabled:y.disabled||l,"aria-busy":l,"aria-live":l?"polite":void 0,"aria-label":O,title:s?void 0:y.title,css:k,block:d,tabIndex:y.tabIndex??0},(0,e.jsx)(ce,{loading:l,text:t,icon:r,alignText:n},u));return C?ie(D,{tooltip:s,placement:a,block:d,jimuCss:_,jimuStyle:T,styles:E}):D},Oe=({className:t,style:r,text:n,children:s,type:o="warning",withIcon:i,variant:a="default",jimuVariant:l,tooltipPlacement:c=Y.tooltip.position.top,...u})=>{const d=ee(),p=Z[o],f=s??(null!=n?(0,e.jsx)("span",null,n):null),h="icon"!==a||p?a:"default",{css:m,...g}=u,y=Array.isArray(m)?[...m]:m?[m]:[];if("icon"===h){const i="string"==typeof n?n:"string"==typeof s?s:f,a=Boolean(i),u="string"==typeof n?n:"string"==typeof s?s:void 0,h=(0,e.jsx)(v.Alert,{...g,type:o,withIcon:!1,variant:l,className:t,css:a?[d.alert]:ne([d.alert,...y],r)},p?(0,e.jsx)("div",{css:d.alertIcon},(0,e.jsx)(ue,{src:p,"aria-label":u})):null);return a?ie(h,{tooltip:i,placement:ae(c),block:!0,jimuCss:y,jimuStyle:r,styles:d}):h}return null!=f||p?(0,e.jsx)(v.Alert,{...g,type:o,withIcon:!1,variant:l,className:t,css:ne([d.alert,...y],r)},(0,e.jsx)("div",{css:d.alertContent},p?(0,e.jsx)("div",{css:d.alertIcon},(0,e.jsx)(ue,{src:p,size:Y.icon.small})):null,f?(0,e.jsx)("div",{css:d.alertMessage},f):null)):(0,e.jsx)(v.Alert,{...g,type:o,withIcon:!1,variant:l,className:t,css:ne([d.alert,...y],r)})},Te=({items:t,value:r,defaultValue:n,onChange:s,onTabChange:o,ariaLabel:i})=>{const a=ee(),[l,c]=re(void 0,n||t[0]?.value),u=void 0!==r,d=u?r:l,p=e.hooks.useEventCallback((e=>{const r=t.find((t=>t.value===e)),n=r?r.value:e;u||c(n),s?.(n),o?.(n)}));return(0,e.jsx)(v.AdvancedButtonGroup,{role:"tablist","aria-label":i,css:[a.row]},t.map(((t,r)=>{const n=d===t.value;return(0,e.jsx)(Re,{key:"string"==typeof t.value||"number"==typeof t.value?String(t.value):`tab-${r}-${t.label}`,icon:t.icon,size:"lg",text:t.hideLabel?void 0:t.label,active:n,"aria-label":t.label,type:n?"primary":"tertiary",role:"tab","aria-selected":n,tooltip:t.tooltip,tooltipPlacement:"bottom",disabled:t.disabled,onClick:()=>{n||p(t.value)},block:!1})})))},Ae=({state:t,className:r,style:n,renderActions:s,center:o})=>{const i=ee(),a=e.hooks.useTranslation(b),{showLoading:c,snapshot:u}=(0,l.kg)(t,Y.loading.delay),[d,p]=e.React.useState(0),f=new Set,m=[],g=e=>{if(null!=e){if("string"==typeof e){const t=e.trim();if(!t||f.has(t))return;return f.add(t),void m.push(t)}m.push(e)}},y="loading"===t.kind?t.message:void 0,E="loading"===t.kind?t.detail:void 0,w="loading"===t.kind&&Array.isArray(t.messages)?t.messages:void 0;g(u?.message??y),g(u?.detail??E);const S=(u?.messages&&Array.isArray(u.messages)?u.messages:w)??[];for(const e of S)g(e);const R=m.length,O=m.map(((t,r)=>"string"==typeof t?t:e.React.isValidElement(t)&&null!=t.key?String(t.key):`node-${r}`)).join("|");e.hooks.useEffectWithPreviousValues((()=>{p(0)}),[O,c]),e.hooks.useEffectWithPreviousValues((()=>{0!==R||0===d?R>0&&d>=R&&p(R-1):p(0)}),[R,d]),e.hooks.useEffectWithPreviousValues((()=>{if(!c||R<=1)return;const e=Y.loading.detailDelay??Y.loading.delay,t=Y.loading.cycleInterval??0;let r=null,n=null;return r=setTimeout((()=>{p((e=>{if(R<=1)return 0;const t=e%R;return 0===t?1:t})),t>0&&(n&&clearInterval(n),n=setInterval((()=>{p((e=>R<=1?0:(e+1)%R))}),t))}),e),()=>{r&&clearTimeout(r),n&&clearInterval(n)}}),[c,R,O]);const T=R>0&&d>=0?m[Math.max(0,d)%R]:null,A=e.hooks.useEventCallback((({actions:t,ariaLabel:r})=>t?.length?(0,e.jsx)("div",{role:"group","aria-label":r,css:i.btn.group},t.map(((t,r)=>(0,e.jsx)(Re,{key:r,onClick:t.onClick,disabled:t.disabled,type:t.type,variant:t.variant,text:t.label,block:!0})))):null)),I=s?({actions:e,ariaLabel:t})=>s(e,t):A,_=()=>(0,e.jsx)("div",{css:i.centered,role:"status","aria-live":"polite","aria-atomic":!0},c&&(0,e.jsx)("div",{css:i.loadingSpinner},(0,e.jsx)(v.Loading,{type:v.LoadingType.Donut,width:Y.loading.width,height:Y.loading.height})),T?(0,e.jsx)("div",{css:[i.typo.loadingMessage,i.loadingText]},T):null),C="loading"===t.kind||c?_():(()=>{switch(t.kind){case"error":{const r=I({actions:t.actions,ariaLabel:a("ariaErrorActions")}),n=null==t.detail?null:(0,e.jsx)("div",{css:i.typo.caption},t.detail);return(0,e.jsx)("div",{role:"alert","aria-live":"assertive",css:i.stateView.error},(0,e.jsx)("div",{css:i.stateView.errorContent},(0,e.jsx)("div",{css:[i.row,i.rowAlignCenter]},(0,e.jsx)(ue,{src:(0,h.sJ)(t.code),size:Y.icon.large}),(0,e.jsx)("div",{css:i.typo.title},t.message)),(0,e.jsx)(e.React.Fragment,null,n,t.code?(0,e.jsx)("div",null,a("lblErrorCode"),": ",t.code):null)),r?(0,e.jsx)("div",{css:i.stateView.errorActions},r):null)}case"empty":return(0,e.jsx)("div",{role:"status","aria-live":"polite"},(0,e.jsx)("div",null,t.message),I({actions:t.actions,ariaLabel:a("ariaEmptyActions")}));case"success":{const r=I({actions:t.actions,ariaLabel:a("ariaSuccessActions")});return(0,e.jsx)("div",{role:"status","aria-live":"polite",css:i.stateView.error},t.title&&(0,e.jsx)("div",{css:i.typo.title},t.title),t.message&&(0,e.jsx)("div",{css:i.typo.caption},t.message),t.detail&&(0,e.jsx)("div",{css:[i.typo.caption,(0,e.css)({"& > div":i.stateView.infoLine})]},"string"==typeof t.detail?(0,e.jsx)("span",null,t.detail):t.detail),r?(0,e.jsx)("div",{css:i.stateView.errorActions},r):null)}case"content":return(0,e.jsx)(e.React.Fragment,null,t.node);case"loading":return _()}})(),k="boolean"==typeof o?o:c;return(0,e.jsx)("div",{className:r,css:ne([i.stateView.frame,k?i.centered:void 0],n)},C)},Ie=t=>{const{buttons:r,secondaryButton:n,primaryButton:s,className:o,style:i}=t,a=ee(),l=r?.length?r.map(((e,t)=>({config:e,role:t===r.length-1?"primary":"secondary",key:t.toString()}))):[s?{config:s,role:"primary",key:"primary"}:null,n?{config:n,role:"secondary",key:"secondary"}:null].filter((e=>null!=e));return l.length?(0,e.jsx)("div",{css:ne([a.btn.group],i),className:o},l.map((({config:t,role:r,key:n})=>{const s="primary"===r?"primary":"default",o={...t,type:t.type??s};return(0,e.jsx)(Re,{key:n,...o,block:!0,css:a.btn.flex})}))):null},_e=t=>{const{variant:r,className:n,style:s,children:o}=t,i=e.hooks.useTranslation(b),a=ee();if("layout"===r){const{title:r,subtitle:l,onBack:c,onSubmit:u,isValid:d=!0,loading:p=!1}=t;return(0,e.jsx)("div",{className:n,css:ne([a.form.layout],s)},(0,e.jsx)("div",{css:a.form.header},r&&(0,e.jsx)("div",{css:a.typo.title},r),l&&(0,e.jsx)("div",{css:a.typo.caption},l)),(0,e.jsx)("div",{css:a.form.content},(0,e.jsx)("div",{css:a.form.body},o),(0,e.jsx)("div",{css:a.form.footer},(0,e.jsx)(Ie,{secondaryButton:c?{text:i("btnBack"),onClick:c,disabled:p}:void 0,primaryButton:{text:i("btnSubmit"),onClick:u,disabled:!d||p,loading:p,tooltip:i("tipSubmitOrder")}}))))}if("field"===r){const{label:r,helper:i,required:a=!1,readOnly:l=!1,error:c}=t;return(0,e.jsx)(Ce,{className:n,style:s,label:r,helper:i,required:a,readOnly:l,error:c},o)}throw new Error(`Unknown Form variant: ${r}`)},Ce=({className:t,style:r,label:n,helper:s,required:o=!1,readOnly:i=!1,check:a=!1,error:l,children:c})=>{const u=ee(),d=e.hooks.useTranslation(b),p=te(),{id:f,child:h}=((t,r,n)=>{if(r||!e.React.isValidElement(t))return{id:void 0,child:t};const s=t.props||{},o=s.id||n;return s.id?{id:o,child:t}:{id:o,child:e.React.cloneElement(t,{id:o})}})(c,i,p);return(0,e.jsx)(v.FormGroup,{className:t,css:ne([u.field],r)},a?(0,e.jsx)(v.Label,{css:[u.typo.label,u.checkLabel],check:!0},(0,e.jsx)("span",null,n,o&&le(d,u)),!i&&h):(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(v.Label,{css:u.typo.label,check:!1,for:f},n,o&&le(d,u)),!i&&h),s&&!l&&(0,e.jsx)("div",{css:u.typo.hint,id:f?`${f}-help`:void 0},s),l&&(0,e.jsx)("div",{id:f?`${f}-error`:void 0,css:u.typo.errorMessage,role:"alert"},l))},ke=(t,r,n,s)=>{if(!t)return(0,e.jsx)(e.React.Fragment,null,s);const i=r("msgContactSupport"),a=i.split(o.BY);return a.length<2?(0,e.jsx)(e.React.Fragment,null,i," ",(0,e.jsx)("a",{href:`mailto:${t}`,css:n.typo.link,"aria-label":r("msgContactSupport",{email:t})},t)):a.map(((s,o)=>o<a.length-1?(0,e.jsx)(e.React.Fragment,{key:o},s,(0,e.jsx)("a",{href:`mailto:${t}`,css:n.typo.link,"aria-label":r("msgContactSupport",{email:t})},t)):(0,e.jsx)(e.React.Fragment,{key:o},s)))};var Le=c(7389),Me=c(2779);class Ne{constructor(e,t,r){this.fieldStates=new Map,this.fieldNames=new Set,this.formValues=e;for(const e of t)this.fieldNames.add(e.name),e.visibilityState&&this.fieldStates.set(e.name,e.visibilityState);if(r)for(const[e,t]of r)this.fieldNames.add(e),t&&this.fieldStates.set(e,t)}evaluate(e,t){const r=this.evaluateInternal(e);return t&&(this.fieldStates.set(t,r),this.fieldNames.add(t)),r}evaluateInternal(e){if(!e)return"visibleEnabled";for(const t of e.if){const r=this.evaluateClause(t);if(!0===r)return t.then;if("unknown"===r)return this.resolveDefault(e)}return this.resolveDefault(e)}resolveDefault(e){return e.default?.value??"visibleEnabled"}evaluateClause(e){const t=(0,h.QdQ)(e)?e:{},r=Object.keys(t).filter((e=>e.startsWith("$")));if(0===r.length)return!0;let n=!1;for(const e of r){const r=this.evaluateCondition(e,t[e]);if(!1===r)return!1;"unknown"===r&&(n=!0)}return!n||"unknown"}evaluateCondition(e,t){switch(e){case"$equals":return this.evaluateEquals(t);case"$lessThan":return this.evaluateLessThan(t);case"$greaterThan":return this.evaluateGreaterThan(t);case"$matchesRegex":return this.evaluateMatchesRegex(t);case"$isEnabled":return this.evaluateIsEnabled(t);case"$isRuntimeValue":return this.evaluateIsRuntimeValue(t);case"$allOf":return this.evaluateAllOf(t);case"$anyOf":return this.evaluateAnyOf(t);case"$not":return this.evaluateNot(t);default:return!1}}evaluateEquals(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;const n=this.getParameterValue(t);if(void 0===n)return"unknown";if(void 0===r)return!1;return(0,h.sLt)(n)===(0,h.sLt)(r)}evaluateLessThan(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;if(null==r)return!1;const n=this.getParameterValue(t);return void 0===n?"unknown":this.compare(n,r,((e,t)=>e<t))}evaluateGreaterThan(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t,value:r}=e;if("string"!=typeof t)return!1;if(null==r)return!1;const n=this.getParameterValue(t);return void 0===n?"unknown":this.compare(n,r,((e,t)=>e>t))}compare(e,t,r){const n=(0,h.sLt)(e),s=(0,h.sLt)(t),o=Number(n),i=Number(s);if(Number.isFinite(o)&&Number.isFinite(i))return r(o,i);const a=this.toLexString(n),l=this.toLexString(s);return r(a.localeCompare(l),0)}evaluateMatchesRegex(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t,regex:r}=e;if("string"!=typeof t||"string"!=typeof r)return!1;const n=this.getParameterValue(t);if(void 0===n)return"unknown";const s=this.toLexString((0,h.sLt)(n)),i=r.trim();if(!i)return!1;const a=(0,Me.rH)(i,"",{maxLength:o.Do});return a?a.test(s):((0,Le.J)("VisibilityEvaluator: Unsafe regex blocked",{parameter:t,length:i.length}),!1)}evaluateIsEnabled(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t}=e;if("string"!=typeof t)return!1;if(!this.fieldNames.has(t))return!1;const r=this.fieldStates.get(t);return r?"visibleEnabled"===r||"hiddenEnabled"===r:"unknown"}evaluateIsRuntimeValue(e){if(!(0,h.QdQ)(e))return!1;const{parameter:t}=e;if("string"!=typeof t)return!1;const r=this.getParameterValue(t);if(void 0===r)return!1;const n=(0,h.NnH)(r);if(n)return n.startsWith("$");const s=(0,h.sLt)(r);return this.toLexString(s).startsWith("$")}evaluateAllOf(e){if(!Array.isArray(e)||0===e.length)return!1;let t=!1;for(const r of e){if(!(0,h.QdQ)(r))return!1;const e=r,n=Object.keys(e).filter((e=>e.startsWith("$")));if(n.length)for(const r of n){const n=this.evaluateCondition(r,e[r]);if(!1===n)return!1;"unknown"===n&&(t=!0)}}return!t||"unknown"}evaluateAnyOf(e){if(!Array.isArray(e)||0===e.length)return!1;let t=!1;for(const r of e){if(!(0,h.QdQ)(r)){(0,Le.J)("Invalid condition in $anyOf (expected object)",r);continue}const e=r,n=Object.keys(e).filter((e=>e.startsWith("$")));if(n.length)for(const r of n){const n=this.evaluateCondition(r,e[r]);if(!0===n)return!0;"unknown"===n&&(t=!0)}else(0,Le.J)("Invalid condition in $anyOf (no operators)",r)}return!!t&&"unknown"}evaluateNot(e){if(!(0,h.QdQ)(e))return!1;const t=e,r=Object.keys(t).filter((e=>e.startsWith("$")));if(!r.length)return!1;const n=this.evaluateCondition(r[0],t[r[0]]);return"unknown"===n?"unknown":!n}getParameterValue(e){const t=this.formValues[e];if(!(0,h.Ime)(t))return t}toLexString(e){return"string"==typeof e?e:String(e)}}var xe=c(5938),De=c(3128);const Pe=new Set([o.Vw.SELECT,o.Vw.COORDSYS,o.Vw.ATTRIBUTE_NAME,o.Vw.DB_CONNECTION,o.Vw.WEB_CONNECTION,o.Vw.REPROJECTION_FILE]),Fe=new Set([o.Vw.MULTI_SELECT,o.Vw.ATTRIBUTE_LIST]),je="text",Ue="file",Ve=e=>(0,h.wKo)(e)??"",We=(t,r,n,s,o={})=>{const{readOnly:i,maxLength:a,overrides:l}=o,c="string"==typeof r||"number"==typeof r?String(r):"",u=l&&void 0!==l.disabled?l.disabled:i;return(0,e.jsx)(fe,{...l,type:"number"===t?"text":t,value:c,placeholder:n,onChange:e=>{if("number"===t){if(""===e)return void s(null);const t=Number(e.replace(/,/g,"."));s(Number.isFinite(t)?t:null)}else s(e)},disabled:u,maxLength:a})},Be=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),qe=(e,t)=>{if(Array.isArray(e))return e.map((e=>{if(Be(e)){const r={};for(const n of t)r[n.key]=e[n.key]??"";return r}return{value:e}}));if((0,h.YH$)(e)){const r=e.trim();try{const e=JSON.parse(r);return Array.isArray(e)?qe(e,t):[]}catch{return r.split(/\r?\n/).map((e=>e.trim())).filter(Boolean).map((e=>({value:e})))}}return[]},Ge=e=>e?.accept?.length?e.accept.map((e=>(e=>{const t=(0,h.NnH)(e).toLowerCase();return t?"*/*"===t||t.endsWith("/*")||t.includes("/")?t:t.startsWith("*.")?`.${t.slice(2)}`:t.startsWith(".")?t:`.${t.replace(/^\*+/,"")}`:null})(e))).filter((e=>Boolean(e))):[],Qe=(e,t)=>{if(!e)return{valid:!1,error:"fileInvalid"};const r=Ge(t),n="number"==typeof t?.maxSizeMb&&Number.isFinite(t.maxSizeMb)?t.maxSizeMb:void 0,s=void 0===n?o.vp.DEFAULT_MAX_SIZE_MB:n>0?n:void 0;if(void 0!==s&&e.size>s*o.vp.ONE_MB_IN_BYTES)return{valid:!1,error:"fileTooLarge",maxSizeMB:Math.floor(s)};const i=(e.name||"").toLowerCase(),a=(e.type||"").toLowerCase();if(r.length){if(!r.some((e=>{if("*/*"===e)return!0;if(e.endsWith("/*")){const t=e.slice(0,e.length-1);return!!a&&a.startsWith(t)}return e.includes("/")?!!a&&a===e:i.endsWith(e)})))return{valid:!1,error:"fileTypeNotAllowed"}}else{if(!o.vp.DEFAULT_ALLOWED_EXTENSIONS.some((e=>i.endsWith(e))))return{valid:!1,error:"fileTypeNotAllowed"};if(!o.vp.DEFAULT_ALLOWED_MIME_TYPES.has(a))return{valid:!1,error:"fileTypeNotAllowed"}}return{valid:!0}},$e=(e,t)=>{if("string"==typeof e){return e.trim()||void 0}if("number"==typeof e||"boolean"==typeof e)return String(e);if(e){if((0,h.E$q)(e))return(0,h.SBV)(e,t);if(Array.isArray(e))for(const r of e){const e=$e(r,t);if(e)return e}else if(Be(e)){const r=e;for(const e of o.vp.FILE_DISPLAY_KEYS)if(e in r){const n=$e(r[e],t);if(n)return n}}}},ze=({value:t,onChange:r,field:n,jimuMapView:s,disabled:o,placeholder:i})=>{const[a,l]=e.React.useState([]),[c,u]=e.React.useState(!1),[d,p]=e.React.useState(null);e.hooks.useEffectWithPreviousValues((()=>{if(n.choiceSetConfig&&"attributeNames"===n.choiceSetConfig.type)if(s){u(!0),p(null);try{const e=(0,h.RBD)(s),t=(0,h.Fmk)(e);l(t),u(!1)}catch(e){console.log("Failed to collect layer attributes",e),p("Failed to load attributes"),u(!1)}}else p("No map view available")}),[n.choiceSetConfig,s]);const f=n.options||[],m=0===a.length?f:(()=>{const e=new Set,t=[];return f.forEach((r=>{const n=String(r.value??"");n&&!e.has(n)&&(e.add(n),t.push({value:n,label:r.label??n}))})),a.forEach((r=>{e.has(r.value)||(e.add(r.value),t.push(r))})),t})();if(d)return(0,e.jsx)(Oe,{type:"warning",withIcon:!0},d);if(c)return(0,e.jsx)(Se,{value:t,options:[],placeholder:"Loading attributes...",disabled:!0,"aria-label":n.label});if(0===m.length)return(0,e.jsx)(fe,{type:"text",value:Ve(t),placeholder:i||"Enter attribute name",onChange:e=>{const t=e.target.value;r(t)},disabled:o,"aria-label":n.label});const g=Pe.has(n.type),y=m,E=(0,h.ZFl)(g,y),v=n.selectConfig;return(0,e.jsx)(Se,{value:t,options:m,placeholder:i||"Select attribute",onChange:e=>{r(e)},"aria-label":n.label,disabled:o,coerce:E,allowSearch:v?.allowSearch??!0,allowCustomValues:v?.allowCustomValues??!0,hierarchical:v?.hierarchical})},He=({field:t,value:r,onChange:n,translate:s,disabled:i,jimuMapView:a})=>{const l=e.hooks.useTranslation(b),c=s??l,u=ee(),d=Fe.has(t.type),p=t.type===o.Vw.TEXT_OR_FILE?r:(0,h.HeH)(r,d),f=(0,h.B_y)(c,t.label),m=Boolean(i||t.readOnly),[g,y]=e.React.useState(null),E=Pe.has(t.type)||Fe.has(t.type),v=t.options||[],w=E&&!d&&1===v.length,S=w?v[0]?.value:void 0,R=e.hooks.useEventCallback((()=>{if(void 0!==S){const e=p;Object.is(e,S)||n(S)}})),O=(0,h.ZFl)(E,v);e.hooks.useEffectWithPreviousValues((()=>{if(!w||void 0===S)return;const e=p;!(null==e||"string"==typeof e&&!(0,h.YH$)(e))&&Object.is(e,S)||n(S)}),[w,S,p,n]);const T=()=>{const s=t.tableConfig;if(!s?.columns?.length){const s=(0,h.H9i)(r),o=(e,t)=>{if(m)return;const r=[...s];r[e]=t,n(r)},i=()=>{m||n([...s||[],""])},a=e=>{if(m)return;const t=s.filter(((t,r)=>r!==e));n(t)};return(0,e.jsx)("div",{"data-testid":"table-field"},0===s.length?(0,e.jsx)("div",null,c("msgTableEmpty")):(0,e.jsx)(be,{responsive:!0,hover:!0,"aria-label":t.label},(0,e.jsx)("tbody",null,s.map(((r,n)=>(0,e.jsx)("tr",{key:n},(0,e.jsx)("td",null,(0,e.jsx)(fe,{type:"text",value:r,placeholder:t.placeholder||f.enter,onChange:e=>{o(n,"string"==typeof e?e:"")},disabled:m})),(0,e.jsx)("td",null,(0,e.jsx)(Re,{text:c("btnDeleteRow"),variant:"text",type:"tertiary",onClick:()=>{a(n)},"aria-label":c("btnDeleteRow"),disabled:m}))))))),(0,e.jsx)(Re,{text:c("btnAddRow"),variant:"outlined",onClick:i,"aria-label":c("btnAddRow"),disabled:m}))}const o=s.columns&&s.columns.length?s.columns:[{key:"value",label:t.label||c("lblColumnDefault"),type:"text"}],i=qe(r,o).map(((e,r)=>({...e,__rowId:`${t.name}-row-${r}-${Date.now()}`}))),a=s?.minRows??0,l=s?.maxRows,u=s?.allowReorder??!1,d=s?.showHeader??!0,p=s?.addRowLabel||c("btnAddRow"),g=s?.removeRowLabel||c("btnDeleteRow"),y=!m&&i.length>a,E=!m&&(void 0===l||i.length<l),v=(e,t,r)=>{if(m)return;const s=i.map(((n,s)=>s===e?{...n,[t]:r}:n));n(s)},b=(e,t)=>{if(m)return;const r=e+t;if(r<0||r>=i.length)return;const s=[...i],[o]=s.splice(e,1);s.splice(r,0,o),n(s)};return(0,e.jsx)("div",{"data-testid":"table-field"},0===i.length?(0,e.jsx)("div",null,c("msgTableEmpty")):(0,e.jsx)(be,{responsive:!0,hover:!0,"aria-label":t.label},d?(0,e.jsx)("thead",null,(0,e.jsx)("tr",null,o.map((t=>(0,e.jsx)("th",{key:t.key},t.label))),(0,e.jsx)("th",null,c("lblActions")))):null,(0,e.jsx)("tbody",null,i.map((r=>(0,e.jsx)("tr",{key:r.__rowId||`fallback-${Math.random()}`},o.map((n=>(0,e.jsx)("td",{key:`${r.__rowId}-${n.key}`},((r,n,s)=>{const o=s[r.key],i=m||r.readOnly,a=r.placeholder||t.placeholder||f.enter;switch(r.type){case"number":return(0,e.jsx)(fe,{type:"number",value:Ve(o),onChange:e=>{const t=""===e?null:Number(e.replace(/,/g,"."));v(n,r.key,Number.isFinite(t)?t:null)},disabled:i,placeholder:a});case"select":return(0,e.jsx)(Se,{value:o,options:r.options||[],placeholder:a,onChange:e=>{v(n,r.key,e)},disabled:i});case"boolean":return(0,e.jsx)(pe,{checked:Boolean(o),onChange:e=>{v(n,r.key,e.target.checked)},disabled:i,"aria-label":r.label});case"date":return(0,e.jsx)(fe,{type:"date",value:Ve(o),onChange:e=>{v(n,r.key,e)},disabled:i,placeholder:a});case"time":return(0,e.jsx)(fe,{type:"time",value:Ve(o),onChange:e=>{v(n,r.key,e)},disabled:i});case"datetime":return(0,e.jsx)(et,{value:Ve(o),onChange:e=>{v(n,r.key,e)},disabled:i,"aria-label":r.label});default:return(0,e.jsx)(fe,{type:"text",value:Ve(o),onChange:e=>{v(n,r.key,e)},disabled:i,placeholder:a})}})(n,i.findIndex((e=>e.__rowId===r.__rowId)),r)))),(0,e.jsx)("td",null,(0,e.jsx)(Re,{text:g,variant:"text",type:"tertiary",onClick:()=>{(e=>{if(m||!y)return;const t=i.filter(((t,r)=>r!==e));n(t)})(i.findIndex((e=>e.__rowId===r.__rowId)))},"aria-label":g,disabled:!y}),u?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(Re,{text:c("btnMoveUp"),variant:"text",type:"tertiary",onClick:()=>{b(i.findIndex((e=>e.__rowId===r.__rowId)),-1)},"aria-label":c("btnMoveUp"),disabled:m||0===i.findIndex((e=>e.__rowId===r.__rowId))}),(0,e.jsx)(Re,{text:c("btnMoveDown"),variant:"text",type:"tertiary",onClick:()=>{b(i.findIndex((e=>e.__rowId===r.__rowId)),1)},"aria-label":c("btnMoveDown"),disabled:m||i.findIndex((e=>e.__rowId===r.__rowId))===i.length-1})):null)))))),(0,e.jsx)(Re,{text:p,variant:"outlined",onClick:()=>{(()=>{if(!E)return;const e=(e=>{const t={};for(const r of e)t[r.key]=void 0!==r.defaultValue?r.defaultValue:"";return t})(o);n([...i,e])})()},"aria-label":p,disabled:!E}))},A=()=>{const s=t.toggleConfig,i=((e,t)=>{if(t){if(void 0!==t.checkedValue&&(0,h.$Xq)(e,t.checkedValue))return!0;if(void 0!==t.uncheckedValue&&(0,h.$Xq)(e,t.uncheckedValue))return!1}const r=(0,h.Dr1)(e);if(void 0!==r)return r;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.trim();if(!t)return!1;if("0"===t)return!1}return Boolean(e)})(null!=r&&""!==r?r:t.defaultValue,s),a=e=>{if(m)return;const t=((e,t)=>e?void 0===t?.checkedValue||t.checkedValue:void 0!==t?.uncheckedValue&&t.uncheckedValue)(e,s);n(t)};return t.type===o.Vw.CHECKBOX?(0,e.jsx)(pe,{checked:i,onChange:e=>{a(e.target.checked)},disabled:m,"aria-label":t.label}):(0,e.jsx)(ge,{checked:i,onChange:(e,t)=>{a(t)},disabled:m,"aria-label":t.label})},I=()=>{const r=((e,t)=>{if(e&&"object"==typeof e&&!Array.isArray(e)&&"mode"in e){const r=e;if(r.mode===Ue&&(0,h.E$q)(r.file))return{mode:Ue,file:r.file,fileName:"string"==typeof r.fileName?r.fileName:(0,h.SBV)(r.file,t)};if(r.mode===je)return{mode:je,text:Ve(r.text)}}return(0,h.E$q)(e)?{mode:Ue,file:e,fileName:(0,h.SBV)(e,t)}:{mode:je,text:Ve(e)}})(p,c),s=r.mode===Ue?Ue:je,o=Ge(t.fileConfig),i=o.length?o.join(","):void 0;return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(Te,{items:[{value:je,label:c("lblTextInput")},{value:Ue,label:c("lblFileInput")}],value:s,onChange:e=>{var t;t=e,m||n(t===Ue?{mode:Ue,file:(0,h.E$q)(r.file)?r.file:null,fileName:r.fileName}:{mode:je,text:Ve(r.text)})},ariaLabel:t.label}),s===je?(0,e.jsx)(he,{value:Ve(r.text),placeholder:t.placeholder||f.enter,onChange:e=>{m||n({mode:je,text:e})},disabled:m,rows:t.rows}):(0,e.jsx)("div",null,(0,e.jsx)(fe,{type:"file",accept:i,onFileChange:e=>{if(m)return void(e.target.value="");const r=e.target.files,s=r&&r.length>0?r[0]:null;if(!s)return y(null),void n({mode:Ue,file:null,fileName:void 0});const o=Qe(s,t.fileConfig);if(!o.valid)return y("fileTooLarge"===o.error?c("errFileLarge",{maxSize:o.maxSizeMB}):"fileTypeNotAllowed"===o.error?c("errFileType"):c("errFileInvalid")),void(e.target.value="");y(null),n({mode:Ue,file:s,fileName:(0,h.SBV)(s,c)})},disabled:m,"aria-label":t.label}),g?(0,e.jsx)("div",{css:u.typo.errorMessage,"data-testid":"text-or-file-error",role:"alert"},g):null,(0,h.E$q)(r.file)&&!g?(0,e.jsx)("div",{"data-testid":"text-or-file-name"},r.fileName||(0,h.SBV)(r.file,c)):null))},_=()=>((t,r,n,s,o)=>(0,e.jsx)(fe,{type:t,value:Ve(r),placeholder:n,onChange:e=>{s(e)},disabled:o}))(t.type===o.Vw.MONTH?"month":"week",p,(0,h.Tdo)(t,f,c),n,m);return(()=>{switch(t.type){case o.Vw.HIDDEN:return(0,e.jsx)(e.React.Fragment,null);case o.Vw.MESSAGE:return(()=>{const r=t.label||t.description||"";return r.trim()?(0,e.jsx)(Oe,{type:"info",withIcon:!0,open:!0,text:r,"aria-live":"polite"}):(0,e.jsx)(e.React.Fragment,null)})();case o.Vw.TEXT:case o.Vw.PASSWORD:case o.Vw.EMAIL:case o.Vw.PHONE:case o.Vw.SEARCH:return(()=>{const e={[o.Vw.PASSWORD]:"password",[o.Vw.EMAIL]:"email",[o.Vw.PHONE]:"tel",[o.Vw.SEARCH]:"search",[o.Vw.TEXT]:"text"}[t.type]||"text",r=t.type===o.Vw.PHONE?"phone":t.type===o.Vw.EMAIL?"email":t.type===o.Vw.SEARCH?"search":void 0,s=t.type===o.Vw.PASSWORD?(0,h.Tdo)(t,f,c):(0,h.Tdo)(t,f,c,r);return We(e,p,s,n,{readOnly:m,maxLength:t.maxLength})})();case o.Vw.NUMBER:return We("number",p,f.enter,n,{readOnly:m});case o.Vw.TEXTAREA:return(0,e.jsx)(he,{value:Ve(p),placeholder:f.enter,onChange:e=>{n(e)},disabled:m,rows:t.rows});case o.Vw.URL:return(()=>{const r=Ve(p);return(0,e.jsx)(me,{value:r,placeholder:t.placeholder||f.enter,onChange:e=>{m||n(e)}})})();case o.Vw.TABLE:return T();case o.Vw.COORDSYS:case o.Vw.DB_CONNECTION:case o.Vw.WEB_CONNECTION:case o.Vw.REPROJECTION_FILE:case o.Vw.SELECT:return(()=>{const r=t.options||[],s=t.selectConfig;if(0===r.length)return We("text",p,f.enter,n,{readOnly:m});if(w){const e=v[0],t=(0,h.NnH)((0,h.I0Z)(e?.label||"",c))||(0,h.NnH)(e?.value)||"";return We("text",t,f.select,R,{readOnly:!0,overrides:{readOnly:!0,disabled:!0}})}return(0,e.jsx)(Se,{value:p,options:r,placeholder:f.select,onChange:e=>{n(e)},"aria-label":t.label,disabled:m,coerce:O,allowSearch:s?.allowSearch,allowCustomValues:s?.allowCustomValues,hierarchical:s?.hierarchical})})();case o.Vw.ATTRIBUTE_NAME:case o.Vw.ATTRIBUTE_LIST:return(0,e.jsx)(ze,{value:p,onChange:n,field:t,jimuMapView:a,disabled:m,placeholder:f.select});case o.Vw.DATE_TIME:return(()=>{const t="string"==typeof p?(0,h.hk0)(p):"";return(0,e.jsx)(et,{value:t,onChange:e=>{const t="string"==typeof p?p:void 0,r=(0,h.HKR)(e,t);n(r)},disabled:m})})();case o.Vw.MULTI_SELECT:return(()=>{const r=t.options||[],s=Array.isArray(p)?p:[],o=t.selectConfig;return(0,e.jsx)(rt,{options:r,values:[...s],placeholder:f.select,disabled:m,onChange:e=>{n(e)},allowSearch:o?.allowSearch,hierarchical:o?.hierarchical})})();case o.Vw.CHECKBOX:case o.Vw.SWITCH:return A();case o.Vw.FILE:return(()=>{const s=(0,h.E$q)(r)?r:null,o=Ge(t.fileConfig),i=o.length?o.join(","):void 0,a=s?$e(t.defaultValue,c):$e(r,c)??$e(p,c)??$e(t.defaultValue,c),l=(0,h.NnH)(a)||"",d=s?(0,h.SBV)(s,c):l,f=Boolean(d)?d:null;return(0,e.jsx)("div",null,(0,e.jsx)(fe,{type:"file",accept:i,onFileChange:e=>{if(m)return void(e.target.value="");const r=e.target.files,s=r&&r.length>0?r[0]:null;if(!s)return y(null),void n(null);const o=Qe(s,t.fileConfig);if(!o.valid)return y("fileTooLarge"===o.error?c("errFileLarge",{maxSize:o.maxSizeMB}):"fileTypeNotAllowed"===o.error?c("errFileType"):c("errFileInvalid")),void(e.target.value="");y(null),n(s)},disabled:m,"aria-label":t.label}),g?(0,e.jsx)("div",{css:u.typo.errorMessage,"data-testid":"file-field-error",role:"alert"},g):null,f&&!g?(0,e.jsx)("div",{"data-testid":"file-field-display","aria-live":"polite",css:u.typo.hint},f):null)})();case o.Vw.TEXT_OR_FILE:return I();case o.Vw.SCRIPTED:return(()=>{const r=(0,h.YH$)(p)?p:Ve(t.defaultValue)||t.description||t.label;return(0,e.jsx)(tt,{html:r||""})})();case o.Vw.RADIO:return(()=>{const r=t.options||[],s=(0,h.ZFl)(!0,r),o=null==p?void 0:(0,h.wKo)(p)??void 0;return(0,e.jsx)(ye,{options:r.map((e=>({label:e.label,value:String(e.value)}))),value:o,onChange:e=>{if("number"!==s)n(e);else{const t=Number(e);if(Number.isFinite(t))n(t);else{const t=r.find((t=>String(t.value)===e));n(t?.value??e)}}},disabled:m,"aria-label":t.label})})();case o.Vw.GEOMETRY:return(()=>{const t=Ve(p).trim();if(!t)return(0,e.jsx)("div",{css:u.typo.hint,"data-testid":"geometry-field"},c("msgNoGeometry"));let r=0,n=0,s=t,i=!1;try{const e=JSON.parse(t),o=Array.isArray(e?.rings)?e.rings:[];r=o.length,n=o.reduce(((e,t)=>e+(Array.isArray(t)?t.filter(Array.isArray).length:0)),0),s=JSON.stringify(e,null,2)}catch{i=!0}const a=s.length>o.vp.GEOMETRY_PREVIEW_MAX_LENGTH?`${s.slice(0,o.vp.GEOMETRY_PREVIEW_MAX_LENGTH)}\u2026`:s;return(0,e.jsx)("div",{"data-testid":"geometry-field"},(0,e.jsx)("div",{css:u.typo.hint},i?c("errGeomParse"):c("msgGeomReady",{rings:r,vertices:n})),a?(0,e.jsx)("pre",{"aria-label":c("ariaGeomPreview")},a):null)})();case o.Vw.SLIDER:return(()=>{const r="number"==typeof p?p:(0,h.YH$)(p)?Number(p.trim()):"number"==typeof t.defaultValue?t.defaultValue:t.min??0,s=Number.isFinite(r)?r:t.min??0,o="number"==typeof t.decimalPrecision&&t.decimalPrecision>=0?t.decimalPrecision:void 0;return(0,e.jsx)(Ee,{value:s,min:t.min??0,max:t.max??100,step:t.step??1,decimalPrecision:o,onChange:e=>{n(e)},disabled:m,"aria-label":t.label})})();case o.Vw.NUMERIC_INPUT:return(()=>{const r="number"==typeof p?p:(0,h.YH$)(p)?Number(p.trim()):void 0,s=void 0===r&&"number"==typeof t.defaultValue?t.defaultValue:void 0,o="number"==typeof t.decimalPrecision&&t.decimalPrecision>=0?t.decimalPrecision:2;let i=null;void 0!==r&&Number.isFinite(r)&&(0===o&&r%1!=0&&(i=c("valIntegerOnly")),i||"number"!=typeof t.min||(t.minExclusive?r<=t.min:r<t.min)&&(i=t.minExclusive?c("valGreaterThan",{value:t.min}):c("valAtLeast",{value:t.min})),i||"number"!=typeof t.max||(t.maxExclusive?r>=t.max:r>t.max)&&(i=t.maxExclusive?c("valLessThan",{value:t.max}):c("valAtMost",{value:t.max})));const a=void 0===r&&void 0!==s?{defaultValue:s}:{value:r};return(0,e.jsx)("div",null,(0,e.jsx)(ve,{...a,placeholder:t.placeholder||f.enter,min:t.min,max:t.max,step:t.step,precision:o,disabled:m,"aria-label":t.label,"aria-invalid":!!i,"aria-describedby":i?`${t.name}-error`:void 0,onChange:e=>{n(void 0!==e?e:null)}}),i&&(0,e.jsx)("div",{id:`${t.name}-error`,css:u.typo.errorMessage,role:"alert","data-testid":"numeric-input-error"},i))})();case o.Vw.TAG_INPUT:return(()=>{const r=Array.isArray(p)?p:[];return(0,e.jsx)(Ze,{value:r,placeholder:t.placeholder||c("phTags"),onChange:e=>{m||n(e)}})})();case o.Vw.COLOR:return(()=>{const r=t.colorConfig,s="string"==typeof p?(0,h.$em)(p,r)||p:void 0,o="string"==typeof s&&s.startsWith("#")?s:"#000000";return(0,e.jsx)(we,{value:o,onChange:e=>{if(m)return;const t=(0,h.FKs)(e,r)||e;n(t)}})})();case o.Vw.DATE:return(()=>{const r="string"==typeof p?(0,h.Wxj)(p):"",s=r?`${r}T00:00:00`:"";return(0,e.jsx)(et,{mode:"date",value:s,onChange:e=>{const t=("string"==typeof e?e:"").split("T")[0]||"",r=(0,h.OD1)(t);n(r)},"aria-label":t.label,disabled:m})})();case o.Vw.MONTH:case o.Vw.WEEK:return _();case o.Vw.TIME:return(()=>{const t="string"==typeof p?(0,h.BU)(p):"";return(0,e.jsx)(fe,{type:"time",value:t,onChange:e=>{const t="string"==typeof p?p:void 0,r=(0,h.rIK)(e,t);n(r)},disabled:m})})()}})()},Ke=()=>(0,De.MN)(),Xe=l.j_,Ye=(e,t)=>[...e,(0,h.RMY)(t)].filter(Boolean),Je=(e,t)=>Ye([e.fullWidth],t),Ze=({value:t,suggestions:r,placeholder:n,onChange:s,style:o})=>{const i=Ke();return(0,e.jsx)(v.TagInput,{values:t,suggestions:r,placeholder:n,onChange:e=>{s?.(e)},css:Je(i,o)})},et=({value:t,defaultValue:r,onChange:n,style:s,disabled:o,"aria-label":i,mode:a="date-time",format:l="iso"})=>{const c=Ke(),[u,d]=Xe(t,r,n),p=()=>{const e=new Date;return"date"===a&&e.setHours(0,0,0,0),e},f=e.React.useRef(p());e.hooks.useUpdateEffect((()=>{f.current=p()}),[a]);const m=f.current,g=(0,h.dCw)(u)||(0,h.dCw)(r)||m,y=e.hooks.useEventCallback(((e,t)=>{if("number"==typeof e&&Number.isFinite(e)){const t=new Date(e);return"date"===a&&t.setHours(0,0,0,0),void d((0,h.JRh)(t,l))}if(e instanceof Date){const t=new Date(e.getTime());return"date"===a&&t.setHours(0,0,0,0),void d((0,h.JRh)(t,l))}null==e&&d("")})),E=Ye([c.fullWidth,c.relative],s),v=(0,e.jsx)("div",{css:E},(0,e.jsx)(xe.DatePicker,{selectedDate:g,runtime:!1,showTimeInput:"date-time"===a,isLongTime:"date-time"===a,supportVirtualDateList:!1,disablePortal:!0,onChange:y,"aria-label":i}));return o?(0,e.jsx)("span",{"aria-disabled":"true",css:c.disabledPicker},v):v},tt=({html:t,placeholder:r,className:n,style:s})=>t&&0!==t.trim().length?(0,e.jsx)(v.RichDisplayer,{className:n,css:(0,h.RMY)(s),value:t}):(0,e.jsx)("div",{className:n,css:(0,h.RMY)(s)},r||""),rt=({options:t=[],values:r,defaultValues:n=[],onChange:s,placeholder:o,disabled:i=!1,style:a,allowSearch:l=!1,hierarchical:c=!1})=>{const u=e.hooks.useTranslation(b),d=Ke(),[p,f]=Xe(r,n),[m,g]=e.React.useState(""),y=o||u("phSelectOption"),E=(l?m.trim():"").toLowerCase(),w=(0,h.SP$)(t,c),S=(E?w.filter((({option:e})=>(e.label&&e.label.trim()?e.label.trim():String(e.value)).toLowerCase().includes(E))):w).map((({option:e,depth:t})=>{if(!e||null==e.value)return null;const r=e.label&&e.label.trim()?e.label.trim():String(e.value),n=c&&t>0?`${"- ".repeat(t)}${r}`:r;return{value:e.value,label:n,disabled:Boolean(e.disabled)}})).filter(Boolean),R=e.hooks.useEventCallback(((e,t)=>{const r=Array.isArray(t)?t.filter((e=>null!=e)):[];f(r),s?.(r)}));return(0,e.jsx)("div",{css:Ye([d.fullWidth],a)},l?(0,e.jsx)(fe,{type:"search",value:m,placeholder:u("phSearch"),onChange:e=>{g("string"==typeof e?e:"")},disabled:i}):null,(0,e.jsx)(v.MultiSelect,{values:p||[],defaultValues:n,onChange:R,placeholder:y,disabled:i,items:S,css:d.fullWidth}))};var nt=c(4945),st=c.n(nt);const ot=e=>Boolean(e.modules||e.submission||e.workspaces||e.parameters||e.geometryValidation),it=e=>{if(!e?.length)return[];const t=[],r=new Set;for(const n of e){if(!n||n.type!==o.QL.GEOMETRY)continue;if("string"!=typeof n.name)continue;const e=n.name.trim();e&&!r.has(e)&&(r.add(e),t.push(e))}return t},at=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1){const n=e[r],s=t[r];if(!n||!s)return!1;if(n.name!==s.name)return!1;if((n.title||"")!==(s.title||""))return!1;if((0,h.NnH)(n?.repository)!==(0,h.NnH)(s?.repository))return!1}return!0},lt=(e,t,r)=>{const n="string"==typeof e?e:(0,h.NnH)(e)??(e&&"object"==typeof e&&"message"in e?(0,h.NnH)(e.message):void 0)??"";if(!n)return r?r():"";try{const e=(0,h.I0Z)(n,t);if(e)return e}catch{}return r?r():n},ct=(e,t,r)=>{const n=e.current;if(n&&n.repository===r&&n.raw===t)return n.result;const s=((e,t)=>{if(!Array.isArray(e)||0===e.length)return o.R0;const r=(0,h.NnH)(t??void 0)??"",n=[];for(const t of e){if(!t||t.type!==o.h6)continue;if(!r){n.push(t);continue}const e=(0,h.NnH)(t?.repository);e&&e!==r||n.push(t)}return 0===n.length?o.R0:1===n.length?n:n.slice().sort(((e,t)=>(e.title||e.name).localeCompare(t.title||t.name,void 0,{sensitivity:"base"})))})(t,r);return n&&n.repository===r&&at(s,n.result)?(e.current={raw:t,repository:r,result:n.result},n.result):(e.current={raw:t,repository:r,result:s},s)},ut=(e,t,r)=>{const n=()=>e.convertParametersToFields(t);return{getFormConfig:n,validateValues:t=>{const s={...e.validateFormValues(t,(()=>{const e=r?.();return e&&e.length>0?e:n()})()).errors},o=t.start;if((0,h.YH$)(o))try{(0,y.Xz)(o.trim())||(s.start="invalidDateTimeFormat")}catch{s.start="invalidDateTimeFormat"}return{isValid:0===Object.keys(s).length,errors:s}},initializeValues:()=>(0,h.bE2)(n())}},dt=({orderResult:t,translate:r,onReuseGeography:n,onBack:s,onReset:i,config:a})=>{const l=(0,o.MN)(),[c,u]=e.React.useState(null),d=(0,h.j$x)(t,a),{hasResult:p,isCancelled:f,isSuccess:m,serviceMode:g}=d;let y=null;if(p&&t)if(f){const n=(t.code||"").toString().toUpperCase().includes("TIMEOUT")?"alertCancelledTimeout":"alertCancelledUser";y=(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Oe,{type:"warning",withIcon:!0,text:r(n)}))}else if(m)y="async"===g?(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Oe,{type:"info",withIcon:!0,text:r("alertAsyncSuccess")})):(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Oe,{type:"success",withIcon:!0,text:r("alertSyncSuccess")}));else{const n=(t.code||"").toString().toUpperCase(),s=t.message||t.statusMessage||"",o="FME_JOB_FAILURE"===n||/FME\s*Flow\s*transformation\s*failed/i.test(s)?"alertJobFailed":"async"===g?"alertAsyncError":"alertSyncError";y=(0,e.jsx)("div",{css:l.field},(0,e.jsx)(Oe,{type:"error",withIcon:!0,text:r(o)}))}const E=(0,h.JoK)(t,a,r,{onReuseGeography:n,onBack:s,onReset:i},void 0,c);return e.hooks.useEffectOnce((()=>{u(null);let e=null,r=null;const n=()=>{if(null!==r&&clearTimeout(r),e){const t=e;setTimeout((()=>{try{URL.revokeObjectURL(t)}catch{}}),o.ST.BLOB_URL_CLEANUP_DELAY_MS)}};if(!t)return n;if(!m||"sync"!==g)return n;!t.downloadUrl&&t.blob&&(e=URL.createObjectURL(t.blob),u(e));const s=t.downloadUrl||e;return s?(r=setTimeout((()=>{try{const e=document.createElement("a");e.href=s,e.download=t.downloadFilename||"download",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch{}}),o.ST.AUTO_DOWNLOAD_DELAY_MS),n):n})),(0,e.jsx)(e.React.Fragment,null,y,(0,e.jsx)(Ae,{state:E}))},pt=({workspaceParameters:t,workspaceName:r,workspaceItem:n,onBack:s,onSubmit:i,isSubmitting:a,translate:c,widgetId:u,config:d,geometryJson:f,jimuMapView:m})=>{const g=(0,h.qpp)(u),[y]=e.React.useState((()=>new p.DF)),[E,v]=e.React.useState([]),b=e.React.useRef([]),[w,S]=e.React.useState({}),R=f??null,[O,T]=e.React.useState((()=>(0,h.XTn)(R)));e.hooks.useEffectWithPreviousValues((()=>{const e=(0,h.XTn)(f??null);T((t=>t===e?t:e))}),[f]);const[A,I]=e.React.useState((()=>it(t)));e.hooks.useEffectWithPreviousValues((()=>{const e=it(t);I((t=>t.length===e.length&&t.every(((t,r)=>t===e[r]))?t:e))}),[t]);const _=e.hooks.useEventCallback((e=>c(1===e?"valSingleError":"valMultipleErrors"))),C=e.React.useRef(null),k=e.React.useRef(""),L=t.map((e=>e.name)).join(",");C.current&&k.current===L||(C.current=ut(y,t,(()=>b.current)),k.current=L);const M=C.current,N=(0,l.UA)(M);e.hooks.useEffectOnce((()=>{N.validateForm()})),e.hooks.useUpdateEffect((()=>{N.validateForm()}),[N.values,N.validateForm]),e.hooks.useUpdateEffect((()=>{N.resetForm(),S({}),b.current=[],v([])}),[r,t,N.resetForm]);const x=e.hooks.useEventCallback(((e,t)=>t instanceof File?(S((r=>({...r,[e]:t}))),void N.updateField(e,t.name)):null===t&&e in w?(S((t=>({...t,[e]:null}))),void N.updateField(e,"")):void N.updateField(e,t))),D=N.values,P=N.setValues,F=e.hooks.useLatest(D),j=e.hooks.useEventCallback((()=>{if(!M)return;const e=M.getFormConfig(),t=new Map;for(const e of b.current)t.set(e.name,e.visibilityState);const r=new Ne(F.current||{},e,t),n=e.map((e=>{const t=r.evaluate(e.visibility,e.name);return{...e,visibilityState:t}}));b.current=n,v(n);const s=[],o=[];for(const e of n)"hiddenDisabled"===e.visibilityState&&s.push(e.name),void 0!==e.visibilityState&&"visibleEnabled"!==e.visibilityState&&o.push(e.name);let i=!1;if(s.length){const e=F.current||{};let t;s.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&(t||(t={...e}),delete t[r])})),t&&(i=!0,P(t)),S((e=>{let t=null;return s.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&null!==e[r]&&(t||(t={...e}),t[r]=null)})),t??e}))}if(o.length){const e=N.errors;let t=null;o.forEach((r=>{Object.prototype.hasOwnProperty.call(e,r)&&(t||(t={...e}),delete t[r])})),t&&(N.setErrors(t),N.setIsValid(0===Object.keys(t).length))}i||N.validateForm()}));e.hooks.useEffectOnce((()=>{j()})),e.hooks.useUpdateEffect((()=>{j()}),[D,j]),e.hooks.useUpdateEffect((()=>{j()}),[M,j]),e.hooks.useEffectWithPreviousValues((()=>{if(!A.length)return;const e=O||"",t=F.current;if(!t)return;if(!A.some((r=>{const n=t?.[r];return(0,h.BvY)(n)!==e})))return;const r={...t};A.forEach((t=>{r[t]=e})),P(r)}),[A,O,F,P]);const U=e.hooks.useEventCallback((()=>{const e=N.validateForm();if(!e.isValid){const t=Object.keys(e.errors).length,r={message:_(t),type:o.By.VALIDATION,code:"FORM_INVALID",severity:o.MU.ERROR,recoverable:!0,timestampMs:Date.now(),kind:"serializable",userFriendlyMessage:"",suggestion:""};return void g.setError("general",r)}const t={...N.values};Object.keys(w).forEach((e=>{const r=w[e];r&&(t[e]=r)})),i({type:r,data:t})})),V=e.hooks.useEventCallback((e=>(0,h.OxR)(e))),W=e.hooks.useEventCallback((e=>{const t=(0,h.Z_x)(e);return t?(0,h.I0Z)(t,c):void 0}));return(0,e.jsx)(_e,{variant:"layout",title:n?.title||r,subtitle:n?.description?V(n.description):c("titleConfigParams"),onBack:s,onSubmit:U,isValid:N.isValid,loading:a},d?.allowRemoteDataset&&(0,e.jsx)(Ce,{label:c("lblUploadFile"),helper:c("hintUploadFile")},(0,e.jsx)(He,{field:{name:"__upload_file__",label:c("lblUploadFile"),type:o.Vw.FILE,required:!1,readOnly:!1},value:N.values.__upload_file__,onChange:e=>x("__upload_file__",e),translate:c,jimuMapView:m})),d?.allowRemoteDataset&&d?.allowRemoteUrlDataset&&(0,e.jsx)(Ce,{label:c("lblRemoteUrl"),helper:c("hintRemoteUrl")},(0,e.jsx)(me,{value:N.values.__remote_dataset_url__||"",onChange:e=>x("__remote_dataset_url__",e)})),(E.length>0?E:M.getFormConfig()).filter((e=>{const t=e.visibilityState??"visibleEnabled";return"visibleEnabled"===t||"visibleDisabled"===t})).map((t=>{if(!t||!t.name||!t.type)return null;const r=t.type===o.Vw.SWITCH||t.type===o.Vw.CHECKBOX,n="visibleDisabled"===t.visibilityState;return t.type===o.Vw.MESSAGE?(0,e.jsx)(He,{key:t.name,field:t,value:N.values[t.name],onChange:e=>x(t.name,e),translate:c,disabled:n,jimuMapView:m}):(0,e.jsx)(Ce,{key:t.name,label:t.label,required:t.required,error:W(N.errors[t.name]),helper:t.helper,check:r},(0,e.jsx)(He,{field:t,value:N.values[t.name],onChange:e=>x(t.name,e),translate:c,disabled:n,jimuMapView:m}))})).filter(Boolean))},ft=t=>{const{widgetId:r,state:n,instructionText:s,loadingState:a,canStartDrawing:c,error:u,onFormBack:d,onFormSubmit:p,orderResult:f,onReuseGeography:m,onBack:g,drawnArea:E,showHeaderActions:v,drawingMode:w=o.hL.POLYGON,onDrawingModeChange:S,isDrawing:R,clickCount:O,isValidatingGeometry:T=!1,onReset:A,canReset:I=!0,config:_,onWorkspaceSelected:C,selectedWorkspace:k,workspaceItems:L,workspaceParameters:M,workspaceItem:N,isPrefetchingWorkspaces:x=!1,geometryJson:D,jimuMapView:P,startupValidationStep:F,startupValidationError:j,onRetryValidation:U,submissionPhase:V="idle",modeNotice:W}=t,B=e.hooks.useTranslation(b),q=(0,o.MN)(),G=e.React.useRef();G.current||(G.current=r&&r.trim()?r:`__local_${Date.now()}_${Math.random().toString(36).slice(2,11)}`);const Q=G.current,$=(0,h.qpp)(Q),z=e.ReactRedux.useDispatch(),H=a??o.nc,[K,X]=e.React.useState(H),Y=e.hooks.useLatest(K),J=(0,l.d7)((e=>{X(e)}),o.ST.MIN_LOADING_DELAY_MS);e.hooks.useEffectWithPreviousValues((()=>{const e=Y.current,t=H;if(!(0,i.areLoadingStatesEqual)(e,t))return ot(t)?(J.cancel(),void X(t)):void(ot(e)?J(t):X(t));ot(t)||J.cancel()}),[H.modules,H.parameters,H.workspaces,H.submission,H.geometryValidation,J]);const Z=K,ee=Boolean(Z.modules),te=Boolean(Z.submission),re=Boolean(Z.workspaces),ne=c??!0,se=e.React.useRef([]),oe=e.hooks.useEventCallback((()=>o.qT.map((e=>({...e,label:B(e.label),tooltip:B(e.tooltip)})))));e.hooks.useUpdateEffect((()=>{se.current=oe()}),[oe]),0===se.current.length&&(se.current=oe());const ie=se.current,ae=e.hooks.useEventCallback((()=>{const t=(0,h.YH$)(s)?s:B("tipDrawMode");return(0,e.jsx)("div",{css:q.form.layout},(0,e.jsx)("div",{css:q.form.content},(0,e.jsx)("div",{css:[q.form.body,q.centered]},(0,e.jsx)("div",{css:q.typo.instruction,role:"status","aria-live":"polite","aria-atomic":!0},t),(0,e.jsx)(Te,{items:ie,value:w,onChange:e=>{S?.(e)},"aria-label":B("tipDrawMode")}))))})),le=e.hooks.useEventCallback(((t,r,n)=>{const s=[];if(Array.isArray(n))for(const e of n)null!=e&&s.push(e);const i=B("msgPleaseWait"),a=s.some((e=>"string"==typeof e&&e===i));return i&&i!==t&&i!==r&&!a&&s.push(i),(0,e.jsx)(Ae,{state:(0,o.aE)(t,r,s.length?s:void 0)})})),ce=e.hooks.useEventCallback(((t,r,n,s,i)=>{const a=[];n?a.push({label:B("btnRetry"),onClick:n}):r&&a.push({label:B("btnBack"),onClick:r});const l=(0,y.id)(_?.supportEmail),c=(0,h.EjJ)(B,l,i),u=lt(t,B,(()=>t)),d=c?ke(l,B,q,c):void 0;return(0,e.jsx)(Ae,{state:(0,o.Qg)(u,{code:s,actions:a,detail:d})})})),ue=(0,h.NnH)(_?.repository)??"",de=e.hooks.usePrevious(ue)??"",pe=(0,h.NnH)(_?.fmeServerUrl),fe=(0,h.NnH)(_?.fmeServerToken),he=Boolean(pe&&fe&&ue),[me,ge]=e.React.useState(null),ye=(0,l.CH)({repository:ue||void 0,fmeServerUrl:pe||void 0,fmeServerToken:fe||void 0},{enabled:he}),Ee=(0,l.SB)(me?.name,{repository:me?.repository??ue??void 0,fmeServerUrl:pe||void 0,fmeServerToken:fe||void 0},{enabled:Boolean(me&&he)}),ve=e.hooks.useLatest(ye.refetch),be=e.React.useRef(null),we=Array.isArray(L)?L:o.R0,Se=ue||null,Ie=Array.isArray(ye.data)?ye.data:o.R0,_e=ct(be,Ie,Se);e.hooks.useEffectWithPreviousValues((()=>{var e,t;e=_e,t=we,!he||e===o.R0&&0===t.length||e===t||at(e,t)||$.setWorkspaceItems(_e,_?.repository)}),[_e,we,he,_?.repository]),e.hooks.useUpdateEffect((()=>{he||(we.length&&$.clearWorkspaceState(_?.repository),me&&ge(null))}),[he,we.length,me,_?.repository]),e.hooks.useUpdateEffect((()=>{if(de===ue)return;if(ge(null),$.clearWorkspaceState(ue),!ue||!he)return;const e=ve.current;"function"==typeof e&&e()}),[ue,de,he]),e.hooks.useUpdateEffect((()=>{if(!me)return;const e=Ee.data;if(!e)return;const t=me.name;t&&(C?C(t,e.parameters,e.item):$.applyWorkspaceData({workspaceName:t,parameters:e.parameters,item:e.item}),ge(null))}),[me,Ee.data,C]);const Ce=we.length>0,Le=_e.length>0,Me=!!he&&Boolean(ye.isLoading||!Ce&&!Le&&ye.isFetching),Ne=Boolean(Ee.isLoading),xe=(0,l.bn)(z,r);e.hooks.useUpdateEffect((()=>{xe("workspaces",Me)}),[Me,xe]),e.hooks.useUpdateEffect((()=>{xe("parameters",Ne)}),[Ne,xe]);const De=e.hooks.useEventCallback(((e,t)=>!e||(0,h.zfx)(e)?null:lt(t,B,(()=>B(t))))),Pe=ye.isError&&he?De(ye.error,"failedToLoadWorkspaces"):null,Fe=(Ee.isError?De(Ee.error,"failedToLoadWorkspaceDetails"):null)||Pe,je=e.hooks.useEventCallback((()=>{if(ge(null),!he)return void $.clearWorkspaceState(_?.repository);const e=ve.current;"function"==typeof e&&e()})),Ue=e.hooks.useEventCallback((()=>we.map(((t,r)=>{const n=t.title||t.name,s=t.name&&t.name.trim()?t.name:`workspace-${r}`;return(0,e.jsx)("div",{key:s,role:"listitem","aria-label":n},(0,e.jsx)(Re,{text:n,icon:st(),type:"tertiary",onClick:()=>{const e=(0,h.NnH)(t?.repository)??Se??void 0;ge({name:t.name,repository:e})},logging:{enabled:!0,prefix:"FME-Export-WorkspaceSelection"}}))})))),Ve=()=>{const e=B("statusInitMap"),t=B("msgLoadingDraw");return ee?le(e,t,[B("tipDrawMode")]):ne?ae():le(e,t,[B("tipDrawMode")])},We=()=>{switch(n){case o.nE.INITIAL:return Ve();case o.nE.DRAWING:return 0===(O||0)?ae():(0,e.jsx)("div",{css:q.centered},(0,e.jsx)("div",{css:q.typo.instruction,role:"status","aria-live":"polite","aria-atomic":!0},s));case o.nE.EXPORT_OPTIONS:case o.nE.WORKSPACE_SELECTION:return Be();case o.nE.EXPORT_FORM:return qe();case o.nE.ORDER_RESULT:return ce(B("msgNoResult"),g);default:return Ve()}},Be=()=>{const t=Boolean(x&&we.length&&n===o.nE.WORKSPACE_SELECTION);if((0,h.Ynv)(re||t,we,n,Boolean(Fe))){const e=B("statusLoadWorkspaces"),r=t?"":B("statusLoadWorkspaces");return le(e,r)}if(Fe)return ce(Fe,g,je);if(!we.length){const t=[{label:B("btnRetry"),onClick:je},{label:B("btnBack"),onClick:g}];return(0,e.jsx)(Ae,{state:(0,o.Dd)(B("msgNoWorkspaces"),t)})}return(0,e.jsx)("div",{css:q.selection.container},(0,e.jsx)("div",{css:q.btn.group,role:"list"},Ue()))},qe=()=>d&&p?M&&k?(0,e.jsx)(e.React.Fragment,null,(()=>{if(!W)return null;const{messageKey:t,params:r,severity:n}=W;if(!t)return null;let s="";try{s=B(t,r||{})}catch{s=B(t)}if(!s)return null;const o="info"===n?"info":"warning";return(0,e.jsx)(Oe,{type:o,text:s,variant:"default",withIcon:!0})})(),(0,e.jsx)(pt,{widgetId:Q,workspaceParameters:M,workspaceName:k,workspaceItem:N,onBack:d,onSubmit:p,isSubmitting:te,translate:B,config:_,geometryJson:D,jimuMapView:P})):le(B("statusLoadWorkspaces")):ce(B("errNoConfig"),g);return(0,e.jsx)("div",{css:q.parent},(0,e.jsx)("div",{css:q.header},v?(()=>{let t=null;if(n!==o.nE.INITIAL&&!(n===o.nE.DRAWING&&0===(O||0))){(0,h.ARn)(A,I,n,E??0,R,O)&&(t=(0,e.jsx)(Re,{tooltip:B("tipCancel"),tooltipPlacement:"bottom",onClick:A,color:"inherit",type:"default",variant:"contained",text:B("btnCancel"),size:"sm","aria-label":B("tipCancel"),logging:{enabled:!0,prefix:"FME-Export-Header"},block:!1}))}return t||null})():null),(0,e.jsx)("div",{css:q.content},n===o.nE.STARTUP_VALIDATION?(()=>{if(j){const e=_?.supportEmail||"";return ce(j.message,void 0,U||(()=>{window.location.reload()}),j.code,j.userFriendlyMessage||e)}const e=F||B("statusValidating");return le(e)})():n===o.nE.ORDER_RESULT&&f?(0,e.jsx)(dt,{orderResult:f,translate:B,onReuseGeography:m,onBack:g,onReset:A,config:_}):te?(()=>{const e=Boolean(_?.syncMode),t=B(e?"submittingOrderSync":"submittingOrder");let r=null;switch(V){case"preparing":r="statusPreparing";break;case"uploading":r="statusUploading";break;default:r=null}return le(t,B(r||(e?"msgProcessingWait":"msgPleaseWait")))})():Boolean(u)?ce(u.message,void 0,"info"!==u.severity?g:void 0,u.code,u.userFriendlyMessage):!T||n!==o.nE.DRAWING&&n!==o.nE.EXPORT_OPTIONS&&n!==o.nE.WORKSPACE_SELECTION?We():(0,e.jsx)(Ae,{state:(0,o.aE)(B("statusValidateGeom"),B("msgCheckGeom"))})))},ht=e=>"object"==typeof e&&null!==e&&"function"==typeof e.then,mt=e=>e,gt=e=>e,yt=e=>e;function Et(r){const{id:n,widgetId:c,useMapWidgetIds:u,dispatch:E,config:v}=r,w=(0,h.P9t)({id:n,widgetId:c}),S=e.React.useRef(null);S.current&&S.current.widgetId===w||(S.current={widgetId:w,selectors:(0,i.createFmeSelectors)(w)});const R=S.current.selectors,O=e.ReactRedux.useSelector(R.selectViewMode),T=e.ReactRedux.useSelector(R.selectDrawingTool),A=e.ReactRedux.useSelector(R.selectGeometryJson),I=e.ReactRedux.useSelector(R.selectDrawnArea),_=e.ReactRedux.useSelector(R.selectWorkspaceItems),C=e.ReactRedux.useSelector(R.selectWorkspaceParameters),k=e.ReactRedux.useSelector(R.selectWorkspaceItem),L=e.ReactRedux.useSelector(R.selectSelectedWorkspace),M=e.ReactRedux.useSelector(R.selectOrderResult),N=e.ReactRedux.useSelector(R.selectLoading,s),x=e.ReactRedux.useSelector(R.selectLoadingFlag("submission")),D=e.ReactRedux.useSelector(R.selectLoadingFlag("geometryValidation")),P=e.ReactRedux.useSelector(R.selectCanExport),F=e.ReactRedux.useSelector(R.selectPrimaryError),j=e.hooks.usePrevious(O),U=e.hooks.useEventCallback((e=>{if(!e)return null;const t="number"==typeof e.timestampMs?e.timestampMs:Date.now();return{...e,timestamp:new Date(t),timestampMs:t,kind:"runtime"}})),V="general"===F?.scope?F.details:null,W=U(V),B=V?.severity===o.MU.ERROR,q=F?.details??null,G=v?.repository??null,Q=(0,l.ho)(_,{repository:v?.repository??void 0,fmeServerUrl:v?.fmeServerUrl,fmeServerToken:v?.fmeServerToken},{enabled:O===o.nE.WORKSPACE_SELECTION&&_.length>0&&!B}),{isPrefetching:$,progress:z,prefetchStatus:H}=Q,K=z?{loaded:z.loaded,total:z.total}:null,X=ee(),Y=e.hooks.useTranslation(b),J=e.hooks.useEventCallback((e=>Y(e))),Z=e.hooks.useCancelablePromiseMaker(),te=e.hooks.useLatest(v),re=e.hooks.useLatest(O),ne=e.hooks.useLatest(T),[se,oe]=e.React.useState(!1),ie=e.React.useRef(null),ae=e.React.useRef(null),le=e.React.useRef(!1),ce=e.React.useRef(null),ue=e.React.useRef(Symbol(`fme-popup-${w}`)),de=e.hooks.usePrevious(w);e.hooks.useUpdateEffect((()=>{if(de&&de!==w){const e=ue.current;e&&h.Fv9.release(e),ue.current=Symbol(`fme-popup-${w}`)}}),[w,de]);const pe=e.React.useRef(null),fe=(0,h.qpp)(w),[he,me]=e.React.useState({isActive:!1,clickCount:0}),[ge,ye]=e.React.useState("idle"),[Ee,ve]=e.React.useState(""),be=e.hooks.useEventCallback((e=>{me((t=>({...t,...e})))})),we=e.hooks.useEventCallback((e=>{"normalizing"!==e?"resolvingDataset"!==e?"applyingDefaults"!==e&&"complete"!==e||ye("finalizing"):ye("uploading"):ye("preparing")})),Se=e.hooks.useEventCallback((e=>{ne.current!==e&&fe.setDrawingTool(e)})),[Re,Oe]=e.React.useState(!1),[Te,Ie]=e.React.useState(null),[_e,Ce]=e.React.useState(),Le=O===o.nE.STARTUP_VALIDATION,Me=Le&&V?V:null,Ne=Le?W:null,xe=Le&&!Me,De=Le?_e:void 0,Pe=e.hooks.useEventCallback((e=>{Oe(Boolean(e))})),Fe=e.hooks.useEventCallback((()=>{Ie(null)})),je=e.hooks.useEventCallback(((e,t,r)=>{if(!e)return void Ie(null);const n={};let s="forcedAsyncArea";"url_length"===e.reason?(s="forcedAsyncUrlLength","number"==typeof e.urlLength&&(n.urlLength=e.urlLength.toLocaleString())):("number"==typeof e.value&&(n.area=t&&r?.view?.spatialReference?(0,h.JdW)(e.value,t,r.view.spatialReference):Math.max(0,Math.round(e.value)).toLocaleString()),"number"==typeof e.threshold&&(n.threshold=t&&r?.view?.spatialReference?(0,h.JdW)(e.threshold,t,r.view.spatialReference):Math.max(0,Math.round(e.threshold)).toLocaleString())),Ie({messageKey:s,severity:"warning",params:n})})),Ue=e.hooks.useEventCallback((()=>{null!=pe.current&&("undefined"!=typeof window&&window.clearTimeout(pe.current),pe.current=null)}));e.hooks.useUpdateEffect((()=>{Le||Ce(void 0)}),[Le]);const Ve=e.hooks.useEventCallback((e=>{if(!e?.view)return;const t=e.view,r=t.popup;if(r){h.Fv9.acquire(ue.current,r,t);try{"function"==typeof t.closePopup&&t.closePopup()}catch(e){(0,h.fAF)("Failed to close map popup",e)}}})),We=e.hooks.useEventCallback((()=>{h.Fv9.release(ue.current)})),Be=e.hooks.useEventCallback((()=>{const t=te.current?.autoCloseOtherWidgets;if(void 0===t||t)try{const t="function"==typeof e.getAppStore?(0,e.getAppStore)():null,r=t?.getState?.(),n=r?.widgetsRuntimeInfo,s=te.current?.widgetCloseExceptions,o=(0,h.UEQ)(n,w,s);if(o.length){const t=o.filter((e=>{const t=n?.[e];return Boolean(t?.isClassLoaded)}));t.length&&E(e.appActions.closeWidgets(t))}}catch(e){(0,h.fAF)("closeOtherWidgets error",e)}})),qe=(0,l.rG)(E,w),Ge=(0,h.bQb)(),Qe=e.hooks.useEventCallback((e=>{fe.clearError("export"),fe.clearError("import"),fe.setViewMode(e)})),$e=v?.drawingColor||o.Ve,ze={outlineWidth:v?.drawingOutlineWidth,fillOpacity:v?.drawingFillOpacity},He=e.React.useRef((0,h.gV5)((0,h.Xk1)($e),ze)),Ke=`${$e}-${v?.drawingOutlineWidth}-${v?.drawingFillOpacity}`,Xe=e.hooks.usePrevious(Ke);e.hooks.useUpdateEffect((()=>{Ke!==Xe&&(He.current=(0,h.gV5)((0,h.Xk1)($e),ze))}),[Ke,Xe,$e,ze]);const Ye=e.hooks.useEventCallback((()=>{if(ie.current?.dispose)try{ie.current.dispose()}catch(e){(0,h.fAF)("Failed to dispose FME client",e)}ie.current=null,ae.current=null})),Je=e.hooks.useEventCallback((()=>{const e=te.current;if(!e)throw new Error("FME client configuration unavailable");const t=[e.fmeServerUrl??e.fme_server_url??"",e.fmeServerToken??e.fme_server_token??e.fmw_server_token??"",e.repository??"",e.requestTimeout??""].map((e=>null==e?"":"number"==typeof e?String(e):"string"==typeof e?e:"")).join("|");if(ie.current&&ae.current===t||(Ye(),ie.current=(0,a.ER)(e),ae.current=t),!ie.current)throw new Error("Failed to initialize FME client");return ie.current}));e.hooks.useUpdateEffect((()=>{v||Ye()}),[v]),e.hooks.useUpdateEffect((()=>{v?.fmeServerUrl&&v?.fmeServerToken||Ue()}),[v?.fmeServerUrl,v?.fmeServerToken,v?.repository,Ue]),e.hooks.useUnmount((()=>{Ge.cancel(),xt.cancel(),Ye(),We(),Ue(),(0,h.Wz3)(ce.current),ce.current=null}));const Ze=e.hooks.useEventCallback((()=>{const e=ne.current;fe.resetState(),Pe(!1),fe.clearWorkspaceState(v?.repository),e&&fe.setDrawingTool(e)})),et=e.hooks.useEventCallback((()=>{fe.resetToDrawing(),Pe(!1),be({isActive:!1,clickCount:0})})),[tt,rt]=e.React.useState(0),nt=e.hooks.useEventCallback((()=>{rt((e=>e+1))})),st=e.hooks.useEventCallback(((t,r)=>{if((0,h.bNn)(t))return null;const n=(0,y.id)(te.current?.supportEmail),s=(0,h.OkK)(t,J,n),i=s.message,a=(0,h.GCs)(t,{onRetry:r??(()=>{fe.clearError("general");const e=(t?.code||"").toUpperCase();if("GEOMETRY_INVALID"===e||"INVALID_GEOMETRY"===e||"AREA_TOO_LARGE"===e){oe(!0),fe.setViewMode(o.nE.DRAWING);try{!dt&&ot&&ct&&qt(ct)}catch{}}}),onReload:(0,h.xsy)()?()=>{try{const e=globalThis.location;e&&"function"==typeof e.reload?e.reload():console.warn("Page reload not available in current environment")}catch{}}:void 0},J),l=(0,h.NnH)(s.hint),c=l?s.code?ke(n,J,X,l):l:void 0;return(0,e.jsx)(Ae,{state:(0,o.Qg)(i,{code:s.code,actions:a,detail:c})})})),{modules:ot,loading:it,errorKey:at}=(0,l.Gb)(tt),lt=(0,l.Vp)(),{jimuMapView:ct,setJimuMapView:ut,sketchViewModel:dt,setSketchViewModel:pt,graphicsLayer:Et,setGraphicsLayer:vt,setCleanupHandles:bt,teardownDrawingResources:wt,cleanupResources:St}=lt,Rt=(0,l.bn)(E,w);e.hooks.useUpdateEffect((()=>{Rt("modules",Boolean(it))}),[it,Rt]),e.hooks.useUpdateEffect((()=>{at&&qe(at,o.By.MODULE,"MAP_MODULES_LOAD_FAILED")}),[at,qe]),e.hooks.useUpdateEffect((()=>{!it&&ot&&"MAP_MODULES_LOAD_FAILED"===W?.code&&fe.clearError("general")}),[it,ot,W?.code]),e.hooks.useUpdateEffect((()=>{if(O!==o.nE.WORKSPACE_SELECTION)if(O!==o.nE.EXPORT_FORM)if(O!==o.nE.ORDER_RESULT)ve("");else{ve(J(M?.success?"msgOrderSuccess":"msgOrderFail"))}else ve(J("msgFormReady"));else ve(J("msgWorkspacesReady"))}),[O,M?.success,J]);const Ot=e.hooks.useEventCallback((()=>{if(!A||!ot?.Polygon)return null;const e=ot.Polygon;try{if("function"==typeof e?.fromJSON)return e.fromJSON(A)}catch{return null}return null}));e.hooks.useUpdateEffect((()=>{if(O!==o.nE.EXPORT_FORM||!te.current)return void Fe();let e=null;(0,h.MmJ)({data:{}},te.current,{workspaceItem:k,areaWarning:Re,drawnArea:I,onModeOverride:t=>{e=t}}),e?je(e,ot,ct):Fe()}),[O,k,Re,I,ot,ct,v?.syncMode,v?.largeArea,Fe,je]);const Tt=e.hooks.useWidgetActived(w),At=e.React.useRef((0,h.xry)(w));e.hooks.useUpdateEffect((()=>{At.current=(0,h.xry)(w)}),[w]);const It=At.current,_t=e.hooks.useEventCallback((e=>{oe(!1),e?.clearLocalGeometry&&be({clickCount:0}),dt&&(0,l.uB)(dt),be({isActive:!1})})),Ct=e.hooks.useEventCallback(((e,t)=>{_t(t),fe.setViewMode(e)})),kt=e.hooks.useEventCallback((e=>{Ce(e)})),Lt=e.hooks.useEventCallback((()=>{Ce(void 0),fe.clearError("general"),fe.completeStartup();const e=re.current,t=null==e,r=e===o.nE.STARTUP_VALIDATION||e===o.nE.INITIAL;(t||r)&&Qe(o.nE.DRAWING)})),Mt=e.hooks.useEventCallback((e=>{Ce(void 0),fe.setError("general",e)})),Nt=e.hooks.useEventCallback(((e,t)=>({message:J(e||"errorStartupFailed"),type:o.By.CONFIG,code:t,severity:o.MU.ERROR,recoverable:!0,timestampMs:Date.now(),userFriendlyMessage:v?.supportEmail?String(v.supportEmail):"",suggestion:J("btnRetryValidation"),kind:"serializable"}))),xt=(0,h.bQb)(),Dt=e.hooks.useEventCallback((async()=>{const e=xt.abortAndCreate();fe.clearError("general");try{const t=await(0,p.MB)({config:v,useMapWidgetIds:u?[...u]:[],translate:J,signal:e.signal,onProgress:kt});t?.success&&Lt()}catch(e){if((0,h.zfx)(e))return;let t=null;try{e instanceof Error&&e.message&&(t=JSON.parse(e.message))}catch{}const r=t||e,n=t?.message||(0,m.fV)(r,(0,y.Ko)(r)),s="object"==typeof r&&null!==r&&"code"in r&&"string"==typeof r.code?r.code:"STARTUP_VALIDATION_FAILED";Mt(Nt(n,s))}finally{xt.finalize(e)}})),Pt=e.hooks.useEventCallback((()=>{nt(),Dt()}));e.hooks.useEffectOnce((()=>(Dt(),()=>{xt.cancel()}))),e.hooks.useUpdateEffect((()=>{(0,f.setLoggingEnabled)(v?.enableLogging??!1)}),[v?.enableLogging]);const Ft=e.hooks.useEventCallback(((e=!1)=>{Ge.cancel(),xt.cancel(),Ce(void 0),oe(!1),e?St():wt(),be({isActive:!1,clickCount:0}),Ze()}));e.hooks.useEffectWithPreviousValues((e=>{let t;const r=()=>{void 0!==t&&window.clearTimeout(t)},n=e[0];if(!n)return r;const s=v,i=n?.fmeServerUrl!==s?.fmeServerUrl||n?.fmeServerToken!==s?.fmeServerToken||n?.repository!==s?.repository;try{i&&(Ft(!1),t=window.setTimeout((()=>{Dt()}),o.ST.POPUP_CLOSE_DELAY_MS))}catch{}return r}),[v]),e.hooks.useUpdateEffect((()=>{try{const e=Array.isArray(u)&&u.length>0;Ft(!e)}catch{}Dt()}),[u]);const jt=e.hooks.useEventCallback((()=>{(0,l.yN)(Et)})),Ut=e.hooks.useEventCallback((async e=>{if(!e.graphic?.geometry)return;if(le.current)return;const t=ce.current;(0,h.Wz3)(t);const r=new AbortController;ce.current=r,le.current=!0;try{_t(),Pe(!1),Rt("geometryValidation",!0);const t=await(0,p.G1)({geometry:e.graphic.geometry,modules:ot,graphicsLayer:Et,config:{areaThreshold:v.maxArea,largeAreaThreshold:v.largeArea},signal:r.signal});if(r.signal.aborted)return void Rt("geometryValidation",!1);if(!t.success){try{Et?.remove(e.graphic)}catch{}return void(r.signal.aborted||(Rt("geometryValidation",!1),wt(),fe.setGeometry(null,0),Pe(!1),Ct(o.nE.INITIAL,{clearLocalGeometry:!0}),t.error&&("ZERO_AREA"===t.error.code?qe(J("errGeomInvalid"),o.By.VALIDATION,"ZERO_AREA"):t.error.message?qe(t.error.message,o.By.VALIDATION,t.error.code):qe("GEOMETRY_ERROR",o.By.GEOMETRY,t.error.code))))}if(Pe(t.shouldWarn||!1),e.graphic&&t.geometry){e.graphic.geometry=t.geometry;const r=He.current?.HIGHLIGHT_SYMBOL;r&&(e.graphic.symbol=r)}t.geometry&&void 0!==t.area&&(fe.completeDrawing(t.geometry,t.area,o.nE.WORKSPACE_SELECTION),Rt("geometryValidation",!1))}catch(e){r.signal.aborted||(Pe(!1),Rt("geometryValidation",!1),qe(J("errDrawComplete"),o.By.VALIDATION,"DRAWING_COMPLETE_ERROR"))}finally{ce.current===r&&(ce.current=null),le.current=!1}})),Vt=e.hooks.useEventCallback((t=>{try{const r={jobId:t.jobId||t.code||"unknown",workspace:L||"unknown",status:t.success?"completed":"failed",downloadUrl:t.downloadUrl||"",message:t.message||"",timestamp:(new Date).toISOString(),serviceMode:t.serviceMode||"unknown"},n=new e.DataRecordSetChangeMessage(w,e.RecordSetChangeType.CreateUpdate,[r]);e.MessageManager.getInstance().publishMessage(n)}catch(e){}})),Wt=e.hooks.useEventCallback((e=>{It.isInactive($t)||(fe.setOrderResult(e),Qe(o.nE.ORDER_RESULT),Vt(e))})),Bt=e.hooks.useEventCallback((async t=>{if(x||!P)return;if(!It.isActive($t))return void(v?.enableLogging&&console.log(`[FME Widget ${w}] Submission aborted: widget not active`));const r=(0,g.M4)(I,v?.maxArea);if(!r.ok&&r.message)return ye("idle"),void qe(r.message,o.By.VALIDATION,r.code);e.ReactDOM.unstable_batchedUpdates((()=>{fe.setLoadingFlag("submission",!0),ye("preparing"),Fe()}));try{if(It.isInactive($t))return v?.enableLogging&&console.log(`[FME Widget ${w}] Submission aborted during prep: widget inactive`),ye("idle"),void fe.setLoadingFlag("submission",!1);const e=Je(),r=t?.data||{};(0,h.MmJ)({data:r},te.current,{workspaceItem:k,areaWarning:Re,drawnArea:I,onModeOverride:je});const n=await(0,p.JV)({formData:t,config:te.current,geometryJson:A,geometry:Ot()||void 0,modules:ot,workspaceParameters:C,workspaceItem:k,selectedWorkspace:L,areaWarning:Re,drawnArea:I,fmeClient:e,submissionAbort:Ge,widgetId:w,translate:J,makeCancelable:Z,onStatusChange:we,getActiveGeometry:Ot});if(It.isInactive($t))return void(v?.enableLogging&&console.log(`[FME Widget ${w}] Submission completed but widget inactive, skipping finalize`));if(!n.success&&n.error){const e=n.error;if(e&&"object"==typeof e&&"kind"in e)return ye("idle"),void fe.setError("general",e)}if(n.result&&(Wt(n.result),n.result.success&&L))try{d.q.invalidateQueries({queryKey:["fme","workspace-item",L]})}catch(e){}}catch(e){(0,h.zfx)(e)||qe(J("errJobSubmit"),o.By.MODULE,"SUBMISSION_UNEXPECTED_ERROR")}finally{ye("idle"),fe.setLoadingFlag("submission",!1)}})),qt=e.hooks.useEventCallback((e=>{if(ut(e),ot)try{Ve(e);const t=(0,p.fW)(e,ot,vt);try{t.title=J("lblDrawLayer")}catch{}const r=He.current.DRAWING_SYMBOLS,{sketchViewModel:n,cleanup:s}=(0,p.CY)({jmv:e,modules:ot,layer:t,onDrawComplete:Ut,dispatch:E,widgetId:w,symbols:{polygon:mt(r.polygon),polyline:gt(r.polyline),point:yt(r.point)},onDrawingSessionChange:be,onSketchToolStart:Se});bt(s),pt(n)}catch(e){qe(J("errMapInit"),o.By.MODULE,"MAP_INIT_ERROR")}}));e.hooks.useUpdateEffect((()=>{ot&&ct&&!dt&&qt(ct)}),[ot,ct,dt,qt]),e.hooks.useUpdateEffect((()=>{if(!se||!dt)return;oe(!1);const e=(T??o.hL.POLYGON)===o.hL.RECTANGLE?"rectangle":"polygon";if("function"==typeof dt.create)try{const t=dt.create.bind(dt)(e);ht(t)&&t.catch((e=>{(0,h.zfx)(e)||qe("errorStartDrawing",o.By.MODULE,"SKETCH_CREATE_FAILED"),(0,h.fAF)("Sketch create promise error",e)}))}catch(e){(0,h.fAF)("Sketch auto-start error",e)}}),[se,dt,T]),e.hooks.useUpdateEffect((()=>{const e=He.current.DRAWING_SYMBOLS,t=mt(e.polygon),r=e=>{"polygon"===e.geometry?.type&&(e.symbol=t)};if(dt)try{const n=dt,s=gt(e.polyline),o=yt(e.point);n.polygonSymbol=t,n.polylineSymbol=s,n.pointSymbol=o;const i=n.viewModel,a=i?.graphic;a&&r(a);const l=i?.previewGraphic;l&&r(l);const c=i?.sketchGraphicsLayer;c?.graphics&&c.graphics.forEach((e=>{r(e)}))}catch{}if(Et?.graphics)try{Et.graphics.forEach((e=>{r(e)}))}catch{}}),[dt,Et,v?.drawingColor,v?.drawingOutlineWidth,v?.drawingFillOpacity]),e.hooks.useUpdateEffect((()=>{!Tt&&dt&&(0,l.uB)(dt)}),[Tt,dt]),e.hooks.useUpdateEffect((()=>{const e=ct;return()=>{e&&St()}}),[ct,St]),e.hooks.useEffectOnce((()=>()=>{Ge.cancel(),xt.cancel(),Ye(),St(),fe.removeWidgetState()}));const Gt=e.hooks.useEventCallback(((e,t)=>0===t?J("hintClickMap"):e===o.hL.RECTANGLE?J("hintDrawRect"):e===o.hL.POLYGON?J(t<3?"hintDrawContinue":"hintDrawComplete"):J("hintSelectMode"))),Qt=e.hooks.useEventCallback((t=>{if(!dt)return;e.ReactDOM.unstable_batchedUpdates((()=>{be({isActive:!0,clickCount:0}),fe.setDrawingTool(t),fe.setViewMode(o.nE.DRAWING),Pe(!1)})),jt();try{const e=dt;Boolean("active"===e?.state||e?._creating)&&(0,l.uB)(dt)}catch{(0,l.uB)(dt)}const r=t===o.hL.RECTANGLE?"rectangle":"polygon";if(dt&&"function"==typeof dt.create)try{const e=dt.create.bind(dt)(r);ht(e)&&e.catch((e=>{(0,h.fAF)("Sketch create promise error",e)}))}catch(e){(0,h.fAF)("Sketch create error",e)}})),$t=e.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo?.[w]?.state)),zt=e.hooks.usePrevious($t),Ht=e.hooks.usePrevious(G),Kt=e.hooks.usePrevious(Tt);e.hooks.useUpdateEffect((()=>{v?.enableLogging&&zt!==$t&&It.log(zt,$t,{viewMode:O,isActive:Tt,hasCriticalError:B})}),[$t,zt,O,Tt,B,v?.enableLogging,It]),e.hooks.useUpdateEffect((()=>{Tt&&!Kt?(Be(),ct&&Ve(ct)):!Tt&&Kt&&_t({clearLocalGeometry:!1})}),[Tt,Kt,Be,ct,Ve,_t]);const Xt=O===o.nE.DRAWING&&0===he.clickCount&&!he.isActive&&!le.current&&dt&&!x&&!B;e.hooks.useUpdateEffect((()=>{Xt&&It.isActive($t)&&Qt(T)}),[O,he.clickCount,he.isActive,T,dt,x,Qt,$t,B,It]);const Yt=e.hooks.useEventCallback((()=>{Ge.cancel(),ye("idle"),fe.setLoadingFlag("submission",!1),fe.setLoadingFlag("geometryValidation",!1),jt(),Pe(!1),be({isActive:!1,clickCount:0}),dt&&(0,l.uB)(dt),et(),Be(),ct&&Ve(ct)}));e.hooks.useUpdateEffect((()=>{It.isTransition(zt,$t,h.zzz.TO_CLOSED)&&Yt()}),[$t,zt,Yt,It]),e.hooks.useUpdateEffect((()=>{if(It.isTransition(zt,$t,h.zzz.FROM_CLOSED)){Be(),ct&&Ve(ct);const e=re.current;e!==o.nE.ORDER_RESULT&&e!==o.nE.EXPORT_FORM&&e!==o.nE.WORKSPACE_SELECTION||et(),Dt()}}),[$t,zt,ct,Be,Ve,et,It,Dt]),e.hooks.useUpdateEffect((()=>{B&&wt()}),[B,wt]),e.hooks.useUpdateEffect((()=>{if(!Boolean(A))return void(Re&&Pe(!1));const e=(0,g.nW)(I,{maxArea:v?.maxArea,largeArea:v?.largeArea}).shouldWarn;e!==Re&&Pe(e)}),[A,I,Re,v?.largeArea,v?.maxArea,Pe]),e.hooks.useUpdateEffect((()=>{G!==Ht&&Re&&Pe(!1)}),[G,Ht,Re,Pe]),e.hooks.useUpdateEffect((()=>{It.isInactive($t)&&We()}),[$t,We,It]),e.hooks.useUpdateEffect((()=>{ct||We()}),[ct,We]);const Jt=e.hooks.useEventCallback(((e,t,r)=>{fe.applyWorkspaceData({workspaceName:e,parameters:t,item:r}),Qe(o.nE.EXPORT_FORM)})),Zt=e.hooks.useEventCallback((()=>{Qe(o.nE.INITIAL)})),er=e.hooks.useEventCallback((()=>{const e=re.current??O,t=o.lh[e]||o.nE.INITIAL;Qe(j&&j!==e?j:t)}));if(!w||"string"!=typeof w||!w.trim())return(0,e.jsx)("div",{css:X.parent},(0,e.jsx)(Ae,{state:(0,o.Qg)(J("errorWidgetIdMissing"),{code:"WIDGET_ID_MISSING"})}));if(it)return(0,e.jsx)("div",{css:X.parent},(0,e.jsx)(Ae,{state:{kind:"loading",message:J("statusPreparingMapTools")}}));if(!ot)return(0,e.jsx)("div",{css:X.parent},st({message:"errorMapInit",type:o.By.MODULE,code:"MAP_MODULES_LOAD_FAILED",severity:o.MU.ERROR,recoverable:!0,timestamp:new Date,timestampMs:Date.now()},Pt));if(Ne)return(0,e.jsx)("div",{css:X.parent},st(Ne,Dt));if(!Le&&B&&W)return(0,e.jsx)("div",{css:X.parent},st(W));const tr=(he.isActive||I>0)&&!x&&!it,rr=Boolean(u&&1===u.length);let nr=v;if(v){const e={...v,fmeServerToken:v.fmeServerToken};delete e.fme_server_token,delete e.fmw_server_token,nr=e}return(0,e.jsx)("div",{css:X.parent},rr&&(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:u[0],onActiveViewChange:qt}),(0,e.jsx)("div",{"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",left:"-10000px",width:"1px",height:"1px",overflow:"hidden"}},Ee),(0,e.jsx)(ft,{widgetId:w,config:nr,geometryJson:A,workspaceItems:_,state:O,error:q,instructionText:Gt(T,he.clickCount),loadingState:{...N,modules:it,submission:x},isPrefetchingWorkspaces:$,workspacePrefetchProgress:K,workspacePrefetchStatus:H,modules:ot,canStartDrawing:!!dt,submissionPhase:ge,modeNotice:Te,jimuMapView:ct?.view??null,onFormBack:()=>Qe(o.nE.WORKSPACE_SELECTION),onFormSubmit:Bt,orderResult:M,onReuseGeography:()=>Qe(o.nE.WORKSPACE_SELECTION),onBack:er,drawnArea:I,areaWarning:Re,formatArea:e=>(0,h.JdW)(e,ot,ct?.view?.spatialReference),drawingMode:T,onDrawingModeChange:e=>{fe.setDrawingTool(e),dt&&((0,l.uB)(dt),be({isActive:!1,clickCount:0}))},isDrawing:he.isActive,clickCount:he.clickCount,isCompleting:le.current,isValidatingGeometry:D,showHeaderActions:O!==o.nE.STARTUP_VALIDATION&&tr,onReset:Yt,canReset:!0,onWorkspaceSelected:Jt,onWorkspaceBack:Zt,selectedWorkspace:L,workspaceParameters:C,workspaceItem:k,isStartupValidating:xe,startupValidationStep:De,startupValidationError:Me,onRetryValidation:Dt}))}function vt(t){const n=()=>(0,h.P9t)({id:t.id,widgetId:t.widgetId});return e.hooks.useEffectOnce((()=>{(0,p.Ou)({widgetId:n(),config:t.config})})),e.hooks.useUpdateEffect((()=>{(0,p.c2)({widgetId:n(),config:t.config})}),[t.id,t.config]),(0,e.jsx)(r.Ht,{client:d.q},(0,e.jsx)(Et,{...t}),null)}function bt(e){c.p=e}Reflect.set(vt,"mapExtraStateProps",((e,t)=>{const r=e["fme-state"],n=(0,h.P9t)({id:t?.id,widgetId:t?.widgetId});return{state:(n?r?.byId?.[n]:void 0)||i.initialFmeState}}))})(),u})())}}}));